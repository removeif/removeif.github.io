{"pages":[{"title":"","text":"404","link":"/404.html"},{"title":"å…³äºæˆ‘","text":"ä¸ªäººç®€ä»‹ æœ¬ç§‘è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯ä¸“ä¸š ä»äº‹JAVAåç«¯å¼€å‘ ç ç•œä¸€æš åšä¿¡ä»£ç æ”¹å˜ä¸–ç•Œ åšå®¢ function createtime(){var n=new Date(\"11/11/2018 00:00:00\");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum=\"0\"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum=\"0\"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum=\"0\"+snum),document.getElementById(\"timeDate\").innerHTML=\"è‡ªâ¤ï¸2018.11.11â¤ï¸å·²è¿è¡Œ \"+dnum+\" å¤© \",document.getElementById(\"times\").innerHTML=hnum+\" å°æ—¶ \"+mnum+\" åˆ† \"+snum+\" ç§’ï¼\"}var now=new Date;setInterval(\"createtime()\",250) ç½‘ç«™é‡‡ç”¨çš„Icarusä¸»é¢˜ æœ¬ç«™æ¨èç´¢å¼• çŸ¥è¯†ç‚¹ ä¸­åäººåå…±å’Œå›½ç½‘ç»œå®‰å…¨æ³• Javaå¹¶å‘çŸ¥è¯†ç‚¹ å…¶ä»– ç½‘æ˜“äº‘éŸ³ä¹æ­Œå•åˆ†äº« è®°å½• 16:24:05/07/19/2019 ç›¸çœ‹ä¸¤ä¸åŒï¼Œåªæœ‰æ•¬äº­å±± â€“æç™½ 15:06:28/06/06/2019 çˆ±æƒ…å°±åƒåœ¨æµ·æ»©ä¸Šæ¡è´å£³ï¼Œä¸è¦æ¡æœ€å¤§çš„ï¼Œ ä¹Ÿä¸è¦æ¡æœ€æ¼‚äº®çš„ï¼Œè¦æ¡å°±æ¡è‡ªå·±æœ€å–œæ¬¢çš„ï¼Œ æœ€é‡è¦çš„æ˜¯æ¡åˆ°äº†è‡ªå·±å–œæ¬¢çš„ å°±æ°¸è¿œä¸è¦å†å»æµ·è¾¹äº†ã€‚ â€“å…¬ä¼—å·æ–‡ç«  11:07/05/22/2019 æ— è®ºèµ°åˆ°å“ªé‡Œï¼Œéƒ½åº”è¯¥è®°ä½ã€‚è¿‡å»éƒ½æ˜¯å‡çš„ï¼Œå›å¿†æ˜¯ä¸€æ¡æ²¡æœ‰å°½å¤´çš„è·¯ï¼Œä¸€åˆ‡ä»¥å¾€çš„æ˜¥å¤©éƒ½ä¸å¤å­˜åœ¨ï¼Œå°±è¿é‚£æœ€åšéŸ§è€Œåˆç‹‚ä¹±çš„çˆ±æƒ…å½’æ ¹ç»“åº•ä¹Ÿä¸è¿‡æ˜¯ä¸€ç§è½¬ç¬å³é€çš„ç°å®ã€‚ â€“é©¬å°”å…‹æ–¯ã€Šç™¾å¹´å­¤ç‹¬ã€‹ 11:05/05/22/2019 æˆ‘è§‰å¾—ç¾ä¸æ˜¯ä¸€åˆ‡ï¼Œå®ƒå¾ˆæµªè´¹äººç”Ÿã€‚ç¾è¦åŠ ä¸Šæ»‹å‘³ã€åŠ ä¸Šå¼€å¿ƒã€åŠ ä¸Šåˆ«çš„ä¸œè¥¿ï¼Œæ‰æ˜¯äººç”Ÿçš„ç¾æ»¡ã€‚ â€“å¼ æ›¼ç‰ 15:37/05/06/2019 Under no circumstances will I give up loving you.å±±æ— æ£±å¤©åœ°åˆæ‰æ•¢ä¸å›ç»ã€‚ â€“ã€Šmoocå­¦é™¢ã€‹ 17:15/04/26/2019 ä¸€ä¸ªäººæ— æ³•è‡ªæˆå­¤å²›ï¼Œè¦ä¹ˆè‡³å°‘ï¼Œä¸€ä¸ªäººæ— æ³•è‡ªæˆæœ€ç†æƒ³çš„å­¤å²›ã€‚ â€“ã€Šå²›ä¸Šä¹¦åº—ã€‹ 17:12/04/22/2019 ä½ å†™ä¸‹çš„æ¯ä¸€ä¸ªbugï¼Œéƒ½æ˜¯äººç±»åæŠ—è¢«äººå·¥æ™ºèƒ½ç»Ÿæ²»çš„ä¸€é¢—å­å¼¹ 17:12/04/22/2019 æ‰€è°“æ´»ç€å¹¶ä¸æ˜¯å•çº¯çš„å‘¼å¸ï¼Œå¿ƒè„è·³åŠ¨ï¼Œä¹Ÿä¸æ˜¯è„‘ç”µæ³¢ï¼Œè€Œæ˜¯åœ¨è¿™ä¸ªä¸–ç•Œä¸Šç•™ä¸‹ç—•è¿¹ã€‚è¦èƒ½çœ‹è§è‡ªå·±ä¸€è·¯èµ°æ¥çš„è„šå°ï¼Œå¹¶ç¡®ä¿¡é‚£äº›éƒ½æ˜¯è‡ªå·±ç•™ä¸‹çš„å°è®°ï¼Œè¿™æ‰å«æ´»ç€ã€‚ â€“ã€Šä¸œé‡åœ­å¾ã€‹ 2019è®¡åˆ’21:59/12/31/2018 2019-flag è´­ä¹°çš„ä¸“ä¸šä¹¦ç±è‡³å°‘çœ‹å®Œä¸€éï¼ˆå¹¶å‘ã€é‡æ„ã€è®¾è®¡æ¨¡å¼â€¦ï¼‰ å¾®ä¿¡è¯»ä¹¦æ¯å¤©ä¸€ä¸ªå°æ—¶(å¹´ç»ˆæ€»è®¡300å°æ—¶) åšæŒæ¯å‘¨å»ä¸¤æ¬¡å¥èº«æˆ¿(å¤šç»ƒè‚šå­ã€åŠ›é‡ã€å­¦ä¼šè¶æ³³) è‡³å°‘å®Œæˆä¸€é¡¹ å‰åç«¯åˆ†ç¦»é¡¹ç›® å®Œæˆä¸€é¡¹ å¾®æœåŠ¡é¡¹ç›®(ç±»ä¼¼å…¬å¸ä½¿ç”¨ç›¸å…³æŠ€æœ¯) ä¸è¾èŒ å¤šäº¤æœ‹å‹ã€å¤šæ¢ä½æ€è€ƒã€å¤šä¸æœ‹å‹äº¤æµæ²Ÿé€š å±…å®‰æ€å±ï¼Œå¤šæ€è€ƒå…³æ³¨ç›¸å…³ä¸“ä¸šå‰æ™¯ï¼Œç”Ÿæ´»ç¯å¢ƒ JavaåŸºç¡€æŠ€èƒ½å¼ºåŒ– å¤šä¹°ä¹¦ å­¦ä¹ æ›´å¤šçš„æ–°èœ(è‡³å°‘ä¸‰é¡¹) å°‘ä¹°ç”µå­äº§å“ï¼Œå°‘ç½‘è´­ï¼Œå°‘é€›æ•°ç äº§å“ å­¦è‹±è¯­è®°å•è¯ã€å­¦æ•°å­¦ã€å¤šçœ‹è§†é¢‘æ•™ç¨‹ å°‘ç©æ¸¸æˆ","link":"/about/index.html"},{"title":"ä¸ªäººç›¸å†Œ","text":"è®°å½•ç”Ÿæ´»ç¾å¥½ç¬é—´ å…¨éƒ¨æ¥è‡ªä¸ªäººæ‹ç…§ã€‚å› å›¾ç‰‡å­˜äºgithubä¸ŠåŠ è½½é€Ÿåº¦è¾ƒæ…¢ï¼Œè¯·è€å¿ƒç­‰å¾…ä¸€ä¸‹ã€‚æ¬¢è¿è®¿é—®500pxğŸ˜Šã€‚","link":"/album/index.html"},{"title":"categories","text":"","link":"/categories/index.html"},{"title":"æœ€æ–°è¯„è®ºåˆ—è¡¨","text":"ps:latest comment exists 10 minutes delayâ€¦","link":"/comment/index.html"},{"title":"éŸ³ä¹æ¬£èµ","text":"æ¸©é¦¨æç¤ºï¼šé€‰æ‹©å–œæ¬¢çš„éŸ³ä¹åŒå‡»æ’­æ”¾ï¼Œç”±äºç‰ˆæƒåŸå› éƒ¨åˆ†ä¸èƒ½æ’­æ”¾ã€‚å¦‚æœå–œæ¬¢æ­Œå•æ”¶è—ä¸€ä¸‹ï¼Œå»ç½‘æ˜“äº‘éƒ½èƒ½æ’­æ”¾å“Ÿï¼","link":"/music/index.html"},{"title":"ç•™è¨€æ¿","text":"ç•…æ‰€æ¬²è¨€æœ‰ç•™å¿…åº”","link":"/message/index.html"},{"title":"éŸ³ä¹æ­Œå•æ”¶è—","text":"æ¸©é¦¨æç¤ºï¼šé€‰æ‹©å–œæ¬¢çš„éŸ³ä¹åŒå‡»æ’­æ”¾ï¼Œç”±äºç‰ˆæƒåŸå› éƒ¨åˆ†ä¸èƒ½æ’­æ”¾ã€‚å¦‚æœå–œæ¬¢æ­Œå•æ”¶è—ä¸€ä¸‹ï¼Œå»ç½‘æ˜“äº‘éƒ½èƒ½æ’­æ”¾å“Ÿï¼","link":"/music1/index.html"},{"title":"tags","text":"","link":"/tags/index.html"}],"posts":[{"title":"mysqlé«˜æ€§èƒ½ä¼˜åŒ–è§„èŒƒæ–¹æ³•","text":"æ•°æ®åº“å‘½ä»¤è§„èŒƒ æ‰€æœ‰æ•°æ®åº“å¯¹è±¡åç§°å¿…é¡»ä½¿ç”¨å°å†™å­—æ¯å¹¶ç”¨ä¸‹åˆ’çº¿åˆ†å‰² æ‰€æœ‰æ•°æ®åº“å¯¹è±¡åç§°ç¦æ­¢ä½¿ç”¨mysqlä¿ç•™å…³é”®å­—ï¼ˆå¦‚æœè¡¨åä¸­åŒ…å«å…³é”®å­—æŸ¥è¯¢æ—¶ï¼Œéœ€è¦å°†å…¶ç”¨å•å¼•å·æ‹¬èµ·æ¥ï¼‰ æ•°æ®åº“å¯¹è±¡çš„å‘½åè¦èƒ½åšåˆ°è§åè¯†æ„ï¼Œå¹¶ä¸”æœ€åä¸è¦è¶…è¿‡32ä¸ªå­—ç¬¦ ä¸´æ—¶åº“è¡¨å¿…é¡»ä»¥tmp_ä¸ºå‰ç¼€å¹¶ä»¥æ—¥æœŸä¸ºåç¼€ï¼Œå¤‡ä»½è¡¨å¿…é¡»ä»¥bak_ä¸ºå‰ç¼€å¹¶ä»¥æ—¥æœŸ(æ—¶é—´æˆ³)ä¸ºåç¼€ æ‰€æœ‰å­˜å‚¨ç›¸åŒæ•°æ®çš„åˆ—åå’Œåˆ—ç±»å‹å¿…é¡»ä¸€è‡´ï¼ˆä¸€èˆ¬ä½œä¸ºå…³è”åˆ—ï¼Œå¦‚æœæŸ¥è¯¢æ—¶å…³è”åˆ—ç±»å‹ä¸ä¸€è‡´ä¼šè‡ªåŠ¨è¿›è¡Œæ•°æ®ç±»å‹éšå¼è½¬æ¢ï¼Œä¼šé€ æˆåˆ—ä¸Šçš„ç´¢å¼•å¤±æ•ˆï¼Œå¯¼è‡´æŸ¥è¯¢æ•ˆç‡é™ä½ï¼‰ æ•°æ®åº“åŸºæœ¬è®¾è®¡è§„èŒƒæ‰€æœ‰è¡¨å¿…é¡»ä½¿ç”¨Innodbå­˜å‚¨å¼•æ“æ²¡æœ‰ç‰¹æ®Šè¦æ±‚ï¼ˆå³Innodbæ— æ³•æ»¡è¶³çš„åŠŸèƒ½å¦‚ï¼šåˆ—å­˜å‚¨ï¼Œå­˜å‚¨ç©ºé—´æ•°æ®ç­‰ï¼‰çš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰è¡¨å¿…é¡»ä½¿ç”¨Innodbå­˜å‚¨å¼•æ“ï¼ˆmysql5.5ä¹‹å‰é»˜è®¤ä½¿ç”¨Myisamï¼Œ5.6ä»¥åé»˜è®¤çš„ä¸ºInnodbï¼‰ã€‚ Innodb æ”¯æŒäº‹åŠ¡ï¼Œæ”¯æŒè¡Œçº§é”ï¼Œæ›´å¥½çš„æ¢å¤æ€§ï¼Œé«˜å¹¶å‘ä¸‹æ€§èƒ½æ›´å¥½ã€‚ æ•°æ®åº“å’Œè¡¨çš„å­—ç¬¦é›†ç»Ÿä¸€ä½¿ç”¨UTF8å…¼å®¹æ€§æ›´å¥½ï¼Œç»Ÿä¸€å­—ç¬¦é›†å¯ä»¥é¿å…ç”±äºå­—ç¬¦é›†è½¬æ¢äº§ç”Ÿçš„ä¹±ç ï¼Œä¸åŒçš„å­—ç¬¦é›†è¿›è¡Œæ¯”è¾ƒå‰éœ€è¦è¿›è¡Œè½¬æ¢ä¼šé€ æˆç´¢å¼•å¤±æ•ˆï¼Œå¦‚æœæ•°æ®åº“ä¸­æœ‰å­˜å‚¨emojiè¡¨æƒ…çš„éœ€è¦ï¼Œå­—ç¬¦é›†éœ€è¦é‡‡ç”¨utf8mb4å­—ç¬¦é›†ã€‚ æ‰€æœ‰è¡¨å’Œå­—æ®µéƒ½éœ€è¦æ·»åŠ æ³¨é‡Šä½¿ç”¨commentä»å¥æ·»åŠ è¡¨å’Œåˆ—çš„å¤‡æ³¨ï¼Œä»ä¸€å¼€å§‹å°±è¿›è¡Œæ•°æ®å­—å…¸çš„ç»´æŠ¤ å°½é‡æ§åˆ¶å•è¡¨æ•°æ®é‡çš„å¤§å°ï¼Œå»ºè®®æ§åˆ¶åœ¨500ä¸‡ä»¥å†…ã€‚500ä¸‡å¹¶ä¸æ˜¯Mysqlæ•°æ®åº“çš„é™åˆ¶ï¼Œè¿‡å¤§ä¼šé€ æˆä¿®æ”¹è¡¨ç»“æ„ï¼Œå¤‡ä»½ï¼Œæ¢å¤éƒ½ä¼šæœ‰å¾ˆå¤§çš„é—®é¢˜ã€‚ å¯ä»¥ç”¨å†å²æ•°æ®å½’æ¡£ï¼ˆåº”ç”¨äºæ—¥å¿—æ•°æ®ï¼‰ï¼Œåˆ†åº“åˆ†è¡¨ï¼ˆåº”ç”¨äºä¸šåŠ¡æ•°æ®ï¼‰ç­‰æ‰‹æ®µæ¥æ§åˆ¶æ•°æ®é‡å¤§å° è°¨æ…ä½¿ç”¨Mysqlåˆ†åŒºè¡¨åˆ†åŒºè¡¨åœ¨ç‰©ç†ä¸Šè¡¨ç°ä¸ºå¤šä¸ªæ–‡ä»¶ï¼Œåœ¨é€»è¾‘ä¸Šè¡¨ç°ä¸ºä¸€ä¸ªè¡¨ï¼› è°¨æ…é€‰æ‹©åˆ†åŒºé”®ï¼Œè·¨åˆ†åŒºæŸ¥è¯¢æ•ˆç‡å¯èƒ½æ›´ä½ï¼› å»ºè®®é‡‡ç”¨ç‰©ç†åˆ†è¡¨çš„æ–¹å¼ç®¡ç†å¤§æ•°æ®ã€‚ å°½é‡åšåˆ°å†·çƒ­æ•°æ®åˆ†ç¦»ï¼Œå‡å°è¡¨çš„å®½åº¦Mysqlé™åˆ¶æ¯ä¸ªè¡¨æœ€å¤šå­˜å‚¨4096åˆ—ï¼Œå¹¶ä¸”æ¯ä¸€è¡Œæ•°æ®çš„å¤§å°ä¸èƒ½è¶…è¿‡65535å­—èŠ‚ã€‚ å‡å°‘ç£ç›˜IO,ä¿è¯çƒ­æ•°æ®çš„å†…å­˜ç¼“å­˜å‘½ä¸­ç‡ï¼ˆè¡¨è¶Šå®½ï¼ŒæŠŠè¡¨è£…è½½è¿›å†…å­˜ç¼“å†²æ± æ—¶æ‰€å ç”¨çš„å†…å­˜ä¹Ÿå°±è¶Šå¤§,ä¹Ÿä¼šæ¶ˆè€—æ›´å¤šçš„IOï¼‰ï¼› æ›´æœ‰æ•ˆçš„åˆ©ç”¨ç¼“å­˜ï¼Œé¿å…è¯»å…¥æ— ç”¨çš„å†·æ•°æ®ï¼› ç»å¸¸ä¸€èµ·ä½¿ç”¨çš„åˆ—æ”¾åˆ°ä¸€ä¸ªè¡¨ä¸­ï¼ˆé¿å…æ›´å¤šçš„å…³è”æ“ä½œï¼‰ã€‚ ç¦æ­¢åœ¨è¡¨ä¸­å»ºç«‹é¢„ç•™å­—æ®µé¢„ç•™å­—æ®µçš„å‘½åå¾ˆéš¾åšåˆ°è§åè¯†ä¹‰ã€‚ é¢„ç•™å­—æ®µæ— æ³•ç¡®è®¤å­˜å‚¨çš„æ•°æ®ç±»å‹ï¼Œæ‰€ä»¥æ— æ³•é€‰æ‹©åˆé€‚çš„ç±»å‹ã€‚ å¯¹é¢„ç•™å­—æ®µç±»å‹çš„ä¿®æ”¹ï¼Œä¼šå¯¹è¡¨è¿›è¡Œé”å®šã€‚ ç¦æ­¢åœ¨æ•°æ®åº“ä¸­å­˜å‚¨å›¾ç‰‡ï¼Œæ–‡ä»¶ç­‰å¤§çš„äºŒè¿›åˆ¶æ•°æ®é€šå¸¸æ–‡ä»¶å¾ˆå¤§ï¼Œä¼šçŸ­æ—¶é—´å†…é€ æˆæ•°æ®é‡å¿«é€Ÿå¢é•¿ï¼Œæ•°æ®åº“è¿›è¡Œæ•°æ®åº“è¯»å–æ—¶ï¼Œé€šå¸¸ä¼šè¿›è¡Œå¤§é‡çš„éšæœºIOæ“ä½œï¼Œæ–‡ä»¶å¾ˆå¤§æ—¶ï¼ŒIOæ“ä½œå¾ˆè€—æ—¶ã€‚ é€šå¸¸å­˜å‚¨äºæ–‡ä»¶æœåŠ¡å™¨ï¼Œæ•°æ®åº“åªå­˜å‚¨æ–‡ä»¶åœ°å€ä¿¡æ¯ ç¦æ­¢åœ¨çº¿ä¸Šåšæ•°æ®åº“å‹åŠ›æµ‹è¯•ç¦æ­¢ä»å¼€å‘ç¯å¢ƒï¼Œæµ‹è¯•ç¯å¢ƒç›´æ¥è¿æ¥ç”Ÿäº§ç¯å¢ƒæ•°æ®åº“ æ•°æ®åº“å­—æ®µè®¾è®¡è§„èŒƒä¼˜å…ˆé€‰æ‹©ç¬¦åˆå­˜å‚¨éœ€è¦çš„æœ€å°çš„æ•°æ®ç±»å‹åŸå› ï¼š åˆ—çš„å­—æ®µè¶Šå¤§ï¼Œå»ºç«‹ç´¢å¼•æ—¶æ‰€éœ€è¦çš„ç©ºé—´ä¹Ÿå°±è¶Šå¤§ï¼Œè¿™æ ·ä¸€é¡µä¸­æ‰€èƒ½å­˜å‚¨çš„ç´¢å¼•èŠ‚ç‚¹çš„æ•°é‡ä¹Ÿå°±è¶Šå°‘ä¹Ÿè¶Šå°‘ï¼Œåœ¨éå†æ—¶æ‰€éœ€è¦çš„IOæ¬¡æ•°ä¹Ÿå°±è¶Šå¤šï¼Œç´¢å¼•çš„æ€§èƒ½ä¹Ÿå°±è¶Šå·®ã€‚ æ–¹æ³•ï¼š å°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—ç±»å‹å­˜å‚¨ï¼Œå¦‚ï¼šå°†IPåœ°å€è½¬æ¢æˆæ•´å½¢æ•°æ®mysqlæä¾›äº†ä¸¤ä¸ªæ–¹æ³•æ¥å¤„ç†ipåœ°å€ inet_aton æŠŠipè½¬ä¸ºæ— ç¬¦å·æ•´å‹(4-8ä½) inet_ntoa æŠŠæ•´å‹çš„ipè½¬ä¸ºåœ°å€ æ’å…¥æ•°æ®å‰ï¼Œå…ˆç”¨inet_atonæŠŠipåœ°å€è½¬ä¸ºæ•´å‹ï¼Œå¯ä»¥èŠ‚çœç©ºé—´ï¼Œæ˜¾ç¤ºæ•°æ®æ—¶ï¼Œä½¿ç”¨inet_ntoaæŠŠæ•´å‹çš„ipåœ°å€è½¬ä¸ºåœ°å€æ˜¾ç¤ºå³å¯ã€‚ å¯¹äºéè´Ÿå‹çš„æ•°æ®ï¼ˆå¦‚è‡ªå¢IDã€æ•´å‹IPï¼‰æ¥è¯´ï¼Œè¦ä¼˜å…ˆä½¿ç”¨æ— ç¬¦å·æ•´å‹æ¥å­˜å‚¨åŸå› ï¼š æ— ç¬¦å·ç›¸å¯¹äºæœ‰ç¬¦å·å¯ä»¥å¤šå‡ºä¸€å€çš„å­˜å‚¨ç©ºé—´ 12SIGNED INT -2147483648~2147483647UNSIGNED INT 0~4294967295 VARCHAR(N)ä¸­çš„Nä»£è¡¨çš„æ˜¯å­—ç¬¦æ•°ï¼Œè€Œä¸æ˜¯å­—èŠ‚æ•°ï¼Œä½¿ç”¨UTF8å­˜å‚¨255ä¸ªæ±‰å­— Varchar(255)=765ä¸ªå­—èŠ‚ã€‚è¿‡å¤§çš„é•¿åº¦ä¼šæ¶ˆè€—æ›´å¤šçš„å†…å­˜ã€‚ é¿å…ä½¿ç”¨TEXTã€BLOBæ•°æ®ç±»å‹ï¼Œæœ€å¸¸è§çš„TEXTç±»å‹å¯ä»¥å­˜å‚¨64kçš„æ•°æ®å»ºè®®æŠŠBLOBæˆ–æ˜¯TEXTåˆ—åˆ†ç¦»åˆ°å•ç‹¬çš„æ‰©å±•è¡¨ä¸­Mysqlå†…å­˜ä¸´æ—¶è¡¨ä¸æ”¯æŒTEXTã€BLOBè¿™æ ·çš„å¤§æ•°æ®ç±»å‹ï¼Œå¦‚æœæŸ¥è¯¢ä¸­åŒ…å«è¿™æ ·çš„æ•°æ®ï¼Œåœ¨æ’åºç­‰æ“ä½œæ—¶ï¼Œå°±ä¸èƒ½ä½¿ç”¨å†…å­˜ä¸´æ—¶è¡¨ï¼Œå¿…é¡»ä½¿ç”¨ç£ç›˜ä¸´æ—¶è¡¨è¿›è¡Œã€‚è€Œä¸”å¯¹äºè¿™ç§æ•°æ®ï¼ŒMysqlè¿˜æ˜¯è¦è¿›è¡ŒäºŒæ¬¡æŸ¥è¯¢ï¼Œä¼šä½¿sqlæ€§èƒ½å˜å¾—å¾ˆå·®ï¼Œä½†æ˜¯ä¸æ˜¯è¯´ä¸€å®šä¸èƒ½ä½¿ç”¨è¿™æ ·çš„æ•°æ®ç±»å‹ã€‚ å¦‚æœä¸€å®šè¦ä½¿ç”¨ï¼Œå»ºè®®æŠŠBLOBæˆ–æ˜¯TEXTåˆ—åˆ†ç¦»åˆ°å•ç‹¬çš„æ‰©å±•è¡¨ä¸­ï¼ŒæŸ¥è¯¢æ—¶ä¸€å®šä¸è¦ä½¿ç”¨select * è€Œåªéœ€è¦å–å‡ºå¿…è¦çš„åˆ—ï¼Œä¸éœ€è¦TEXTåˆ—çš„æ•°æ®æ—¶ä¸è¦å¯¹è¯¥åˆ—è¿›è¡ŒæŸ¥è¯¢ã€‚ TEXTæˆ–BLOBç±»å‹åªèƒ½ä½¿ç”¨å‰ç¼€ç´¢å¼•å› ä¸ºMySQLå¯¹ç´¢å¼•å­—æ®µé•¿åº¦æ˜¯æœ‰é™åˆ¶çš„ï¼Œæ‰€ä»¥TEXTç±»å‹åªèƒ½ä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Œå¹¶ä¸”TEXTåˆ—ä¸Šæ˜¯ä¸èƒ½æœ‰é»˜è®¤å€¼çš„ é¿å…ä½¿ç”¨ENUMç±»å‹ä¿®æ”¹ENUMå€¼éœ€è¦ä½¿ç”¨ALTERè¯­å¥ ENUMç±»å‹çš„ORDER BYæ“ä½œæ•ˆç‡ä½ï¼Œéœ€è¦é¢å¤–æ“ä½œ ç¦æ­¢ä½¿ç”¨æ•°å€¼ä½œä¸ºENUMçš„æšä¸¾å€¼ å°½å¯èƒ½æŠŠæ‰€æœ‰åˆ—å®šä¹‰ä¸ºNOT NULLåŸå› ï¼š ç´¢å¼•NULLåˆ—éœ€è¦é¢å¤–çš„ç©ºé—´æ¥ä¿å­˜ï¼Œæ‰€ä»¥è¦å ç”¨æ›´å¤šçš„ç©ºé—´ è¿›è¡Œæ¯”è¾ƒå’Œè®¡ç®—æ—¶è¦å¯¹NULLå€¼åšç‰¹åˆ«çš„å¤„ç† ä½¿ç”¨TIMESTAMPï¼ˆ4ä¸ªå­—èŠ‚ï¼‰æˆ–DATETIMEç±»å‹ï¼ˆ8ä¸ªå­—èŠ‚ï¼‰å­˜å‚¨æ—¶é—´TIMESTAMP å­˜å‚¨çš„æ—¶é—´èŒƒå›´ 1970-01-01 00:00:01 ~ 2038-01-19-03:14:07 TIMESTAMP å ç”¨4å­—èŠ‚å’ŒINTç›¸åŒï¼Œä½†æ¯”INTå¯è¯»æ€§é«˜ è¶…å‡ºTIMESTAMPå–å€¼èŒƒå›´çš„ä½¿ç”¨DATETIMEç±»å‹å­˜å‚¨ ç»å¸¸ä¼šæœ‰äººç”¨å­—ç¬¦ä¸²å­˜å‚¨æ—¥æœŸå‹çš„æ•°æ®ï¼ˆä¸æ­£ç¡®çš„åšæ³•ï¼‰ ç¼ºç‚¹1ï¼šæ— æ³•ç”¨æ—¥æœŸå‡½æ•°è¿›è¡Œè®¡ç®—å’Œæ¯”è¾ƒ ç¼ºç‚¹2ï¼šç”¨å­—ç¬¦ä¸²å­˜å‚¨æ—¥æœŸè¦å ç”¨æ›´å¤šçš„ç©ºé—´ åŒè´¢åŠ¡ç›¸å…³çš„é‡‘é¢ç±»æ•°æ®å¿…é¡»ä½¿ç”¨decimalç±»å‹ éç²¾å‡†æµ®ç‚¹ï¼šfloat,double ç²¾å‡†æµ®ç‚¹ï¼šdecimal Decimalç±»å‹ä¸ºç²¾å‡†æµ®ç‚¹æ•°ï¼Œåœ¨è®¡ç®—æ—¶ä¸ä¼šä¸¢å¤±ç²¾åº¦ å ç”¨ç©ºé—´ç”±å®šä¹‰çš„å®½åº¦å†³å®šï¼Œæ¯4ä¸ªå­—èŠ‚å¯ä»¥å­˜å‚¨9ä½æ•°å­—ï¼Œå¹¶ä¸”å°æ•°ç‚¹è¦å ç”¨ä¸€ä¸ªå­—èŠ‚ å¯ç”¨äºå­˜å‚¨æ¯”bigintæ›´å¤§çš„æ•´å‹æ•°æ® ç´¢å¼•è®¾è®¡è§„èŒƒé™åˆ¶æ¯å¼ è¡¨ä¸Šçš„ç´¢å¼•æ•°é‡ï¼Œå»ºè®®å•å¼ è¡¨ç´¢å¼•ä¸è¶…è¿‡5ä¸ªç´¢å¼•å¹¶ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼ç´¢å¼•å¯ä»¥æé«˜æ•ˆç‡åŒæ ·å¯ä»¥é™ä½æ•ˆç‡ã€‚ ç´¢å¼•å¯ä»¥å¢åŠ æŸ¥è¯¢æ•ˆç‡ï¼Œä½†åŒæ ·ä¹Ÿä¼šé™ä½æ’å…¥å’Œæ›´æ–°çš„æ•ˆç‡ï¼Œç”šè‡³æœ‰äº›æƒ…å†µä¸‹ä¼šé™ä½æŸ¥è¯¢æ•ˆç‡ã€‚ å› ä¸ºmysqlä¼˜åŒ–å™¨åœ¨é€‰æ‹©å¦‚ä½•ä¼˜åŒ–æŸ¥è¯¢æ—¶ï¼Œä¼šæ ¹æ®ç»Ÿä¸€ä¿¡æ¯ï¼Œå¯¹æ¯ä¸€ä¸ªå¯ä»¥ç”¨åˆ°çš„ç´¢å¼•æ¥è¿›è¡Œè¯„ä¼°ï¼Œä»¥ç”Ÿæˆå‡ºä¸€ä¸ªæœ€å¥½çš„æ‰§è¡Œè®¡åˆ’ï¼Œå¦‚æœåŒæ—¶æœ‰å¾ˆå¤šä¸ªç´¢å¼•éƒ½å¯ä»¥ç”¨äºæŸ¥è¯¢ï¼Œå°±ä¼šå¢åŠ mysqlä¼˜åŒ–å™¨ç”Ÿæˆæ‰§è¡Œè®¡åˆ’çš„æ—¶é—´ï¼ŒåŒæ ·ä¼šé™ä½æŸ¥è¯¢æ€§èƒ½ã€‚ ç¦æ­¢ç»™è¡¨ä¸­çš„æ¯ä¸€åˆ—éƒ½å»ºç«‹å•ç‹¬çš„ç´¢å¼•5.6ç‰ˆæœ¬ä¹‹å‰ï¼Œä¸€ä¸ªsqlåªèƒ½ä½¿ç”¨åˆ°ä¸€ä¸ªè¡¨ä¸­çš„ä¸€ä¸ªç´¢å¼•ï¼Œ5.6ä»¥åï¼Œè™½ç„¶æœ‰äº†åˆå¹¶ç´¢å¼•çš„ä¼˜åŒ–æ–¹å¼ï¼Œä½†æ˜¯è¿˜æ˜¯è¿œè¿œæ²¡æœ‰ä½¿ç”¨ä¸€ä¸ªè”åˆç´¢å¼•çš„æŸ¥è¯¢æ–¹å¼å¥½ã€‚ æ¯ä¸ªInnodbè¡¨å¿…é¡»æœ‰ä¸ªä¸»é”®Innodbæ˜¯ä¸€ç§ç´¢å¼•ç»„ç»‡è¡¨ï¼šæ•°æ®çš„å­˜å‚¨çš„é€»è¾‘é¡ºåºå’Œç´¢å¼•çš„é¡ºåºæ˜¯ç›¸åŒçš„ã€‚æ¯ä¸ªè¡¨éƒ½å¯ä»¥æœ‰å¤šä¸ªç´¢å¼•ï¼Œä½†æ˜¯è¡¨çš„å­˜å‚¨é¡ºåºåªèƒ½æœ‰ä¸€ç§ã€‚ Innodbæ˜¯æŒ‰ç…§ä¸»é”®ç´¢å¼•çš„é¡ºåºæ¥ç»„ç»‡è¡¨çš„ ä¸è¦ä½¿ç”¨æ›´æ–°é¢‘ç¹çš„åˆ—ä½œä¸ºä¸»é”®ï¼Œä¸é€‚ç”¨å¤šåˆ—ä¸»é”®ï¼ˆç›¸å½“äºè”åˆç´¢å¼•ï¼‰ ä¸è¦ä½¿ç”¨UUID,MD5,HASH,å­—ç¬¦ä¸²åˆ—ä½œä¸ºä¸»é”®ï¼ˆæ— æ³•ä¿è¯æ•°æ®çš„é¡ºåºå¢é•¿ï¼‰ ä¸»é”®å»ºè®®ä½¿ç”¨è‡ªå¢IDå€¼ å¸¸è§ç´¢å¼•åˆ—å»ºè®® å‡ºç°åœ¨SELECTã€UPDATEã€DELETEè¯­å¥çš„WHEREä»å¥ä¸­çš„åˆ— åŒ…å«åœ¨ORDER BYã€GROUP BYã€DISTINCTä¸­çš„å­—æ®µ å¹¶ä¸è¦å°†ç¬¦åˆ1å’Œ2ä¸­çš„å­—æ®µçš„åˆ—éƒ½å»ºç«‹ä¸€ä¸ªç´¢å¼•ï¼Œ é€šå¸¸å°†1ã€2ä¸­çš„å­—æ®µå»ºç«‹è”åˆç´¢å¼•æ•ˆæœæ›´å¥½ å¤šè¡¨joinçš„å…³è”åˆ— å¦‚ä½•é€‰æ‹©ç´¢å¼•åˆ—çš„é¡ºåºå»ºç«‹ç´¢å¼•çš„ç›®çš„æ˜¯ï¼šå¸Œæœ›é€šè¿‡ç´¢å¼•è¿›è¡Œæ•°æ®æŸ¥æ‰¾ï¼Œå‡å°‘éšæœºIOï¼Œå¢åŠ æŸ¥è¯¢æ€§èƒ½ ï¼Œç´¢å¼•èƒ½è¿‡æ»¤å‡ºè¶Šå°‘çš„æ•°æ®ï¼Œåˆ™ä»ç£ç›˜ä¸­è¯»å…¥çš„æ•°æ®ä¹Ÿå°±è¶Šå°‘ã€‚ åŒºåˆ†åº¦æœ€é«˜çš„æ”¾åœ¨è”åˆç´¢å¼•çš„æœ€å·¦ä¾§ï¼ˆåŒºåˆ†åº¦=åˆ—ä¸­ä¸åŒå€¼çš„æ•°é‡/åˆ—çš„æ€»è¡Œæ•°ï¼‰ å°½é‡æŠŠå­—æ®µé•¿åº¦å°çš„åˆ—æ”¾åœ¨è”åˆç´¢å¼•çš„æœ€å·¦ä¾§ï¼ˆå› ä¸ºå­—æ®µé•¿åº¦è¶Šå°ï¼Œä¸€é¡µèƒ½å­˜å‚¨çš„æ•°æ®é‡è¶Šå¤§ï¼ŒIOæ€§èƒ½ä¹Ÿå°±è¶Šå¥½ï¼‰ ä½¿ç”¨æœ€é¢‘ç¹çš„åˆ—æ”¾åˆ°è”åˆç´¢å¼•çš„å·¦ä¾§ï¼ˆè¿™æ ·å¯ä»¥æ¯”è¾ƒå°‘çš„å»ºç«‹ä¸€äº›ç´¢å¼•ï¼‰ é¿å…å»ºç«‹å†—ä½™ç´¢å¼•å’Œé‡å¤ç´¢å¼•ï¼ˆå¢åŠ äº†æŸ¥è¯¢ä¼˜åŒ–å™¨ç”Ÿæˆæ‰§è¡Œè®¡åˆ’çš„æ—¶é—´ï¼‰ é‡å¤ç´¢å¼•ç¤ºä¾‹ï¼šprimary key(id)ã€index(id)ã€unique index(id) å†—ä½™ç´¢å¼•ç¤ºä¾‹ï¼šindex(a,b,c)ã€index(a,b)ã€index(a) å¯¹äºé¢‘ç¹çš„æŸ¥è¯¢ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨è¦†ç›–ç´¢å¼•è¦†ç›–ç´¢å¼•ï¼šå°±æ˜¯åŒ…å«äº†æ‰€æœ‰æŸ¥è¯¢å­—æ®µ(where,select,ordery by,group byåŒ…å«çš„å­—æ®µ)çš„ç´¢å¼• è¦†ç›–ç´¢å¼•çš„å¥½å¤„ï¼š é¿å…Innodbè¡¨è¿›è¡Œç´¢å¼•çš„äºŒæ¬¡æŸ¥è¯¢Innodbæ˜¯ä»¥èšé›†ç´¢å¼•çš„é¡ºåºæ¥å­˜å‚¨çš„ï¼Œå¯¹äºInnodbæ¥è¯´ï¼ŒäºŒçº§ç´¢å¼•åœ¨å¶å­èŠ‚ç‚¹ä¸­æ‰€ä¿å­˜çš„æ˜¯è¡Œçš„ä¸»é”®ä¿¡æ¯ï¼Œå¦‚æœæ˜¯ç”¨äºŒçº§ç´¢å¼•æŸ¥è¯¢æ•°æ®çš„è¯ï¼Œåœ¨æŸ¥æ‰¾åˆ°ç›¸åº”çš„é”®å€¼åï¼Œè¿˜è¦é€šè¿‡ä¸»é”®è¿›è¡ŒäºŒæ¬¡æŸ¥è¯¢æ‰èƒ½è·å–æˆ‘ä»¬çœŸå®æ‰€éœ€è¦çš„æ•°æ®ã€‚ è€Œåœ¨è¦†ç›–ç´¢å¼•ä¸­ï¼ŒäºŒçº§ç´¢å¼•çš„é”®å€¼ä¸­å¯ä»¥è·å–æ‰€æœ‰çš„æ•°æ®ï¼Œé¿å…äº†å¯¹ä¸»é”®çš„äºŒæ¬¡æŸ¥è¯¢ ï¼Œå‡å°‘äº†IOæ“ä½œï¼Œæå‡äº†æŸ¥è¯¢æ•ˆç‡ã€‚ å¯ä»¥æŠŠéšæœºIOå˜æˆé¡ºåºIOåŠ å¿«æŸ¥è¯¢æ•ˆç‡ç”±äºè¦†ç›–ç´¢å¼•æ˜¯æŒ‰é”®å€¼çš„é¡ºåºå­˜å‚¨çš„ï¼Œå¯¹äºIOå¯†é›†å‹çš„èŒƒå›´æŸ¥æ‰¾æ¥è¯´ï¼Œå¯¹æ¯”éšæœºä»ç£ç›˜è¯»å–æ¯ä¸€è¡Œçš„æ•°æ®IOè¦å°‘çš„å¤šï¼Œå› æ­¤åˆ©ç”¨è¦†ç›–ç´¢å¼•åœ¨è®¿é—®æ—¶ä¹Ÿå¯ä»¥æŠŠç£ç›˜çš„éšæœºè¯»å–çš„IOè½¬å˜æˆç´¢å¼•æŸ¥æ‰¾çš„é¡ºåºIOã€‚ ç´¢å¼•SETè§„èŒƒå°½é‡é¿å…ä½¿ç”¨å¤–é”®çº¦æŸ ä¸å»ºè®®ä½¿ç”¨å¤–é”®çº¦æŸï¼ˆforeign keyï¼‰ï¼Œä½†ä¸€å®šè¦åœ¨è¡¨ä¸è¡¨ä¹‹é—´çš„å…³è”é”®ä¸Šå»ºç«‹ç´¢å¼• å¤–é”®å¯ç”¨äºä¿è¯æ•°æ®çš„å‚ç…§å®Œæ•´æ€§ï¼Œä½†å»ºè®®åœ¨ä¸šåŠ¡ç«¯å®ç° å¤–é”®ä¼šå½±å“çˆ¶è¡¨å’Œå­è¡¨çš„å†™æ“ä½œä»è€Œé™ä½æ€§èƒ½ æ•°æ®åº“SQLå¼€å‘è§„èŒƒå»ºè®®ä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥è¿›è¡Œæ•°æ®åº“æ“ä½œé¢„ç¼–è¯‘è¯­å¥å¯ä»¥é‡å¤ä½¿ç”¨è¿™äº›è®¡åˆ’ï¼Œå‡å°‘SQLç¼–è¯‘æ‰€éœ€è¦çš„æ—¶é—´ï¼Œè¿˜å¯ä»¥è§£å†³åŠ¨æ€SQLæ‰€å¸¦æ¥çš„SQLæ³¨å…¥çš„é—®é¢˜ã€‚ åªä¼ å‚æ•°ï¼Œæ¯”ä¼ é€’SQLè¯­å¥æ›´é«˜æ•ˆã€‚ ç›¸åŒè¯­å¥å¯ä»¥ä¸€æ¬¡è§£æï¼Œå¤šæ¬¡ä½¿ç”¨ï¼Œæé«˜å¤„ç†æ•ˆç‡ã€‚ é¿å…æ•°æ®ç±»å‹çš„éšå¼è½¬æ¢éšå¼è½¬æ¢ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆå¦‚: 1select name,phone from customer where id = '111'; å……åˆ†åˆ©ç”¨è¡¨ä¸Šå·²ç»å­˜åœ¨çš„ç´¢å¼•sé¿å…ä½¿ç”¨åŒ%å·çš„æŸ¥è¯¢æ¡ä»¶ã€‚å¦‚ï¼ša like '%123%'ï¼Œï¼ˆå¦‚æœæ— å‰ç½®%,åªæœ‰åç½®%ï¼Œæ˜¯å¯ä»¥ç”¨åˆ°åˆ—ä¸Šçš„ç´¢å¼•çš„ï¼‰ ä¸€ä¸ªSQLåªèƒ½åˆ©ç”¨åˆ°å¤åˆç´¢å¼•ä¸­çš„ä¸€åˆ—è¿›è¡ŒèŒƒå›´æŸ¥è¯¢ã€‚å¦‚ï¼šæœ‰ a,b,cåˆ—çš„è”åˆç´¢å¼•ï¼Œåœ¨æŸ¥è¯¢æ¡ä»¶ä¸­æœ‰aåˆ—çš„èŒƒå›´æŸ¥è¯¢ï¼Œåˆ™åœ¨b,cåˆ—ä¸Šçš„ç´¢å¼•å°†ä¸ä¼šè¢«ç”¨åˆ°ã€‚ åœ¨å®šä¹‰è”åˆç´¢å¼•æ—¶ï¼Œå¦‚æœaåˆ—è¦ç”¨åˆ°èŒƒå›´æŸ¥æ‰¾çš„è¯ï¼Œå°±è¦æŠŠaåˆ—æ”¾åˆ°è”åˆç´¢å¼•çš„å³ä¾§ï¼Œä½¿ç”¨left join æˆ– not existsæ¥ä¼˜åŒ–not in æ“ä½œï¼Œå› ä¸ºnot in ä¹Ÿé€šå¸¸ä¼šä½¿ç”¨ç´¢å¼•å¤±æ•ˆã€‚ æ•°æ®åº“è®¾è®¡æ—¶ï¼Œåº”è¯¥è¦å¯¹ä»¥åæ‰©å±•è¿›è¡Œè€ƒè™‘ç¨‹åºè¿æ¥ä¸åŒçš„æ•°æ®åº“ä½¿ç”¨ä¸åŒçš„è´¦å·ï¼Œè¿›åˆ¶è·¨åº“æŸ¥è¯¢ ä¸ºæ•°æ®åº“è¿ç§»å’Œåˆ†åº“åˆ†è¡¨ç•™å‡ºä½™åœ° é™ä½ä¸šåŠ¡è€¦åˆåº¦ é¿å…æƒé™è¿‡å¤§è€Œäº§ç”Ÿçš„å®‰å…¨é£é™© ç¦æ­¢ä½¿ç”¨SELECT * å¿…é¡»ä½¿ç”¨SELECT &lt;å­—æ®µåˆ—è¡¨&gt; æŸ¥è¯¢åŸå› ï¼š æ¶ˆè€—æ›´å¤šçš„CPUå’ŒIOä»¥ç½‘ç»œå¸¦å®½èµ„æº æ— æ³•ä½¿ç”¨è¦†ç›–ç´¢å¼• å¯å‡å°‘è¡¨ç»“æ„å˜æ›´å¸¦æ¥çš„å½±å“ ç¦æ­¢ä½¿ç”¨ä¸å«å­—æ®µåˆ—è¡¨çš„INSERTè¯­å¥å¦‚ï¼š 1insert into values ('a','b','c'); åº”ä½¿ç”¨ï¼š 1insert into t(c1,c2,c3) values ('a','b','c'); é¿å…ä½¿ç”¨å­æŸ¥è¯¢ï¼Œå¯ä»¥æŠŠå­æŸ¥è¯¢ä¼˜åŒ–ä¸ºjoinæ“ä½œé€šå¸¸å­æŸ¥è¯¢åœ¨inå­å¥ä¸­ï¼Œä¸”bä¸­ä¸ºç®€å•SQL(ä¸åŒ…å«unionã€group byã€order byã€limitä»å¥)æ—¶,æ‰å¯ä»¥æŠŠå­æŸ¥è¯¢è½¬åŒ–ä¸ºå…³è”æŸ¥è¯¢è¿›è¡Œä¼˜åŒ–ã€‚ å­æŸ¥è¯¢æ€§èƒ½å·®çš„åŸå› ï¼š å­æŸ¥è¯¢çš„ç»“æœé›†æ— æ³•ä½¿ç”¨ç´¢å¼•ï¼Œé€šå¸¸å­æŸ¥è¯¢çš„ç»“æœé›†ä¼šè¢«å­˜å‚¨åˆ°ä¸´æ—¶è¡¨ä¸­ï¼Œä¸è®ºæ˜¯å†…å­˜ä¸´æ—¶è¡¨è¿˜æ˜¯ç£ç›˜ä¸´æ—¶è¡¨éƒ½ä¸ä¼šå­˜åœ¨ç´¢å¼•ï¼Œæ‰€ä»¥æŸ¥è¯¢æ€§èƒ½ä¼šå—åˆ°ä¸€å®šçš„å½±å“ã€‚ç‰¹åˆ«æ˜¯å¯¹äºè¿”å›ç»“æœé›†æ¯”è¾ƒå¤§çš„å­æŸ¥è¯¢ï¼Œå…¶å¯¹æŸ¥è¯¢æ€§èƒ½çš„å½±å“ä¹Ÿå°±è¶Šå¤§ã€‚ ç”±äºå­æŸ¥è¯¢ä¼šäº§ç”Ÿå¤§é‡çš„ä¸´æ—¶è¡¨ä¹Ÿæ²¡æœ‰ç´¢å¼•ï¼Œæ‰€ä»¥ä¼šæ¶ˆè€—è¿‡å¤šçš„CPUå’ŒIOèµ„æºï¼Œäº§ç”Ÿå¤§é‡çš„æ…¢æŸ¥è¯¢ã€‚ é¿å…ä½¿ç”¨JOINå…³è”å¤ªå¤šçš„è¡¨å¯¹äºMysqlæ¥è¯´ï¼Œæ˜¯å­˜åœ¨å…³è”ç¼“å­˜çš„ï¼Œç¼“å­˜çš„å¤§å°å¯ä»¥ç”±join_buffer_sizeå‚æ•°è¿›è¡Œè®¾ç½®ã€‚ åœ¨Mysqlä¸­ï¼Œå¯¹äºåŒä¸€ä¸ªSQLå¤šå…³è”ï¼ˆjoinï¼‰ä¸€ä¸ªè¡¨ï¼Œå°±ä¼šå¤šåˆ†é…ä¸€ä¸ªå…³è”ç¼“å­˜ï¼Œå¦‚æœåœ¨ä¸€ä¸ªSQLä¸­å…³è”çš„è¡¨è¶Šå¤šï¼Œæ‰€å ç”¨çš„å†…å­˜ä¹Ÿå°±è¶Šå¤§ã€‚ å¦‚æœç¨‹åºä¸­å¤§é‡çš„ä½¿ç”¨äº†å¤šè¡¨å…³è”çš„æ“ä½œï¼ŒåŒæ—¶join_buffer_sizeè®¾ç½®çš„ä¹Ÿä¸åˆç†çš„æƒ…å†µä¸‹ï¼Œå°±å®¹æ˜“é€ æˆæœåŠ¡å™¨å†…å­˜æº¢å‡ºçš„æƒ…å†µï¼Œå°±ä¼šå½±å“åˆ°æœåŠ¡å™¨æ•°æ®åº“æ€§èƒ½çš„ç¨³å®šæ€§ã€‚ åŒæ—¶å¯¹äºå…³è”æ“ä½œæ¥è¯´ï¼Œä¼šäº§ç”Ÿä¸´æ—¶è¡¨æ“ä½œï¼Œå½±å“æŸ¥è¯¢æ•ˆç‡ï¼ŒMysqlæœ€å¤šå…è®¸å…³è”61ä¸ªè¡¨ï¼Œå»ºè®®ä¸è¶…è¿‡5ä¸ªã€‚ å‡å°‘åŒæ•°æ®åº“çš„äº¤äº’æ¬¡æ•°æ•°æ®åº“æ›´é€‚åˆå¤„ç†æ‰¹é‡æ“ä½œï¼Œåˆå¹¶å¤šä¸ªç›¸åŒçš„æ“ä½œåˆ°ä¸€èµ·ï¼Œå¯ä»¥æé«˜å¤„ç†æ•ˆç‡ã€‚ å¯¹åº”åŒä¸€åˆ—è¿›è¡Œoråˆ¤æ–­æ—¶ï¼Œä½¿ç”¨inä»£æ›¿orin çš„å€¼ä¸è¦è¶…è¿‡500ä¸ªï¼Œin æ“ä½œå¯ä»¥æ›´æœ‰æ•ˆçš„åˆ©ç”¨ç´¢å¼•ï¼Œorå¤§å¤šæ•°æƒ…å†µä¸‹å¾ˆå°‘èƒ½åˆ©ç”¨åˆ°ç´¢å¼•ã€‚ ç¦æ­¢ä½¿ç”¨order by rand() è¿›è¡Œéšæœºæ’åºorder by rand()ä¼šæŠŠè¡¨ä¸­æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æ•°æ®è£…è½½åˆ°å†…å­˜ä¸­ï¼Œç„¶ååœ¨å†…å­˜ä¸­å¯¹æ‰€æœ‰æ•°æ®æ ¹æ®éšæœºç”Ÿæˆçš„å€¼è¿›è¡Œæ’åºï¼Œå¹¶ä¸”å¯èƒ½ä¼šå¯¹æ¯ä¸€è¡Œéƒ½ç”Ÿæˆä¸€ä¸ªéšæœºå€¼ï¼Œå¦‚æœæ»¡è¶³æ¡ä»¶çš„æ•°æ®é›†éå¸¸å¤§ï¼Œå°±ä¼šæ¶ˆè€—å¤§é‡çš„CPUå’ŒIOåŠå†…å­˜èµ„æºã€‚ æ¨èåœ¨ç¨‹åºä¸­è·å–ä¸€ä¸ªéšæœºå€¼ï¼Œç„¶åä»æ•°æ®åº“ä¸­è·å–æ•°æ®çš„æ–¹å¼ã€‚ WHEREä»å¥ä¸­ç¦æ­¢å¯¹åˆ—è¿›è¡Œå‡½æ•°è½¬æ¢å’Œè®¡ç®—å¯¹åˆ—è¿›è¡Œå‡½æ•°è½¬æ¢æˆ–è®¡ç®—æ—¶ä¼šå¯¼è‡´æ— æ³•ä½¿ç”¨ç´¢å¼• ä¸æ¨èï¼š 1where date(create_time)='20190101' æ¨èï¼š 1where create_time &gt;= '20190101' and create_time &lt; '20190102' åœ¨æ˜æ˜¾ä¸ä¼šæœ‰é‡å¤å€¼æ—¶ä½¿ç”¨UNION ALL è€Œä¸æ˜¯UNION UNION ä¼šæŠŠä¸¤ä¸ªç»“æœé›†çš„æ‰€æœ‰æ•°æ®æ”¾åˆ°ä¸´æ—¶è¡¨ä¸­åå†è¿›è¡Œå»é‡æ“ä½œ UNION ALL ä¸ä¼šå†å¯¹ç»“æœé›†è¿›è¡Œå»é‡æ“ä½œ æ‹†åˆ†å¤æ‚çš„å¤§SQLä¸ºå¤šä¸ªå°SQL å¤§SQLé€»è¾‘ä¸Šæ¯”è¾ƒå¤æ‚ï¼Œéœ€è¦å ç”¨å¤§é‡CPUè¿›è¡Œè®¡ç®—çš„SQL MySQLä¸­ï¼Œä¸€ä¸ªSQLåªèƒ½ä½¿ç”¨ä¸€ä¸ªCPUè¿›è¡Œè®¡ç®— SQLæ‹†åˆ†åå¯ä»¥é€šè¿‡å¹¶è¡Œæ‰§è¡Œæ¥æé«˜å¤„ç†æ•ˆç‡ æ•°æ®åº“æ“ä½œè¡Œä¸ºè§„èŒƒè¶…100ä¸‡è¡Œçš„æ‰¹é‡å†™ï¼ˆUPDATEã€DELETEã€INSERTï¼‰æ“ä½œï¼Œè¦åˆ†æ‰¹å¤šæ¬¡è¿›è¡Œæ“ä½œå¤§æ‰¹é‡æ“ä½œå¯èƒ½ä¼šé€ æˆä¸¥é‡çš„ä¸»ä»å»¶è¿Ÿ ä¸»ä»ç¯å¢ƒä¸­,å¤§æ‰¹é‡æ“ä½œå¯èƒ½ä¼šé€ æˆä¸¥é‡çš„ä¸»ä»å»¶è¿Ÿï¼Œå¤§æ‰¹é‡çš„å†™æ“ä½œä¸€èˆ¬éƒ½éœ€è¦æ‰§è¡Œä¸€å®šé•¿çš„æ—¶é—´ï¼Œè€Œåªæœ‰å½“ä¸»åº“ä¸Šæ‰§è¡Œå®Œæˆåï¼Œæ‰ä¼šåœ¨å…¶ä»–ä»åº“ä¸Šæ‰§è¡Œï¼Œæ‰€ä»¥ä¼šé€ æˆä¸»åº“ä¸ä»åº“é•¿æ—¶é—´çš„å»¶è¿Ÿæƒ…å†µ binlogæ—¥å¿—ä¸ºrowæ ¼å¼æ—¶ä¼šäº§ç”Ÿå¤§é‡çš„æ—¥å¿— å¤§æ‰¹é‡å†™æ“ä½œä¼šäº§ç”Ÿå¤§é‡æ—¥å¿—ï¼Œç‰¹åˆ«æ˜¯å¯¹äºrowæ ¼å¼äºŒè¿›åˆ¶æ•°æ®è€Œè¨€ï¼Œç”±äºåœ¨rowæ ¼å¼ä¸­ä¼šè®°å½•æ¯ä¸€è¡Œæ•°æ®çš„ä¿®æ”¹ï¼Œæˆ‘ä»¬ä¸€æ¬¡ä¿®æ”¹çš„æ•°æ®è¶Šå¤šï¼Œäº§ç”Ÿçš„æ—¥å¿—é‡ä¹Ÿå°±ä¼šè¶Šå¤šï¼Œæ—¥å¿—çš„ä¼ è¾“å’Œæ¢å¤æ‰€éœ€è¦çš„æ—¶é—´ä¹Ÿå°±è¶Šé•¿ï¼Œè¿™ä¹Ÿæ˜¯é€ æˆä¸»ä»å»¶è¿Ÿçš„ä¸€ä¸ªåŸå› ã€‚ é¿å…äº§ç”Ÿå¤§äº‹åŠ¡æ“ä½œ å¤§æ‰¹é‡ä¿®æ”¹æ•°æ®ï¼Œä¸€å®šæ˜¯åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­è¿›è¡Œçš„ï¼Œè¿™å°±ä¼šé€ æˆè¡¨ä¸­å¤§æ‰¹é‡æ•°æ®è¿›è¡Œé”å®šï¼Œä»è€Œå¯¼è‡´å¤§é‡çš„é˜»å¡ï¼Œé˜»å¡ä¼šå¯¹MySQLçš„æ€§èƒ½äº§ç”Ÿéå¸¸å¤§çš„å½±å“ã€‚ ç‰¹åˆ«æ˜¯é•¿æ—¶é—´çš„é˜»å¡ä¼šå æ»¡æ‰€æœ‰æ•°æ®åº“çš„å¯ç”¨è¿æ¥ï¼Œè¿™ä¼šä½¿ç”Ÿäº§ç¯å¢ƒä¸­çš„å…¶ä»–åº”ç”¨æ— æ³•è¿æ¥åˆ°æ•°æ®åº“ï¼Œå› æ­¤ä¸€å®šè¦æ³¨æ„å¤§æ‰¹é‡å†™æ“ä½œè¦è¿›è¡Œåˆ†æ‰¹ å¯¹äºå¤§è¡¨ä½¿ç”¨pt-online-schema-changeä¿®æ”¹è¡¨ç»“æ„ é¿å…å¤§è¡¨ä¿®æ”¹äº§ç”Ÿçš„ä¸»ä»å»¶è¿Ÿ é¿å…åœ¨å¯¹è¡¨å­—æ®µè¿›è¡Œä¿®æ”¹æ—¶è¿›è¡Œé”è¡¨ å¯¹å¤§è¡¨æ•°æ®ç»“æ„çš„ä¿®æ”¹ä¸€å®šè¦è°¨æ…ï¼Œä¼šé€ æˆä¸¥é‡çš„é”è¡¨æ“ä½œï¼Œå°¤å…¶æ˜¯ç”Ÿäº§ç¯å¢ƒï¼Œæ˜¯ä¸èƒ½å®¹å¿çš„ã€‚ pt-online-schema-changeå®ƒä¼šé¦–å…ˆå»ºç«‹ä¸€ä¸ªä¸åŸè¡¨ç»“æ„ç›¸åŒçš„æ–°è¡¨ï¼Œå¹¶ä¸”åœ¨æ–°è¡¨ä¸Šè¿›è¡Œè¡¨ç»“æ„çš„ä¿®æ”¹ï¼Œç„¶åå†æŠŠåŸè¡¨ä¸­çš„æ•°æ®å¤åˆ¶åˆ°æ–°è¡¨ä¸­ï¼Œå¹¶åœ¨åŸè¡¨ä¸­å¢åŠ ä¸€äº›è§¦å‘å™¨ã€‚æŠŠåŸè¡¨ä¸­æ–°å¢çš„æ•°æ®ä¹Ÿå¤åˆ¶åˆ°æ–°è¡¨ä¸­ï¼Œåœ¨è¡Œæ‰€æœ‰æ•°æ®å¤åˆ¶å®Œæˆä¹‹åï¼ŒæŠŠæ–°è¡¨å‘½åæˆåŸè¡¨ï¼Œå¹¶æŠŠåŸæ¥çš„è¡¨åˆ é™¤æ‰ã€‚æŠŠåŸæ¥ä¸€ä¸ªDDLæ“ä½œï¼Œåˆ†è§£æˆå¤šä¸ªå°çš„æ‰¹æ¬¡è¿›è¡Œã€‚ ç¦æ­¢ä¸ºç¨‹åºä½¿ç”¨çš„è´¦å·èµ‹äºˆsuperæƒé™ å½“è¾¾åˆ°æœ€å¤§è¿æ¥æ•°é™åˆ¶æ—¶ï¼Œè¿˜è¿è¡Œ1ä¸ªæœ‰superæƒé™çš„ç”¨æˆ·è¿æ¥ superæƒé™åªèƒ½ç•™ç»™DBAå¤„ç†é—®é¢˜çš„è´¦å·ä½¿ç”¨ å¯¹äºç¨‹åºè¿æ¥æ•°æ®åº“è´¦å·ï¼Œéµå¾ªæƒé™æœ€å°åŸåˆ™ ç¨‹åºä½¿ç”¨æ•°æ®åº“è´¦å·åªèƒ½åœ¨ä¸€ä¸ªDBä¸‹ä½¿ç”¨ï¼Œä¸å‡†è·¨åº“ ç¨‹åºä½¿ç”¨çš„è´¦å·åŸåˆ™ä¸Šä¸å‡†æœ‰dropæƒé™ æ–‡ç« æ¥æº .","link":"/2019/08/21/mysqlé«˜æ€§èƒ½ä¼˜åŒ–è§„èŒƒæ–¹æ³•.html"},{"title":"Javaå®¹å™¨é›†åˆ","text":"å®¹å™¨ä¸»è¦åŒ…æ‹¬ Collection å’Œ Map ä¸¤ç§ï¼ŒCollection å­˜å‚¨ç€å¯¹è±¡çš„é›†åˆï¼Œè€Œ Map å­˜å‚¨ç€é”®å€¼å¯¹ï¼ˆä¸¤ä¸ªå¯¹è±¡ï¼‰çš„æ˜ å°„è¡¨ã€‚ æ¦‚è§ˆå®¹å™¨ä¸»è¦åŒ…æ‹¬ Collection å’Œ Map ä¸¤ç§ï¼ŒCollection å­˜å‚¨ç€å¯¹è±¡çš„é›†åˆï¼Œè€Œ Map å­˜å‚¨ç€é”®å€¼å¯¹ï¼ˆä¸¤ä¸ªå¯¹è±¡ï¼‰çš„æ˜ å°„è¡¨ã€‚ Collection 1. Set TreeSetï¼šåŸºäºçº¢é»‘æ ‘å®ç°ï¼Œæ”¯æŒæœ‰åºæ€§æ“ä½œï¼Œä¾‹å¦‚æ ¹æ®ä¸€ä¸ªèŒƒå›´æŸ¥æ‰¾å…ƒç´ çš„æ“ä½œã€‚ä½†æ˜¯æŸ¥æ‰¾æ•ˆç‡ä¸å¦‚ HashSetï¼ŒHashSet æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼ŒTreeSet åˆ™ä¸º O(logN)ã€‚ HashSetï¼šåŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œæ”¯æŒå¿«é€ŸæŸ¥æ‰¾ï¼Œä½†ä¸æ”¯æŒæœ‰åºæ€§æ“ä½œã€‚å¹¶ä¸”å¤±å»äº†å…ƒç´ çš„æ’å…¥é¡ºåºä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯è¯´ä½¿ç”¨ Iterator éå† HashSet å¾—åˆ°çš„ç»“æœæ˜¯ä¸ç¡®å®šçš„ã€‚ LinkedHashSetï¼šå…·æœ‰ HashSet çš„æŸ¥æ‰¾æ•ˆç‡ï¼Œä¸”å†…éƒ¨ä½¿ç”¨åŒå‘é“¾è¡¨ç»´æŠ¤å…ƒç´ çš„æ’å…¥é¡ºåºã€‚ 2. List ArrayListï¼šåŸºäºåŠ¨æ€æ•°ç»„å®ç°ï¼Œæ”¯æŒéšæœºè®¿é—®ã€‚ Vectorï¼šå’Œ ArrayList ç±»ä¼¼ï¼Œä½†å®ƒæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ LinkedListï¼šåŸºäºåŒå‘é“¾è¡¨å®ç°ï¼Œåªèƒ½é¡ºåºè®¿é—®ï¼Œä½†æ˜¯å¯ä»¥å¿«é€Ÿåœ°åœ¨é“¾è¡¨ä¸­é—´æ’å…¥å’Œåˆ é™¤å…ƒç´ ã€‚ä¸ä»…å¦‚æ­¤ï¼ŒLinkedList è¿˜å¯ä»¥ç”¨ä½œæ ˆã€é˜Ÿåˆ—å’ŒåŒå‘é˜Ÿåˆ—ã€‚ 3. Queue LinkedListï¼šå¯ä»¥ç”¨å®ƒæ¥å®ç°åŒå‘é˜Ÿåˆ—ã€‚ PriorityQueueï¼šåŸºäºå †ç»“æ„å®ç°ï¼Œå¯ä»¥ç”¨å®ƒæ¥å®ç°ä¼˜å…ˆé˜Ÿåˆ—ã€‚ Map TreeMapï¼šåŸºäºçº¢é»‘æ ‘å®ç°ã€‚ HashMapï¼šåŸºäºå“ˆå¸Œè¡¨å®ç°ã€‚ HashTableï¼šå’Œ HashMap ç±»ä¼¼ï¼Œä½†å®ƒæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè¿™æ„å‘³ç€åŒä¸€æ—¶åˆ»å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶å†™å…¥ HashTable å¹¶ä¸”ä¸ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚å®ƒæ˜¯é—ç•™ç±»ï¼Œä¸åº”è¯¥å»ä½¿ç”¨å®ƒã€‚ç°åœ¨å¯ä»¥ä½¿ç”¨ ConcurrentHashMap æ¥æ”¯æŒçº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸” ConcurrentHashMap çš„æ•ˆç‡ä¼šæ›´é«˜ï¼Œå› ä¸º ConcurrentHashMap å¼•å…¥äº†åˆ†æ®µé”ã€‚ LinkedHashMapï¼šä½¿ç”¨åŒå‘é“¾è¡¨æ¥ç»´æŠ¤å…ƒç´ çš„é¡ºåºï¼Œé¡ºåºä¸ºæ’å…¥é¡ºåºæˆ–è€…æœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼ˆLRUï¼‰é¡ºåºã€‚ å®¹å™¨ä¸­çš„è®¾è®¡æ¨¡å¼è¿­ä»£å™¨æ¨¡å¼ Collection ç»§æ‰¿äº† Iterable æ¥å£ï¼Œå…¶ä¸­çš„ iterator() æ–¹æ³•èƒ½å¤Ÿäº§ç”Ÿä¸€ä¸ª Iterator å¯¹è±¡ï¼Œé€šè¿‡è¿™ä¸ªå¯¹è±¡å°±å¯ä»¥è¿­ä»£éå† Collection ä¸­çš„å…ƒç´ ã€‚ ä» JDK 1.5 ä¹‹åå¯ä»¥ä½¿ç”¨ foreach æ–¹æ³•æ¥éå†å®ç°äº† Iterable æ¥å£çš„èšåˆå¯¹è±¡ã€‚ 123456List&lt;String&gt; list = new ArrayList&lt;&gt;();list.add(\"a\");list.add(\"b\");for (String item : list) { System.out.println(item);} é€‚é…å™¨æ¨¡å¼java.util.Arrays#asList() å¯ä»¥æŠŠæ•°ç»„ç±»å‹è½¬æ¢ä¸º List ç±»å‹ã€‚ 12@SafeVarargspublic static &lt;T&gt; List&lt;T&gt; asList(T... a) åº”è¯¥æ³¨æ„çš„æ˜¯ asList() çš„å‚æ•°ä¸ºæ³›å‹çš„å˜é•¿å‚æ•°ï¼Œä¸èƒ½ä½¿ç”¨åŸºæœ¬ç±»å‹æ•°ç»„ä½œä¸ºå‚æ•°ï¼Œåªèƒ½ä½¿ç”¨ç›¸åº”çš„åŒ…è£…ç±»å‹æ•°ç»„ã€‚ 12Integer[] arr = {1, 2, 3};List list = Arrays.asList(arr); ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼è°ƒç”¨ asList()ï¼š 1List list = Arrays.asList(1, 2, 3); æºç åˆ†æå¦‚æœæ²¡æœ‰ç‰¹åˆ«è¯´æ˜ï¼Œä»¥ä¸‹æºç åˆ†æåŸºäº JDK 1.8ã€‚ åœ¨ IDEA ä¸­ double shift è°ƒå‡º Search EveryWhereï¼ŒæŸ¥æ‰¾æºç æ–‡ä»¶ï¼Œæ‰¾åˆ°ä¹‹åå°±å¯ä»¥é˜…è¯»æºç ã€‚ ArrayList1. æ¦‚è§ˆå› ä¸º ArrayList æ˜¯åŸºäºæ•°ç»„å®ç°çš„ï¼Œæ‰€ä»¥æ”¯æŒå¿«é€Ÿéšæœºè®¿é—®ã€‚RandomAccess æ¥å£æ ‡è¯†ç€è¯¥ç±»æ”¯æŒå¿«é€Ÿéšæœºè®¿é—®ã€‚ 12public class ArrayList&lt;E&gt; extends AbstractList&lt;E&gt; implements List&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable æ•°ç»„çš„é»˜è®¤å¤§å°ä¸º 10ã€‚ 1private static final int DEFAULT_CAPACITY = 10; 2. æ‰©å®¹æ·»åŠ å…ƒç´ æ—¶ä½¿ç”¨ ensureCapacityInternal() æ–¹æ³•æ¥ä¿è¯å®¹é‡è¶³å¤Ÿï¼Œå¦‚æœä¸å¤Ÿæ—¶ï¼Œéœ€è¦ä½¿ç”¨ grow() æ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼Œæ–°å®¹é‡çš„å¤§å°ä¸º oldCapacity + (oldCapacity &gt;&gt; 1)ï¼Œä¹Ÿå°±æ˜¯æ—§å®¹é‡çš„ 1.5 å€ã€‚ æ‰©å®¹æ“ä½œéœ€è¦è°ƒç”¨ Arrays.copyOf() æŠŠåŸæ•°ç»„æ•´ä¸ªå¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ï¼Œè¿™ä¸ªæ“ä½œä»£ä»·å¾ˆé«˜ï¼Œå› æ­¤æœ€å¥½åœ¨åˆ›å»º ArrayList å¯¹è±¡æ—¶å°±æŒ‡å®šå¤§æ¦‚çš„å®¹é‡å¤§å°ï¼Œå‡å°‘æ‰©å®¹æ“ä½œçš„æ¬¡æ•°ã€‚ 12345678910111213141516171819202122232425262728293031public boolean add(E e) { ensureCapacityInternal(size + 1); // Increments modCount!! elementData[size++] = e; return true;}private void ensureCapacityInternal(int minCapacity) { if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) { minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity); } ensureExplicitCapacity(minCapacity);}private void ensureExplicitCapacity(int minCapacity) { modCount++; // overflow-conscious code if (minCapacity - elementData.length &gt; 0) grow(minCapacity);}private void grow(int minCapacity) { // overflow-conscious code int oldCapacity = elementData.length; int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1); if (newCapacity - minCapacity &lt; 0) newCapacity = minCapacity; if (newCapacity - MAX_ARRAY_SIZE &gt; 0) newCapacity = hugeCapacity(minCapacity); // minCapacity is usually close to size, so this is a win: elementData = Arrays.copyOf(elementData, newCapacity);} 3. åˆ é™¤å…ƒç´ éœ€è¦è°ƒç”¨ System.arraycopy() å°† index+1 åé¢çš„å…ƒç´ éƒ½å¤åˆ¶åˆ° index ä½ç½®ä¸Šï¼Œè¯¥æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º O(N)ï¼Œå¯ä»¥çœ‹å‡º ArrayList åˆ é™¤å…ƒç´ çš„ä»£ä»·æ˜¯éå¸¸é«˜çš„ã€‚ 12345678910public E remove(int index) { rangeCheck(index); modCount++; E oldValue = elementData(index); int numMoved = size - index - 1; if (numMoved &gt; 0) System.arraycopy(elementData, index+1, elementData, index, numMoved); elementData[--size] = null; // clear to let GC do its work return oldValue;} 4. Fail-FastmodCount ç”¨æ¥è®°å½• ArrayList ç»“æ„å‘ç”Ÿå˜åŒ–çš„æ¬¡æ•°ã€‚ç»“æ„å‘ç”Ÿå˜åŒ–æ˜¯æŒ‡æ·»åŠ æˆ–è€…åˆ é™¤è‡³å°‘ä¸€ä¸ªå…ƒç´ çš„æ‰€æœ‰æ“ä½œï¼Œæˆ–è€…æ˜¯è°ƒæ•´å†…éƒ¨æ•°ç»„çš„å¤§å°ï¼Œä»…ä»…åªæ˜¯è®¾ç½®å…ƒç´ çš„å€¼ä¸ç®—ç»“æ„å‘ç”Ÿå˜åŒ–ã€‚ åœ¨è¿›è¡Œåºåˆ—åŒ–æˆ–è€…è¿­ä»£ç­‰æ“ä½œæ—¶ï¼Œéœ€è¦æ¯”è¾ƒæ“ä½œå‰å modCount æ˜¯å¦æ”¹å˜ï¼Œå¦‚æœæ”¹å˜äº†éœ€è¦æŠ›å‡º ConcurrentModificationExceptionã€‚ 123456789101112131415161718private void writeObject(java.io.ObjectOutputStream s) throws java.io.IOException{ // Write out element count, and any hidden stuff int expectedModCount = modCount; s.defaultWriteObject(); // Write out size as capacity for behavioural compatibility with clone() s.writeInt(size); // Write out all elements in the proper order. for (int i=0; i&lt;size; i++) { s.writeObject(elementData[i]); } if (modCount != expectedModCount) { throw new ConcurrentModificationException(); }} 5. åºåˆ—åŒ–ArrayList åŸºäºæ•°ç»„å®ç°ï¼Œå¹¶ä¸”å…·æœ‰åŠ¨æ€æ‰©å®¹ç‰¹æ€§ï¼Œå› æ­¤ä¿å­˜å…ƒç´ çš„æ•°ç»„ä¸ä¸€å®šéƒ½ä¼šè¢«ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±æ²¡å¿…è¦å…¨éƒ¨è¿›è¡Œåºåˆ—åŒ–ã€‚ ä¿å­˜å…ƒç´ çš„æ•°ç»„ elementData ä½¿ç”¨ transient ä¿®é¥°ï¼Œè¯¥å…³é”®å­—å£°æ˜æ•°ç»„é»˜è®¤ä¸ä¼šè¢«åºåˆ—åŒ–ã€‚ 1transient Object[] elementData; // non-private to simplify nested class access ArrayList å®ç°äº† writeObject() å’Œ readObject() æ¥æ§åˆ¶åªåºåˆ—åŒ–æ•°ç»„ä¸­æœ‰å…ƒç´ å¡«å……é‚£éƒ¨åˆ†å†…å®¹ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839private void readObject(java.io.ObjectInputStream s) throws java.io.IOException, ClassNotFoundException { elementData = EMPTY_ELEMENTDATA; // Read in size, and any hidden stuff s.defaultReadObject(); // Read in capacity s.readInt(); // ignored if (size &gt; 0) { // be like clone(), allocate array based upon size not capacity ensureCapacityInternal(size); Object[] a = elementData; // Read in all elements in the proper order. for (int i=0; i&lt;size; i++) { a[i] = s.readObject(); } }}private void writeObject(java.io.ObjectOutputStream s) throws java.io.IOException{ // Write out element count, and any hidden stuff int expectedModCount = modCount; s.defaultWriteObject(); // Write out size as capacity for behavioural compatibility with clone() s.writeInt(size); // Write out all elements in the proper order. for (int i=0; i&lt;size; i++) { s.writeObject(elementData[i]); } if (modCount != expectedModCount) { throw new ConcurrentModificationException(); }} åºåˆ—åŒ–æ—¶éœ€è¦ä½¿ç”¨ ObjectOutputStream çš„ writeObject() å°†å¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚æµå¹¶è¾“å‡ºã€‚è€Œ writeObject() æ–¹æ³•åœ¨ä¼ å…¥çš„å¯¹è±¡å­˜åœ¨ writeObject() çš„æ—¶å€™ä¼šå»åå°„è°ƒç”¨è¯¥å¯¹è±¡çš„ writeObject() æ¥å®ç°åºåˆ—åŒ–ã€‚ååºåˆ—åŒ–ä½¿ç”¨çš„æ˜¯ ObjectInputStream çš„ readObject() æ–¹æ³•ï¼ŒåŸç†ç±»ä¼¼ã€‚ 123ArrayList list = new ArrayList();ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(file));oos.writeObject(list); Vector1. åŒæ­¥å®ƒçš„å®ç°ä¸ ArrayList ç±»ä¼¼ï¼Œä½†æ˜¯ä½¿ç”¨äº† synchronized è¿›è¡ŒåŒæ­¥ã€‚ 12345678910111213public synchronized boolean add(E e) { modCount++; ensureCapacityHelper(elementCount + 1); elementData[elementCount++] = e; return true;}public synchronized E get(int index) { if (index &gt;= elementCount) throw new ArrayIndexOutOfBoundsException(index); return elementData(index);} 2. ä¸ ArrayList çš„æ¯”è¾ƒ Vector æ˜¯åŒæ­¥çš„ï¼Œå› æ­¤å¼€é”€å°±æ¯” ArrayList è¦å¤§ï¼Œè®¿é—®é€Ÿåº¦æ›´æ…¢ã€‚æœ€å¥½ä½¿ç”¨ ArrayList è€Œä¸æ˜¯ Vectorï¼Œå› ä¸ºåŒæ­¥æ“ä½œå®Œå…¨å¯ä»¥ç”±ç¨‹åºå‘˜è‡ªå·±æ¥æ§åˆ¶ï¼› Vector æ¯æ¬¡æ‰©å®¹è¯·æ±‚å…¶å¤§å°çš„ 2 å€ç©ºé—´ï¼Œè€Œ ArrayList æ˜¯ 1.5 å€ã€‚ 3. æ›¿ä»£æ–¹æ¡ˆå¯ä»¥ä½¿ç”¨ Collections.synchronizedList(); å¾—åˆ°ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ ArrayListã€‚ 12List&lt;String&gt; list = new ArrayList&lt;&gt;();List&lt;String&gt; synList = Collections.synchronizedList(list); ä¹Ÿå¯ä»¥ä½¿ç”¨ concurrent å¹¶å‘åŒ…ä¸‹çš„ CopyOnWriteArrayList ç±»ã€‚ 1List&lt;String&gt; list = new CopyOnWriteArrayList&lt;&gt;(); CopyOnWriteArrayListè¯»å†™åˆ†ç¦»å†™æ“ä½œåœ¨ä¸€ä¸ªå¤åˆ¶çš„æ•°ç»„ä¸Šè¿›è¡Œï¼Œè¯»æ“ä½œè¿˜æ˜¯åœ¨åŸå§‹æ•°ç»„ä¸­è¿›è¡Œï¼Œè¯»å†™åˆ†ç¦»ï¼Œäº’ä¸å½±å“ã€‚ å†™æ“ä½œéœ€è¦åŠ é”ï¼Œé˜²æ­¢å¹¶å‘å†™å…¥æ—¶å¯¼è‡´å†™å…¥æ•°æ®ä¸¢å¤±ã€‚ å†™æ“ä½œç»“æŸä¹‹åéœ€è¦æŠŠåŸå§‹æ•°ç»„æŒ‡å‘æ–°çš„å¤åˆ¶æ•°ç»„ã€‚ 12345678910111213141516171819202122public boolean add(E e) { final ReentrantLock lock = this.lock; lock.lock(); try { Object[] elements = getArray(); int len = elements.length; Object[] newElements = Arrays.copyOf(elements, len + 1); newElements[len] = e; setArray(newElements); return true; } finally { lock.unlock(); }}final void setArray(Object[] a) { array = a;}@SuppressWarnings(\"unchecked\")private E get(Object[] a, int index) { return (E) a[index];} é€‚ç”¨åœºæ™¯CopyOnWriteArrayList åœ¨å†™æ“ä½œçš„åŒæ—¶å…è®¸è¯»æ“ä½œï¼Œå¤§å¤§æé«˜äº†è¯»æ“ä½œçš„æ€§èƒ½ï¼Œå› æ­¤å¾ˆé€‚åˆè¯»å¤šå†™å°‘çš„åº”ç”¨åœºæ™¯ã€‚ ä½†æ˜¯ CopyOnWriteArrayList æœ‰å…¶ç¼ºé™·ï¼š å†…å­˜å ç”¨ï¼šåœ¨å†™æ“ä½œæ—¶éœ€è¦å¤åˆ¶ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œä½¿å¾—å†…å­˜å ç”¨ä¸ºåŸæ¥çš„ä¸¤å€å·¦å³ï¼› æ•°æ®ä¸ä¸€è‡´ï¼šè¯»æ“ä½œä¸èƒ½è¯»å–å®æ—¶æ€§çš„æ•°æ®ï¼Œå› ä¸ºéƒ¨åˆ†å†™æ“ä½œçš„æ•°æ®è¿˜æœªåŒæ­¥åˆ°è¯»æ•°ç»„ä¸­ã€‚ æ‰€ä»¥ CopyOnWriteArrayList ä¸é€‚åˆå†…å­˜æ•æ„Ÿä»¥åŠå¯¹å®æ—¶æ€§è¦æ±‚å¾ˆé«˜çš„åœºæ™¯ã€‚ LinkedList1. æ¦‚è§ˆåŸºäºåŒå‘é“¾è¡¨å®ç°ï¼Œä½¿ç”¨ Node å­˜å‚¨é“¾è¡¨èŠ‚ç‚¹ä¿¡æ¯ã€‚ 12345private static class Node&lt;E&gt; { E item; Node&lt;E&gt; next; Node&lt;E&gt; prev;} æ¯ä¸ªé“¾è¡¨å­˜å‚¨äº† first å’Œ last æŒ‡é’ˆï¼š 12transient Node&lt;E&gt; first;transient Node&lt;E&gt; last; 2. ä¸ ArrayList çš„æ¯”è¾ƒ ArrayList åŸºäºåŠ¨æ€æ•°ç»„å®ç°ï¼ŒLinkedList åŸºäºåŒå‘é“¾è¡¨å®ç°ï¼› ArrayList æ”¯æŒéšæœºè®¿é—®ï¼ŒLinkedList ä¸æ”¯æŒï¼› LinkedList åœ¨ä»»æ„ä½ç½®æ·»åŠ åˆ é™¤å…ƒç´ æ›´å¿«ã€‚ HashMapä¸ºäº†ä¾¿äºç†è§£ï¼Œä»¥ä¸‹æºç åˆ†æä»¥ JDK 1.7 ä¸ºä¸»ã€‚ 1. å­˜å‚¨ç»“æ„å†…éƒ¨åŒ…å«äº†ä¸€ä¸ª Entry ç±»å‹çš„æ•°ç»„ tableã€‚ 1transient Entry[] table; Entry å­˜å‚¨ç€é”®å€¼å¯¹ã€‚å®ƒåŒ…å«äº†å››ä¸ªå­—æ®µï¼Œä» next å­—æ®µæˆ‘ä»¬å¯ä»¥çœ‹å‡º Entry æ˜¯ä¸€ä¸ªé“¾è¡¨ã€‚å³æ•°ç»„ä¸­çš„æ¯ä¸ªä½ç½®è¢«å½“æˆä¸€ä¸ªæ¡¶ï¼Œä¸€ä¸ªæ¡¶å­˜æ”¾ä¸€ä¸ªé“¾è¡¨ã€‚HashMap ä½¿ç”¨æ‹‰é“¾æ³•æ¥è§£å†³å†²çªï¼ŒåŒä¸€ä¸ªé“¾è¡¨ä¸­å­˜æ”¾å“ˆå¸Œå€¼å’Œæ•£åˆ—æ¡¶å–æ¨¡è¿ç®—ç»“æœç›¸åŒçš„ Entryã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950static class Entry&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; { final K key; V value; Entry&lt;K,V&gt; next; int hash; Entry(int h, K k, V v, Entry&lt;K,V&gt; n) { value = v; next = n; key = k; hash = h; } public final K getKey() { return key; } public final V getValue() { return value; } public final V setValue(V newValue) { V oldValue = value; value = newValue; return oldValue; } public final boolean equals(Object o) { if (!(o instanceof Map.Entry)) return false; Map.Entry e = (Map.Entry)o; Object k1 = getKey(); Object k2 = e.getKey(); if (k1 == k2 || (k1 != null &amp;&amp; k1.equals(k2))) { Object v1 = getValue(); Object v2 = e.getValue(); if (v1 == v2 || (v1 != null &amp;&amp; v1.equals(v2))) return true; } return false; } public final int hashCode() { return Objects.hashCode(getKey()) ^ Objects.hashCode(getValue()); } public final String toString() { return getKey() + \"=\" + getValue(); }} 2. æ‹‰é“¾æ³•çš„å·¥ä½œåŸç†1234HashMap&lt;String, String&gt; map = new HashMap&lt;&gt;();map.put(\"K1\", \"V1\");map.put(\"K2\", \"V2\");map.put(\"K3\", \"V3\"); æ–°å»ºä¸€ä¸ª HashMapï¼Œé»˜è®¤å¤§å°ä¸º 16ï¼› æ’å…¥ &lt;K1,V1&gt; é”®å€¼å¯¹ï¼Œå…ˆè®¡ç®— K1 çš„ hashCode ä¸º 115ï¼Œä½¿ç”¨é™¤ç•™ä½™æ•°æ³•å¾—åˆ°æ‰€åœ¨çš„æ¡¶ä¸‹æ ‡ 115%16=3ã€‚ æ’å…¥ &lt;K2,V2&gt; é”®å€¼å¯¹ï¼Œå…ˆè®¡ç®— K2 çš„ hashCode ä¸º 118ï¼Œä½¿ç”¨é™¤ç•™ä½™æ•°æ³•å¾—åˆ°æ‰€åœ¨çš„æ¡¶ä¸‹æ ‡ 118%16=6ã€‚ æ’å…¥ &lt;K3,V3&gt; é”®å€¼å¯¹ï¼Œå…ˆè®¡ç®— K3 çš„ hashCode ä¸º 118ï¼Œä½¿ç”¨é™¤ç•™ä½™æ•°æ³•å¾—åˆ°æ‰€åœ¨çš„æ¡¶ä¸‹æ ‡ 118%16=6ï¼Œæ’åœ¨ &lt;K2,V2&gt; å‰é¢ã€‚ åº”è¯¥æ³¨æ„åˆ°é“¾è¡¨çš„æ’å…¥æ˜¯ä»¥å¤´æ’æ³•æ–¹å¼è¿›è¡Œçš„ï¼Œä¾‹å¦‚ä¸Šé¢çš„ &lt;K3,V3&gt; ä¸æ˜¯æ’åœ¨ &lt;K2,V2&gt; åé¢ï¼Œè€Œæ˜¯æ’å…¥åœ¨é“¾è¡¨å¤´éƒ¨ã€‚ æŸ¥æ‰¾éœ€è¦åˆ†æˆä¸¤æ­¥è¿›è¡Œï¼š è®¡ç®—é”®å€¼å¯¹æ‰€åœ¨çš„æ¡¶ï¼› åœ¨é“¾è¡¨ä¸Šé¡ºåºæŸ¥æ‰¾ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¾ç„¶å’Œé“¾è¡¨çš„é•¿åº¦æˆæ­£æ¯”ã€‚ 3. put æ“ä½œ1234567891011121314151617181920212223242526public V put(K key, V value) { if (table == EMPTY_TABLE) { inflateTable(threshold); } // é”®ä¸º null å•ç‹¬å¤„ç† if (key == null) return putForNullKey(value); int hash = hash(key); // ç¡®å®šæ¡¶ä¸‹æ ‡ int i = indexFor(hash, table.length); // å…ˆæ‰¾å‡ºæ˜¯å¦å·²ç»å­˜åœ¨é”®ä¸º key çš„é”®å€¼å¯¹ï¼Œå¦‚æœå­˜åœ¨çš„è¯å°±æ›´æ–°è¿™ä¸ªé”®å€¼å¯¹çš„å€¼ä¸º value for (Entry&lt;K,V&gt; e = table[i]; e != null; e = e.next) { Object k; if (e.hash == hash &amp;&amp; ((k = e.key) == key || key.equals(k))) { V oldValue = e.value; e.value = value; e.recordAccess(this); return oldValue; } } modCount++; // æ’å…¥æ–°é”®å€¼å¯¹ addEntry(hash, key, value, i); return null;} HashMap å…è®¸æ’å…¥é”®ä¸º null çš„é”®å€¼å¯¹ã€‚ä½†æ˜¯å› ä¸ºæ— æ³•è°ƒç”¨ null çš„ hashCode() æ–¹æ³•ï¼Œä¹Ÿå°±æ— æ³•ç¡®å®šè¯¥é”®å€¼å¯¹çš„æ¡¶ä¸‹æ ‡ï¼Œåªèƒ½é€šè¿‡å¼ºåˆ¶æŒ‡å®šä¸€ä¸ªæ¡¶ä¸‹æ ‡æ¥å­˜æ”¾ã€‚HashMap ä½¿ç”¨ç¬¬ 0 ä¸ªæ¡¶å­˜æ”¾é”®ä¸º null çš„é”®å€¼å¯¹ã€‚ 12345678910111213private V putForNullKey(V value) { for (Entry&lt;K,V&gt; e = table[0]; e != null; e = e.next) { if (e.key == null) { V oldValue = e.value; e.value = value; e.recordAccess(this); return oldValue; } } modCount++; addEntry(0, null, value, 0); return null;} ä½¿ç”¨é“¾è¡¨çš„å¤´æ’æ³•ï¼Œä¹Ÿå°±æ˜¯æ–°çš„é”®å€¼å¯¹æ’åœ¨é“¾è¡¨çš„å¤´éƒ¨ï¼Œè€Œä¸æ˜¯é“¾è¡¨çš„å°¾éƒ¨ã€‚ 12345678910111213141516171819202122void addEntry(int hash, K key, V value, int bucketIndex) { if ((size &gt;= threshold) &amp;&amp; (null != table[bucketIndex])) { resize(2 * table.length); hash = (null != key) ? hash(key) : 0; bucketIndex = indexFor(hash, table.length); } createEntry(hash, key, value, bucketIndex);}void createEntry(int hash, K key, V value, int bucketIndex) { Entry&lt;K,V&gt; e = table[bucketIndex]; // å¤´æ’æ³•ï¼Œé“¾è¡¨å¤´éƒ¨æŒ‡å‘æ–°çš„é”®å€¼å¯¹ table[bucketIndex] = new Entry&lt;&gt;(hash, key, value, e); size++;}Entry(int h, K k, V v, Entry&lt;K,V&gt; n) { value = v; next = n; key = k; hash = h;} 4. ç¡®å®šæ¡¶ä¸‹æ ‡å¾ˆå¤šæ“ä½œéƒ½éœ€è¦å…ˆç¡®å®šä¸€ä¸ªé”®å€¼å¯¹æ‰€åœ¨çš„æ¡¶ä¸‹æ ‡ã€‚ 12int hash = hash(key);int i = indexFor(hash, table.length); 4.1 è®¡ç®— hash å€¼ 1234567891011121314151617final int hash(Object k) { int h = hashSeed; if (0 != h &amp;&amp; k instanceof String) { return sun.misc.Hashing.stringHash32((String) k); } h ^= k.hashCode(); // This function ensures that hashCodes that differ only by // constant multiples at each bit position have a bounded // number of collisions (approximately 8 at default load factor). h ^= (h &gt;&gt;&gt; 20) ^ (h &gt;&gt;&gt; 12); return h ^ (h &gt;&gt;&gt; 7) ^ (h &gt;&gt;&gt; 4);}public final int hashCode() { return Objects.hashCode(key) ^ Objects.hashCode(value);} 4.2 å–æ¨¡ ä»¤ x = 1&lt;&lt;4ï¼Œå³ x ä¸º 2 çš„ 4 æ¬¡æ–¹ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼š 12x : 00010000x-1 : 00001111 ä»¤ä¸€ä¸ªæ•° y ä¸ x-1 åšä¸è¿ç®—ï¼Œå¯ä»¥å»é™¤ y ä½çº§è¡¨ç¤ºçš„ç¬¬ 4 ä½ä»¥ä¸Šæ•°ï¼š 123y : 10110010x-1 : 00001111y&amp;(x-1) : 00000010 è¿™ä¸ªæ€§è´¨å’Œ y å¯¹ x å–æ¨¡æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼š 123y : 10110010x : 00010000y%x : 00000010 æˆ‘ä»¬çŸ¥é“ï¼Œä½è¿ç®—çš„ä»£ä»·æ¯”æ±‚æ¨¡è¿ç®—å°çš„å¤šï¼Œå› æ­¤åœ¨è¿›è¡Œè¿™ç§è®¡ç®—æ—¶ç”¨ä½è¿ç®—çš„è¯èƒ½å¸¦æ¥æ›´é«˜çš„æ€§èƒ½ã€‚ ç¡®å®šæ¡¶ä¸‹æ ‡çš„æœ€åä¸€æ­¥æ˜¯å°† key çš„ hash å€¼å¯¹æ¡¶ä¸ªæ•°å–æ¨¡ï¼šhash%capacityï¼Œå¦‚æœèƒ½ä¿è¯ capacity ä¸º 2 çš„ n æ¬¡æ–¹ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°†è¿™ä¸ªæ“ä½œè½¬æ¢ä¸ºä½è¿ç®—ã€‚ 123static int indexFor(int h, int length) { return h &amp; (length-1);} 5. æ‰©å®¹-åŸºæœ¬åŸç†è®¾ HashMap çš„ table é•¿åº¦ä¸º Mï¼Œéœ€è¦å­˜å‚¨çš„é”®å€¼å¯¹æ•°é‡ä¸º Nï¼Œå¦‚æœå“ˆå¸Œå‡½æ•°æ»¡è¶³å‡åŒ€æ€§çš„è¦æ±‚ï¼Œé‚£ä¹ˆæ¯æ¡é“¾è¡¨çš„é•¿åº¦å¤§çº¦ä¸º N/Mï¼Œå› æ­¤å¹³å‡æŸ¥æ‰¾æ¬¡æ•°çš„å¤æ‚åº¦ä¸º O(N/M)ã€‚ ä¸ºäº†è®©æŸ¥æ‰¾çš„æˆæœ¬é™ä½ï¼Œåº”è¯¥å°½å¯èƒ½ä½¿å¾— N/M å°½å¯èƒ½å°ï¼Œå› æ­¤éœ€è¦ä¿è¯ M å°½å¯èƒ½å¤§ï¼Œä¹Ÿå°±æ˜¯è¯´ table è¦å°½å¯èƒ½å¤§ã€‚HashMap é‡‡ç”¨åŠ¨æ€æ‰©å®¹æ¥æ ¹æ®å½“å‰çš„ N å€¼æ¥è°ƒæ•´ M å€¼ï¼Œä½¿å¾—ç©ºé—´æ•ˆç‡å’Œæ—¶é—´æ•ˆç‡éƒ½èƒ½å¾—åˆ°ä¿è¯ã€‚ å’Œæ‰©å®¹ç›¸å…³çš„å‚æ•°ä¸»è¦æœ‰ï¼šcapacityã€sizeã€threshold å’Œ load_factorã€‚ å‚æ•° å«ä¹‰ capacity table çš„å®¹é‡å¤§å°ï¼Œé»˜è®¤ä¸º 16ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ capacity å¿…é¡»ä¿è¯ä¸º 2 çš„ n æ¬¡æ–¹ã€‚ size é”®å€¼å¯¹æ•°é‡ã€‚ threshold size çš„ä¸´ç•Œå€¼ï¼Œå½“ size å¤§äºç­‰äº threshold å°±å¿…é¡»è¿›è¡Œæ‰©å®¹æ“ä½œã€‚ loadFactor è£…è½½å› å­ï¼Œtable èƒ½å¤Ÿä½¿ç”¨çš„æ¯”ä¾‹ï¼Œthreshold = capacity * loadFactorã€‚ 123456789101112131415static final int DEFAULT_INITIAL_CAPACITY = 16;static final int MAXIMUM_CAPACITY = 1 &lt;&lt; 30;static final float DEFAULT_LOAD_FACTOR = 0.75f;transient Entry[] table;transient int size;int threshold;final float loadFactor;transient int modCount; ä»ä¸‹é¢çš„æ·»åŠ å…ƒç´ ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œå½“éœ€è¦æ‰©å®¹æ—¶ï¼Œä»¤ capacity ä¸ºåŸæ¥çš„ä¸¤å€ã€‚ 123456void addEntry(int hash, K key, V value, int bucketIndex) { Entry&lt;K,V&gt; e = table[bucketIndex]; table[bucketIndex] = new Entry&lt;&gt;(hash, key, value, e); if (size++ &gt;= threshold) resize(2 * table.length);} æ‰©å®¹ä½¿ç”¨ resize() å®ç°ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‰©å®¹æ“ä½œåŒæ ·éœ€è¦æŠŠ oldTable çš„æ‰€æœ‰é”®å€¼å¯¹é‡æ–°æ’å…¥ newTable ä¸­ï¼Œå› æ­¤è¿™ä¸€æ­¥æ˜¯å¾ˆè´¹æ—¶çš„ã€‚ 123456789101112131415161718192021222324252627282930void resize(int newCapacity) { Entry[] oldTable = table; int oldCapacity = oldTable.length; if (oldCapacity == MAXIMUM_CAPACITY) { threshold = Integer.MAX_VALUE; return; } Entry[] newTable = new Entry[newCapacity]; transfer(newTable); table = newTable; threshold = (int)(newCapacity * loadFactor);}void transfer(Entry[] newTable) { Entry[] src = table; int newCapacity = newTable.length; for (int j = 0; j &lt; src.length; j++) { Entry&lt;K,V&gt; e = src[j]; if (e != null) { src[j] = null; do { Entry&lt;K,V&gt; next = e.next; int i = indexFor(e.hash, newCapacity); e.next = newTable[i]; newTable[i] = e; e = next; } while (e != null); } }} 6. æ‰©å®¹-é‡æ–°è®¡ç®—æ¡¶ä¸‹æ ‡åœ¨è¿›è¡Œæ‰©å®¹æ—¶ï¼Œéœ€è¦æŠŠé”®å€¼å¯¹é‡æ–°æ”¾åˆ°å¯¹åº”çš„æ¡¶ä¸Šã€‚HashMap ä½¿ç”¨äº†ä¸€ä¸ªç‰¹æ®Šçš„æœºåˆ¶ï¼Œå¯ä»¥é™ä½é‡æ–°è®¡ç®—æ¡¶ä¸‹æ ‡çš„æ“ä½œã€‚ å‡è®¾åŸæ•°ç»„é•¿åº¦ capacity ä¸º 16ï¼Œæ‰©å®¹ä¹‹å new capacity ä¸º 32ï¼š 12capacity : 00010000new capacity : 00100000 å¯¹äºä¸€ä¸ª Keyï¼Œ å®ƒçš„å“ˆå¸Œå€¼å¦‚æœåœ¨ç¬¬ 5 ä½ä¸Šä¸º 0ï¼Œé‚£ä¹ˆå–æ¨¡å¾—åˆ°çš„ç»“æœå’Œä¹‹å‰ä¸€æ ·ï¼› å¦‚æœä¸º 1ï¼Œé‚£ä¹ˆå¾—åˆ°çš„ç»“æœä¸ºåŸæ¥çš„ç»“æœ +16ã€‚ 7. è®¡ç®—æ•°ç»„å®¹é‡HashMap æ„é€ å‡½æ•°å…è®¸ç”¨æˆ·ä¼ å…¥çš„å®¹é‡ä¸æ˜¯ 2 çš„ n æ¬¡æ–¹ï¼Œå› ä¸ºå®ƒå¯ä»¥è‡ªåŠ¨åœ°å°†ä¼ å…¥çš„å®¹é‡è½¬æ¢ä¸º 2 çš„ n æ¬¡æ–¹ã€‚ å…ˆè€ƒè™‘å¦‚ä½•æ±‚ä¸€ä¸ªæ•°çš„æ©ç ï¼Œå¯¹äº 10010000ï¼Œå®ƒçš„æ©ç ä¸º 11111111ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•å¾—åˆ°ï¼š 123mask |= mask &gt;&gt; 1 11011000mask |= mask &gt;&gt; 2 11111110mask |= mask &gt;&gt; 4 11111111 mask+1 æ˜¯å¤§äºåŸå§‹æ•°å­—çš„æœ€å°çš„ 2 çš„ n æ¬¡æ–¹ã€‚ 12num 10010000mask+1 100000000 ä»¥ä¸‹æ˜¯ HashMap ä¸­è®¡ç®—æ•°ç»„å®¹é‡çš„ä»£ç ï¼š 123456789static final int tableSizeFor(int cap) { int n = cap - 1; n |= n &gt;&gt;&gt; 1; n |= n &gt;&gt;&gt; 2; n |= n &gt;&gt;&gt; 4; n |= n &gt;&gt;&gt; 8; n |= n &gt;&gt;&gt; 16; return (n &lt; 0) ? 1 : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;} 8. é“¾è¡¨è½¬çº¢é»‘æ ‘ä» JDK 1.8 å¼€å§‹ï¼Œä¸€ä¸ªæ¡¶å­˜å‚¨çš„é“¾è¡¨é•¿åº¦å¤§äº 8 æ—¶ä¼šå°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚ åº”è¯¥æ˜¯ï¼šä» JDK 1.8 å¼€å§‹ï¼Œ tableçš„é•¿åº¦ä¹Ÿå°±æ˜¯HashMapçš„capacity(ä¸æ˜¯size)ä¸èƒ½å°äº64è€Œä¸”åœ¨æ¡¶å­˜å‚¨çš„é“¾è¡¨é•¿åº¦ä¸º8æ—¶(å‡†ç¡®çš„è¯´æ˜¯é•¿åº¦ä¸º7å¹¶ä¸”åœ¨ç»§ç»­å¡ç¬¬8ä¸ªæ—¶),è½¬æ¢æˆçº¢é»‘æ ‘,è€Œä¸æ˜¯è¶…è¿‡8ã€‚ 9. ä¸ HashTable çš„æ¯”è¾ƒ HashTable ä½¿ç”¨ synchronized æ¥è¿›è¡ŒåŒæ­¥ã€‚ HashMap å¯ä»¥æ’å…¥é”®ä¸º null çš„ Entryã€‚ HashMap çš„è¿­ä»£å™¨æ˜¯ fail-fast è¿­ä»£å™¨ã€‚ HashMap ä¸èƒ½ä¿è¯éšç€æ—¶é—´çš„æ¨ç§» Map ä¸­çš„å…ƒç´ æ¬¡åºæ˜¯ä¸å˜çš„ã€‚ ConcurrentHashMap1. å­˜å‚¨ç»“æ„123456static final class HashEntry&lt;K,V&gt; { final int hash; final K key; volatile V value; volatile HashEntry&lt;K,V&gt; next;} ConcurrentHashMap å’Œ HashMap å®ç°ä¸Šç±»ä¼¼ï¼Œæœ€ä¸»è¦çš„å·®åˆ«æ˜¯ ConcurrentHashMap é‡‡ç”¨äº†åˆ†æ®µé”ï¼ˆSegmentï¼‰ï¼Œæ¯ä¸ªåˆ†æ®µé”ç»´æŠ¤ç€å‡ ä¸ªæ¡¶ï¼ˆHashEntryï¼‰ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è®¿é—®ä¸åŒåˆ†æ®µé”ä¸Šçš„æ¡¶ï¼Œä»è€Œä½¿å…¶å¹¶å‘åº¦æ›´é«˜ï¼ˆå¹¶å‘åº¦å°±æ˜¯ Segment çš„ä¸ªæ•°ï¼‰ã€‚ Segment ç»§æ‰¿è‡ª ReentrantLockã€‚ 123456789101112131415161718static final class Segment&lt;K,V&gt; extends ReentrantLock implements Serializable { private static final long serialVersionUID = 2249069246763182397L; static final int MAX_SCAN_RETRIES = Runtime.getRuntime().availableProcessors() &gt; 1 ? 64 : 1; transient volatile HashEntry&lt;K,V&gt;[] table; transient int count; transient int modCount; transient int threshold; final float loadFactor;}final Segment&lt;K,V&gt;[] segments; é»˜è®¤çš„å¹¶å‘çº§åˆ«ä¸º 16ï¼Œä¹Ÿå°±æ˜¯è¯´é»˜è®¤åˆ›å»º 16 ä¸ª Segmentã€‚ 1static final int DEFAULT_CONCURRENCY_LEVEL = 16; 2. size æ“ä½œæ¯ä¸ª Segment ç»´æŠ¤äº†ä¸€ä¸ª count å˜é‡æ¥ç»Ÿè®¡è¯¥ Segment ä¸­çš„é”®å€¼å¯¹ä¸ªæ•°ã€‚ 12345/** * The number of elements. Accessed only either within locks * or among other volatile reads that maintain visibility. */transient int count; åœ¨æ‰§è¡Œ size æ“ä½œæ—¶ï¼Œéœ€è¦éå†æ‰€æœ‰ Segment ç„¶åæŠŠ count ç´¯è®¡èµ·æ¥ã€‚ ConcurrentHashMap åœ¨æ‰§è¡Œ size æ“ä½œæ—¶å…ˆå°è¯•ä¸åŠ é”ï¼Œå¦‚æœè¿ç»­ä¸¤æ¬¡ä¸åŠ é”æ“ä½œå¾—åˆ°çš„ç»“æœä¸€è‡´ï¼Œé‚£ä¹ˆå¯ä»¥è®¤ä¸ºè¿™ä¸ªç»“æœæ˜¯æ­£ç¡®çš„ã€‚ å°è¯•æ¬¡æ•°ä½¿ç”¨ RETRIES_BEFORE_LOCK å®šä¹‰ï¼Œè¯¥å€¼ä¸º 2ï¼Œretries åˆå§‹å€¼ä¸º -1ï¼Œå› æ­¤å°è¯•æ¬¡æ•°ä¸º 3ã€‚ å¦‚æœå°è¯•çš„æ¬¡æ•°è¶…è¿‡ 3 æ¬¡ï¼Œå°±éœ€è¦å¯¹æ¯ä¸ª Segment åŠ é”ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849/** * Number of unsynchronized retries in size and containsValue * methods before resorting to locking. This is used to avoid * unbounded retries if tables undergo continuous modification * which would make it impossible to obtain an accurate result. */static final int RETRIES_BEFORE_LOCK = 2;public int size() { // Try a few times to get accurate count. On failure due to // continuous async changes in table, resort to locking. final Segment&lt;K,V&gt;[] segments = this.segments; int size; boolean overflow; // true if size overflows 32 bits long sum; // sum of modCounts long last = 0L; // previous sum int retries = -1; // first iteration isn't retry try { for (;;) { // è¶…è¿‡å°è¯•æ¬¡æ•°ï¼Œåˆ™å¯¹æ¯ä¸ª Segment åŠ é” if (retries++ == RETRIES_BEFORE_LOCK) { for (int j = 0; j &lt; segments.length; ++j) ensureSegment(j).lock(); // force creation } sum = 0L; size = 0; overflow = false; for (int j = 0; j &lt; segments.length; ++j) { Segment&lt;K,V&gt; seg = segmentAt(segments, j); if (seg != null) { sum += seg.modCount; int c = seg.count; if (c &lt; 0 || (size += c) &lt; 0) overflow = true; } } // è¿ç»­ä¸¤æ¬¡å¾—åˆ°çš„ç»“æœä¸€è‡´ï¼Œåˆ™è®¤ä¸ºè¿™ä¸ªç»“æœæ˜¯æ­£ç¡®çš„ if (sum == last) break; last = sum; } } finally { if (retries &gt; RETRIES_BEFORE_LOCK) { for (int j = 0; j &lt; segments.length; ++j) segmentAt(segments, j).unlock(); } } return overflow ? Integer.MAX_VALUE : size;} 3. JDK 1.8 çš„æ”¹åŠ¨JDK 1.7 ä½¿ç”¨åˆ†æ®µé”æœºåˆ¶æ¥å®ç°å¹¶å‘æ›´æ–°æ“ä½œï¼Œæ ¸å¿ƒç±»ä¸º Segmentï¼Œå®ƒç»§æ‰¿è‡ªé‡å…¥é” ReentrantLockï¼Œå¹¶å‘åº¦ä¸ Segment æ•°é‡ç›¸ç­‰ã€‚ JDK 1.8 ä½¿ç”¨äº† CAS æ“ä½œæ¥æ”¯æŒæ›´é«˜çš„å¹¶å‘åº¦ï¼Œåœ¨ CAS æ“ä½œå¤±è´¥æ—¶ä½¿ç”¨å†…ç½®é” synchronizedã€‚ å¹¶ä¸” JDK 1.8 çš„å®ç°ä¹Ÿåœ¨é“¾è¡¨è¿‡é•¿æ—¶ä¼šè½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚ LinkedHashMapå­˜å‚¨ç»“æ„ç»§æ‰¿è‡ª HashMapï¼Œå› æ­¤å…·æœ‰å’Œ HashMap ä¸€æ ·çš„å¿«é€ŸæŸ¥æ‰¾ç‰¹æ€§ã€‚ 1public class LinkedHashMap&lt;K,V&gt; extends HashMap&lt;K,V&gt; implements Map&lt;K,V&gt; å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œç”¨æ¥ç»´æŠ¤æ’å…¥é¡ºåºæˆ–è€… LRU é¡ºåºã€‚ 123456789/** * The head (eldest) of the doubly linked list. */transient LinkedHashMap.Entry&lt;K,V&gt; head;/** * The tail (youngest) of the doubly linked list. */transient LinkedHashMap.Entry&lt;K,V&gt; tail; accessOrder å†³å®šäº†é¡ºåºï¼Œé»˜è®¤ä¸º falseï¼Œæ­¤æ—¶ç»´æŠ¤çš„æ˜¯æ’å…¥é¡ºåºã€‚ 1final boolean accessOrder; LinkedHashMap æœ€é‡è¦çš„æ˜¯ä»¥ä¸‹ç”¨äºç»´æŠ¤é¡ºåºçš„å‡½æ•°ï¼Œå®ƒä»¬ä¼šåœ¨ putã€get ç­‰æ–¹æ³•ä¸­è°ƒç”¨ã€‚ 12void afterNodeAccess(Node&lt;K,V&gt; p) { }void afterNodeInsertion(boolean evict) { } afterNodeAccess()å½“ä¸€ä¸ªèŠ‚ç‚¹è¢«è®¿é—®æ—¶ï¼Œå¦‚æœ accessOrder ä¸º trueï¼Œåˆ™ä¼šå°†è¯¥èŠ‚ç‚¹ç§»åˆ°é“¾è¡¨å°¾éƒ¨ã€‚ä¹Ÿå°±æ˜¯è¯´æŒ‡å®šä¸º LRU é¡ºåºä¹‹åï¼Œåœ¨æ¯æ¬¡è®¿é—®ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œä¼šå°†è¿™ä¸ªèŠ‚ç‚¹ç§»åˆ°é“¾è¡¨å°¾éƒ¨ï¼Œä¿è¯é“¾è¡¨å°¾éƒ¨æ˜¯æœ€è¿‘è®¿é—®çš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆé“¾è¡¨é¦–éƒ¨å°±æ˜¯æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„èŠ‚ç‚¹ã€‚ 123456789101112131415161718192021222324void afterNodeAccess(Node&lt;K,V&gt; e) { // move node to last LinkedHashMap.Entry&lt;K,V&gt; last; if (accessOrder &amp;&amp; (last = tail) != e) { LinkedHashMap.Entry&lt;K,V&gt; p = (LinkedHashMap.Entry&lt;K,V&gt;)e, b = p.before, a = p.after; p.after = null; if (b == null) head = a; else b.after = a; if (a != null) a.before = b; else last = b; if (last == null) head = p; else { p.before = last; last.after = p; } tail = p; ++modCount; }} afterNodeInsertion()åœ¨ put ç­‰æ“ä½œä¹‹åæ‰§è¡Œï¼Œå½“ removeEldestEntry() æ–¹æ³•è¿”å› true æ—¶ä¼šç§»é™¤æœ€æ™šçš„èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯é“¾è¡¨é¦–éƒ¨èŠ‚ç‚¹ firstã€‚ evict åªæœ‰åœ¨æ„å»º Map çš„æ—¶å€™æ‰ä¸º falseï¼Œåœ¨è¿™é‡Œä¸º trueã€‚ 1234567void afterNodeInsertion(boolean evict) { // possibly remove eldest LinkedHashMap.Entry&lt;K,V&gt; first; if (evict &amp;&amp; (first = head) != null &amp;&amp; removeEldestEntry(first)) { K key = first.key; removeNode(hash(key), key, null, false, true); }} removeEldestEntry() é»˜è®¤ä¸º falseï¼Œå¦‚æœéœ€è¦è®©å®ƒä¸º trueï¼Œéœ€è¦ç»§æ‰¿ LinkedHashMap å¹¶ä¸”è¦†ç›–è¿™ä¸ªæ–¹æ³•çš„å®ç°ï¼Œè¿™åœ¨å®ç° LRU çš„ç¼“å­˜ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼Œé€šè¿‡ç§»é™¤æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„èŠ‚ç‚¹ï¼Œä»è€Œä¿è¯ç¼“å­˜ç©ºé—´è¶³å¤Ÿï¼Œå¹¶ä¸”ç¼“å­˜çš„æ•°æ®éƒ½æ˜¯çƒ­ç‚¹æ•°æ®ã€‚ 123protected boolean removeEldestEntry(Map.Entry&lt;K,V&gt; eldest) { return false;} LRU ç¼“å­˜ä»¥ä¸‹æ˜¯ä½¿ç”¨ LinkedHashMap å®ç°çš„ä¸€ä¸ª LRU ç¼“å­˜ï¼š è®¾å®šæœ€å¤§ç¼“å­˜ç©ºé—´ MAX_ENTRIES ä¸º 3ï¼› ä½¿ç”¨ LinkedHashMap çš„æ„é€ å‡½æ•°å°† accessOrder è®¾ç½®ä¸º trueï¼Œå¼€å¯ LRU é¡ºåºï¼› è¦†ç›– removeEldestEntry() æ–¹æ³•å®ç°ï¼Œåœ¨èŠ‚ç‚¹å¤šäº MAX_ENTRIES å°±ä¼šå°†æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„æ•°æ®ç§»é™¤ã€‚ 123456789101112131415161718192021class LRUCache&lt;K, V&gt; extends LinkedHashMap&lt;K, V&gt; { private static final int MAX_ENTRIES = 3; protected boolean removeEldestEntry(Map.Entry eldest) { return size() &gt; MAX_ENTRIES; } LRUCache() { super(MAX_ENTRIES, 0.75f, true); }}public static void main(String[] args) { LRUCache&lt;Integer, String&gt; cache = new LRUCache&lt;&gt;(); cache.put(1, \"a\"); cache.put(2, \"b\"); cache.put(3, \"c\"); cache.get(1); cache.put(4, \"d\"); System.out.println(cache.keySet());}[3, 1, 4] WeakHashMapå­˜å‚¨ç»“æ„WeakHashMap çš„ Entry ç»§æ‰¿è‡ª WeakReferenceï¼Œè¢« WeakReference å…³è”çš„å¯¹è±¡åœ¨ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶æ—¶ä¼šè¢«å›æ”¶ã€‚ WeakHashMap ä¸»è¦ç”¨æ¥å®ç°ç¼“å­˜ï¼Œé€šè¿‡ä½¿ç”¨ WeakHashMap æ¥å¼•ç”¨ç¼“å­˜å¯¹è±¡ï¼Œç”± JVM å¯¹è¿™éƒ¨åˆ†ç¼“å­˜è¿›è¡Œå›æ”¶ã€‚ 1private static class Entry&lt;K,V&gt; extends WeakReference&lt;Object&gt; implements Map.Entry&lt;K,V&gt; ConcurrentCacheTomcat ä¸­çš„ ConcurrentCache ä½¿ç”¨äº† WeakHashMap æ¥å®ç°ç¼“å­˜åŠŸèƒ½ã€‚ ConcurrentCache é‡‡å–çš„æ˜¯åˆ†ä»£ç¼“å­˜ï¼š ç»å¸¸ä½¿ç”¨çš„å¯¹è±¡æ”¾å…¥ eden ä¸­ï¼Œeden ä½¿ç”¨ ConcurrentHashMap å®ç°ï¼Œä¸ç”¨æ‹…å¿ƒä¼šè¢«å›æ”¶ï¼ˆä¼Šç”¸å›­ï¼‰ï¼› ä¸å¸¸ç”¨çš„å¯¹è±¡æ”¾å…¥ longtermï¼Œlongterm ä½¿ç”¨ WeakHashMap å®ç°ï¼Œè¿™äº›è€å¯¹è±¡ä¼šè¢«åƒåœ¾æ”¶é›†å™¨å›æ”¶ã€‚ å½“è°ƒç”¨ get() æ–¹æ³•æ—¶ï¼Œä¼šå…ˆä» eden åŒºè·å–ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°çš„è¯å†åˆ° longterm è·å–ï¼Œå½“ä» longterm è·å–åˆ°å°±æŠŠå¯¹è±¡æ”¾å…¥ eden ä¸­ï¼Œä»è€Œä¿è¯ç»å¸¸è¢«è®¿é—®çš„èŠ‚ç‚¹ä¸å®¹æ˜“è¢«å›æ”¶ã€‚ å½“è°ƒç”¨ put() æ–¹æ³•æ—¶ï¼Œå¦‚æœ eden çš„å¤§å°è¶…è¿‡äº† sizeï¼Œé‚£ä¹ˆå°±å°† eden ä¸­çš„æ‰€æœ‰å¯¹è±¡éƒ½æ”¾å…¥ longterm ä¸­ï¼Œåˆ©ç”¨è™šæ‹Ÿæœºå›æ”¶æ‰ä¸€éƒ¨åˆ†ä¸ç»å¸¸ä½¿ç”¨çš„å¯¹è±¡ã€‚ 1234567891011121314151617181920212223242526272829303132public final class ConcurrentCache&lt;K, V&gt; { private final int size; private final Map&lt;K, V&gt; eden; private final Map&lt;K, V&gt; longterm; public ConcurrentCache(int size) { this.size = size; this.eden = new ConcurrentHashMap&lt;&gt;(size); this.longterm = new WeakHashMap&lt;&gt;(size); } public V get(K k) { V v = this.eden.get(k); if (v == null) { v = this.longterm.get(k); if (v != null) this.eden.put(k, v); } return v; } public void put(K k, V v) { if (this.eden.size() &gt;= size) { this.longterm.putAll(this.eden); this.eden.clear(); } this.eden.put(k, v); }} æ–‡ç« æ¥æº) .","link":"/2019/08/16/Javaå®¹å™¨é›†åˆ.html"},{"title":"ä¸­åäººæ°‘å…±å’Œå›½ç½‘ç»œå®‰å…¨æ³•","text":"ã€Šä¸­åäººæ°‘å…±å’Œå›½ç½‘ç»œå®‰å…¨æ³•ã€‹æ˜¯ä¸ºä¿éšœç½‘ç»œå®‰å…¨ï¼Œç»´æŠ¤ç½‘ç»œç©ºé—´ä¸»æƒå’Œå›½å®¶å®‰å…¨ã€ç¤¾ä¼šå…¬å…±åˆ©ç›Šï¼Œä¿æŠ¤å…¬æ°‘ã€æ³•äººå’Œå…¶ä»–ç»„ç»‡çš„åˆæ³•æƒç›Šï¼Œä¿ƒè¿›ç»æµç¤¾ä¼šä¿¡æ¯åŒ–å¥åº·å‘å±•åˆ¶å®šã€‚ç”±å…¨å›½äººæ°‘ä»£è¡¨å¤§ä¼šå¸¸åŠ¡å§”å‘˜ä¼šäº2016å¹´11æœˆ7æ—¥å‘å¸ƒï¼Œè‡ª2017å¹´6æœˆ1æ—¥èµ·æ–½è¡Œã€‚ ä¸­åäººæ°‘å…±å’Œå›½ç½‘ç»œå®‰å…¨æ³•ä¸­æ–‡åï¼šä¸­åäººæ°‘å…±å’Œå›½ç½‘ç»œå®‰å…¨æ³• å¤–æ–‡åï¼šPeopleâ€™s Republic of China Network Security Law å‘å¸ƒæœºæ„ï¼šå…¨å›½äººæ°‘ä»£è¡¨å¤§ä¼šå¸¸åŠ¡å§”å‘˜ä¼š å‘å¸ƒæ—¥æœŸï¼š2016å¹´11æœˆ7æ—¥ å®æ–½æ—¥æœŸï¼š2017å¹´6æœˆ1æ—¥ â€‹ ç¬¬ä¸€ç«  æ€» åˆ™ â€‹ ç¬¬äºŒç«  ç½‘ç»œå®‰å…¨æ”¯æŒä¸ä¿ƒè¿› â€‹ ç¬¬ä¸‰ç«  ç½‘ç»œè¿è¡Œå®‰å…¨ â€‹ ç¬¬ä¸€èŠ‚ ä¸€èˆ¬è§„å®š â€‹ ç¬¬äºŒèŠ‚ å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½çš„è¿è¡Œå®‰å…¨ â€‹ ç¬¬å››ç«  ç½‘ç»œä¿¡æ¯å®‰å…¨ â€‹ ç¬¬äº”ç«  ç›‘æµ‹é¢„è­¦ä¸åº”æ€¥å¤„ç½® â€‹ ç¬¬å…­ç«  æ³•å¾‹è´£ä»» â€‹ ç¬¬ä¸ƒç«  é™„ åˆ™ ç¬¬ä¸€ç«  æ€» åˆ™ç¬¬ä¸€æ¡ ä¸ºäº†ä¿éšœç½‘ç»œå®‰å…¨ï¼Œç»´æŠ¤ç½‘ç»œç©ºé—´ä¸»æƒå’Œå›½å®¶å®‰å…¨ã€ç¤¾ä¼šå…¬å…±åˆ©ç›Šï¼Œä¿æŠ¤å…¬æ°‘ã€æ³•äººå’Œå…¶ä»–ç»„ç»‡çš„åˆæ³•æƒç›Šï¼Œä¿ƒè¿›ç»æµç¤¾ä¼šä¿¡æ¯åŒ–å¥åº·å‘å±•ï¼Œåˆ¶å®šæœ¬æ³•ã€‚ ç¬¬äºŒæ¡ åœ¨ä¸­åäººæ°‘å…±å’Œå›½å¢ƒå†…å»ºè®¾ã€è¿è¥ã€ç»´æŠ¤å’Œä½¿ç”¨ç½‘ç»œï¼Œä»¥åŠç½‘ç»œå®‰å…¨çš„ç›‘ç£ç®¡ç†ï¼Œé€‚ç”¨æœ¬æ³•ã€‚ ç¬¬ä¸‰æ¡ å›½å®¶åšæŒç½‘ç»œå®‰å…¨ä¸ä¿¡æ¯åŒ–å‘å±•å¹¶é‡ï¼Œéµå¾ªç§¯æåˆ©ç”¨ã€ç§‘å­¦å‘å±•ã€ä¾æ³•ç®¡ç†ã€ç¡®ä¿å®‰å…¨çš„æ–¹é’ˆï¼Œæ¨è¿›ç½‘ç»œåŸºç¡€è®¾æ–½å»ºè®¾å’Œäº’è”äº’é€šï¼Œé¼“åŠ±ç½‘ç»œæŠ€æœ¯åˆ›æ–°å’Œåº”ç”¨ï¼Œæ”¯æŒåŸ¹å…»ç½‘ç»œå®‰å…¨äººæ‰ï¼Œå»ºç«‹å¥å…¨ç½‘ç»œå®‰å…¨ä¿éšœä½“ç³»ï¼Œæé«˜ç½‘ç»œå®‰å…¨ä¿æŠ¤èƒ½åŠ›ã€‚ ç¬¬å››æ¡ å›½å®¶åˆ¶å®šå¹¶ä¸æ–­å®Œå–„ç½‘ç»œå®‰å…¨æˆ˜ç•¥ï¼Œæ˜ç¡®ä¿éšœç½‘ç»œå®‰å…¨çš„åŸºæœ¬è¦æ±‚å’Œä¸»è¦ç›®æ ‡ï¼Œæå‡ºé‡ç‚¹é¢†åŸŸçš„ç½‘ç»œå®‰å…¨æ”¿ç­–ã€å·¥ä½œä»»åŠ¡å’Œæªæ–½ã€‚ ç¬¬äº”æ¡ å›½å®¶é‡‡å–æªæ–½ï¼Œç›‘æµ‹ã€é˜²å¾¡ã€å¤„ç½®æ¥æºäºä¸­åäººæ°‘å…±å’Œå›½å¢ƒå†…å¤–çš„ç½‘ç»œå®‰å…¨é£é™©å’Œå¨èƒï¼Œä¿æŠ¤å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½å…å—æ”»å‡»ã€ä¾µå…¥ã€å¹²æ‰°å’Œç ´åï¼Œä¾æ³•æƒ©æ²»ç½‘ç»œè¿æ³•çŠ¯ç½ªæ´»åŠ¨ï¼Œç»´æŠ¤ç½‘ç»œç©ºé—´å®‰å…¨å’Œç§©åºã€‚ ç¬¬å…­æ¡ å›½å®¶å€¡å¯¼è¯šå®å®ˆä¿¡ã€å¥åº·æ–‡æ˜çš„ç½‘ç»œè¡Œä¸ºï¼Œæ¨åŠ¨ä¼ æ’­ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ï¼Œé‡‡å–æªæ–½æé«˜å…¨ç¤¾ä¼šçš„ç½‘ç»œå®‰å…¨æ„è¯†å’Œæ°´å¹³ï¼Œå½¢æˆå…¨ç¤¾ä¼šå…±åŒå‚ä¸ä¿ƒè¿›ç½‘ç»œå®‰å…¨çš„è‰¯å¥½ç¯å¢ƒã€‚ ç¬¬ä¸ƒæ¡ å›½å®¶ç§¯æå¼€å±•ç½‘ç»œç©ºé—´æ²»ç†ã€ç½‘ç»œæŠ€æœ¯ç ”å‘å’Œæ ‡å‡†åˆ¶å®šã€æ‰“å‡»ç½‘ç»œè¿æ³•çŠ¯ç½ªç­‰æ–¹é¢çš„å›½é™…äº¤æµä¸åˆä½œï¼Œæ¨åŠ¨æ„å»ºå’Œå¹³ã€å®‰å…¨ã€å¼€æ”¾ã€åˆä½œçš„ç½‘ç»œç©ºé—´ï¼Œå»ºç«‹å¤šè¾¹ã€æ°‘ä¸»ã€é€æ˜çš„ç½‘ç»œæ²»ç†ä½“ç³»ã€‚ ç¬¬å…«æ¡ å›½å®¶ç½‘ä¿¡éƒ¨é—¨è´Ÿè´£ç»Ÿç­¹åè°ƒç½‘ç»œå®‰å…¨å·¥ä½œå’Œç›¸å…³ç›‘ç£ç®¡ç†å·¥ä½œã€‚å›½åŠ¡é™¢ç”µä¿¡ä¸»ç®¡éƒ¨é—¨ã€å…¬å®‰éƒ¨é—¨å’Œå…¶ä»–æœ‰å…³æœºå…³ä¾ç…§æœ¬æ³•å’Œæœ‰å…³æ³•å¾‹ã€è¡Œæ”¿æ³•è§„çš„è§„å®šï¼Œåœ¨å„è‡ªèŒè´£èŒƒå›´å†…è´Ÿè´£ç½‘ç»œå®‰å…¨ä¿æŠ¤å’Œç›‘ç£ç®¡ç†å·¥ä½œã€‚ å¿çº§ä»¥ä¸Šåœ°æ–¹äººæ°‘æ”¿åºœæœ‰å…³éƒ¨é—¨çš„ç½‘ç»œå®‰å…¨ä¿æŠ¤å’Œç›‘ç£ç®¡ç†èŒè´£ï¼ŒæŒ‰ç…§å›½å®¶æœ‰å…³è§„å®šç¡®å®šã€‚ ç¬¬ä¹æ¡ ç½‘ç»œè¿è¥è€…å¼€å±•ç»è¥å’ŒæœåŠ¡æ´»åŠ¨ï¼Œå¿…é¡»éµå®ˆæ³•å¾‹ã€è¡Œæ”¿æ³•è§„ï¼Œå°Šé‡ç¤¾ä¼šå…¬å¾·ï¼Œéµå®ˆå•†ä¸šé“å¾·ï¼Œè¯šå®ä¿¡ç”¨ï¼Œå±¥è¡Œç½‘ç»œå®‰å…¨ä¿æŠ¤ä¹‰åŠ¡ï¼Œæ¥å—æ”¿åºœå’Œç¤¾ä¼šçš„ç›‘ç£ï¼Œæ‰¿æ‹…ç¤¾ä¼šè´£ä»»ã€‚ ç¬¬åæ¡ å»ºè®¾ã€è¿è¥ç½‘ç»œæˆ–è€…é€šè¿‡ç½‘ç»œæä¾›æœåŠ¡ï¼Œåº”å½“ä¾ç…§æ³•å¾‹ã€è¡Œæ”¿æ³•è§„çš„è§„å®šå’Œå›½å®¶æ ‡å‡†çš„å¼ºåˆ¶æ€§è¦æ±‚ï¼Œé‡‡å–æŠ€æœ¯æªæ–½å’Œå…¶ä»–å¿…è¦æªæ–½ï¼Œä¿éšœç½‘ç»œå®‰å…¨ã€ç¨³å®šè¿è¡Œï¼Œæœ‰æ•ˆåº”å¯¹ç½‘ç»œå®‰å…¨äº‹ä»¶ï¼Œé˜²èŒƒç½‘ç»œè¿æ³•çŠ¯ç½ªæ´»åŠ¨ï¼Œç»´æŠ¤ç½‘ç»œæ•°æ®çš„å®Œæ•´æ€§ã€ä¿å¯†æ€§å’Œå¯ç”¨æ€§ã€‚ ç¬¬åä¸€æ¡ ç½‘ç»œç›¸å…³è¡Œä¸šç»„ç»‡æŒ‰ç…§ç« ç¨‹ï¼ŒåŠ å¼ºè¡Œä¸šè‡ªå¾‹ï¼Œåˆ¶å®šç½‘ç»œå®‰å…¨è¡Œä¸ºè§„èŒƒï¼ŒæŒ‡å¯¼ä¼šå‘˜åŠ å¼ºç½‘ç»œå®‰å…¨ä¿æŠ¤ï¼Œæé«˜ç½‘ç»œå®‰å…¨ä¿æŠ¤æ°´å¹³ï¼Œä¿ƒè¿›è¡Œä¸šå¥åº·å‘å±•ã€‚ ç¬¬åäºŒæ¡ å›½å®¶ä¿æŠ¤å…¬æ°‘ã€æ³•äººå’Œå…¶ä»–ç»„ç»‡ä¾æ³•ä½¿ç”¨ç½‘ç»œçš„æƒåˆ©ï¼Œä¿ƒè¿›ç½‘ç»œæ¥å…¥æ™®åŠï¼Œæå‡ç½‘ç»œæœåŠ¡æ°´å¹³ï¼Œä¸ºç¤¾ä¼šæä¾›å®‰å…¨ã€ä¾¿åˆ©çš„ç½‘ç»œæœåŠ¡ï¼Œä¿éšœç½‘ç»œä¿¡æ¯ä¾æ³•æœ‰åºè‡ªç”±æµåŠ¨ã€‚ ä»»ä½•ä¸ªäººå’Œç»„ç»‡ä½¿ç”¨ç½‘ç»œåº”å½“éµå®ˆå®ªæ³•æ³•å¾‹ï¼Œéµå®ˆå…¬å…±ç§©åºï¼Œå°Šé‡ç¤¾ä¼šå…¬å¾·ï¼Œä¸å¾—å±å®³ç½‘ç»œå®‰å…¨ï¼Œä¸å¾—åˆ©ç”¨ç½‘ç»œä»äº‹å±å®³å›½å®¶å®‰å…¨ã€è£èª‰å’Œåˆ©ç›Šï¼Œç…½åŠ¨é¢ è¦†å›½å®¶æ”¿æƒã€æ¨ç¿»ç¤¾ä¼šä¸»ä¹‰åˆ¶åº¦ï¼Œç…½åŠ¨åˆ†è£‚å›½å®¶ã€ç ´åå›½å®¶ç»Ÿä¸€ï¼Œå®£æ‰¬ææ€–ä¸»ä¹‰ã€æç«¯ä¸»ä¹‰ï¼Œå®£æ‰¬æ°‘æ—ä»‡æ¨ã€æ°‘æ—æ­§è§†ï¼Œä¼ æ’­æš´åŠ›ã€æ·«ç§½è‰²æƒ…ä¿¡æ¯ï¼Œç¼–é€ ã€ä¼ æ’­è™šå‡ä¿¡æ¯æ‰°ä¹±ç»æµç§©åºå’Œç¤¾ä¼šç§©åºï¼Œä»¥åŠä¾µå®³ä»–äººåèª‰ã€éšç§ã€çŸ¥è¯†äº§æƒå’Œå…¶ä»–åˆæ³•æƒç›Šç­‰æ´»åŠ¨ã€‚ ç¬¬åä¸‰æ¡ å›½å®¶æ”¯æŒç ”ç©¶å¼€å‘æœ‰åˆ©äºæœªæˆå¹´äººå¥åº·æˆé•¿çš„ç½‘ç»œäº§å“å’ŒæœåŠ¡ï¼Œä¾æ³•æƒ©æ²»åˆ©ç”¨ç½‘ç»œä»äº‹å±å®³æœªæˆå¹´äººèº«å¿ƒå¥åº·çš„æ´»åŠ¨ï¼Œä¸ºæœªæˆå¹´äººæä¾›å®‰å…¨ã€å¥åº·çš„ç½‘ç»œç¯å¢ƒã€‚ ç¬¬åå››æ¡ ä»»ä½•ä¸ªäººå’Œç»„ç»‡æœ‰æƒå¯¹å±å®³ç½‘ç»œå®‰å…¨çš„è¡Œä¸ºå‘ç½‘ä¿¡ã€ç”µä¿¡ã€å…¬å®‰ç­‰éƒ¨é—¨ä¸¾æŠ¥ã€‚æ”¶åˆ°ä¸¾æŠ¥çš„éƒ¨é—¨åº”å½“åŠæ—¶ä¾æ³•ä½œå‡ºå¤„ç†ï¼›ä¸å±äºæœ¬éƒ¨é—¨èŒè´£çš„ï¼Œåº”å½“åŠæ—¶ç§»é€æœ‰æƒå¤„ç†çš„éƒ¨é—¨ã€‚ æœ‰å…³éƒ¨é—¨åº”å½“å¯¹ä¸¾æŠ¥äººçš„ç›¸å…³ä¿¡æ¯äºˆä»¥ä¿å¯†ï¼Œä¿æŠ¤ä¸¾æŠ¥äººçš„åˆæ³•æƒç›Šã€‚ ç¬¬äºŒç«  ç½‘ç»œå®‰å…¨æ”¯æŒä¸ä¿ƒè¿›ç¬¬åäº”æ¡ å›½å®¶å»ºç«‹å’Œå®Œå–„ç½‘ç»œå®‰å…¨æ ‡å‡†ä½“ç³»ã€‚å›½åŠ¡é™¢æ ‡å‡†åŒ–è¡Œæ”¿ä¸»ç®¡éƒ¨é—¨å’Œå›½åŠ¡é™¢å…¶ä»–æœ‰å…³éƒ¨é—¨æ ¹æ®å„è‡ªçš„èŒè´£ï¼Œç»„ç»‡åˆ¶å®šå¹¶é€‚æ—¶ä¿®è®¢æœ‰å…³ç½‘ç»œå®‰å…¨ç®¡ç†ä»¥åŠç½‘ç»œäº§å“ã€æœåŠ¡å’Œè¿è¡Œå®‰å…¨çš„å›½å®¶æ ‡å‡†ã€è¡Œä¸šæ ‡å‡†ã€‚ å›½å®¶æ”¯æŒä¼ä¸šã€ç ”ç©¶æœºæ„ã€é«˜ç­‰å­¦æ ¡ã€ç½‘ç»œç›¸å…³è¡Œä¸šç»„ç»‡å‚ä¸ç½‘ç»œå®‰å…¨å›½å®¶æ ‡å‡†ã€è¡Œä¸šæ ‡å‡†çš„åˆ¶å®šã€‚ ç¬¬åå…­æ¡ å›½åŠ¡é™¢å’Œçœã€è‡ªæ²»åŒºã€ç›´è¾–å¸‚äººæ°‘æ”¿åºœåº”å½“ç»Ÿç­¹è§„åˆ’ï¼ŒåŠ å¤§æŠ•å…¥ï¼Œæ‰¶æŒé‡ç‚¹ç½‘ç»œå®‰å…¨æŠ€æœ¯äº§ä¸šå’Œé¡¹ç›®ï¼Œæ”¯æŒç½‘ç»œå®‰å…¨æŠ€æœ¯çš„ç ”ç©¶å¼€å‘å’Œåº”ç”¨ï¼Œæ¨å¹¿å®‰å…¨å¯ä¿¡çš„ç½‘ç»œäº§å“å’ŒæœåŠ¡ï¼Œä¿æŠ¤ç½‘ç»œæŠ€æœ¯çŸ¥è¯†äº§æƒï¼Œæ”¯æŒä¼ä¸šã€ç ”ç©¶æœºæ„å’Œé«˜ç­‰å­¦æ ¡ç­‰å‚ä¸å›½å®¶ç½‘ç»œå®‰å…¨æŠ€æœ¯åˆ›æ–°é¡¹ç›®ã€‚ ç¬¬åä¸ƒæ¡ å›½å®¶æ¨è¿›ç½‘ç»œå®‰å…¨ç¤¾ä¼šåŒ–æœåŠ¡ä½“ç³»å»ºè®¾ï¼Œé¼“åŠ±æœ‰å…³ä¼ä¸šã€æœºæ„å¼€å±•ç½‘ç»œå®‰å…¨è®¤è¯ã€æ£€æµ‹å’Œé£é™©è¯„ä¼°ç­‰å®‰å…¨æœåŠ¡ã€‚ ç¬¬åå…«æ¡ å›½å®¶é¼“åŠ±å¼€å‘ç½‘ç»œæ•°æ®å®‰å…¨ä¿æŠ¤å’Œåˆ©ç”¨æŠ€æœ¯ï¼Œä¿ƒè¿›å…¬å…±æ•°æ®èµ„æºå¼€æ”¾ï¼Œæ¨åŠ¨æŠ€æœ¯åˆ›æ–°å’Œç»æµç¤¾ä¼šå‘å±•ã€‚ å›½å®¶æ”¯æŒåˆ›æ–°ç½‘ç»œå®‰å…¨ç®¡ç†æ–¹å¼ï¼Œè¿ç”¨ç½‘ç»œæ–°æŠ€æœ¯ï¼Œæå‡ç½‘ç»œå®‰å…¨ä¿æŠ¤æ°´å¹³ã€‚ ç¬¬åä¹æ¡ å„çº§äººæ°‘æ”¿åºœåŠå…¶æœ‰å…³éƒ¨é—¨åº”å½“ç»„ç»‡å¼€å±•ç»å¸¸æ€§çš„ç½‘ç»œå®‰å…¨å®£ä¼ æ•™è‚²ï¼Œå¹¶æŒ‡å¯¼ã€ç£ä¿ƒæœ‰å…³å•ä½åšå¥½ç½‘ç»œå®‰å…¨å®£ä¼ æ•™è‚²å·¥ä½œã€‚ å¤§ä¼—ä¼ æ’­åª’ä»‹åº”å½“æœ‰é’ˆå¯¹æ€§åœ°é¢å‘ç¤¾ä¼šè¿›è¡Œç½‘ç»œå®‰å…¨å®£ä¼ æ•™è‚²ã€‚ ç¬¬äºŒåæ¡ å›½å®¶æ”¯æŒä¼ä¸šå’Œé«˜ç­‰å­¦æ ¡ã€èŒä¸šå­¦æ ¡ç­‰æ•™è‚²åŸ¹è®­æœºæ„å¼€å±•ç½‘ç»œå®‰å…¨ç›¸å…³æ•™è‚²ä¸åŸ¹è®­ï¼Œé‡‡å–å¤šç§æ–¹å¼åŸ¹å…»ç½‘ç»œå®‰å…¨äººæ‰ï¼Œä¿ƒè¿›ç½‘ç»œå®‰å…¨äººæ‰äº¤æµã€‚ ç¬¬ä¸‰ç«  ç½‘ç»œè¿è¡Œå®‰å…¨ ç¬¬ä¸€èŠ‚ ä¸€èˆ¬è§„å®šç¬¬äºŒåä¸€æ¡ å›½å®¶å®è¡Œç½‘ç»œå®‰å…¨ç­‰çº§ä¿æŠ¤åˆ¶åº¦ã€‚ç½‘ç»œè¿è¥è€…åº”å½“æŒ‰ç…§ç½‘ç»œå®‰å…¨ç­‰çº§ä¿æŠ¤åˆ¶åº¦çš„è¦æ±‚ï¼Œå±¥è¡Œä¸‹åˆ—å®‰å…¨ä¿æŠ¤ä¹‰åŠ¡ï¼Œä¿éšœç½‘ç»œå…å—å¹²æ‰°ã€ç ´åæˆ–è€…æœªç»æˆæƒçš„è®¿é—®ï¼Œé˜²æ­¢ç½‘ç»œæ•°æ®æ³„éœ²æˆ–è€…è¢«çªƒå–ã€ç¯¡æ”¹ï¼š ï¼ˆä¸€ï¼‰åˆ¶å®šå†…éƒ¨å®‰å…¨ç®¡ç†åˆ¶åº¦å’Œæ“ä½œè§„ç¨‹ï¼Œç¡®å®šç½‘ç»œå®‰å…¨è´Ÿè´£äººï¼Œè½å®ç½‘ç»œå®‰å…¨ä¿æŠ¤è´£ä»»ï¼› ï¼ˆäºŒï¼‰é‡‡å–é˜²èŒƒè®¡ç®—æœºç—…æ¯’å’Œç½‘ç»œæ”»å‡»ã€ç½‘ç»œä¾µå…¥ç­‰å±å®³ç½‘ç»œå®‰å…¨è¡Œä¸ºçš„æŠ€æœ¯æªæ–½ï¼› ï¼ˆä¸‰ï¼‰é‡‡å–ç›‘æµ‹ã€è®°å½•ç½‘ç»œè¿è¡ŒçŠ¶æ€ã€ç½‘ç»œå®‰å…¨äº‹ä»¶çš„æŠ€æœ¯æªæ–½ï¼Œå¹¶æŒ‰ç…§è§„å®šç•™å­˜ç›¸å…³çš„ç½‘ç»œæ—¥å¿—ä¸å°‘äºå…­ä¸ªæœˆï¼› ï¼ˆå››ï¼‰é‡‡å–æ•°æ®åˆ†ç±»ã€é‡è¦æ•°æ®å¤‡ä»½å’ŒåŠ å¯†ç­‰æªæ–½ï¼› ï¼ˆäº”ï¼‰æ³•å¾‹ã€è¡Œæ”¿æ³•è§„è§„å®šçš„å…¶ä»–ä¹‰åŠ¡ã€‚ ç¬¬äºŒåäºŒæ¡ ç½‘ç»œäº§å“ã€æœåŠ¡åº”å½“ç¬¦åˆç›¸å…³å›½å®¶æ ‡å‡†çš„å¼ºåˆ¶æ€§è¦æ±‚ã€‚ç½‘ç»œäº§å“ã€æœåŠ¡çš„æä¾›è€…ä¸å¾—è®¾ç½®æ¶æ„ç¨‹åºï¼›å‘ç°å…¶ç½‘ç»œäº§å“ã€æœåŠ¡å­˜åœ¨å®‰å…¨ç¼ºé™·ã€æ¼æ´ç­‰é£é™©æ—¶ï¼Œåº”å½“ç«‹å³é‡‡å–è¡¥æ•‘æªæ–½ï¼ŒæŒ‰ç…§è§„å®šåŠæ—¶å‘ŠçŸ¥ç”¨æˆ·å¹¶å‘æœ‰å…³ä¸»ç®¡éƒ¨é—¨æŠ¥å‘Šã€‚ ç½‘ç»œäº§å“ã€æœåŠ¡çš„æä¾›è€…åº”å½“ä¸ºå…¶äº§å“ã€æœåŠ¡æŒç»­æä¾›å®‰å…¨ç»´æŠ¤ï¼›åœ¨è§„å®šæˆ–è€…å½“äº‹äººçº¦å®šçš„æœŸé™å†…ï¼Œä¸å¾—ç»ˆæ­¢æä¾›å®‰å…¨ç»´æŠ¤ã€‚ ç½‘ç»œäº§å“ã€æœåŠ¡å…·æœ‰æ”¶é›†ç”¨æˆ·ä¿¡æ¯åŠŸèƒ½çš„ï¼Œå…¶æä¾›è€…åº”å½“å‘ç”¨æˆ·æ˜ç¤ºå¹¶å–å¾—åŒæ„ï¼›æ¶‰åŠç”¨æˆ·ä¸ªäººä¿¡æ¯çš„ï¼Œè¿˜åº”å½“éµå®ˆæœ¬æ³•å’Œæœ‰å…³æ³•å¾‹ã€è¡Œæ”¿æ³•è§„å…³äºä¸ªäººä¿¡æ¯ä¿æŠ¤çš„è§„å®šã€‚ ç¬¬äºŒåä¸‰æ¡ ç½‘ç»œå…³é”®è®¾å¤‡å’Œç½‘ç»œå®‰å…¨ä¸“ç”¨äº§å“åº”å½“æŒ‰ç…§ç›¸å…³å›½å®¶æ ‡å‡†çš„å¼ºåˆ¶æ€§è¦æ±‚ï¼Œç”±å…·å¤‡èµ„æ ¼çš„æœºæ„å®‰å…¨è®¤è¯åˆæ ¼æˆ–è€…å®‰å…¨æ£€æµ‹ç¬¦åˆè¦æ±‚åï¼Œæ–¹å¯é”€å”®æˆ–è€…æä¾›ã€‚å›½å®¶ç½‘ä¿¡éƒ¨é—¨ä¼šåŒå›½åŠ¡é™¢æœ‰å…³éƒ¨é—¨åˆ¶å®šã€å…¬å¸ƒç½‘ç»œå…³é”®è®¾å¤‡å’Œç½‘ç»œå®‰å…¨ä¸“ç”¨äº§å“ç›®å½•ï¼Œå¹¶æ¨åŠ¨å®‰å…¨è®¤è¯å’Œå®‰å…¨æ£€æµ‹ç»“æœäº’è®¤ï¼Œé¿å…é‡å¤è®¤è¯ã€æ£€æµ‹ã€‚ ç¬¬äºŒåå››æ¡ ç½‘ç»œè¿è¥è€…ä¸ºç”¨æˆ·åŠç†ç½‘ç»œæ¥å…¥ã€åŸŸåæ³¨å†ŒæœåŠ¡ï¼ŒåŠç†å›ºå®šç”µè¯ã€ç§»åŠ¨ç”µè¯ç­‰å…¥ç½‘æ‰‹ç»­ï¼Œæˆ–è€…ä¸ºç”¨æˆ·æä¾›ä¿¡æ¯å‘å¸ƒã€å³æ—¶é€šè®¯ç­‰æœåŠ¡ï¼Œåœ¨ä¸ç”¨æˆ·ç­¾è®¢åè®®æˆ–è€…ç¡®è®¤æä¾›æœåŠ¡æ—¶ï¼Œåº”å½“è¦æ±‚ç”¨æˆ·æä¾›çœŸå®èº«ä»½ä¿¡æ¯ã€‚ç”¨æˆ·ä¸æä¾›çœŸå®èº«ä»½ä¿¡æ¯çš„ï¼Œç½‘ç»œè¿è¥è€…ä¸å¾—ä¸ºå…¶æä¾›ç›¸å…³æœåŠ¡ã€‚ å›½å®¶å®æ–½ç½‘ç»œå¯ä¿¡èº«ä»½æˆ˜ç•¥ï¼Œæ”¯æŒç ”ç©¶å¼€å‘å®‰å…¨ã€æ–¹ä¾¿çš„ç”µå­èº«ä»½è®¤è¯æŠ€æœ¯ï¼Œæ¨åŠ¨ä¸åŒç”µå­èº«ä»½è®¤è¯ä¹‹é—´çš„äº’è®¤ã€‚ ç¬¬äºŒåäº”æ¡ ç½‘ç»œè¿è¥è€…åº”å½“åˆ¶å®šç½‘ç»œå®‰å…¨äº‹ä»¶åº”æ€¥é¢„æ¡ˆï¼ŒåŠæ—¶å¤„ç½®ç³»ç»Ÿæ¼æ´ã€è®¡ç®—æœºç—…æ¯’ã€ç½‘ç»œæ”»å‡»ã€ç½‘ç»œä¾µå…¥ç­‰å®‰å…¨é£é™©ï¼›åœ¨å‘ç”Ÿå±å®³ç½‘ç»œå®‰å…¨çš„äº‹ä»¶æ—¶ï¼Œç«‹å³å¯åŠ¨åº”æ€¥é¢„æ¡ˆï¼Œé‡‡å–ç›¸åº”çš„è¡¥æ•‘æªæ–½ï¼Œå¹¶æŒ‰ç…§è§„å®šå‘æœ‰å…³ä¸»ç®¡éƒ¨é—¨æŠ¥å‘Šã€‚ ç¬¬äºŒåå…­æ¡ å¼€å±•ç½‘ç»œå®‰å…¨è®¤è¯ã€æ£€æµ‹ã€é£é™©è¯„ä¼°ç­‰æ´»åŠ¨ï¼Œå‘ç¤¾ä¼šå‘å¸ƒç³»ç»Ÿæ¼æ´ã€è®¡ç®—æœºç—…æ¯’ã€ç½‘ç»œæ”»å‡»ã€ç½‘ç»œä¾µå…¥ç­‰ç½‘ç»œå®‰å…¨ä¿¡æ¯ï¼Œåº”å½“éµå®ˆå›½å®¶æœ‰å…³è§„å®šã€‚ ç¬¬äºŒåä¸ƒæ¡ ä»»ä½•ä¸ªäººå’Œç»„ç»‡ä¸å¾—ä»äº‹éæ³•ä¾µå…¥ä»–äººç½‘ç»œã€å¹²æ‰°ä»–äººç½‘ç»œæ­£å¸¸åŠŸèƒ½ã€çªƒå–ç½‘ç»œæ•°æ®ç­‰å±å®³ç½‘ç»œå®‰å…¨çš„æ´»åŠ¨ï¼›ä¸å¾—æä¾›ä¸“é—¨ç”¨äºä»äº‹ä¾µå…¥ç½‘ç»œã€å¹²æ‰°ç½‘ç»œæ­£å¸¸åŠŸèƒ½åŠé˜²æŠ¤æªæ–½ã€çªƒå–ç½‘ç»œæ•°æ®ç­‰å±å®³ç½‘ç»œå®‰å…¨æ´»åŠ¨çš„ç¨‹åºã€å·¥å…·ï¼›æ˜çŸ¥ä»–äººä»äº‹å±å®³ç½‘ç»œå®‰å…¨çš„æ´»åŠ¨çš„ï¼Œä¸å¾—ä¸ºå…¶æä¾›æŠ€æœ¯æ”¯æŒã€å¹¿å‘Šæ¨å¹¿ã€æ”¯ä»˜ç»“ç®—ç­‰å¸®åŠ©ã€‚ ç¬¬äºŒåå…«æ¡ ç½‘ç»œè¿è¥è€…åº”å½“ä¸ºå…¬å®‰æœºå…³ã€å›½å®¶å®‰å…¨æœºå…³ä¾æ³•ç»´æŠ¤å›½å®¶å®‰å…¨å’Œä¾¦æŸ¥çŠ¯ç½ªçš„æ´»åŠ¨æä¾›æŠ€æœ¯æ”¯æŒå’ŒååŠ©ã€‚ ç¬¬äºŒåä¹æ¡ å›½å®¶æ”¯æŒç½‘ç»œè¿è¥è€…ä¹‹é—´åœ¨ç½‘ç»œå®‰å…¨ä¿¡æ¯æ”¶é›†ã€åˆ†æã€é€šæŠ¥å’Œåº”æ€¥å¤„ç½®ç­‰æ–¹é¢è¿›è¡Œåˆä½œï¼Œæé«˜ç½‘ç»œè¿è¥è€…çš„å®‰å…¨ä¿éšœèƒ½åŠ›ã€‚ æœ‰å…³è¡Œä¸šç»„ç»‡å»ºç«‹å¥å…¨æœ¬è¡Œä¸šçš„ç½‘ç»œå®‰å…¨ä¿æŠ¤è§„èŒƒå’Œåä½œæœºåˆ¶ï¼ŒåŠ å¼ºå¯¹ç½‘ç»œå®‰å…¨é£é™©çš„åˆ†æè¯„ä¼°ï¼Œå®šæœŸå‘ä¼šå‘˜è¿›è¡Œé£é™©è­¦ç¤ºï¼Œæ”¯æŒã€ååŠ©ä¼šå‘˜åº”å¯¹ç½‘ç»œå®‰å…¨é£é™©ã€‚ ç¬¬ä¸‰åæ¡ ç½‘ä¿¡éƒ¨é—¨å’Œæœ‰å…³éƒ¨é—¨åœ¨å±¥è¡Œç½‘ç»œå®‰å…¨ä¿æŠ¤èŒè´£ä¸­è·å–çš„ä¿¡æ¯ï¼Œåªèƒ½ç”¨äºç»´æŠ¤ç½‘ç»œå®‰å…¨çš„éœ€è¦ï¼Œä¸å¾—ç”¨äºå…¶ä»–ç”¨é€”ã€‚ ç¬¬äºŒèŠ‚ å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½çš„è¿è¡Œå®‰å…¨ç¬¬ä¸‰åä¸€æ¡ å›½å®¶å¯¹å…¬å…±é€šä¿¡å’Œä¿¡æ¯æœåŠ¡ã€èƒ½æºã€äº¤é€šã€æ°´åˆ©ã€é‡‘èã€å…¬å…±æœåŠ¡ã€ç”µå­æ”¿åŠ¡ç­‰é‡è¦è¡Œä¸šå’Œé¢†åŸŸï¼Œä»¥åŠå…¶ä»–ä¸€æ—¦é­åˆ°ç ´åã€ä¸§å¤±åŠŸèƒ½æˆ–è€…æ•°æ®æ³„éœ²ï¼Œå¯èƒ½ä¸¥é‡å±å®³å›½å®¶å®‰å…¨ã€å›½è®¡æ°‘ç”Ÿã€å…¬å…±åˆ©ç›Šçš„å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½ï¼Œåœ¨ç½‘ç»œå®‰å…¨ç­‰çº§ä¿æŠ¤åˆ¶åº¦çš„åŸºç¡€ä¸Šï¼Œå®è¡Œé‡ç‚¹ä¿æŠ¤ã€‚å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½çš„å…·ä½“èŒƒå›´å’Œå®‰å…¨ä¿æŠ¤åŠæ³•ç”±å›½åŠ¡é™¢åˆ¶å®šã€‚ å›½å®¶é¼“åŠ±å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½ä»¥å¤–çš„ç½‘ç»œè¿è¥è€…è‡ªæ„¿å‚ä¸å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½ä¿æŠ¤ä½“ç³»ã€‚ ç¬¬ä¸‰åäºŒæ¡ æŒ‰ç…§å›½åŠ¡é™¢è§„å®šçš„èŒè´£åˆ†å·¥ï¼Œè´Ÿè´£å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½å®‰å…¨ä¿æŠ¤å·¥ä½œçš„éƒ¨é—¨åˆ†åˆ«ç¼–åˆ¶å¹¶ç»„ç»‡å®æ–½æœ¬è¡Œä¸šã€æœ¬é¢†åŸŸçš„å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½å®‰å…¨è§„åˆ’ï¼ŒæŒ‡å¯¼å’Œç›‘ç£å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½è¿è¡Œå®‰å…¨ä¿æŠ¤å·¥ä½œã€‚ ç¬¬ä¸‰åä¸‰æ¡ å»ºè®¾å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½åº”å½“ç¡®ä¿å…¶å…·æœ‰æ”¯æŒä¸šåŠ¡ç¨³å®šã€æŒç»­è¿è¡Œçš„æ€§èƒ½ï¼Œå¹¶ä¿è¯å®‰å…¨æŠ€æœ¯æªæ–½åŒæ­¥è§„åˆ’ã€åŒæ­¥å»ºè®¾ã€åŒæ­¥ä½¿ç”¨ã€‚ ç¬¬ä¸‰åå››æ¡ é™¤æœ¬æ³•ç¬¬äºŒåä¸€æ¡çš„è§„å®šå¤–ï¼Œå…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½çš„è¿è¥è€…è¿˜åº”å½“å±¥è¡Œä¸‹åˆ—å®‰å…¨ä¿æŠ¤ä¹‰åŠ¡ï¼š ï¼ˆä¸€ï¼‰è®¾ç½®ä¸“é—¨å®‰å…¨ç®¡ç†æœºæ„å’Œå®‰å…¨ç®¡ç†è´Ÿè´£äººï¼Œå¹¶å¯¹è¯¥è´Ÿè´£äººå’Œå…³é”®å²—ä½çš„äººå‘˜è¿›è¡Œå®‰å…¨èƒŒæ™¯å®¡æŸ¥ï¼› ï¼ˆäºŒï¼‰å®šæœŸå¯¹ä»ä¸šäººå‘˜è¿›è¡Œç½‘ç»œå®‰å…¨æ•™è‚²ã€æŠ€æœ¯åŸ¹è®­å’ŒæŠ€èƒ½è€ƒæ ¸ï¼› ï¼ˆä¸‰ï¼‰å¯¹é‡è¦ç³»ç»Ÿå’Œæ•°æ®åº“è¿›è¡Œå®¹ç¾å¤‡ä»½ï¼› ï¼ˆå››ï¼‰åˆ¶å®šç½‘ç»œå®‰å…¨äº‹ä»¶åº”æ€¥é¢„æ¡ˆï¼Œå¹¶å®šæœŸè¿›è¡Œæ¼”ç»ƒï¼› ï¼ˆäº”ï¼‰æ³•å¾‹ã€è¡Œæ”¿æ³•è§„è§„å®šçš„å…¶ä»–ä¹‰åŠ¡ã€‚ ç¬¬ä¸‰åäº”æ¡ å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½çš„è¿è¥è€…é‡‡è´­ç½‘ç»œäº§å“å’ŒæœåŠ¡ï¼Œå¯èƒ½å½±å“å›½å®¶å®‰å…¨çš„ï¼Œåº”å½“é€šè¿‡å›½å®¶ç½‘ä¿¡éƒ¨é—¨ä¼šåŒå›½åŠ¡é™¢æœ‰å…³éƒ¨é—¨ç»„ç»‡çš„å›½å®¶å®‰å…¨å®¡æŸ¥ã€‚ ç¬¬ä¸‰åå…­æ¡ å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½çš„è¿è¥è€…é‡‡è´­ç½‘ç»œäº§å“å’ŒæœåŠ¡ï¼Œåº”å½“æŒ‰ç…§è§„å®šä¸æä¾›è€…ç­¾è®¢å®‰å…¨ä¿å¯†åè®®ï¼Œæ˜ç¡®å®‰å…¨å’Œä¿å¯†ä¹‰åŠ¡ä¸è´£ä»»ã€‚ ç¬¬ä¸‰åä¸ƒæ¡ å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½çš„è¿è¥è€…åœ¨ä¸­åäººæ°‘å…±å’Œå›½å¢ƒå†…è¿è¥ä¸­æ”¶é›†å’Œäº§ç”Ÿçš„ä¸ªäººä¿¡æ¯å’Œé‡è¦æ•°æ®åº”å½“åœ¨å¢ƒå†…å­˜å‚¨ã€‚å› ä¸šåŠ¡éœ€è¦ï¼Œç¡®éœ€å‘å¢ƒå¤–æä¾›çš„ï¼Œåº”å½“æŒ‰ç…§å›½å®¶ç½‘ä¿¡éƒ¨é—¨ä¼šåŒå›½åŠ¡é™¢æœ‰å…³éƒ¨é—¨åˆ¶å®šçš„åŠæ³•è¿›è¡Œå®‰å…¨è¯„ä¼°ï¼›æ³•å¾‹ã€è¡Œæ”¿æ³•è§„å¦æœ‰è§„å®šçš„ï¼Œä¾ç…§å…¶è§„å®šã€‚ ç¬¬ä¸‰åå…«æ¡ å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½çš„è¿è¥è€…åº”å½“è‡ªè¡Œæˆ–è€…å§”æ‰˜ç½‘ç»œå®‰å…¨æœåŠ¡æœºæ„å¯¹å…¶ç½‘ç»œçš„å®‰å…¨æ€§å’Œå¯èƒ½å­˜åœ¨çš„é£é™©æ¯å¹´è‡³å°‘è¿›è¡Œä¸€æ¬¡æ£€æµ‹è¯„ä¼°ï¼Œå¹¶å°†æ£€æµ‹è¯„ä¼°æƒ…å†µå’Œæ”¹è¿›æªæ–½æŠ¥é€ç›¸å…³è´Ÿè´£å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½å®‰å…¨ä¿æŠ¤å·¥ä½œçš„éƒ¨é—¨ã€‚ ç¬¬ä¸‰åä¹æ¡ å›½å®¶ç½‘ä¿¡éƒ¨é—¨åº”å½“ç»Ÿç­¹åè°ƒæœ‰å…³éƒ¨é—¨å¯¹å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½çš„å®‰å…¨ä¿æŠ¤é‡‡å–ä¸‹åˆ—æªæ–½ï¼š ï¼ˆä¸€ï¼‰å¯¹å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½çš„å®‰å…¨é£é™©è¿›è¡ŒæŠ½æŸ¥æ£€æµ‹ï¼Œæå‡ºæ”¹è¿›æªæ–½ï¼Œå¿…è¦æ—¶å¯ä»¥å§”æ‰˜ç½‘ç»œå®‰å…¨æœåŠ¡æœºæ„å¯¹ç½‘ç»œå­˜åœ¨çš„å®‰å…¨é£é™©è¿›è¡Œæ£€æµ‹è¯„ä¼°ï¼› ï¼ˆäºŒï¼‰å®šæœŸç»„ç»‡å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½çš„è¿è¥è€…è¿›è¡Œç½‘ç»œå®‰å…¨åº”æ€¥æ¼”ç»ƒï¼Œæé«˜åº”å¯¹ç½‘ç»œå®‰å…¨äº‹ä»¶çš„æ°´å¹³å’ŒååŒé…åˆèƒ½åŠ›ï¼› ï¼ˆä¸‰ï¼‰ä¿ƒè¿›æœ‰å…³éƒ¨é—¨ã€å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½çš„è¿è¥è€…ä»¥åŠæœ‰å…³ç ”ç©¶æœºæ„ã€ç½‘ç»œå®‰å…¨æœåŠ¡æœºæ„ç­‰ä¹‹é—´çš„ç½‘ç»œå®‰å…¨ä¿¡æ¯å…±äº«ï¼› ï¼ˆå››ï¼‰å¯¹ç½‘ç»œå®‰å…¨äº‹ä»¶çš„åº”æ€¥å¤„ç½®ä¸ç½‘ç»œåŠŸèƒ½çš„æ¢å¤ç­‰ï¼Œæä¾›æŠ€æœ¯æ”¯æŒå’ŒååŠ©ã€‚ ç¬¬å››ç«  ç½‘ç»œä¿¡æ¯å®‰å…¨ç¬¬å››åæ¡ ç½‘ç»œè¿è¥è€…åº”å½“å¯¹å…¶æ”¶é›†çš„ç”¨æˆ·ä¿¡æ¯ä¸¥æ ¼ä¿å¯†ï¼Œå¹¶å»ºç«‹å¥å…¨ç”¨æˆ·ä¿¡æ¯ä¿æŠ¤åˆ¶åº¦ã€‚ ç¬¬å››åä¸€æ¡ ç½‘ç»œè¿è¥è€…æ”¶é›†ã€ä½¿ç”¨ä¸ªäººä¿¡æ¯ï¼Œåº”å½“éµå¾ªåˆæ³•ã€æ­£å½“ã€å¿…è¦çš„åŸåˆ™ï¼Œå…¬å¼€æ”¶é›†ã€ä½¿ç”¨è§„åˆ™ï¼Œæ˜ç¤ºæ”¶é›†ã€ä½¿ç”¨ä¿¡æ¯çš„ç›®çš„ã€æ–¹å¼å’ŒèŒƒå›´ï¼Œå¹¶ç»è¢«æ”¶é›†è€…åŒæ„ã€‚ ç½‘ç»œè¿è¥è€…ä¸å¾—æ”¶é›†ä¸å…¶æä¾›çš„æœåŠ¡æ— å…³çš„ä¸ªäººä¿¡æ¯ï¼Œä¸å¾—è¿åæ³•å¾‹ã€è¡Œæ”¿æ³•è§„çš„è§„å®šå’ŒåŒæ–¹çš„çº¦å®šæ”¶é›†ã€ä½¿ç”¨ä¸ªäººä¿¡æ¯ï¼Œå¹¶åº”å½“ä¾ç…§æ³•å¾‹ã€è¡Œæ”¿æ³•è§„çš„è§„å®šå’Œä¸ç”¨æˆ·çš„çº¦å®šï¼Œå¤„ç†å…¶ä¿å­˜çš„ä¸ªäººä¿¡æ¯ã€‚ ç¬¬å››åäºŒæ¡ ç½‘ç»œè¿è¥è€…ä¸å¾—æ³„éœ²ã€ç¯¡æ”¹ã€æ¯æŸå…¶æ”¶é›†çš„ä¸ªäººä¿¡æ¯ï¼›æœªç»è¢«æ”¶é›†è€…åŒæ„ï¼Œä¸å¾—å‘ä»–äººæä¾›ä¸ªäººä¿¡æ¯ã€‚ä½†æ˜¯ï¼Œç»è¿‡å¤„ç†æ— æ³•è¯†åˆ«ç‰¹å®šä¸ªäººä¸”ä¸èƒ½å¤åŸçš„é™¤å¤–ã€‚ ç½‘ç»œè¿è¥è€…åº”å½“é‡‡å–æŠ€æœ¯æªæ–½å’Œå…¶ä»–å¿…è¦æªæ–½ï¼Œç¡®ä¿å…¶æ”¶é›†çš„ä¸ªäººä¿¡æ¯å®‰å…¨ï¼Œé˜²æ­¢ä¿¡æ¯æ³„éœ²ã€æ¯æŸã€ä¸¢å¤±ã€‚åœ¨å‘ç”Ÿæˆ–è€…å¯èƒ½å‘ç”Ÿä¸ªäººä¿¡æ¯æ³„éœ²ã€æ¯æŸã€ä¸¢å¤±çš„æƒ…å†µæ—¶ï¼Œåº”å½“ç«‹å³é‡‡å–è¡¥æ•‘æªæ–½ï¼ŒæŒ‰ç…§è§„å®šåŠæ—¶å‘ŠçŸ¥ç”¨æˆ·å¹¶å‘æœ‰å…³ä¸»ç®¡éƒ¨é—¨æŠ¥å‘Šã€‚ ç¬¬å››åä¸‰æ¡ ä¸ªäººå‘ç°ç½‘ç»œè¿è¥è€…è¿åæ³•å¾‹ã€è¡Œæ”¿æ³•è§„çš„è§„å®šæˆ–è€…åŒæ–¹çš„çº¦å®šæ”¶é›†ã€ä½¿ç”¨å…¶ä¸ªäººä¿¡æ¯çš„ï¼Œæœ‰æƒè¦æ±‚ç½‘ç»œè¿è¥è€…åˆ é™¤å…¶ä¸ªäººä¿¡æ¯ï¼›å‘ç°ç½‘ç»œè¿è¥è€…æ”¶é›†ã€å­˜å‚¨çš„å…¶ä¸ªäººä¿¡æ¯æœ‰é”™è¯¯çš„ï¼Œæœ‰æƒè¦æ±‚ç½‘ç»œè¿è¥è€…äºˆä»¥æ›´æ­£ã€‚ç½‘ç»œè¿è¥è€…åº”å½“é‡‡å–æªæ–½äºˆä»¥åˆ é™¤æˆ–è€…æ›´æ­£ã€‚ ç¬¬å››åå››æ¡ ä»»ä½•ä¸ªäººå’Œç»„ç»‡ä¸å¾—çªƒå–æˆ–è€…ä»¥å…¶ä»–éæ³•æ–¹å¼è·å–ä¸ªäººä¿¡æ¯ï¼Œä¸å¾—éæ³•å‡ºå”®æˆ–è€…éæ³•å‘ä»–äººæä¾›ä¸ªäººä¿¡æ¯ã€‚ ç¬¬å››åäº”æ¡ ä¾æ³•è´Ÿæœ‰ç½‘ç»œå®‰å…¨ç›‘ç£ç®¡ç†èŒè´£çš„éƒ¨é—¨åŠå…¶å·¥ä½œäººå‘˜ï¼Œå¿…é¡»å¯¹åœ¨å±¥è¡ŒèŒè´£ä¸­çŸ¥æ‚‰çš„ä¸ªäººä¿¡æ¯ã€éšç§å’Œå•†ä¸šç§˜å¯†ä¸¥æ ¼ä¿å¯†ï¼Œä¸å¾—æ³„éœ²ã€å‡ºå”®æˆ–è€…éæ³•å‘ä»–äººæä¾›ã€‚ ç¬¬å››åå…­æ¡ ä»»ä½•ä¸ªäººå’Œç»„ç»‡åº”å½“å¯¹å…¶ä½¿ç”¨ç½‘ç»œçš„è¡Œä¸ºè´Ÿè´£ï¼Œä¸å¾—è®¾ç«‹ç”¨äºå®æ–½è¯ˆéª—ï¼Œä¼ æˆçŠ¯ç½ªæ–¹æ³•ï¼Œåˆ¶ä½œæˆ–è€…é”€å”®è¿ç¦ç‰©å“ã€ç®¡åˆ¶ç‰©å“ç­‰è¿æ³•çŠ¯ç½ªæ´»åŠ¨çš„ç½‘ç«™ã€é€šè®¯ç¾¤ç»„ï¼Œä¸å¾—åˆ©ç”¨ç½‘ç»œå‘å¸ƒæ¶‰åŠå®æ–½è¯ˆéª—ï¼Œåˆ¶ä½œæˆ–è€…é”€å”®è¿ç¦ç‰©å“ã€ç®¡åˆ¶ç‰©å“ä»¥åŠå…¶ä»–è¿æ³•çŠ¯ç½ªæ´»åŠ¨çš„ä¿¡æ¯ã€‚ ç¬¬å››åä¸ƒæ¡ ç½‘ç»œè¿è¥è€…åº”å½“åŠ å¼ºå¯¹å…¶ç”¨æˆ·å‘å¸ƒçš„ä¿¡æ¯çš„ç®¡ç†ï¼Œå‘ç°æ³•å¾‹ã€è¡Œæ”¿æ³•è§„ç¦æ­¢å‘å¸ƒæˆ–è€…ä¼ è¾“çš„ä¿¡æ¯çš„ï¼Œåº”å½“ç«‹å³åœæ­¢ä¼ è¾“è¯¥ä¿¡æ¯ï¼Œé‡‡å–æ¶ˆé™¤ç­‰å¤„ç½®æªæ–½ï¼Œé˜²æ­¢ä¿¡æ¯æ‰©æ•£ï¼Œä¿å­˜æœ‰å…³è®°å½•ï¼Œå¹¶å‘æœ‰å…³ä¸»ç®¡éƒ¨é—¨æŠ¥å‘Šã€‚ ç¬¬å››åå…«æ¡ ä»»ä½•ä¸ªäººå’Œç»„ç»‡å‘é€çš„ç”µå­ä¿¡æ¯ã€æä¾›çš„åº”ç”¨è½¯ä»¶ï¼Œä¸å¾—è®¾ç½®æ¶æ„ç¨‹åºï¼Œä¸å¾—å«æœ‰æ³•å¾‹ã€è¡Œæ”¿æ³•è§„ç¦æ­¢å‘å¸ƒæˆ–è€…ä¼ è¾“çš„ä¿¡æ¯ã€‚ ç”µå­ä¿¡æ¯å‘é€æœåŠ¡æä¾›è€…å’Œåº”ç”¨è½¯ä»¶ä¸‹è½½æœåŠ¡æä¾›è€…ï¼Œåº”å½“å±¥è¡Œå®‰å…¨ç®¡ç†ä¹‰åŠ¡ï¼ŒçŸ¥é“å…¶ç”¨æˆ·æœ‰å‰æ¬¾è§„å®šè¡Œä¸ºçš„ï¼Œåº”å½“åœæ­¢æä¾›æœåŠ¡ï¼Œé‡‡å–æ¶ˆé™¤ç­‰å¤„ç½®æªæ–½ï¼Œä¿å­˜æœ‰å…³è®°å½•ï¼Œå¹¶å‘æœ‰å…³ä¸»ç®¡éƒ¨é—¨æŠ¥å‘Šã€‚ ç¬¬å››åä¹æ¡ ç½‘ç»œè¿è¥è€…åº”å½“å»ºç«‹ç½‘ç»œä¿¡æ¯å®‰å…¨æŠ•è¯‰ã€ä¸¾æŠ¥åˆ¶åº¦ï¼Œå…¬å¸ƒæŠ•è¯‰ã€ä¸¾æŠ¥æ–¹å¼ç­‰ä¿¡æ¯ï¼ŒåŠæ—¶å—ç†å¹¶å¤„ç†æœ‰å…³ç½‘ç»œä¿¡æ¯å®‰å…¨çš„æŠ•è¯‰å’Œä¸¾æŠ¥ã€‚ ç½‘ç»œè¿è¥è€…å¯¹ç½‘ä¿¡éƒ¨é—¨å’Œæœ‰å…³éƒ¨é—¨ä¾æ³•å®æ–½çš„ç›‘ç£æ£€æŸ¥ï¼Œåº”å½“äºˆä»¥é…åˆã€‚ ç¬¬äº”åæ¡ å›½å®¶ç½‘ä¿¡éƒ¨é—¨å’Œæœ‰å…³éƒ¨é—¨ä¾æ³•å±¥è¡Œç½‘ç»œä¿¡æ¯å®‰å…¨ç›‘ç£ç®¡ç†èŒè´£ï¼Œå‘ç°æ³•å¾‹ã€è¡Œæ”¿æ³•è§„ç¦æ­¢å‘å¸ƒæˆ–è€…ä¼ è¾“çš„ä¿¡æ¯çš„ï¼Œåº”å½“è¦æ±‚ç½‘ç»œè¿è¥è€…åœæ­¢ä¼ è¾“ï¼Œé‡‡å–æ¶ˆé™¤ç­‰å¤„ç½®æªæ–½ï¼Œä¿å­˜æœ‰å…³è®°å½•ï¼›å¯¹æ¥æºäºä¸­åäººæ°‘å…±å’Œå›½å¢ƒå¤–çš„ä¸Šè¿°ä¿¡æ¯ï¼Œåº”å½“é€šçŸ¥æœ‰å…³æœºæ„é‡‡å–æŠ€æœ¯æªæ–½å’Œå…¶ä»–å¿…è¦æªæ–½é˜»æ–­ä¼ æ’­ã€‚ ç¬¬äº”ç«  ç›‘æµ‹é¢„è­¦ä¸åº”æ€¥å¤„ç½®ç¬¬äº”åä¸€æ¡ å›½å®¶å»ºç«‹ç½‘ç»œå®‰å…¨ç›‘æµ‹é¢„è­¦å’Œä¿¡æ¯é€šæŠ¥åˆ¶åº¦ã€‚å›½å®¶ç½‘ä¿¡éƒ¨é—¨åº”å½“ç»Ÿç­¹åè°ƒæœ‰å…³éƒ¨é—¨åŠ å¼ºç½‘ç»œå®‰å…¨ä¿¡æ¯æ”¶é›†ã€åˆ†æå’Œé€šæŠ¥å·¥ä½œï¼ŒæŒ‰ç…§è§„å®šç»Ÿä¸€å‘å¸ƒç½‘ç»œå®‰å…¨ç›‘æµ‹é¢„è­¦ä¿¡æ¯ã€‚ ç¬¬äº”åäºŒæ¡ è´Ÿè´£å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½å®‰å…¨ä¿æŠ¤å·¥ä½œçš„éƒ¨é—¨ï¼Œåº”å½“å»ºç«‹å¥å…¨æœ¬è¡Œä¸šã€æœ¬é¢†åŸŸçš„ç½‘ç»œå®‰å…¨ç›‘æµ‹é¢„è­¦å’Œä¿¡æ¯é€šæŠ¥åˆ¶åº¦ï¼Œå¹¶æŒ‰ç…§è§„å®šæŠ¥é€ç½‘ç»œå®‰å…¨ç›‘æµ‹é¢„è­¦ä¿¡æ¯ã€‚ ç¬¬äº”åä¸‰æ¡ å›½å®¶ç½‘ä¿¡éƒ¨é—¨åè°ƒæœ‰å…³éƒ¨é—¨å»ºç«‹å¥å…¨ç½‘ç»œå®‰å…¨é£é™©è¯„ä¼°å’Œåº”æ€¥å·¥ä½œæœºåˆ¶ï¼Œåˆ¶å®šç½‘ç»œå®‰å…¨äº‹ä»¶åº”æ€¥é¢„æ¡ˆï¼Œå¹¶å®šæœŸç»„ç»‡æ¼”ç»ƒã€‚ è´Ÿè´£å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½å®‰å…¨ä¿æŠ¤å·¥ä½œçš„éƒ¨é—¨åº”å½“åˆ¶å®šæœ¬è¡Œä¸šã€æœ¬é¢†åŸŸçš„ç½‘ç»œå®‰å…¨äº‹ä»¶åº”æ€¥é¢„æ¡ˆï¼Œå¹¶å®šæœŸç»„ç»‡æ¼”ç»ƒã€‚ ç½‘ç»œå®‰å…¨äº‹ä»¶åº”æ€¥é¢„æ¡ˆåº”å½“æŒ‰ç…§äº‹ä»¶å‘ç”Ÿåçš„å±å®³ç¨‹åº¦ã€å½±å“èŒƒå›´ç­‰å› ç´ å¯¹ç½‘ç»œå®‰å…¨äº‹ä»¶è¿›è¡Œåˆ†çº§ï¼Œå¹¶è§„å®šç›¸åº”çš„åº”æ€¥å¤„ç½®æªæ–½ã€‚ ç¬¬äº”åå››æ¡ ç½‘ç»œå®‰å…¨äº‹ä»¶å‘ç”Ÿçš„é£é™©å¢å¤§æ—¶ï¼Œçœçº§ä»¥ä¸Šäººæ°‘æ”¿åºœæœ‰å…³éƒ¨é—¨åº”å½“æŒ‰ç…§è§„å®šçš„æƒé™å’Œç¨‹åºï¼Œå¹¶æ ¹æ®ç½‘ç»œå®‰å…¨é£é™©çš„ç‰¹ç‚¹å’Œå¯èƒ½é€ æˆçš„å±å®³ï¼Œé‡‡å–ä¸‹åˆ—æªæ–½ï¼š ï¼ˆä¸€ï¼‰è¦æ±‚æœ‰å…³éƒ¨é—¨ã€æœºæ„å’Œäººå‘˜åŠæ—¶æ”¶é›†ã€æŠ¥å‘Šæœ‰å…³ä¿¡æ¯ï¼ŒåŠ å¼ºå¯¹ç½‘ç»œå®‰å…¨é£é™©çš„ç›‘æµ‹ï¼› ï¼ˆäºŒï¼‰ç»„ç»‡æœ‰å…³éƒ¨é—¨ã€æœºæ„å’Œä¸“ä¸šäººå‘˜ï¼Œå¯¹ç½‘ç»œå®‰å…¨é£é™©ä¿¡æ¯è¿›è¡Œåˆ†æè¯„ä¼°ï¼Œé¢„æµ‹äº‹ä»¶å‘ç”Ÿçš„å¯èƒ½æ€§ã€å½±å“èŒƒå›´å’Œå±å®³ç¨‹åº¦ï¼› ï¼ˆä¸‰ï¼‰å‘ç¤¾ä¼šå‘å¸ƒç½‘ç»œå®‰å…¨é£é™©é¢„è­¦ï¼Œå‘å¸ƒé¿å…ã€å‡è½»å±å®³çš„æªæ–½ã€‚ ç¬¬äº”åäº”æ¡ å‘ç”Ÿç½‘ç»œå®‰å…¨äº‹ä»¶ï¼Œåº”å½“ç«‹å³å¯åŠ¨ç½‘ç»œå®‰å…¨äº‹ä»¶åº”æ€¥é¢„æ¡ˆï¼Œå¯¹ç½‘ç»œå®‰å…¨äº‹ä»¶è¿›è¡Œè°ƒæŸ¥å’Œè¯„ä¼°ï¼Œè¦æ±‚ç½‘ç»œè¿è¥è€…é‡‡å–æŠ€æœ¯æªæ–½å’Œå…¶ä»–å¿…è¦æªæ–½ï¼Œæ¶ˆé™¤å®‰å…¨éšæ‚£ï¼Œé˜²æ­¢å±å®³æ‰©å¤§ï¼Œå¹¶åŠæ—¶å‘ç¤¾ä¼šå‘å¸ƒä¸å…¬ä¼—æœ‰å…³çš„è­¦ç¤ºä¿¡æ¯ã€‚ ç¬¬äº”åå…­æ¡ çœçº§ä»¥ä¸Šäººæ°‘æ”¿åºœæœ‰å…³éƒ¨é—¨åœ¨å±¥è¡Œç½‘ç»œå®‰å…¨ç›‘ç£ç®¡ç†èŒè´£ä¸­ï¼Œå‘ç°ç½‘ç»œå­˜åœ¨è¾ƒå¤§å®‰å…¨é£é™©æˆ–è€…å‘ç”Ÿå®‰å…¨äº‹ä»¶çš„ï¼Œå¯ä»¥æŒ‰ç…§è§„å®šçš„æƒé™å’Œç¨‹åºå¯¹è¯¥ç½‘ç»œçš„è¿è¥è€…çš„æ³•å®šä»£è¡¨äººæˆ–è€…ä¸»è¦è´Ÿè´£äººè¿›è¡Œçº¦è°ˆã€‚ç½‘ç»œè¿è¥è€…åº”å½“æŒ‰ç…§è¦æ±‚é‡‡å–æªæ–½ï¼Œè¿›è¡Œæ•´æ”¹ï¼Œæ¶ˆé™¤éšæ‚£ã€‚ ç¬¬äº”åä¸ƒæ¡ å› ç½‘ç»œå®‰å…¨äº‹ä»¶ï¼Œå‘ç”Ÿçªå‘äº‹ä»¶æˆ–è€…ç”Ÿäº§å®‰å…¨äº‹æ•…çš„ï¼Œåº”å½“ä¾ç…§ã€Šä¸­åäººæ°‘å…±å’Œå›½çªå‘äº‹ä»¶åº”å¯¹æ³•ã€‹ã€ã€Šä¸­åäººæ°‘å…±å’Œå›½å®‰å…¨ç”Ÿäº§æ³•ã€‹ç­‰æœ‰å…³æ³•å¾‹ã€è¡Œæ”¿æ³•è§„çš„è§„å®šå¤„ç½®ã€‚ ç¬¬äº”åå…«æ¡ å› ç»´æŠ¤å›½å®¶å®‰å…¨å’Œç¤¾ä¼šå…¬å…±ç§©åºï¼Œå¤„ç½®é‡å¤§çªå‘ç¤¾ä¼šå®‰å…¨äº‹ä»¶çš„éœ€è¦ï¼Œç»å›½åŠ¡é™¢å†³å®šæˆ–è€…æ‰¹å‡†ï¼Œå¯ä»¥åœ¨ç‰¹å®šåŒºåŸŸå¯¹ç½‘ç»œé€šä¿¡é‡‡å–é™åˆ¶ç­‰ä¸´æ—¶æªæ–½ã€‚ ç¬¬å…­ç«  æ³•å¾‹è´£ä»»ç¬¬äº”åä¹æ¡ ç½‘ç»œè¿è¥è€…ä¸å±¥è¡Œæœ¬æ³•ç¬¬äºŒåä¸€æ¡ã€ç¬¬äºŒåäº”æ¡è§„å®šçš„ç½‘ç»œå®‰å…¨ä¿æŠ¤ä¹‰åŠ¡çš„ï¼Œç”±æœ‰å…³ä¸»ç®¡éƒ¨é—¨è´£ä»¤æ”¹æ­£ï¼Œç»™äºˆè­¦å‘Šï¼›æ‹’ä¸æ”¹æ­£æˆ–è€…å¯¼è‡´å±å®³ç½‘ç»œå®‰å…¨ç­‰åæœçš„ï¼Œå¤„ä¸€ä¸‡å…ƒä»¥ä¸Šåä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ï¼Œå¯¹ç›´æ¥è´Ÿè´£çš„ä¸»ç®¡äººå‘˜å¤„äº”åƒå…ƒä»¥ä¸Šäº”ä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ã€‚ å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½çš„è¿è¥è€…ä¸å±¥è¡Œæœ¬æ³•ç¬¬ä¸‰åä¸‰æ¡ã€ç¬¬ä¸‰åå››æ¡ã€ç¬¬ä¸‰åå…­æ¡ã€ç¬¬ä¸‰åå…«æ¡è§„å®šçš„ç½‘ç»œå®‰å…¨ä¿æŠ¤ä¹‰åŠ¡çš„ï¼Œç”±æœ‰å…³ä¸»ç®¡éƒ¨é—¨è´£ä»¤æ”¹æ­£ï¼Œç»™äºˆè­¦å‘Šï¼›æ‹’ä¸æ”¹æ­£æˆ–è€…å¯¼è‡´å±å®³ç½‘ç»œå®‰å…¨ç­‰åæœçš„ï¼Œå¤„åä¸‡å…ƒä»¥ä¸Šä¸€ç™¾ä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ï¼Œå¯¹ç›´æ¥è´Ÿè´£çš„ä¸»ç®¡äººå‘˜å¤„ä¸€ä¸‡å…ƒä»¥ä¸Šåä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ã€‚ ç¬¬å…­åæ¡ è¿åæœ¬æ³•ç¬¬äºŒåäºŒæ¡ç¬¬ä¸€æ¬¾ã€ç¬¬äºŒæ¬¾å’Œç¬¬å››åå…«æ¡ç¬¬ä¸€æ¬¾è§„å®šï¼Œæœ‰ä¸‹åˆ—è¡Œä¸ºä¹‹ä¸€çš„ï¼Œç”±æœ‰å…³ä¸»ç®¡éƒ¨é—¨è´£ä»¤æ”¹æ­£ï¼Œç»™äºˆè­¦å‘Šï¼›æ‹’ä¸æ”¹æ­£æˆ–è€…å¯¼è‡´å±å®³ç½‘ç»œå®‰å…¨ç­‰åæœçš„ï¼Œå¤„äº”ä¸‡å…ƒä»¥ä¸Šäº”åä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ï¼Œå¯¹ç›´æ¥è´Ÿè´£çš„ä¸»ç®¡äººå‘˜å¤„ä¸€ä¸‡å…ƒä»¥ä¸Šåä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ï¼š ï¼ˆä¸€ï¼‰è®¾ç½®æ¶æ„ç¨‹åºçš„ï¼› ï¼ˆäºŒï¼‰å¯¹å…¶äº§å“ã€æœåŠ¡å­˜åœ¨çš„å®‰å…¨ç¼ºé™·ã€æ¼æ´ç­‰é£é™©æœªç«‹å³é‡‡å–è¡¥æ•‘æªæ–½ï¼Œæˆ–è€…æœªæŒ‰ç…§è§„å®šåŠæ—¶å‘ŠçŸ¥ç”¨æˆ·å¹¶å‘æœ‰å…³ä¸»ç®¡éƒ¨é—¨æŠ¥å‘Šçš„ï¼› ï¼ˆä¸‰ï¼‰æ“…è‡ªç»ˆæ­¢ä¸ºå…¶äº§å“ã€æœåŠ¡æä¾›å®‰å…¨ç»´æŠ¤çš„ã€‚ ç¬¬å…­åä¸€æ¡ ç½‘ç»œè¿è¥è€…è¿åæœ¬æ³•ç¬¬äºŒåå››æ¡ç¬¬ä¸€æ¬¾è§„å®šï¼Œæœªè¦æ±‚ç”¨æˆ·æä¾›çœŸå®èº«ä»½ä¿¡æ¯ï¼Œæˆ–è€…å¯¹ä¸æä¾›çœŸå®èº«ä»½ä¿¡æ¯çš„ç”¨æˆ·æä¾›ç›¸å…³æœåŠ¡çš„ï¼Œç”±æœ‰å…³ä¸»ç®¡éƒ¨é—¨è´£ä»¤æ”¹æ­£ï¼›æ‹’ä¸æ”¹æ­£æˆ–è€…æƒ…èŠ‚ä¸¥é‡çš„ï¼Œå¤„äº”ä¸‡å…ƒä»¥ä¸Šäº”åä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ï¼Œå¹¶å¯ä»¥ç”±æœ‰å…³ä¸»ç®¡éƒ¨é—¨è´£ä»¤æš‚åœç›¸å…³ä¸šåŠ¡ã€åœä¸šæ•´é¡¿ã€å…³é—­ç½‘ç«™ã€åŠé”€ç›¸å…³ä¸šåŠ¡è®¸å¯è¯æˆ–è€…åŠé”€è¥ä¸šæ‰§ç…§ï¼Œå¯¹ç›´æ¥è´Ÿè´£çš„ä¸»ç®¡äººå‘˜å’Œå…¶ä»–ç›´æ¥è´£ä»»äººå‘˜å¤„ä¸€ä¸‡å…ƒä»¥ä¸Šåä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ã€‚ ç¬¬å…­åäºŒæ¡ è¿åæœ¬æ³•ç¬¬äºŒåå…­æ¡è§„å®šï¼Œå¼€å±•ç½‘ç»œå®‰å…¨è®¤è¯ã€æ£€æµ‹ã€é£é™©è¯„ä¼°ç­‰æ´»åŠ¨ï¼Œæˆ–è€…å‘ç¤¾ä¼šå‘å¸ƒç³»ç»Ÿæ¼æ´ã€è®¡ç®—æœºç—…æ¯’ã€ç½‘ç»œæ”»å‡»ã€ç½‘ç»œä¾µå…¥ç­‰ç½‘ç»œå®‰å…¨ä¿¡æ¯çš„ï¼Œç”±æœ‰å…³ä¸»ç®¡éƒ¨é—¨è´£ä»¤æ”¹æ­£ï¼Œç»™äºˆè­¦å‘Šï¼›æ‹’ä¸æ”¹æ­£æˆ–è€…æƒ…èŠ‚ä¸¥é‡çš„ï¼Œå¤„ä¸€ä¸‡å…ƒä»¥ä¸Šåä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ï¼Œå¹¶å¯ä»¥ç”±æœ‰å…³ä¸»ç®¡éƒ¨é—¨è´£ä»¤æš‚åœç›¸å…³ä¸šåŠ¡ã€åœä¸šæ•´é¡¿ã€å…³é—­ç½‘ç«™ã€åŠé”€ç›¸å…³ä¸šåŠ¡è®¸å¯è¯æˆ–è€…åŠé”€è¥ä¸šæ‰§ç…§ï¼Œå¯¹ç›´æ¥è´Ÿè´£çš„ä¸»ç®¡äººå‘˜å’Œå…¶ä»–ç›´æ¥è´£ä»»äººå‘˜å¤„äº”åƒå…ƒä»¥ä¸Šäº”ä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ã€‚ ç¬¬å…­åä¸‰æ¡ è¿åæœ¬æ³•ç¬¬äºŒåä¸ƒæ¡è§„å®šï¼Œä»äº‹å±å®³ç½‘ç»œå®‰å…¨çš„æ´»åŠ¨ï¼Œæˆ–è€…æä¾›ä¸“é—¨ç”¨äºä»äº‹å±å®³ç½‘ç»œå®‰å…¨æ´»åŠ¨çš„ç¨‹åºã€å·¥å…·ï¼Œæˆ–è€…ä¸ºä»–äººä»äº‹å±å®³ç½‘ç»œå®‰å…¨çš„æ´»åŠ¨æä¾›æŠ€æœ¯æ”¯æŒã€å¹¿å‘Šæ¨å¹¿ã€æ”¯ä»˜ç»“ç®—ç­‰å¸®åŠ©ï¼Œå°šä¸æ„æˆçŠ¯ç½ªçš„ï¼Œç”±å…¬å®‰æœºå…³æ²¡æ”¶è¿æ³•æ‰€å¾—ï¼Œå¤„äº”æ—¥ä»¥ä¸‹æ‹˜ç•™ï¼Œå¯ä»¥å¹¶å¤„äº”ä¸‡å…ƒä»¥ä¸Šäº”åä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ï¼›æƒ…èŠ‚è¾ƒé‡çš„ï¼Œå¤„äº”æ—¥ä»¥ä¸Šåäº”æ—¥ä»¥ä¸‹æ‹˜ç•™ï¼Œå¯ä»¥å¹¶å¤„åä¸‡å…ƒä»¥ä¸Šä¸€ç™¾ä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ã€‚ å•ä½æœ‰å‰æ¬¾è¡Œä¸ºçš„ï¼Œç”±å…¬å®‰æœºå…³æ²¡æ”¶è¿æ³•æ‰€å¾—ï¼Œå¤„åä¸‡å…ƒä»¥ä¸Šä¸€ç™¾ä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ï¼Œå¹¶å¯¹ç›´æ¥è´Ÿè´£çš„ä¸»ç®¡äººå‘˜å’Œå…¶ä»–ç›´æ¥è´£ä»»äººå‘˜ä¾ç…§å‰æ¬¾è§„å®šå¤„ç½šã€‚ è¿åæœ¬æ³•ç¬¬äºŒåä¸ƒæ¡è§„å®šï¼Œå—åˆ°æ²»å®‰ç®¡ç†å¤„ç½šçš„äººå‘˜ï¼Œäº”å¹´å†…ä¸å¾—ä»äº‹ç½‘ç»œå®‰å…¨ç®¡ç†å’Œç½‘ç»œè¿è¥å…³é”®å²—ä½çš„å·¥ä½œï¼›å—åˆ°åˆ‘äº‹å¤„ç½šçš„äººå‘˜ï¼Œç»ˆèº«ä¸å¾—ä»äº‹ç½‘ç»œå®‰å…¨ç®¡ç†å’Œç½‘ç»œè¿è¥å…³é”®å²—ä½çš„å·¥ä½œã€‚ ç¬¬å…­åå››æ¡ ç½‘ç»œè¿è¥è€…ã€ç½‘ç»œäº§å“æˆ–è€…æœåŠ¡çš„æä¾›è€…è¿åæœ¬æ³•ç¬¬äºŒåäºŒæ¡ç¬¬ä¸‰æ¬¾ã€ç¬¬å››åä¸€æ¡è‡³ç¬¬å››åä¸‰æ¡è§„å®šï¼Œä¾µå®³ä¸ªäººä¿¡æ¯ä¾æ³•å¾—åˆ°ä¿æŠ¤çš„æƒåˆ©çš„ï¼Œç”±æœ‰å…³ä¸»ç®¡éƒ¨é—¨è´£ä»¤æ”¹æ­£ï¼Œå¯ä»¥æ ¹æ®æƒ…èŠ‚å•å¤„æˆ–è€…å¹¶å¤„è­¦å‘Šã€æ²¡æ”¶è¿æ³•æ‰€å¾—ã€å¤„è¿æ³•æ‰€å¾—ä¸€å€ä»¥ä¸Šåå€ä»¥ä¸‹ç½šæ¬¾ï¼Œæ²¡æœ‰è¿æ³•æ‰€å¾—çš„ï¼Œå¤„ä¸€ç™¾ä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ï¼Œå¯¹ç›´æ¥è´Ÿè´£çš„ä¸»ç®¡äººå‘˜å’Œå…¶ä»–ç›´æ¥è´£ä»»äººå‘˜å¤„ä¸€ä¸‡å…ƒä»¥ä¸Šåä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ï¼›æƒ…èŠ‚ä¸¥é‡çš„ï¼Œå¹¶å¯ä»¥è´£ä»¤æš‚åœç›¸å…³ä¸šåŠ¡ã€åœä¸šæ•´é¡¿ã€å…³é—­ç½‘ç«™ã€åŠé”€ç›¸å…³ä¸šåŠ¡è®¸å¯è¯æˆ–è€…åŠé”€è¥ä¸šæ‰§ç…§ã€‚ è¿åæœ¬æ³•ç¬¬å››åå››æ¡è§„å®šï¼Œçªƒå–æˆ–è€…ä»¥å…¶ä»–éæ³•æ–¹å¼è·å–ã€éæ³•å‡ºå”®æˆ–è€…éæ³•å‘ä»–äººæä¾›ä¸ªäººä¿¡æ¯ï¼Œå°šä¸æ„æˆçŠ¯ç½ªçš„ï¼Œç”±å…¬å®‰æœºå…³æ²¡æ”¶è¿æ³•æ‰€å¾—ï¼Œå¹¶å¤„è¿æ³•æ‰€å¾—ä¸€å€ä»¥ä¸Šåå€ä»¥ä¸‹ç½šæ¬¾ï¼Œæ²¡æœ‰è¿æ³•æ‰€å¾—çš„ï¼Œå¤„ä¸€ç™¾ä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ã€‚ ç¬¬å…­åäº”æ¡ å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½çš„è¿è¥è€…è¿åæœ¬æ³•ç¬¬ä¸‰åäº”æ¡è§„å®šï¼Œä½¿ç”¨æœªç»å®‰å…¨å®¡æŸ¥æˆ–è€…å®‰å…¨å®¡æŸ¥æœªé€šè¿‡çš„ç½‘ç»œäº§å“æˆ–è€…æœåŠ¡çš„ï¼Œç”±æœ‰å…³ä¸»ç®¡éƒ¨é—¨è´£ä»¤åœæ­¢ä½¿ç”¨ï¼Œå¤„é‡‡è´­é‡‘é¢ä¸€å€ä»¥ä¸Šåå€ä»¥ä¸‹ç½šæ¬¾ï¼›å¯¹ç›´æ¥è´Ÿè´£çš„ä¸»ç®¡äººå‘˜å’Œå…¶ä»–ç›´æ¥è´£ä»»äººå‘˜å¤„ä¸€ä¸‡å…ƒä»¥ä¸Šåä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ã€‚ ç¬¬å…­åå…­æ¡ å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½çš„è¿è¥è€…è¿åæœ¬æ³•ç¬¬ä¸‰åä¸ƒæ¡è§„å®šï¼Œåœ¨å¢ƒå¤–å­˜å‚¨ç½‘ç»œæ•°æ®ï¼Œæˆ–è€…å‘å¢ƒå¤–æä¾›ç½‘ç»œæ•°æ®çš„ï¼Œç”±æœ‰å…³ä¸»ç®¡éƒ¨é—¨è´£ä»¤æ”¹æ­£ï¼Œç»™äºˆè­¦å‘Šï¼Œæ²¡æ”¶è¿æ³•æ‰€å¾—ï¼Œå¤„äº”ä¸‡å…ƒä»¥ä¸Šäº”åä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ï¼Œå¹¶å¯ä»¥è´£ä»¤æš‚åœç›¸å…³ä¸šåŠ¡ã€åœä¸šæ•´é¡¿ã€å…³é—­ç½‘ç«™ã€åŠé”€ç›¸å…³ä¸šåŠ¡è®¸å¯è¯æˆ–è€…åŠé”€è¥ä¸šæ‰§ç…§ï¼›å¯¹ç›´æ¥è´Ÿè´£çš„ä¸»ç®¡äººå‘˜å’Œå…¶ä»–ç›´æ¥è´£ä»»äººå‘˜å¤„ä¸€ä¸‡å…ƒä»¥ä¸Šåä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ã€‚ ç¬¬å…­åä¸ƒæ¡ è¿åæœ¬æ³•ç¬¬å››åå…­æ¡è§„å®šï¼Œè®¾ç«‹ç”¨äºå®æ–½è¿æ³•çŠ¯ç½ªæ´»åŠ¨çš„ç½‘ç«™ã€é€šè®¯ç¾¤ç»„ï¼Œæˆ–è€…åˆ©ç”¨ç½‘ç»œå‘å¸ƒæ¶‰åŠå®æ–½è¿æ³•çŠ¯ç½ªæ´»åŠ¨çš„ä¿¡æ¯ï¼Œå°šä¸æ„æˆçŠ¯ç½ªçš„ï¼Œç”±å…¬å®‰æœºå…³å¤„äº”æ—¥ä»¥ä¸‹æ‹˜ç•™ï¼Œå¯ä»¥å¹¶å¤„ä¸€ä¸‡å…ƒä»¥ä¸Šåä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ï¼›æƒ…èŠ‚è¾ƒé‡çš„ï¼Œå¤„äº”æ—¥ä»¥ä¸Šåäº”æ—¥ä»¥ä¸‹æ‹˜ç•™ï¼Œå¯ä»¥å¹¶å¤„äº”ä¸‡å…ƒä»¥ä¸Šäº”åä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ã€‚å…³é—­ç”¨äºå®æ–½è¿æ³•çŠ¯ç½ªæ´»åŠ¨çš„ç½‘ç«™ã€é€šè®¯ç¾¤ç»„ã€‚ å•ä½æœ‰å‰æ¬¾è¡Œä¸ºçš„ï¼Œç”±å…¬å®‰æœºå…³å¤„åä¸‡å…ƒä»¥ä¸Šäº”åä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ï¼Œå¹¶å¯¹ç›´æ¥è´Ÿè´£çš„ä¸»ç®¡äººå‘˜å’Œå…¶ä»–ç›´æ¥è´£ä»»äººå‘˜ä¾ç…§å‰æ¬¾è§„å®šå¤„ç½šã€‚ ç¬¬å…­åå…«æ¡ ç½‘ç»œè¿è¥è€…è¿åæœ¬æ³•ç¬¬å››åä¸ƒæ¡è§„å®šï¼Œå¯¹æ³•å¾‹ã€è¡Œæ”¿æ³•è§„ç¦æ­¢å‘å¸ƒæˆ–è€…ä¼ è¾“çš„ä¿¡æ¯æœªåœæ­¢ä¼ è¾“ã€é‡‡å–æ¶ˆé™¤ç­‰å¤„ç½®æªæ–½ã€ä¿å­˜æœ‰å…³è®°å½•çš„ï¼Œç”±æœ‰å…³ä¸»ç®¡éƒ¨é—¨è´£ä»¤æ”¹æ­£ï¼Œç»™äºˆè­¦å‘Šï¼Œæ²¡æ”¶è¿æ³•æ‰€å¾—ï¼›æ‹’ä¸æ”¹æ­£æˆ–è€…æƒ…èŠ‚ä¸¥é‡çš„ï¼Œå¤„åä¸‡å…ƒä»¥ä¸Šäº”åä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ï¼Œå¹¶å¯ä»¥è´£ä»¤æš‚åœç›¸å…³ä¸šåŠ¡ã€åœä¸šæ•´é¡¿ã€å…³é—­ç½‘ç«™ã€åŠé”€ç›¸å…³ä¸šåŠ¡è®¸å¯è¯æˆ–è€…åŠé”€è¥ä¸šæ‰§ç…§ï¼Œå¯¹ç›´æ¥è´Ÿè´£çš„ä¸»ç®¡äººå‘˜å’Œå…¶ä»–ç›´æ¥è´£ä»»äººå‘˜å¤„ä¸€ä¸‡å…ƒä»¥ä¸Šåä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ã€‚ ç”µå­ä¿¡æ¯å‘é€æœåŠ¡æä¾›è€…ã€åº”ç”¨è½¯ä»¶ä¸‹è½½æœåŠ¡æä¾›è€…ï¼Œä¸å±¥è¡Œæœ¬æ³•ç¬¬å››åå…«æ¡ç¬¬äºŒæ¬¾è§„å®šçš„å®‰å…¨ç®¡ç†ä¹‰åŠ¡çš„ï¼Œä¾ç…§å‰æ¬¾è§„å®šå¤„ç½šã€‚ ç¬¬å…­åä¹æ¡ ç½‘ç»œè¿è¥è€…è¿åæœ¬æ³•è§„å®šï¼Œæœ‰ä¸‹åˆ—è¡Œä¸ºä¹‹ä¸€çš„ï¼Œç”±æœ‰å…³ä¸»ç®¡éƒ¨é—¨è´£ä»¤æ”¹æ­£ï¼›æ‹’ä¸æ”¹æ­£æˆ–è€…æƒ…èŠ‚ä¸¥é‡çš„ï¼Œå¤„äº”ä¸‡å…ƒä»¥ä¸Šäº”åä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ï¼Œå¯¹ç›´æ¥è´Ÿè´£çš„ä¸»ç®¡äººå‘˜å’Œå…¶ä»–ç›´æ¥è´£ä»»äººå‘˜ï¼Œå¤„ä¸€ä¸‡å…ƒä»¥ä¸Šåä¸‡å…ƒä»¥ä¸‹ç½šæ¬¾ï¼š ï¼ˆä¸€ï¼‰ä¸æŒ‰ç…§æœ‰å…³éƒ¨é—¨çš„è¦æ±‚å¯¹æ³•å¾‹ã€è¡Œæ”¿æ³•è§„ç¦æ­¢å‘å¸ƒæˆ–è€…ä¼ è¾“çš„ä¿¡æ¯ï¼Œé‡‡å–åœæ­¢ä¼ è¾“ã€æ¶ˆé™¤ç­‰å¤„ç½®æªæ–½çš„ï¼› ï¼ˆäºŒï¼‰æ‹’ç»ã€é˜»ç¢æœ‰å…³éƒ¨é—¨ä¾æ³•å®æ–½çš„ç›‘ç£æ£€æŸ¥çš„ï¼› ï¼ˆä¸‰ï¼‰æ‹’ä¸å‘å…¬å®‰æœºå…³ã€å›½å®¶å®‰å…¨æœºå…³æä¾›æŠ€æœ¯æ”¯æŒå’ŒååŠ©çš„ã€‚ ç¬¬ä¸ƒåæ¡ å‘å¸ƒæˆ–è€…ä¼ è¾“æœ¬æ³•ç¬¬åäºŒæ¡ç¬¬äºŒæ¬¾å’Œå…¶ä»–æ³•å¾‹ã€è¡Œæ”¿æ³•è§„ç¦æ­¢å‘å¸ƒæˆ–è€…ä¼ è¾“çš„ä¿¡æ¯çš„ï¼Œä¾ç…§æœ‰å…³æ³•å¾‹ã€è¡Œæ”¿æ³•è§„çš„è§„å®šå¤„ç½šã€‚ ç¬¬ä¸ƒåä¸€æ¡ æœ‰æœ¬æ³•è§„å®šçš„è¿æ³•è¡Œä¸ºçš„ï¼Œä¾ç…§æœ‰å…³æ³•å¾‹ã€è¡Œæ”¿æ³•è§„çš„è§„å®šè®°å…¥ä¿¡ç”¨æ¡£æ¡ˆï¼Œå¹¶äºˆä»¥å…¬ç¤ºã€‚ ç¬¬ä¸ƒåäºŒæ¡ å›½å®¶æœºå…³æ”¿åŠ¡ç½‘ç»œçš„è¿è¥è€…ä¸å±¥è¡Œæœ¬æ³•è§„å®šçš„ç½‘ç»œå®‰å…¨ä¿æŠ¤ä¹‰åŠ¡çš„ï¼Œç”±å…¶ä¸Šçº§æœºå…³æˆ–è€…æœ‰å…³æœºå…³è´£ä»¤æ”¹æ­£ï¼›å¯¹ç›´æ¥è´Ÿè´£çš„ä¸»ç®¡äººå‘˜å’Œå…¶ä»–ç›´æ¥è´£ä»»äººå‘˜ä¾æ³•ç»™äºˆå¤„åˆ†ã€‚ ç¬¬ä¸ƒåä¸‰æ¡ ç½‘ä¿¡éƒ¨é—¨å’Œæœ‰å…³éƒ¨é—¨è¿åæœ¬æ³•ç¬¬ä¸‰åæ¡è§„å®šï¼Œå°†åœ¨å±¥è¡Œç½‘ç»œå®‰å…¨ä¿æŠ¤èŒè´£ä¸­è·å–çš„ä¿¡æ¯ç”¨äºå…¶ä»–ç”¨é€”çš„ï¼Œå¯¹ç›´æ¥è´Ÿè´£çš„ä¸»ç®¡äººå‘˜å’Œå…¶ä»–ç›´æ¥è´£ä»»äººå‘˜ä¾æ³•ç»™äºˆå¤„åˆ†ã€‚ ç½‘ä¿¡éƒ¨é—¨å’Œæœ‰å…³éƒ¨é—¨çš„å·¥ä½œäººå‘˜ç©å¿½èŒå®ˆã€æ»¥ç”¨èŒæƒã€å¾‡ç§èˆå¼Šï¼Œå°šä¸æ„æˆçŠ¯ç½ªçš„ï¼Œä¾æ³•ç»™äºˆå¤„åˆ†ã€‚ ç¬¬ä¸ƒåå››æ¡ è¿åæœ¬æ³•è§„å®šï¼Œç»™ä»–äººé€ æˆæŸå®³çš„ï¼Œä¾æ³•æ‰¿æ‹…æ°‘äº‹è´£ä»»ã€‚ è¿åæœ¬æ³•è§„å®šï¼Œæ„æˆè¿åæ²»å®‰ç®¡ç†è¡Œä¸ºçš„ï¼Œä¾æ³•ç»™äºˆæ²»å®‰ç®¡ç†å¤„ç½šï¼›æ„æˆçŠ¯ç½ªçš„ï¼Œä¾æ³•è¿½ç©¶åˆ‘äº‹è´£ä»»ã€‚ ç¬¬ä¸ƒåäº”æ¡ å¢ƒå¤–çš„æœºæ„ã€ç»„ç»‡ã€ä¸ªäººä»äº‹æ”»å‡»ã€ä¾µå…¥ã€å¹²æ‰°ã€ç ´åç­‰å±å®³ä¸­åäººæ°‘å…±å’Œå›½çš„å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½çš„æ´»åŠ¨ï¼Œé€ æˆä¸¥é‡åæœçš„ï¼Œä¾æ³•è¿½ç©¶æ³•å¾‹è´£ä»»ï¼›å›½åŠ¡é™¢å…¬å®‰éƒ¨é—¨å’Œæœ‰å…³éƒ¨é—¨å¹¶å¯ä»¥å†³å®šå¯¹è¯¥æœºæ„ã€ç»„ç»‡ã€ä¸ªäººé‡‡å–å†»ç»“è´¢äº§æˆ–è€…å…¶ä»–å¿…è¦çš„åˆ¶è£æªæ–½ã€‚ ç¬¬ä¸ƒç«  é™„ åˆ™ç¬¬ä¸ƒåå…­æ¡ æœ¬æ³•ä¸‹åˆ—ç”¨è¯­çš„å«ä¹‰ï¼š ï¼ˆä¸€ï¼‰ç½‘ç»œï¼Œæ˜¯æŒ‡ç”±è®¡ç®—æœºæˆ–è€…å…¶ä»–ä¿¡æ¯ç»ˆç«¯åŠç›¸å…³è®¾å¤‡ç»„æˆçš„æŒ‰ç…§ä¸€å®šçš„è§„åˆ™å’Œç¨‹åºå¯¹ä¿¡æ¯è¿›è¡Œæ”¶é›†ã€å­˜å‚¨ã€ä¼ è¾“ã€äº¤æ¢ã€å¤„ç†çš„ç³»ç»Ÿã€‚ ï¼ˆäºŒï¼‰ç½‘ç»œå®‰å…¨ï¼Œæ˜¯æŒ‡é€šè¿‡é‡‡å–å¿…è¦æªæ–½ï¼Œé˜²èŒƒå¯¹ç½‘ç»œçš„æ”»å‡»ã€ä¾µå…¥ã€å¹²æ‰°ã€ç ´åå’Œéæ³•ä½¿ç”¨ä»¥åŠæ„å¤–äº‹æ•…ï¼Œä½¿ç½‘ç»œå¤„äºç¨³å®šå¯é è¿è¡Œçš„çŠ¶æ€ï¼Œä»¥åŠä¿éšœç½‘ç»œæ•°æ®çš„å®Œæ•´æ€§ã€ä¿å¯†æ€§ã€å¯ç”¨æ€§çš„èƒ½åŠ›ã€‚ ï¼ˆä¸‰ï¼‰ç½‘ç»œè¿è¥è€…ï¼Œæ˜¯æŒ‡ç½‘ç»œçš„æ‰€æœ‰è€…ã€ç®¡ç†è€…å’Œç½‘ç»œæœåŠ¡æä¾›è€…ã€‚ ï¼ˆå››ï¼‰ç½‘ç»œæ•°æ®ï¼Œæ˜¯æŒ‡é€šè¿‡ç½‘ç»œæ”¶é›†ã€å­˜å‚¨ã€ä¼ è¾“ã€å¤„ç†å’Œäº§ç”Ÿçš„å„ç§ç”µå­æ•°æ®ã€‚ ï¼ˆäº”ï¼‰ä¸ªäººä¿¡æ¯ï¼Œæ˜¯æŒ‡ä»¥ç”µå­æˆ–è€…å…¶ä»–æ–¹å¼è®°å½•çš„èƒ½å¤Ÿå•ç‹¬æˆ–è€…ä¸å…¶ä»–ä¿¡æ¯ç»“åˆè¯†åˆ«è‡ªç„¶äººä¸ªäººèº«ä»½çš„å„ç§ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºè‡ªç„¶äººçš„å§“åã€å‡ºç”Ÿæ—¥æœŸã€èº«ä»½è¯ä»¶å·ç ã€ä¸ªäººç”Ÿç‰©è¯†åˆ«ä¿¡æ¯ã€ä½å€ã€ç”µè¯å·ç ç­‰ã€‚ ç¬¬ä¸ƒåä¸ƒæ¡ å­˜å‚¨ã€å¤„ç†æ¶‰åŠå›½å®¶ç§˜å¯†ä¿¡æ¯çš„ç½‘ç»œçš„è¿è¡Œå®‰å…¨ä¿æŠ¤ï¼Œé™¤åº”å½“éµå®ˆæœ¬æ³•å¤–ï¼Œè¿˜åº”å½“éµå®ˆä¿å¯†æ³•å¾‹ã€è¡Œæ”¿æ³•è§„çš„è§„å®šã€‚ ç¬¬ä¸ƒåå…«æ¡ å†›äº‹ç½‘ç»œçš„å®‰å…¨ä¿æŠ¤ï¼Œç”±ä¸­å¤®å†›äº‹å§”å‘˜ä¼šå¦è¡Œè§„å®šã€‚ ç¬¬ä¸ƒåä¹æ¡ æœ¬æ³•è‡ª2017å¹´6æœˆ1æ—¥èµ·æ–½è¡Œã€‚","link":"/2019/08/08/ä¸­åäººæ°‘å…±å’Œå›½ç½‘ç»œå®‰å…¨æ³•.html"},{"title":"Javaå¹¶å‘ç›¸å…³çŸ¥è¯†ç‚¹","text":"äº’æ–¥åŒæ­¥æœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯çº¿ç¨‹é˜»å¡å’Œå”¤é†’æ‰€å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ï¼Œå› æ­¤è¿™ç§åŒæ­¥ä¹Ÿç§°ä¸ºé˜»å¡åŒæ­¥ã€‚ äº’æ–¥åŒæ­¥å±äºä¸€ç§æ‚²è§‚çš„å¹¶å‘ç­–ç•¥ï¼Œæ€»æ˜¯è®¤ä¸ºåªè¦ä¸å»åšæ­£ç¡®çš„åŒæ­¥æªæ–½ï¼Œé‚£å°±è‚¯å®šä¼šå‡ºç°é—®é¢˜ã€‚æ— è®ºå…±äº«æ•°æ®æ˜¯å¦çœŸçš„ä¼šå‡ºç°ç«äº‰ï¼Œå®ƒéƒ½è¦è¿›è¡ŒåŠ é”ï¼ˆè¿™é‡Œè®¨è®ºçš„æ˜¯æ¦‚å¿µæ¨¡å‹ï¼Œå®é™…ä¸Šè™šæ‹Ÿæœºä¼šä¼˜åŒ–æ‰å¾ˆå¤§ä¸€éƒ¨åˆ†ä¸å¿…è¦çš„åŠ é”ï¼‰ã€ç”¨æˆ·æ€æ ¸å¿ƒæ€è½¬æ¢ã€ç»´æŠ¤é”è®¡æ•°å™¨å’Œæ£€æŸ¥æ˜¯å¦æœ‰è¢«é˜»å¡çš„çº¿ç¨‹éœ€è¦å”¤é†’ç­‰æ“ä½œã€‚ å¹¶å‘é›¶ç¢çŸ¥è¯†ç‚¹ çº¿ç¨‹çŠ¶æ€è½¬æ¢ æ–°å»ºï¼ˆNewï¼‰ åˆ›å»ºåå°šæœªå¯åŠ¨ã€‚ å¯è¿è¡Œï¼ˆRunnableï¼‰ å¯èƒ½æ­£åœ¨è¿è¡Œï¼Œä¹Ÿå¯èƒ½æ­£åœ¨ç­‰å¾… CPU æ—¶é—´ç‰‡ã€‚ åŒ…å«äº†æ“ä½œç³»ç»Ÿçº¿ç¨‹çŠ¶æ€ä¸­çš„ Running å’Œ Readyã€‚ é˜»å¡ï¼ˆBlockedï¼‰ ç­‰å¾…è·å–ä¸€ä¸ªæ’å®ƒé”ï¼Œå¦‚æœå…¶çº¿ç¨‹é‡Šæ”¾äº†é”å°±ä¼šç»“æŸæ­¤çŠ¶æ€ã€‚ æ— é™æœŸç­‰å¾…ï¼ˆWaitingï¼‰ ç­‰å¾…å…¶å®ƒçº¿ç¨‹æ˜¾å¼åœ°å”¤é†’ï¼Œå¦åˆ™ä¸ä¼šè¢«åˆ†é… CPU æ—¶é—´ç‰‡ã€‚ è¿›å…¥æ–¹æ³• é€€å‡ºæ–¹æ³• æ²¡æœ‰è®¾ç½® Timeout å‚æ•°çš„ Object.wait() æ–¹æ³• Object.notify() / Object.notifyAll() æ²¡æœ‰è®¾ç½® Timeout å‚æ•°çš„ Thread.join() æ–¹æ³• è¢«è°ƒç”¨çš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯• LockSupport.park() æ–¹æ³• LockSupport.unpark(Thread) é™æœŸç­‰å¾…ï¼ˆTimed Waitingï¼‰ æ— éœ€ç­‰å¾…å…¶å®ƒçº¿ç¨‹æ˜¾å¼åœ°å”¤é†’ï¼Œåœ¨ä¸€å®šæ—¶é—´ä¹‹åä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨å”¤é†’ã€‚ è°ƒç”¨ Thread.sleep() æ–¹æ³•ä½¿çº¿ç¨‹è¿›å…¥é™æœŸç­‰å¾…çŠ¶æ€æ—¶ï¼Œå¸¸å¸¸ç”¨â€œä½¿ä¸€ä¸ªçº¿ç¨‹ç¡çœ â€è¿›è¡Œæè¿°ã€‚ è°ƒç”¨ Object.wait() æ–¹æ³•ä½¿çº¿ç¨‹è¿›å…¥é™æœŸç­‰å¾…æˆ–è€…æ— é™æœŸç­‰å¾…æ—¶ï¼Œå¸¸å¸¸ç”¨â€œæŒ‚èµ·ä¸€ä¸ªçº¿ç¨‹â€è¿›è¡Œæè¿°ã€‚ ç¡çœ å’ŒæŒ‚èµ·æ˜¯ç”¨æ¥æè¿°è¡Œä¸ºï¼Œè€Œé˜»å¡å’Œç­‰å¾…ç”¨æ¥æè¿°çŠ¶æ€ã€‚ é˜»å¡å’Œç­‰å¾…çš„åŒºåˆ«åœ¨äºï¼Œé˜»å¡æ˜¯è¢«åŠ¨çš„ï¼Œå®ƒæ˜¯åœ¨ç­‰å¾…è·å–ä¸€ä¸ªæ’å®ƒé”ã€‚è€Œç­‰å¾…æ˜¯ä¸»åŠ¨çš„ï¼Œé€šè¿‡è°ƒç”¨ Thread.sleep() å’Œ Object.wait() ç­‰æ–¹æ³•è¿›å…¥ã€‚ è¿›å…¥æ–¹æ³• é€€å‡ºæ–¹æ³• Thread.sleep() æ–¹æ³• æ—¶é—´ç»“æŸ è®¾ç½®äº† Timeout å‚æ•°çš„ Object.wait() æ–¹æ³• æ—¶é—´ç»“æŸ / Object.notify() / Object.notifyAll() è®¾ç½®äº† Timeout å‚æ•°çš„ Thread.join() æ–¹æ³• æ—¶é—´ç»“æŸ / è¢«è°ƒç”¨çš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯• LockSupport.parkNanos() æ–¹æ³• LockSupport.unpark(Thread) LockSupport.parkUntil() æ–¹æ³• LockSupport.unpark(Thread) æ­»äº¡ï¼ˆTerminatedï¼‰ å¯ä»¥æ˜¯çº¿ç¨‹ç»“æŸä»»åŠ¡ä¹‹åè‡ªå·±ç»“æŸï¼Œæˆ–è€…äº§ç”Ÿäº†å¼‚å¸¸è€Œç»“æŸã€‚ ä½¿ç”¨çº¿ç¨‹æœ‰ä¸‰ç§ä½¿ç”¨çº¿ç¨‹çš„æ–¹æ³•ï¼š å®ç° Runnable æ¥å£ï¼› å®ç° Callable æ¥å£ï¼› ç»§æ‰¿ Thread ç±»ã€‚ å®ç° Runnable å’Œ Callable æ¥å£çš„ç±»åªèƒ½å½“åšä¸€ä¸ªå¯ä»¥åœ¨çº¿ç¨‹ä¸­è¿è¡Œçš„ä»»åŠ¡ï¼Œä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„çº¿ç¨‹ï¼Œå› æ­¤æœ€åè¿˜éœ€è¦é€šè¿‡ Thread æ¥è°ƒç”¨ã€‚å¯ä»¥è¯´ä»»åŠ¡æ˜¯é€šè¿‡çº¿ç¨‹é©±åŠ¨ä»è€Œæ‰§è¡Œçš„ã€‚ å®ç° Runnable æ¥å£éœ€è¦å®ç° run() æ–¹æ³•ã€‚ é€šè¿‡ Thread è°ƒç”¨ start() æ–¹æ³•æ¥å¯åŠ¨çº¿ç¨‹ã€‚ 1234567891011public class MyRunnable implements Runnable { public void run() { // ... }}public static void main(String[] args) { MyRunnable instance = new MyRunnable(); Thread thread = new Thread(instance); thread.start(); //è°ƒç”¨ thread.run()å¹¶ä¸æ˜¯å¼€å¯æ–°çº¿ç¨‹ï¼Œè€Œæ˜¯åœ¨å½“å‰çº¿ç¨‹é‡Œé©¬ä¸Šè°ƒç”¨run()æ–¹æ³•} å®ç° Callable æ¥å£ä¸ Runnable ç›¸æ¯”ï¼ŒCallable å¯ä»¥æœ‰è¿”å›å€¼ï¼Œè¿”å›å€¼é€šè¿‡ FutureTask è¿›è¡Œå°è£…ã€‚ 123456789101112public class MyCallable implements Callable&lt;Integer&gt; { public Integer call() { return 123; }}public static void main(String[] args) throws ExecutionException, InterruptedException { MyCallable mc = new MyCallable(); FutureTask&lt;Integer&gt; ft = new FutureTask&lt;&gt;(mc); Thread thread = new Thread(ft); thread.start(); System.out.println(ft.get());} ç»§æ‰¿ Thread ç±»åŒæ ·ä¹Ÿæ˜¯éœ€è¦å®ç° run() æ–¹æ³•ï¼Œå› ä¸º Thread ç±»ä¹Ÿå®ç°äº† Runable æ¥å£ã€‚ å½“è°ƒç”¨ start() æ–¹æ³•å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œè™šæ‹Ÿæœºä¼šå°†è¯¥çº¿ç¨‹æ”¾å…¥å°±ç»ªé˜Ÿåˆ—ä¸­ç­‰å¾…è¢«è°ƒåº¦ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è¢«è°ƒåº¦æ—¶ä¼šæ‰§è¡Œè¯¥çº¿ç¨‹çš„ run() æ–¹æ³•ã€‚ 123456789public class MyThread extends Thread { public void run() { // ... }}public static void main(String[] args) { MyThread mt = new MyThread(); mt.start();} å®ç°æ¥å£ VS ç»§æ‰¿ Threadå®ç°æ¥å£ä¼šæ›´å¥½ä¸€äº›ï¼Œå› ä¸ºï¼š Java ä¸æ”¯æŒå¤šé‡ç»§æ‰¿ï¼Œå› æ­¤ç»§æ‰¿äº† Thread ç±»å°±æ— æ³•ç»§æ‰¿å…¶å®ƒç±»ï¼Œä½†æ˜¯å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼› ç±»å¯èƒ½åªè¦æ±‚å¯æ‰§è¡Œå°±è¡Œï¼Œç»§æ‰¿æ•´ä¸ª Thread ç±»å¼€é”€è¿‡å¤§ã€‚ åŸºç¡€çº¿ç¨‹æœºåˆ¶ExecutorExecutor ç®¡ç†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œï¼Œè€Œæ— éœ€ç¨‹åºå‘˜æ˜¾å¼åœ°ç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™é‡Œçš„å¼‚æ­¥æ˜¯æŒ‡å¤šä¸ªä»»åŠ¡çš„æ‰§è¡Œäº’ä¸å¹²æ‰°ï¼Œä¸éœ€è¦è¿›è¡ŒåŒæ­¥æ“ä½œã€‚ ä¸»è¦æœ‰ä¸‰ç§ Executorï¼š CachedThreadPoolï¼šä¸€ä¸ªä»»åŠ¡åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼› FixedThreadPoolï¼šæ‰€æœ‰ä»»åŠ¡åªèƒ½ä½¿ç”¨å›ºå®šå¤§å°çš„çº¿ç¨‹ï¼› SingleThreadExecutorï¼šç›¸å½“äºå¤§å°ä¸º 1 çš„ FixedThreadPoolã€‚ 1234567public static void main(String[] args) { ExecutorService executorService = Executors.newCachedThreadPool(); for (int i = 0; i &lt; 5; i++) { executorService.execute(new MyRunnable()); } executorService.shutdown();} Daemonå®ˆæŠ¤çº¿ç¨‹æ˜¯ç¨‹åºè¿è¡Œæ—¶åœ¨åå°æä¾›æœåŠ¡çš„çº¿ç¨‹ï¼Œä¸å±äºç¨‹åºä¸­ä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ†ã€‚ å½“æ‰€æœ‰éå®ˆæŠ¤çº¿ç¨‹ç»“æŸæ—¶ï¼Œç¨‹åºä¹Ÿå°±ç»ˆæ­¢ï¼ŒåŒæ—¶ä¼šæ€æ­»æ‰€æœ‰å®ˆæŠ¤çº¿ç¨‹ã€‚ main() å±äºéå®ˆæŠ¤çº¿ç¨‹ã€‚ åœ¨çº¿ç¨‹å¯åŠ¨ä¹‹å‰ä½¿ç”¨ setDaemon() æ–¹æ³•å¯ä»¥å°†ä¸€ä¸ªçº¿ç¨‹è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚ 1234public static void main(String[] args) { Thread thread = new Thread(new MyRunnable()); thread.setDaemon(true);} sleep()Thread.sleep(millisec) æ–¹æ³•ä¼šä¼‘çœ å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹ï¼Œmillisec å•ä½ä¸ºæ¯«ç§’ã€‚ sleep() å¯èƒ½ä¼šæŠ›å‡º InterruptedExceptionï¼Œå› ä¸ºå¼‚å¸¸ä¸èƒ½è·¨çº¿ç¨‹ä¼ æ’­å› main() ä¸­ï¼Œå› æ­¤å¿…é¡»åœ¨æœ¬åœ°è¿›è¡Œå¤„ç†ã€‚çº¿ç¨‹ä¸­æŠ›å‡ºçš„å…¶å®ƒå¼‚å¸¸ä¹ŸåŒæ ·éœ€è¦åœ¨æœ¬åœ°è¿›è¡Œå¤„ç†ã€‚ 1234567public void run() { try { Thread.sleep(3000); } catch (InterruptedException e) { e.printStackTrace(); }} yield()å¯¹é™æ€æ–¹æ³• Thread.yield() çš„è°ƒç”¨å£°æ˜äº†å½“å‰çº¿ç¨‹å·²ç»å®Œæˆäº†ç”Ÿå‘½å‘¨æœŸä¸­æœ€é‡è¦çš„éƒ¨åˆ†ï¼Œå¯ä»¥åˆ‡æ¢ç»™å…¶å®ƒçº¿ç¨‹æ¥æ‰§è¡Œã€‚è¯¥æ–¹æ³•åªæ˜¯å¯¹çº¿ç¨‹è°ƒåº¦å™¨çš„ä¸€ä¸ªå»ºè®®ï¼Œè€Œä¸”ä¹Ÿåªæ˜¯å»ºè®®å…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„å…¶å®ƒçº¿ç¨‹å¯ä»¥è¿è¡Œã€‚ 123public void run() { Thread.yield();} ä¸­æ–­ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹åä¼šè‡ªåŠ¨ç»“æŸï¼Œå¦‚æœåœ¨è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸ä¹Ÿä¼šæå‰ç»“æŸã€‚ InterruptedExceptioné€šè¿‡è°ƒç”¨ä¸€ä¸ªçº¿ç¨‹çš„ interrupt() æ¥ä¸­æ–­è¯¥çº¿ç¨‹ï¼Œå¦‚æœè¯¥çº¿ç¨‹å¤„äºé˜»å¡ã€é™æœŸç­‰å¾…æˆ–è€…æ— é™æœŸç­‰å¾…çŠ¶æ€ï¼Œé‚£ä¹ˆå°±ä¼šæŠ›å‡º InterruptedExceptionï¼Œä»è€Œæå‰ç»“æŸè¯¥çº¿ç¨‹ã€‚ä½†æ˜¯ä¸èƒ½ä¸­æ–­ I/O é˜»å¡å’Œ synchronized é”é˜»å¡ã€‚ å¯¹äºä»¥ä¸‹ä»£ç ï¼Œåœ¨ main() ä¸­å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ä¹‹åå†ä¸­æ–­å®ƒï¼Œç”±äºçº¿ç¨‹ä¸­è°ƒç”¨äº† Thread.sleep() æ–¹æ³•ï¼Œå› æ­¤ä¼šæŠ›å‡ºä¸€ä¸ª InterruptedExceptionï¼Œä»è€Œæå‰ç»“æŸçº¿ç¨‹ï¼Œä¸æ‰§è¡Œä¹‹åçš„è¯­å¥ã€‚ 1234567891011121314151617181920212223242526public class InterruptExample { private static class MyThread1 extends Thread { @Override public void run() { try { Thread.sleep(2000); System.out.println(\"Thread run\"); } catch (InterruptedException e) { e.printStackTrace(); } } }}public static void main(String[] args) throws InterruptedException { Thread thread1 = new MyThread1(); thread1.start(); thread1.interrupt(); System.out.println(\"Main run\");}Main runjava.lang.InterruptedException: sleep interrupted at java.lang.Thread.sleep(Native Method) at InterruptExample.lambda$main$0(InterruptExample.java:5) at InterruptExample$$Lambda$1/713338599.run(Unknown Source) at java.lang.Thread.run(Thread.java:745) interrupted()å¦‚æœä¸€ä¸ªçº¿ç¨‹çš„ run() æ–¹æ³•æ‰§è¡Œä¸€ä¸ªæ— é™å¾ªç¯ï¼Œå¹¶ä¸”æ²¡æœ‰æ‰§è¡Œ sleep() ç­‰ä¼šæŠ›å‡º InterruptedException çš„æ“ä½œï¼Œé‚£ä¹ˆè°ƒç”¨çº¿ç¨‹çš„ interrupt() æ–¹æ³•å°±æ— æ³•ä½¿çº¿ç¨‹æå‰ç»“æŸã€‚ ä½†æ˜¯è°ƒç”¨ interrupt() æ–¹æ³•ä¼šè®¾ç½®çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°ï¼Œæ­¤æ—¶è°ƒç”¨ interrupted() æ–¹æ³•ä¼šè¿”å› trueã€‚å› æ­¤å¯ä»¥åœ¨å¾ªç¯ä½“ä¸­ä½¿ç”¨ interrupted() æ–¹æ³•æ¥åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å¤„äºä¸­æ–­çŠ¶æ€ï¼Œä»è€Œæå‰ç»“æŸçº¿ç¨‹ã€‚ 123456789101112131415161718public class InterruptExample { private static class MyThread2 extends Thread { @Override public void run() { while (!interrupted()) { // .. } System.out.println(\"Thread end\"); } }}public static void main(String[] args) throws InterruptedException { Thread thread2 = new MyThread2(); thread2.start(); thread2.interrupt();}Thread end Executor çš„ä¸­æ–­æ“ä½œè°ƒç”¨ Executor çš„ shutdown() æ–¹æ³•ä¼šç­‰å¾…çº¿ç¨‹éƒ½æ‰§è¡Œå®Œæ¯•ä¹‹åå†å…³é—­ï¼Œä½†æ˜¯å¦‚æœè°ƒç”¨çš„æ˜¯ shutdownNow() æ–¹æ³•ï¼Œåˆ™ç›¸å½“äºè°ƒç”¨æ¯ä¸ªçº¿ç¨‹çš„ interrupt() æ–¹æ³•ã€‚ ä»¥ä¸‹ä½¿ç”¨ Lambda åˆ›å»ºçº¿ç¨‹ï¼Œç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ªåŒ¿åå†…éƒ¨çº¿ç¨‹ã€‚ 123456789101112131415161718192021public static void main(String[] args) { ExecutorService executorService = Executors.newCachedThreadPool(); executorService.execute(() -&gt; { try { Thread.sleep(2000); System.out.println(\"Thread run\"); } catch (InterruptedException e) { e.printStackTrace(); } }); executorService.shutdownNow(); System.out.println(\"Main run\");}Main runjava.lang.InterruptedException: sleep interrupted at java.lang.Thread.sleep(Native Method) at ExecutorInterruptExample.lambda$main$0(ExecutorInterruptExample.java:9) at ExecutorInterruptExample$$Lambda$1/1160460865.run(Unknown Source) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) at java.lang.Thread.run(Thread.java:745) å¦‚æœåªæƒ³ä¸­æ–­ Executor ä¸­çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨ submit() æ–¹æ³•æ¥æäº¤ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª Future&lt;?&gt; å¯¹è±¡ï¼Œé€šè¿‡è°ƒç”¨è¯¥å¯¹è±¡çš„ cancel(true) æ–¹æ³•å°±å¯ä»¥ä¸­æ–­çº¿ç¨‹ã€‚ 1234Future&lt;?&gt; future = executorService.submit(() -&gt; { // ..});future.cancel(true); äº’æ–¥åŒæ­¥Java æä¾›äº†ä¸¤ç§é”æœºåˆ¶æ¥æ§åˆ¶å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºçš„äº’æ–¥è®¿é—®ï¼Œç¬¬ä¸€ä¸ªæ˜¯ JVM å®ç°çš„ synchronizedï¼Œè€Œå¦ä¸€ä¸ªæ˜¯ JDK å®ç°çš„ ReentrantLockã€‚ synchronized1. åŒæ­¥ä¸€ä¸ªä»£ç å— 12345public void func() { synchronized (this) { // ... }} å®ƒåªä½œç”¨äºåŒä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœè°ƒç”¨ä¸¤ä¸ªå¯¹è±¡ä¸Šçš„åŒæ­¥ä»£ç å—ï¼Œå°±ä¸ä¼šè¿›è¡ŒåŒæ­¥ã€‚ å¯¹äºä»¥ä¸‹ä»£ç ï¼Œä½¿ç”¨ ExecutorService æ‰§è¡Œäº†ä¸¤ä¸ªçº¿ç¨‹ï¼Œç”±äºè°ƒç”¨çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡çš„åŒæ­¥ä»£ç å—ï¼Œå› æ­¤è¿™ä¸¤ä¸ªçº¿ç¨‹ä¼šè¿›è¡ŒåŒæ­¥ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥åŒæ­¥è¯­å¥å—æ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å°±å¿…é¡»ç­‰å¾…ã€‚ 1234567891011121314151617public class SynchronizedExample { public void func1() { synchronized (this) { for (int i = 0; i &lt; 10; i++) { System.out.print(i + \" \"); } } }}public static void main(String[] args) { SynchronizedExample e1 = new SynchronizedExample(); ExecutorService executorService = Executors.newCachedThreadPool(); executorService.execute(() -&gt; e1.func1()); executorService.execute(() -&gt; e1.func1());}0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 å¯¹äºä»¥ä¸‹ä»£ç ï¼Œä¸¤ä¸ªçº¿ç¨‹è°ƒç”¨äº†ä¸åŒå¯¹è±¡çš„åŒæ­¥ä»£ç å—ï¼Œå› æ­¤è¿™ä¸¤ä¸ªçº¿ç¨‹å°±ä¸éœ€è¦åŒæ­¥ã€‚ä»è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼Œä¸¤ä¸ªçº¿ç¨‹äº¤å‰æ‰§è¡Œã€‚ 12345678public static void main(String[] args) { SynchronizedExample e1 = new SynchronizedExample(); SynchronizedExample e2 = new SynchronizedExample(); ExecutorService executorService = Executors.newCachedThreadPool(); executorService.execute(() -&gt; e1.func1()); executorService.execute(() -&gt; e2.func1());}0 0 1 1 2 2 3 3 4 4 5 5 6 6 7 7 8 8 9 9 2. åŒæ­¥ä¸€ä¸ªæ–¹æ³• 123public synchronized void func () { // ...} å®ƒå’ŒåŒæ­¥ä»£ç å—ä¸€æ ·ï¼Œä½œç”¨äºåŒä¸€ä¸ªå¯¹è±¡ã€‚ 3. åŒæ­¥ä¸€ä¸ªç±» 12345public void func() { synchronized (SynchronizedExample.class) { // ... }} ä½œç”¨äºæ•´ä¸ªç±»ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤ä¸ªçº¿ç¨‹è°ƒç”¨åŒä¸€ä¸ªç±»çš„ä¸åŒå¯¹è±¡ä¸Šçš„è¿™ç§åŒæ­¥è¯­å¥ï¼Œä¹Ÿä¼šè¿›è¡ŒåŒæ­¥ã€‚ 123456789101112131415161718public class SynchronizedExample { public void func2() { synchronized (SynchronizedExample.class) { for (int i = 0; i &lt; 10; i++) { System.out.print(i + \" \"); } } }}public static void main(String[] args) { SynchronizedExample e1 = new SynchronizedExample(); SynchronizedExample e2 = new SynchronizedExample(); ExecutorService executorService = Executors.newCachedThreadPool(); executorService.execute(() -&gt; e1.func2()); executorService.execute(() -&gt; e2.func2());}0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 4. åŒæ­¥ä¸€ä¸ªé™æ€æ–¹æ³• 123public synchronized static void fun() { // ...} ä½œç”¨äºæ•´ä¸ªç±»ã€‚ ReentrantLockReentrantLock æ˜¯ java.util.concurrentï¼ˆJ.U.Cï¼‰åŒ…ä¸­çš„é”ã€‚ 12345678910111213141516171819202122public class LockExample { private Lock lock = new ReentrantLock(); public void func() { lock.lock(); try { for (int i = 0; i &lt; 10; i++) { System.out.print(i + \" \"); } } finally { lock.unlock(); // ç¡®ä¿é‡Šæ”¾é”ï¼Œä»è€Œé¿å…å‘ç”Ÿæ­»é”ã€‚ } }}public static void main(String[] args) { LockExample lockExample = new LockExample(); ExecutorService executorService = Executors.newCachedThreadPool(); executorService.execute(() -&gt; lockExample.func()); executorService.execute(() -&gt; lockExample.func());}0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 æ¯”è¾ƒ1. é”çš„å®ç° synchronized æ˜¯ JVM å®ç°çš„ï¼Œè€Œ ReentrantLock æ˜¯ JDK å®ç°çš„ã€‚ 2. æ€§èƒ½ æ–°ç‰ˆæœ¬ Java å¯¹ synchronized è¿›è¡Œäº†å¾ˆå¤šä¼˜åŒ–ï¼Œä¾‹å¦‚è‡ªæ—‹é”ç­‰ï¼Œsynchronized ä¸ ReentrantLock å¤§è‡´ç›¸åŒã€‚ 3. ç­‰å¾…å¯ä¸­æ–­ å½“æŒæœ‰é”çš„çº¿ç¨‹é•¿æœŸä¸é‡Šæ”¾é”çš„æ—¶å€™ï¼Œæ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹å¯ä»¥é€‰æ‹©æ”¾å¼ƒç­‰å¾…ï¼Œæ”¹ä¸ºå¤„ç†å…¶ä»–äº‹æƒ…ã€‚ ReentrantLock å¯ä¸­æ–­ï¼Œè€Œ synchronized ä¸è¡Œã€‚ 4. å…¬å¹³é” å…¬å¹³é”æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…åŒä¸€ä¸ªé”æ—¶ï¼Œå¿…é¡»æŒ‰ç…§ç”³è¯·é”çš„æ—¶é—´é¡ºåºæ¥ä¾æ¬¡è·å¾—é”ã€‚ synchronized ä¸­çš„é”æ˜¯éå…¬å¹³çš„ï¼ŒReentrantLock é»˜è®¤æƒ…å†µä¸‹ä¹Ÿæ˜¯éå…¬å¹³çš„ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æ˜¯å…¬å¹³çš„ã€‚ 5. é”ç»‘å®šå¤šä¸ªæ¡ä»¶ ä¸€ä¸ª ReentrantLock å¯ä»¥åŒæ—¶ç»‘å®šå¤šä¸ª Condition å¯¹è±¡ã€‚ ä½¿ç”¨é€‰æ‹©é™¤ééœ€è¦ä½¿ç”¨ ReentrantLock çš„é«˜çº§åŠŸèƒ½ï¼Œå¦åˆ™ä¼˜å…ˆä½¿ç”¨ synchronizedã€‚è¿™æ˜¯å› ä¸º synchronized æ˜¯ JVM å®ç°çš„ä¸€ç§é”æœºåˆ¶ï¼ŒJVM åŸç”Ÿåœ°æ”¯æŒå®ƒï¼Œè€Œ ReentrantLock ä¸æ˜¯æ‰€æœ‰çš„ JDK ç‰ˆæœ¬éƒ½æ”¯æŒã€‚å¹¶ä¸”ä½¿ç”¨ synchronized ä¸ç”¨æ‹…å¿ƒæ²¡æœ‰é‡Šæ”¾é”è€Œå¯¼è‡´æ­»é”é—®é¢˜ï¼Œå› ä¸º JVM ä¼šç¡®ä¿é”çš„é‡Šæ”¾ã€‚ çº¿ç¨‹ä¹‹é—´çš„åä½œå½“å¤šä¸ªçº¿ç¨‹å¯ä»¥ä¸€èµ·å·¥ä½œå»è§£å†³æŸä¸ªé—®é¢˜æ—¶ï¼Œå¦‚æœæŸäº›éƒ¨åˆ†å¿…é¡»åœ¨å…¶å®ƒéƒ¨åˆ†ä¹‹å‰å®Œæˆï¼Œé‚£ä¹ˆå°±éœ€è¦å¯¹çº¿ç¨‹è¿›è¡Œåè°ƒã€‚ join()åœ¨çº¿ç¨‹ä¸­è°ƒç”¨å¦ä¸€ä¸ªçº¿ç¨‹çš„ join() æ–¹æ³•ï¼Œä¼šå°†å½“å‰çº¿ç¨‹æŒ‚èµ·ï¼Œè€Œä¸æ˜¯å¿™ç­‰å¾…ï¼Œç›´åˆ°ç›®æ ‡çº¿ç¨‹ç»“æŸã€‚ å¯¹äºä»¥ä¸‹ä»£ç ï¼Œè™½ç„¶ b çº¿ç¨‹å…ˆå¯åŠ¨ï¼Œä½†æ˜¯å› ä¸ºåœ¨ b çº¿ç¨‹ä¸­è°ƒç”¨äº† a çº¿ç¨‹çš„ join() æ–¹æ³•ï¼Œb çº¿ç¨‹ä¼šç­‰å¾… a çº¿ç¨‹ç»“æŸæ‰ç»§ç»­æ‰§è¡Œï¼Œå› æ­¤æœ€åèƒ½å¤Ÿä¿è¯ a çº¿ç¨‹çš„è¾“å‡ºå…ˆäº b çº¿ç¨‹çš„è¾“å‡ºã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041public class JoinExample { private class A extends Thread { @Override public void run() { System.out.println(\"A\"); } } private class B extends Thread { private A a; B(A a) { this.a = a; } @Override public void run() { try { a.join(); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(\"B\"); } } public void test() { A a = new A(); B b = new B(a); b.start(); a.start(); }}public static void main(String[] args) { JoinExample example = new JoinExample(); example.test();}AB wait() notify() notifyAll()è°ƒç”¨ wait() ä½¿å¾—çº¿ç¨‹ç­‰å¾…æŸä¸ªæ¡ä»¶æ»¡è¶³ï¼Œçº¿ç¨‹åœ¨ç­‰å¾…æ—¶ä¼šè¢«æŒ‚èµ·ï¼Œå½“å…¶ä»–çº¿ç¨‹çš„è¿è¡Œä½¿å¾—è¿™ä¸ªæ¡ä»¶æ»¡è¶³æ—¶ï¼Œå…¶å®ƒçº¿ç¨‹ä¼šè°ƒç”¨ notify() æˆ–è€… notifyAll() æ¥å”¤é†’æŒ‚èµ·çš„çº¿ç¨‹ã€‚ å®ƒä»¬éƒ½å±äº Object çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸å±äº Threadã€‚ åªèƒ½ç”¨åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥æ§åˆ¶å—ä¸­ä½¿ç”¨ï¼Œå¦åˆ™ä¼šåœ¨è¿è¡Œæ—¶æŠ›å‡º IllegalMonitorStateExceptionã€‚ ä½¿ç”¨ wait() æŒ‚èµ·æœŸé—´ï¼Œçº¿ç¨‹ä¼šé‡Šæ”¾é”ã€‚è¿™æ˜¯å› ä¸ºï¼Œå¦‚æœæ²¡æœ‰é‡Šæ”¾é”ï¼Œé‚£ä¹ˆå…¶å®ƒçº¿ç¨‹å°±æ— æ³•è¿›å…¥å¯¹è±¡çš„åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥æ§åˆ¶å—ä¸­ï¼Œé‚£ä¹ˆå°±æ— æ³•æ‰§è¡Œ notify() æˆ–è€… notifyAll() æ¥å”¤é†’æŒ‚èµ·çš„çº¿ç¨‹ï¼Œé€ æˆæ­»é”ã€‚ 123456789101112131415161718192021222324public class WaitNotifyExample { public synchronized void before() { System.out.println(\"before\"); notifyAll(); } public synchronized void after() { try { wait(); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(\"after\"); }}public static void main(String[] args) { ExecutorService executorService = Executors.newCachedThreadPool(); WaitNotifyExample example = new WaitNotifyExample(); executorService.execute(() -&gt; example.after()); executorService.execute(() -&gt; example.before());}beforeafter wait() å’Œ sleep() çš„åŒºåˆ« wait() æ˜¯ Object çš„æ–¹æ³•ï¼Œè€Œ sleep() æ˜¯ Thread çš„é™æ€æ–¹æ³•ï¼› wait() ä¼šé‡Šæ”¾é”ï¼Œsleep() ä¸ä¼šã€‚ await() signal() signalAll()java.util.concurrent ç±»åº“ä¸­æä¾›äº† Condition ç±»æ¥å®ç°çº¿ç¨‹ä¹‹é—´çš„åè°ƒï¼Œå¯ä»¥åœ¨ Condition ä¸Šè°ƒç”¨ await() æ–¹æ³•ä½¿çº¿ç¨‹ç­‰å¾…ï¼Œå…¶å®ƒçº¿ç¨‹è°ƒç”¨ signal() æˆ– signalAll() æ–¹æ³•å”¤é†’ç­‰å¾…çš„çº¿ç¨‹ã€‚ ç›¸æ¯”äº wait() è¿™ç§ç­‰å¾…æ–¹å¼ï¼Œawait() å¯ä»¥æŒ‡å®šç­‰å¾…çš„æ¡ä»¶ï¼Œå› æ­¤æ›´åŠ çµæ´»ã€‚ ä½¿ç”¨ Lock æ¥è·å–ä¸€ä¸ª Condition å¯¹è±¡ã€‚ 1234567891011121314151617181920212223242526272829303132333435public class AwaitSignalExample { private Lock lock = new ReentrantLock(); private Condition condition = lock.newCondition(); public void before() { lock.lock(); try { System.out.println(\"before\"); condition.signalAll(); } finally { lock.unlock(); } } public void after() { lock.lock(); try { condition.await(); System.out.println(\"after\"); } catch (InterruptedException e) { e.printStackTrace(); } finally { lock.unlock(); } }}public static void main(String[] args) { ExecutorService executorService = Executors.newCachedThreadPool(); AwaitSignalExample example = new AwaitSignalExample(); executorService.execute(() -&gt; example.after()); executorService.execute(() -&gt; example.before());}beforeafter J.U.C - AQSjava.util.concurrentï¼ˆJ.U.Cï¼‰å¤§å¤§æé«˜äº†å¹¶å‘æ€§èƒ½ï¼ŒAQS è¢«è®¤ä¸ºæ˜¯ J.U.C çš„æ ¸å¿ƒã€‚ CountDownLatchç”¨æ¥æ§åˆ¶ä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹ç­‰å¾…å¤šä¸ªçº¿ç¨‹ã€‚ ç»´æŠ¤äº†ä¸€ä¸ªè®¡æ•°å™¨ cntï¼Œæ¯æ¬¡è°ƒç”¨ countDown() æ–¹æ³•ä¼šè®©è®¡æ•°å™¨çš„å€¼å‡ 1ï¼Œå‡åˆ° 0 çš„æ—¶å€™ï¼Œé‚£äº›å› ä¸ºè°ƒç”¨ await() æ–¹æ³•è€Œåœ¨ç­‰å¾…çš„çº¿ç¨‹å°±ä¼šè¢«å”¤é†’ã€‚ 12345678910111213141516171819public class CountdownLatchExample { public static void main(String[] args) throws InterruptedException { final int totalThread = 10; CountDownLatch countDownLatch = new CountDownLatch(totalThread); ExecutorService executorService = Executors.newCachedThreadPool(); for (int i = 0; i &lt; totalThread; i++) { executorService.execute(() -&gt; { System.out.print(\"run..\"); countDownLatch.countDown(); }); } countDownLatch.await(); System.out.println(\"end\"); executorService.shutdown(); }}run..run..run..run..run..run..run..run..run..run..end CyclicBarrierç”¨æ¥æ§åˆ¶å¤šä¸ªçº¿ç¨‹äº’ç›¸ç­‰å¾…ï¼Œåªæœ‰å½“å¤šä¸ªçº¿ç¨‹éƒ½åˆ°è¾¾æ—¶ï¼Œè¿™äº›çº¿ç¨‹æ‰ä¼šç»§ç»­æ‰§è¡Œã€‚ å’Œ CountdownLatch ç›¸ä¼¼ï¼Œéƒ½æ˜¯é€šè¿‡ç»´æŠ¤è®¡æ•°å™¨æ¥å®ç°çš„ã€‚çº¿ç¨‹æ‰§è¡Œ await() æ–¹æ³•ä¹‹åè®¡æ•°å™¨ä¼šå‡ 1ï¼Œå¹¶è¿›è¡Œç­‰å¾…ï¼Œç›´åˆ°è®¡æ•°å™¨ä¸º 0ï¼Œæ‰€æœ‰è°ƒç”¨ await() æ–¹æ³•è€Œåœ¨ç­‰å¾…çš„çº¿ç¨‹æ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚ CyclicBarrier å’Œ CountdownLatch çš„ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼ŒCyclicBarrier çš„è®¡æ•°å™¨é€šè¿‡è°ƒç”¨ reset() æ–¹æ³•å¯ä»¥å¾ªç¯ä½¿ç”¨ï¼Œæ‰€ä»¥å®ƒæ‰å«åšå¾ªç¯å±éšœã€‚ CyclicBarrier æœ‰ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼Œå…¶ä¸­ parties æŒ‡ç¤ºè®¡æ•°å™¨çš„åˆå§‹å€¼ï¼ŒbarrierAction åœ¨æ‰€æœ‰çº¿ç¨‹éƒ½åˆ°è¾¾å±éšœçš„æ—¶å€™ä¼šæ‰§è¡Œä¸€æ¬¡ã€‚ 12345678910public CyclicBarrier(int parties, Runnable barrierAction) { if (parties &lt;= 0) throw new IllegalArgumentException(); this.parties = parties; this.count = parties; this.barrierCommand = barrierAction;}public CyclicBarrier(int parties) { this(parties, null);} 123456789101112131415161718192021public class CyclicBarrierExample { public static void main(String[] args) { final int totalThread = 10; CyclicBarrier cyclicBarrier = new CyclicBarrier(totalThread); ExecutorService executorService = Executors.newCachedThreadPool(); for (int i = 0; i &lt; totalThread; i++) { executorService.execute(() -&gt; { System.out.print(\"before..\"); try { cyclicBarrier.await(); } catch (InterruptedException | BrokenBarrierException e) { e.printStackTrace(); } System.out.print(\"after..\"); }); } executorService.shutdown(); }}before..before..before..before..before..before..before..before..before..before..after..after..after..after..after..after..after..after..after..after.. SemaphoreSemaphore ç±»ä¼¼äºæ“ä½œç³»ç»Ÿä¸­çš„ä¿¡å·é‡ï¼Œå¯ä»¥æ§åˆ¶å¯¹äº’æ–¥èµ„æºçš„è®¿é—®çº¿ç¨‹æ•°ã€‚ ä»¥ä¸‹ä»£ç æ¨¡æ‹Ÿäº†å¯¹æŸä¸ªæœåŠ¡çš„å¹¶å‘è¯·æ±‚ï¼Œæ¯æ¬¡åªèƒ½æœ‰ 3 ä¸ªå®¢æˆ·ç«¯åŒæ—¶è®¿é—®ï¼Œè¯·æ±‚æ€»æ•°ä¸º 10ã€‚ 1234567891011121314151617181920212223public class SemaphoreExample { public static void main(String[] args) { final int clientCount = 3; final int totalRequestCount = 10; Semaphore semaphore = new Semaphore(clientCount); ExecutorService executorService = Executors.newCachedThreadPool(); for (int i = 0; i &lt; totalRequestCount; i++) { executorService.execute(()-&gt;{ try { semaphore.acquire(); System.out.print(semaphore.availablePermits() + \" \"); } catch (InterruptedException e) { e.printStackTrace(); } finally { semaphore.release(); } }); } executorService.shutdown(); }}2 1 2 2 2 2 2 1 2 2 J.U.C - å…¶å®ƒç»„ä»¶FutureTaskåœ¨ä»‹ç» Callable æ—¶æˆ‘ä»¬çŸ¥é“å®ƒå¯ä»¥æœ‰è¿”å›å€¼ï¼Œè¿”å›å€¼é€šè¿‡ Future è¿›è¡Œå°è£…ã€‚FutureTask å®ç°äº† RunnableFuture æ¥å£ï¼Œè¯¥æ¥å£ç»§æ‰¿è‡ª Runnable å’Œ Future æ¥å£ï¼Œè¿™ä½¿å¾— FutureTask æ—¢å¯ä»¥å½“åšä¸€ä¸ªä»»åŠ¡æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥æœ‰è¿”å›å€¼ã€‚ 12public class FutureTask&lt;V&gt; implements RunnableFuture&lt;V&gt;public interface RunnableFuture&lt;V&gt; extends Runnable, Future&lt;V&gt; FutureTask å¯ç”¨äºå¼‚æ­¥è·å–æ‰§è¡Œç»“æœæˆ–å–æ¶ˆæ‰§è¡Œä»»åŠ¡çš„åœºæ™¯ã€‚å½“ä¸€ä¸ªè®¡ç®—ä»»åŠ¡éœ€è¦æ‰§è¡Œå¾ˆé•¿æ—¶é—´ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨ FutureTask æ¥å°è£…è¿™ä¸ªä»»åŠ¡ï¼Œä¸»çº¿ç¨‹åœ¨å®Œæˆè‡ªå·±çš„ä»»åŠ¡ä¹‹åå†å»è·å–ç»“æœã€‚ 1234567891011121314151617181920212223242526272829303132public class FutureTaskExample { public static void main(String[] args) throws ExecutionException, InterruptedException { FutureTask&lt;Integer&gt; futureTask = new FutureTask&lt;Integer&gt;(new Callable&lt;Integer&gt;() { @Override public Integer call() throws Exception { int result = 0; for (int i = 0; i &lt; 100; i++) { Thread.sleep(10); result += i; } return result; } }); Thread computeThread = new Thread(futureTask); computeThread.start(); Thread otherThread = new Thread(() -&gt; { System.out.println(\"other task is running...\"); try { Thread.sleep(1000); } catch (InterruptedException e) { e.printStackTrace(); } }); otherThread.start(); System.out.println(futureTask.get()); }}other task is running...4950 BlockingQueuejava.util.concurrent.BlockingQueue æ¥å£æœ‰ä»¥ä¸‹é˜»å¡é˜Ÿåˆ—çš„å®ç°ï¼š FIFO é˜Ÿåˆ— ï¼šLinkedBlockingQueueã€ArrayBlockingQueueï¼ˆå›ºå®šé•¿åº¦ï¼‰ ä¼˜å…ˆçº§é˜Ÿåˆ— ï¼šPriorityBlockingQueue æä¾›äº†é˜»å¡çš„ take() å’Œ put() æ–¹æ³•ï¼šå¦‚æœé˜Ÿåˆ—ä¸ºç©º take() å°†é˜»å¡ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸­æœ‰å†…å®¹ï¼›å¦‚æœé˜Ÿåˆ—ä¸ºæ»¡ put() å°†é˜»å¡ï¼Œç›´åˆ°é˜Ÿåˆ—æœ‰ç©ºé—²ä½ç½®ã€‚ ä½¿ç”¨ BlockingQueue å®ç°ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜ 1234567891011121314151617181920212223242526272829303132333435363738394041424344public class ProducerConsumer { private static BlockingQueue&lt;String&gt; queue = new ArrayBlockingQueue&lt;&gt;(5); private static class Producer extends Thread { @Override public void run() { try { queue.put(\"product\"); } catch (InterruptedException e) { e.printStackTrace(); } System.out.print(\"produce..\"); } } private static class Consumer extends Thread { @Override public void run() { try { String product = queue.take(); } catch (InterruptedException e) { e.printStackTrace(); } System.out.print(\"consume..\"); } }}public static void main(String[] args) { for (int i = 0; i &lt; 2; i++) { Producer producer = new Producer(); producer.start(); } for (int i = 0; i &lt; 5; i++) { Consumer consumer = new Consumer(); consumer.start(); } for (int i = 0; i &lt; 3; i++) { Producer producer = new Producer(); producer.start(); }}produce..produce..consume..consume..produce..consume..produce..consume..produce..consume.. ForkJoinä¸»è¦ç”¨äºå¹¶è¡Œè®¡ç®—ä¸­ï¼Œå’Œ MapReduce åŸç†ç±»ä¼¼ï¼Œéƒ½æ˜¯æŠŠå¤§çš„è®¡ç®—ä»»åŠ¡æ‹†åˆ†æˆå¤šä¸ªå°ä»»åŠ¡å¹¶è¡Œè®¡ç®—ã€‚ 12345678910111213141516171819202122232425262728293031323334353637public class ForkJoinExample extends RecursiveTask&lt;Integer&gt; { private final int threshold = 5; private int first; private int last; public ForkJoinExample(int first, int last) { this.first = first; this.last = last; } @Override protected Integer compute() { int result = 0; if (last - first &lt;= threshold) { // ä»»åŠ¡è¶³å¤Ÿå°åˆ™ç›´æ¥è®¡ç®— for (int i = first; i &lt;= last; i++) { result += i; } } else { // æ‹†åˆ†æˆå°ä»»åŠ¡ int middle = first + (last - first) / 2; ForkJoinExample leftTask = new ForkJoinExample(first, middle); ForkJoinExample rightTask = new ForkJoinExample(middle + 1, last); leftTask.fork(); rightTask.fork(); result = leftTask.join() + rightTask.join(); } return result; }}public static void main(String[] args) throws ExecutionException, InterruptedException { ForkJoinExample example = new ForkJoinExample(1, 10000); ForkJoinPool forkJoinPool = new ForkJoinPool(); Future result = forkJoinPool.submit(example); System.out.println(result.get());} ForkJoin ä½¿ç”¨ ForkJoinPool æ¥å¯åŠ¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„çº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ•°é‡å–å†³äº CPU æ ¸æ•°ã€‚ 1public class ForkJoinPool extends AbstractExecutorService ForkJoinPool å®ç°äº†å·¥ä½œçªƒå–ç®—æ³•æ¥æé«˜ CPU çš„åˆ©ç”¨ç‡ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½ç»´æŠ¤äº†ä¸€ä¸ªåŒç«¯é˜Ÿåˆ—ï¼Œç”¨æ¥å­˜å‚¨éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ã€‚å·¥ä½œçªƒå–ç®—æ³•å…è®¸ç©ºé—²çš„çº¿ç¨‹ä»å…¶å®ƒçº¿ç¨‹çš„åŒç«¯é˜Ÿåˆ—ä¸­çªƒå–ä¸€ä¸ªä»»åŠ¡æ¥æ‰§è¡Œã€‚çªƒå–çš„ä»»åŠ¡å¿…é¡»æ˜¯æœ€æ™šçš„ä»»åŠ¡ï¼Œé¿å…å’Œé˜Ÿåˆ—æ‰€å±çº¿ç¨‹å‘ç”Ÿç«äº‰ã€‚ä¾‹å¦‚ä¸‹å›¾ä¸­ï¼ŒThread2 ä» Thread1 çš„é˜Ÿåˆ—ä¸­æ‹¿å‡ºæœ€æ™šçš„ Task1 ä»»åŠ¡ï¼ŒThread1 ä¼šæ‹¿å‡º Task2 æ¥æ‰§è¡Œï¼Œè¿™æ ·å°±é¿å…å‘ç”Ÿç«äº‰ã€‚ä½†æ˜¯å¦‚æœé˜Ÿåˆ—ä¸­åªæœ‰ä¸€ä¸ªä»»åŠ¡æ—¶è¿˜æ˜¯ä¼šå‘ç”Ÿç«äº‰ã€‚ çº¿ç¨‹ä¸å®‰å…¨ç¤ºä¾‹å¦‚æœå¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªå…±äº«æ•°æ®è¿›è¡Œè®¿é—®è€Œä¸é‡‡å–åŒæ­¥æ“ä½œçš„è¯ï¼Œé‚£ä¹ˆæ“ä½œçš„ç»“æœæ˜¯ä¸ä¸€è‡´çš„ã€‚ ä»¥ä¸‹ä»£ç æ¼”ç¤ºäº† 1000 ä¸ªçº¿ç¨‹åŒæ—¶å¯¹ cnt æ‰§è¡Œè‡ªå¢æ“ä½œï¼Œæ“ä½œç»“æŸä¹‹åå®ƒçš„å€¼æœ‰å¯èƒ½å°äº 1000ã€‚ 12345678910111213141516171819202122232425262728public class ThreadUnsafeExample { private int cnt = 0; public void add() { cnt++; } public int get() { return cnt; }}public static void main(String[] args) throws InterruptedException { final int threadSize = 1000; ThreadUnsafeExample example = new ThreadUnsafeExample(); final CountDownLatch countDownLatch = new CountDownLatch(threadSize); ExecutorService executorService = Executors.newCachedThreadPool(); for (int i = 0; i &lt; threadSize; i++) { executorService.execute(() -&gt; { example.add(); countDownLatch.countDown(); }); } countDownLatch.await(); executorService.shutdown(); System.out.println(example.get());}997 Java å†…å­˜æ¨¡å‹Java å†…å­˜æ¨¡å‹è¯•å›¾å±è”½å„ç§ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„å†…å­˜è®¿é—®å·®å¼‚ï¼Œä»¥å®ç°è®© Java ç¨‹åºåœ¨å„ç§å¹³å°ä¸‹éƒ½èƒ½è¾¾åˆ°ä¸€è‡´çš„å†…å­˜è®¿é—®æ•ˆæœã€‚ ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜å¤„ç†å™¨ä¸Šçš„å¯„å­˜å™¨çš„è¯»å†™çš„é€Ÿåº¦æ¯”å†…å­˜å¿«å‡ ä¸ªæ•°é‡çº§ï¼Œä¸ºäº†è§£å†³è¿™ç§é€Ÿåº¦çŸ›ç›¾ï¼Œåœ¨å®ƒä»¬ä¹‹é—´åŠ å…¥äº†é«˜é€Ÿç¼“å­˜ã€‚ åŠ å…¥é«˜é€Ÿç¼“å­˜å¸¦æ¥äº†ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼šç¼“å­˜ä¸€è‡´æ€§ã€‚å¦‚æœå¤šä¸ªç¼“å­˜å…±äº«åŒä¸€å—ä¸»å†…å­˜åŒºåŸŸï¼Œé‚£ä¹ˆå¤šä¸ªç¼“å­˜çš„æ•°æ®å¯èƒ½ä¼šä¸ä¸€è‡´ï¼Œéœ€è¦ä¸€äº›åè®®æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ æ‰€æœ‰çš„å˜é‡éƒ½å­˜å‚¨åœ¨ä¸»å†…å­˜ä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹è¿˜æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œå·¥ä½œå†…å­˜å­˜å‚¨åœ¨é«˜é€Ÿç¼“å­˜æˆ–è€…å¯„å­˜å™¨ä¸­ï¼Œä¿å­˜äº†è¯¥çº¿ç¨‹ä½¿ç”¨çš„å˜é‡çš„ä¸»å†…å­˜å‰¯æœ¬æ‹·è´ã€‚ çº¿ç¨‹åªèƒ½ç›´æ¥æ“ä½œå·¥ä½œå†…å­˜ä¸­çš„å˜é‡ï¼Œä¸åŒçº¿ç¨‹ä¹‹é—´çš„å˜é‡å€¼ä¼ é€’éœ€è¦é€šè¿‡ä¸»å†…å­˜æ¥å®Œæˆã€‚ å†…å­˜é—´äº¤äº’æ“ä½œJava å†…å­˜æ¨¡å‹å®šä¹‰äº† 8 ä¸ªæ“ä½œæ¥å®Œæˆä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜çš„äº¤äº’æ“ä½œã€‚ å†…å­˜æ¨¡å‹ä¸‰å¤§ç‰¹æ€§1. åŸå­æ€§ Java å†…å­˜æ¨¡å‹ä¿è¯äº† readã€loadã€useã€assignã€storeã€writeã€lock å’Œ unlock æ“ä½œå…·æœ‰åŸå­æ€§ï¼Œä¾‹å¦‚å¯¹ä¸€ä¸ª int ç±»å‹çš„å˜é‡æ‰§è¡Œ assign èµ‹å€¼æ“ä½œï¼Œè¿™ä¸ªæ“ä½œå°±æ˜¯åŸå­æ€§çš„ã€‚ä½†æ˜¯ Java å†…å­˜æ¨¡å‹å…è®¸è™šæ‹Ÿæœºå°†æ²¡æœ‰è¢« volatile ä¿®é¥°çš„ 64 ä½æ•°æ®ï¼ˆlongï¼Œdoubleï¼‰çš„è¯»å†™æ“ä½œåˆ’åˆ†ä¸ºä¸¤æ¬¡ 32 ä½çš„æ“ä½œæ¥è¿›è¡Œï¼Œå³ loadã€storeã€read å’Œ write æ“ä½œå¯ä»¥ä¸å…·å¤‡åŸå­æ€§ã€‚ æœ‰ä¸€ä¸ªé”™è¯¯è®¤è¯†å°±æ˜¯ï¼Œint ç­‰åŸå­æ€§çš„ç±»å‹åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ä¸ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚å‰é¢çš„çº¿ç¨‹ä¸å®‰å…¨ç¤ºä¾‹ä»£ç ä¸­ï¼Œcnt å±äº int ç±»å‹å˜é‡ï¼Œ1000 ä¸ªçº¿ç¨‹å¯¹å®ƒè¿›è¡Œè‡ªå¢æ“ä½œä¹‹åï¼Œå¾—åˆ°çš„å€¼ä¸º 997 è€Œä¸æ˜¯ 1000ã€‚ ä¸ºäº†æ–¹ä¾¿è®¨è®ºï¼Œå°†å†…å­˜é—´çš„äº¤äº’æ“ä½œç®€åŒ–ä¸º 3 ä¸ªï¼šloadã€assignã€storeã€‚ ä¸‹å›¾æ¼”ç¤ºäº†ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å¯¹ cnt è¿›è¡Œæ“ä½œï¼Œloadã€assignã€store è¿™ä¸€ç³»åˆ—æ“ä½œæ•´ä½“ä¸Šçœ‹ä¸å…·å¤‡åŸå­æ€§ï¼Œé‚£ä¹ˆåœ¨ T1 ä¿®æ”¹ cnt å¹¶ä¸”è¿˜æ²¡æœ‰å°†ä¿®æ”¹åçš„å€¼å†™å…¥ä¸»å†…å­˜ï¼ŒT2 ä¾ç„¶å¯ä»¥è¯»å…¥æ—§å€¼ã€‚å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸¤ä¸ªçº¿ç¨‹è™½ç„¶æ‰§è¡Œäº†ä¸¤æ¬¡è‡ªå¢è¿ç®—ï¼Œä½†æ˜¯ä¸»å†…å­˜ä¸­ cnt çš„å€¼æœ€åä¸º 1 è€Œä¸æ˜¯ 2ã€‚å› æ­¤å¯¹ int ç±»å‹è¯»å†™æ“ä½œæ»¡è¶³åŸå­æ€§åªæ˜¯è¯´æ˜ loadã€assignã€store è¿™äº›å•ä¸ªæ“ä½œå…·å¤‡åŸå­æ€§ã€‚ AtomicInteger èƒ½ä¿è¯å¤šä¸ªçº¿ç¨‹ä¿®æ”¹çš„åŸå­æ€§ã€‚ ä½¿ç”¨ AtomicInteger é‡å†™ä¹‹å‰çº¿ç¨‹ä¸å®‰å…¨çš„ä»£ç ä¹‹åå¾—åˆ°ä»¥ä¸‹çº¿ç¨‹å®‰å…¨å®ç°ï¼š 12345678910111213141516171819202122232425262728public class AtomicExample { private AtomicInteger cnt = new AtomicInteger(); public void add() { cnt.incrementAndGet(); } public int get() { return cnt.get(); }}public static void main(String[] args) throws InterruptedException { final int threadSize = 1000; AtomicExample example = new AtomicExample(); // åªä¿®æ”¹è¿™æ¡è¯­å¥ final CountDownLatch countDownLatch = new CountDownLatch(threadSize); ExecutorService executorService = Executors.newCachedThreadPool(); for (int i = 0; i &lt; threadSize; i++) { executorService.execute(() -&gt; { example.add(); countDownLatch.countDown(); }); } countDownLatch.await(); executorService.shutdown(); System.out.println(example.get());}1000 é™¤äº†ä½¿ç”¨åŸå­ç±»ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ synchronized äº’æ–¥é”æ¥ä¿è¯æ“ä½œçš„åŸå­æ€§ã€‚å®ƒå¯¹åº”çš„å†…å­˜é—´äº¤äº’æ“ä½œä¸ºï¼šlock å’Œ unlockï¼Œåœ¨è™šæ‹Ÿæœºå®ç°ä¸Šå¯¹åº”çš„å­—èŠ‚ç æŒ‡ä»¤ä¸º monitorenter å’Œ monitorexitã€‚ 12345678910111213141516171819202122232425262728public class AtomicSynchronizedExample { private int cnt = 0; public synchronized void add() { cnt++; } public synchronized int get() { return cnt; }}public static void main(String[] args) throws InterruptedException { final int threadSize = 1000; AtomicSynchronizedExample example = new AtomicSynchronizedExample(); final CountDownLatch countDownLatch = new CountDownLatch(threadSize); ExecutorService executorService = Executors.newCachedThreadPool(); for (int i = 0; i &lt; threadSize; i++) { executorService.execute(() -&gt; { example.add(); countDownLatch.countDown(); }); } countDownLatch.await(); executorService.shutdown(); System.out.println(example.get());}1000 2. å¯è§æ€§ å¯è§æ€§æŒ‡å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å…±äº«å˜é‡çš„å€¼ï¼Œå…¶å®ƒçº¿ç¨‹èƒ½å¤Ÿç«‹å³å¾—çŸ¥è¿™ä¸ªä¿®æ”¹ã€‚Java å†…å­˜æ¨¡å‹æ˜¯é€šè¿‡åœ¨å˜é‡ä¿®æ”¹åå°†æ–°å€¼åŒæ­¥å›ä¸»å†…å­˜ï¼Œåœ¨å˜é‡è¯»å–å‰ä»ä¸»å†…å­˜åˆ·æ–°å˜é‡å€¼æ¥å®ç°å¯è§æ€§çš„ã€‚ ä¸»è¦æœ‰ä¸‰ç§å®ç°å¯è§æ€§çš„æ–¹å¼ï¼š volatile synchronizedï¼Œå¯¹ä¸€ä¸ªå˜é‡æ‰§è¡Œ unlock æ“ä½œä¹‹å‰ï¼Œå¿…é¡»æŠŠå˜é‡å€¼åŒæ­¥å›ä¸»å†…å­˜ã€‚ finalï¼Œè¢« final å…³é”®å­—ä¿®é¥°çš„å­—æ®µåœ¨æ„é€ å™¨ä¸­ä¸€æ—¦åˆå§‹åŒ–å®Œæˆï¼Œå¹¶ä¸”æ²¡æœ‰å‘ç”Ÿ this é€ƒé€¸ï¼ˆå…¶å®ƒçº¿ç¨‹é€šè¿‡ this å¼•ç”¨è®¿é—®åˆ°åˆå§‹åŒ–äº†ä¸€åŠçš„å¯¹è±¡ï¼‰ï¼Œé‚£ä¹ˆå…¶å®ƒçº¿ç¨‹å°±èƒ½çœ‹è§ final å­—æ®µçš„å€¼ã€‚ å¯¹å‰é¢çš„çº¿ç¨‹ä¸å®‰å…¨ç¤ºä¾‹ä¸­çš„ cnt å˜é‡ä½¿ç”¨ volatile ä¿®é¥°ï¼Œä¸èƒ½è§£å†³çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜ï¼Œå› ä¸º volatile å¹¶ä¸èƒ½ä¿è¯æ“ä½œçš„åŸå­æ€§ã€‚ 3. æœ‰åºæ€§ æœ‰åºæ€§æ˜¯æŒ‡ï¼šåœ¨æœ¬çº¿ç¨‹å†…è§‚å¯Ÿï¼Œæ‰€æœ‰æ“ä½œéƒ½æ˜¯æœ‰åºçš„ã€‚åœ¨ä¸€ä¸ªçº¿ç¨‹è§‚å¯Ÿå¦ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€æœ‰æ“ä½œéƒ½æ˜¯æ— åºçš„ï¼Œæ— åºæ˜¯å› ä¸ºå‘ç”Ÿäº†æŒ‡ä»¤é‡æ’åºã€‚åœ¨ Java å†…å­˜æ¨¡å‹ä¸­ï¼Œå…è®¸ç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¯¹æŒ‡ä»¤è¿›è¡Œé‡æ’åºï¼Œé‡æ’åºè¿‡ç¨‹ä¸ä¼šå½±å“åˆ°å•çº¿ç¨‹ç¨‹åºçš„æ‰§è¡Œï¼Œå´ä¼šå½±å“åˆ°å¤šçº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„æ­£ç¡®æ€§ã€‚ volatile å…³é”®å­—é€šè¿‡æ·»åŠ å†…å­˜å±éšœçš„æ–¹å¼æ¥ç¦æ­¢æŒ‡ä»¤é‡æ’ï¼Œå³é‡æ’åºæ—¶ä¸èƒ½æŠŠåé¢çš„æŒ‡ä»¤æ”¾åˆ°å†…å­˜å±éšœä¹‹å‰ã€‚ ä¹Ÿå¯ä»¥é€šè¿‡ synchronized æ¥ä¿è¯æœ‰åºæ€§ï¼Œå®ƒä¿è¯æ¯ä¸ªæ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œç›¸å½“äºæ˜¯è®©çº¿ç¨‹é¡ºåºæ‰§è¡ŒåŒæ­¥ä»£ç ã€‚ å…ˆè¡Œå‘ç”ŸåŸåˆ™ä¸Šé¢æåˆ°äº†å¯ä»¥ç”¨ volatile å’Œ synchronized æ¥ä¿è¯æœ‰åºæ€§ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒJVM è¿˜è§„å®šäº†å…ˆè¡Œå‘ç”ŸåŸåˆ™ï¼Œè®©ä¸€ä¸ªæ“ä½œæ— éœ€æ§åˆ¶å°±èƒ½å…ˆäºå¦ä¸€ä¸ªæ“ä½œå®Œæˆã€‚ 1. å•ä¸€çº¿ç¨‹åŸåˆ™ Single Thread rule åœ¨ä¸€ä¸ªçº¿ç¨‹å†…ï¼Œåœ¨ç¨‹åºå‰é¢çš„æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢çš„æ“ä½œã€‚ 2. ç®¡ç¨‹é”å®šè§„åˆ™ Monitor Lock Rule â€‹ ä¸€ä¸ª unlock æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹åŒä¸€ä¸ªé”çš„ lock æ“ä½œã€‚ 3.volatile å˜é‡è§„åˆ™ Volatile Variable Rule å¯¹ä¸€ä¸ª volatile å˜é‡çš„å†™æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹è¿™ä¸ªå˜é‡çš„è¯»æ“ä½œã€‚ 4. çº¿ç¨‹å¯åŠ¨è§„åˆ™ Thread Start Rule Thread å¯¹è±¡çš„ start() æ–¹æ³•è°ƒç”¨å…ˆè¡Œå‘ç”Ÿäºæ­¤çº¿ç¨‹çš„æ¯ä¸€ä¸ªåŠ¨ä½œã€‚ 5. çº¿ç¨‹åŠ å…¥è§„åˆ™ Thread Join Rule Thread å¯¹è±¡çš„ç»“æŸå…ˆè¡Œå‘ç”Ÿäº join() æ–¹æ³•è¿”å›ã€‚ 6. çº¿ç¨‹ä¸­æ–­è§„åˆ™ Thread Interruption Rule å¯¹çº¿ç¨‹ interrupt() æ–¹æ³•çš„è°ƒç”¨å…ˆè¡Œå‘ç”Ÿäºè¢«ä¸­æ–­çº¿ç¨‹çš„ä»£ç æ£€æµ‹åˆ°ä¸­æ–­äº‹ä»¶çš„å‘ç”Ÿï¼Œå¯ä»¥é€šè¿‡ interrupted() æ–¹æ³•æ£€æµ‹åˆ°æ˜¯å¦æœ‰ä¸­æ–­å‘ç”Ÿã€‚ 7. å¯¹è±¡ç»ˆç»“è§„åˆ™ Finalizer Rule ä¸€ä¸ªå¯¹è±¡çš„åˆå§‹åŒ–å®Œæˆï¼ˆæ„é€ å‡½æ•°æ‰§è¡Œç»“æŸï¼‰å…ˆè¡Œå‘ç”Ÿäºå®ƒçš„ finalize() æ–¹æ³•çš„å¼€å§‹ã€‚ 8. ä¼ é€’æ€§ Transitivity å¦‚æœæ“ä½œ A å…ˆè¡Œå‘ç”Ÿäºæ“ä½œ Bï¼Œæ“ä½œ B å…ˆè¡Œå‘ç”Ÿäºæ“ä½œ Cï¼Œé‚£ä¹ˆæ“ä½œ A å…ˆè¡Œå‘ç”Ÿäºæ“ä½œ Cã€‚ çº¿ç¨‹å®‰å…¨å¤šä¸ªçº¿ç¨‹ä¸ç®¡ä»¥ä½•ç§æ–¹å¼è®¿é—®æŸä¸ªç±»ï¼Œå¹¶ä¸”åœ¨ä¸»è°ƒä»£ç ä¸­ä¸éœ€è¦è¿›è¡ŒåŒæ­¥ï¼Œéƒ½èƒ½è¡¨ç°æ­£ç¡®çš„è¡Œä¸ºã€‚ çº¿ç¨‹å®‰å…¨æœ‰ä»¥ä¸‹å‡ ç§å®ç°æ–¹å¼ï¼š ä¸å¯å˜ä¸å¯å˜ï¼ˆImmutableï¼‰çš„å¯¹è±¡ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¸éœ€è¦å†é‡‡å–ä»»ä½•çš„çº¿ç¨‹å®‰å…¨ä¿éšœæªæ–½ã€‚åªè¦ä¸€ä¸ªä¸å¯å˜çš„å¯¹è±¡è¢«æ­£ç¡®åœ°æ„å»ºå‡ºæ¥ï¼Œæ°¸è¿œä¹Ÿä¸ä¼šçœ‹åˆ°å®ƒåœ¨å¤šä¸ªçº¿ç¨‹ä¹‹ä¸­å¤„äºä¸ä¸€è‡´çš„çŠ¶æ€ã€‚å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œåº”å½“å°½é‡ä½¿å¯¹è±¡æˆä¸ºä¸å¯å˜ï¼Œæ¥æ»¡è¶³çº¿ç¨‹å®‰å…¨ã€‚ ä¸å¯å˜çš„ç±»å‹ï¼š final å…³é”®å­—ä¿®é¥°çš„åŸºæœ¬æ•°æ®ç±»å‹ String æšä¸¾ç±»å‹ Number éƒ¨åˆ†å­ç±»ï¼Œå¦‚ Long å’Œ Double ç­‰æ•°å€¼åŒ…è£…ç±»å‹ï¼ŒBigInteger å’Œ BigDecimal ç­‰å¤§æ•°æ®ç±»å‹ã€‚ä½†åŒä¸º Number çš„åŸå­ç±» AtomicInteger å’Œ AtomicLong åˆ™æ˜¯å¯å˜çš„ã€‚ å¯¹äºé›†åˆç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨ Collections.unmodifiableXXX() æ–¹æ³•æ¥è·å–ä¸€ä¸ªä¸å¯å˜çš„é›†åˆã€‚ 12345678910public class ImmutableExample { public static void main(String[] args) { Map&lt;String, Integer&gt; map = new HashMap&lt;&gt;(); Map&lt;String, Integer&gt; unmodifiableMap = Collections.unmodifiableMap(map); unmodifiableMap.put(\"a\", 1); }}Exception in thread \"main\" java.lang.UnsupportedOperationException at java.util.Collections$UnmodifiableMap.put(Collections.java:1457) at ImmutableExample.main(ImmutableExample.java:9) Collections.unmodifiableXXX() å…ˆå¯¹åŸå§‹çš„é›†åˆè¿›è¡Œæ‹·è´ï¼Œéœ€è¦å¯¹é›†åˆè¿›è¡Œä¿®æ”¹çš„æ–¹æ³•éƒ½ç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚ 123public V put(K key, V value) { throw new UnsupportedOperationException();} äº’æ–¥åŒæ­¥synchronized å’Œ ReentrantLockã€‚ éé˜»å¡åŒæ­¥äº’æ–¥åŒæ­¥æœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯çº¿ç¨‹é˜»å¡å’Œå”¤é†’æ‰€å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ï¼Œå› æ­¤è¿™ç§åŒæ­¥ä¹Ÿç§°ä¸ºé˜»å¡åŒæ­¥ã€‚ äº’æ–¥åŒæ­¥å±äºä¸€ç§æ‚²è§‚çš„å¹¶å‘ç­–ç•¥ï¼Œæ€»æ˜¯è®¤ä¸ºåªè¦ä¸å»åšæ­£ç¡®çš„åŒæ­¥æªæ–½ï¼Œé‚£å°±è‚¯å®šä¼šå‡ºç°é—®é¢˜ã€‚æ— è®ºå…±äº«æ•°æ®æ˜¯å¦çœŸçš„ä¼šå‡ºç°ç«äº‰ï¼Œå®ƒéƒ½è¦è¿›è¡ŒåŠ é”ï¼ˆè¿™é‡Œè®¨è®ºçš„æ˜¯æ¦‚å¿µæ¨¡å‹ï¼Œå®é™…ä¸Šè™šæ‹Ÿæœºä¼šä¼˜åŒ–æ‰å¾ˆå¤§ä¸€éƒ¨åˆ†ä¸å¿…è¦çš„åŠ é”ï¼‰ã€ç”¨æˆ·æ€æ ¸å¿ƒæ€è½¬æ¢ã€ç»´æŠ¤é”è®¡æ•°å™¨å’Œæ£€æŸ¥æ˜¯å¦æœ‰è¢«é˜»å¡çš„çº¿ç¨‹éœ€è¦å”¤é†’ç­‰æ“ä½œã€‚ 1. CAS éšç€ç¡¬ä»¶æŒ‡ä»¤é›†çš„å‘å±•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŸºäºå†²çªæ£€æµ‹çš„ä¹è§‚å¹¶å‘ç­–ç•¥ï¼šå…ˆè¿›è¡Œæ“ä½œï¼Œå¦‚æœæ²¡æœ‰å…¶å®ƒçº¿ç¨‹äº‰ç”¨å…±äº«æ•°æ®ï¼Œé‚£æ“ä½œå°±æˆåŠŸäº†ï¼Œå¦åˆ™é‡‡å–è¡¥å¿æªæ–½ï¼ˆä¸æ–­åœ°é‡è¯•ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ï¼‰ã€‚è¿™ç§ä¹è§‚çš„å¹¶å‘ç­–ç•¥çš„è®¸å¤šå®ç°éƒ½ä¸éœ€è¦å°†çº¿ç¨‹é˜»å¡ï¼Œå› æ­¤è¿™ç§åŒæ­¥æ“ä½œç§°ä¸ºéé˜»å¡åŒæ­¥ã€‚ ä¹è§‚é”éœ€è¦æ“ä½œå’Œå†²çªæ£€æµ‹è¿™ä¸¤ä¸ªæ­¥éª¤å…·å¤‡åŸå­æ€§ï¼Œè¿™é‡Œå°±ä¸èƒ½å†ä½¿ç”¨äº’æ–¥åŒæ­¥æ¥ä¿è¯äº†ï¼Œåªèƒ½é ç¡¬ä»¶æ¥å®Œæˆã€‚ç¡¬ä»¶æ”¯æŒçš„åŸå­æ€§æ“ä½œæœ€å…¸å‹çš„æ˜¯ï¼šæ¯”è¾ƒå¹¶äº¤æ¢ï¼ˆCompare-and-Swapï¼ŒCASï¼‰ã€‚CAS æŒ‡ä»¤éœ€è¦æœ‰ 3 ä¸ªæ“ä½œæ•°ï¼Œåˆ†åˆ«æ˜¯å†…å­˜åœ°å€ Vã€æ—§çš„é¢„æœŸå€¼ A å’Œæ–°å€¼ Bã€‚å½“æ‰§è¡Œæ“ä½œæ—¶ï¼Œåªæœ‰å½“ V çš„å€¼ç­‰äº Aï¼Œæ‰å°† V çš„å€¼æ›´æ–°ä¸º Bã€‚ 2. AtomicInteger J.U.C åŒ…é‡Œé¢çš„æ•´æ•°åŸå­ç±» AtomicInteger çš„æ–¹æ³•è°ƒç”¨äº† Unsafe ç±»çš„ CAS æ“ä½œã€‚ ä»¥ä¸‹ä»£ç ä½¿ç”¨äº† AtomicInteger æ‰§è¡Œäº†è‡ªå¢çš„æ“ä½œã€‚ 12345private AtomicInteger cnt = new AtomicInteger();public void add() { cnt.incrementAndGet();} ä»¥ä¸‹ä»£ç æ˜¯ incrementAndGet() çš„æºç ï¼Œå®ƒè°ƒç”¨äº† Unsafe çš„ getAndAddInt() ã€‚ 123public final int incrementAndGet() { return unsafe.getAndAddInt(this, valueOffset, 1) + 1;} ä»¥ä¸‹ä»£ç æ˜¯ getAndAddInt() æºç ï¼Œvar1 æŒ‡ç¤ºå¯¹è±¡å†…å­˜åœ°å€ï¼Œvar2 æŒ‡ç¤ºè¯¥å­—æ®µç›¸å¯¹å¯¹è±¡å†…å­˜åœ°å€çš„åç§»ï¼Œvar4 æŒ‡ç¤ºæ“ä½œéœ€è¦åŠ çš„æ•°å€¼ï¼Œè¿™é‡Œä¸º 1ã€‚é€šè¿‡ getIntVolatile(var1, var2) å¾—åˆ°æ—§çš„é¢„æœŸå€¼ï¼Œé€šè¿‡è°ƒç”¨ compareAndSwapInt() æ¥è¿›è¡Œ CAS æ¯”è¾ƒï¼Œå¦‚æœè¯¥å­—æ®µå†…å­˜åœ°å€ä¸­çš„å€¼ç­‰äº var5ï¼Œé‚£ä¹ˆå°±æ›´æ–°å†…å­˜åœ°å€ä¸º var1+var2 çš„å˜é‡ä¸º var5+var4ã€‚ å¯ä»¥çœ‹åˆ° getAndAddInt() åœ¨ä¸€ä¸ªå¾ªç¯ä¸­è¿›è¡Œï¼Œå‘ç”Ÿå†²çªçš„åšæ³•æ˜¯ä¸æ–­çš„è¿›è¡Œé‡è¯•ã€‚ 12345678public final int getAndAddInt(Object var1, long var2, int var4) { int var5; do { var5 = this.getIntVolatile(var1, var2); } while(!this.compareAndSwapInt(var1, var2, var5, var5 + var4)); return var5;} 3. ABA å¦‚æœä¸€ä¸ªå˜é‡åˆæ¬¡è¯»å–çš„æ—¶å€™æ˜¯ A å€¼ï¼Œå®ƒçš„å€¼è¢«æ”¹æˆäº† Bï¼Œåæ¥åˆè¢«æ”¹å›ä¸º Aï¼Œé‚£ CAS æ“ä½œå°±ä¼šè¯¯è®¤ä¸ºå®ƒä»æ¥æ²¡æœ‰è¢«æ”¹å˜è¿‡ã€‚ J.U.C åŒ…æä¾›äº†ä¸€ä¸ªå¸¦æœ‰æ ‡è®°çš„åŸå­å¼•ç”¨ç±» AtomicStampedReference æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒå¯ä»¥é€šè¿‡æ§åˆ¶å˜é‡å€¼çš„ç‰ˆæœ¬æ¥ä¿è¯ CAS çš„æ­£ç¡®æ€§ã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹ ABA é—®é¢˜ä¸ä¼šå½±å“ç¨‹åºå¹¶å‘çš„æ­£ç¡®æ€§ï¼Œå¦‚æœéœ€è¦è§£å†³ ABA é—®é¢˜ï¼Œæ”¹ç”¨ä¼ ç»Ÿçš„äº’æ–¥åŒæ­¥å¯èƒ½ä¼šæ¯”åŸå­ç±»æ›´é«˜æ•ˆã€‚ æ— åŒæ­¥æ–¹æ¡ˆè¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸æ˜¯ä¸€å®šå°±è¦è¿›è¡ŒåŒæ­¥ã€‚å¦‚æœä¸€ä¸ªæ–¹æ³•æœ¬æ¥å°±ä¸æ¶‰åŠå…±äº«æ•°æ®ï¼Œé‚£å®ƒè‡ªç„¶å°±æ— é¡»ä»»ä½•åŒæ­¥æªæ–½å»ä¿è¯æ­£ç¡®æ€§ã€‚ 1. æ ˆå°é—­ å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªæ–¹æ³•çš„å±€éƒ¨å˜é‡æ—¶ï¼Œä¸ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œå› ä¸ºå±€éƒ¨å˜é‡å­˜å‚¨åœ¨è™šæ‹Ÿæœºæ ˆä¸­ï¼Œå±äºçº¿ç¨‹ç§æœ‰çš„ã€‚ 123456789101112131415161718public class StackClosedExample { public void add100() { int cnt = 0; for (int i = 0; i &lt; 100; i++) { cnt++; } System.out.println(cnt); }}public static void main(String[] args) { StackClosedExample example = new StackClosedExample(); ExecutorService executorService = Executors.newCachedThreadPool(); executorService.execute(() -&gt; example.add100()); executorService.execute(() -&gt; example.add100()); executorService.shutdown();}100100 2. çº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼ˆThread Local Storageï¼‰ å¦‚æœä¸€æ®µä»£ç ä¸­æ‰€éœ€è¦çš„æ•°æ®å¿…é¡»ä¸å…¶ä»–ä»£ç å…±äº«ï¼Œé‚£å°±çœ‹çœ‹è¿™äº›å…±äº«æ•°æ®çš„ä»£ç æ˜¯å¦èƒ½ä¿è¯åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œã€‚å¦‚æœèƒ½ä¿è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå…±äº«æ•°æ®çš„å¯è§èŒƒå›´é™åˆ¶åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¹‹å†…ï¼Œè¿™æ ·ï¼Œæ— é¡»åŒæ­¥ä¹Ÿèƒ½ä¿è¯çº¿ç¨‹ä¹‹é—´ä¸å‡ºç°æ•°æ®äº‰ç”¨çš„é—®é¢˜ã€‚ ç¬¦åˆè¿™ç§ç‰¹ç‚¹çš„åº”ç”¨å¹¶ä¸å°‘è§ï¼Œå¤§éƒ¨åˆ†ä½¿ç”¨æ¶ˆè´¹é˜Ÿåˆ—çš„æ¶æ„æ¨¡å¼ï¼ˆå¦‚â€œç”Ÿäº§è€…-æ¶ˆè´¹è€…â€æ¨¡å¼ï¼‰éƒ½ä¼šå°†äº§å“çš„æ¶ˆè´¹è¿‡ç¨‹å°½é‡åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ¶ˆè´¹å®Œã€‚å…¶ä¸­æœ€é‡è¦çš„ä¸€ä¸ªåº”ç”¨å®ä¾‹å°±æ˜¯ç»å…¸ Web äº¤äº’æ¨¡å‹ä¸­çš„â€œä¸€ä¸ªè¯·æ±‚å¯¹åº”ä¸€ä¸ªæœåŠ¡å™¨çº¿ç¨‹â€ï¼ˆThread-per-Requestï¼‰çš„å¤„ç†æ–¹å¼ï¼Œè¿™ç§å¤„ç†æ–¹å¼çš„å¹¿æ³›åº”ç”¨ä½¿å¾—å¾ˆå¤š Web æœåŠ¡ç«¯åº”ç”¨éƒ½å¯ä»¥ä½¿ç”¨çº¿ç¨‹æœ¬åœ°å­˜å‚¨æ¥è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚ å¯ä»¥ä½¿ç”¨ java.lang.ThreadLocal ç±»æ¥å®ç°çº¿ç¨‹æœ¬åœ°å­˜å‚¨åŠŸèƒ½ã€‚ å¯¹äºä»¥ä¸‹ä»£ç ï¼Œthread1 ä¸­è®¾ç½® threadLocal ä¸º 1ï¼Œè€Œ thread2 è®¾ç½® threadLocal ä¸º 2ã€‚è¿‡äº†ä¸€æ®µæ—¶é—´ä¹‹åï¼Œthread1 è¯»å– threadLocal ä¾ç„¶æ˜¯ 1ï¼Œä¸å— thread2 çš„å½±å“ã€‚ 12345678910111213141516171819202122public class ThreadLocalExample { public static void main(String[] args) { ThreadLocal threadLocal = new ThreadLocal(); Thread thread1 = new Thread(() -&gt; { threadLocal.set(1); try { Thread.sleep(1000); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(threadLocal.get()); threadLocal.remove(); }); Thread thread2 = new Thread(() -&gt; { threadLocal.set(2); threadLocal.remove(); }); thread1.start(); thread2.start(); }}1 ä¸ºäº†ç†è§£ ThreadLocalï¼Œå…ˆçœ‹ä»¥ä¸‹ä»£ç ï¼š 12345678910111213141516public class ThreadLocalExample1 { public static void main(String[] args) { ThreadLocal threadLocal1 = new ThreadLocal(); ThreadLocal threadLocal2 = new ThreadLocal(); Thread thread1 = new Thread(() -&gt; { threadLocal1.set(1); threadLocal2.set(1); }); Thread thread2 = new Thread(() -&gt; { threadLocal1.set(2); threadLocal2.set(2); }); thread1.start(); thread2.start(); }} å®ƒæ‰€å¯¹åº”çš„åº•å±‚ç»“æ„å›¾ä¸ºï¼š æ¯ä¸ª Thread éƒ½æœ‰ä¸€ä¸ª ThreadLocal.ThreadLocalMap å¯¹è±¡ã€‚ 123/* ThreadLocal values pertaining to this thread. This map is maintained * by the ThreadLocal class. */ThreadLocal.ThreadLocalMap threadLocals = null; å½“è°ƒç”¨ä¸€ä¸ª ThreadLocal çš„ set(T value) æ–¹æ³•æ—¶ï¼Œå…ˆå¾—åˆ°å½“å‰çº¿ç¨‹çš„ ThreadLocalMap å¯¹è±¡ï¼Œç„¶åå°† ThreadLocal-&gt;value é”®å€¼å¯¹æ’å…¥åˆ°è¯¥ Map ä¸­ã€‚ 12345678public void set(T value) { Thread t = Thread.currentThread(); ThreadLocalMap map = getMap(t); if (map != null) map.set(this, value); else createMap(t, value);} get() æ–¹æ³•ç±»ä¼¼ã€‚ 12345678910111213public T get() { Thread t = Thread.currentThread(); ThreadLocalMap map = getMap(t); if (map != null) { ThreadLocalMap.Entry e = map.getEntry(this); if (e != null) { @SuppressWarnings(\"unchecked\") T result = (T)e.value; return result; } } return setInitialValue();} ThreadLocal ä»ç†è®ºä¸Šè®²å¹¶ä¸æ˜¯ç”¨æ¥è§£å†³å¤šçº¿ç¨‹å¹¶å‘é—®é¢˜çš„ï¼Œå› ä¸ºæ ¹æœ¬ä¸å­˜åœ¨å¤šçº¿ç¨‹ç«äº‰ã€‚ åœ¨ä¸€äº›åœºæ™¯ (å°¤å…¶æ˜¯ä½¿ç”¨çº¿ç¨‹æ± ) ä¸‹ï¼Œç”±äº ThreadLocal.ThreadLocalMap çš„åº•å±‚æ•°æ®ç»“æ„å¯¼è‡´ ThreadLocal æœ‰å†…å­˜æ³„æ¼çš„æƒ…å†µï¼Œåº”è¯¥å°½å¯èƒ½åœ¨æ¯æ¬¡ä½¿ç”¨ ThreadLocal åæ‰‹åŠ¨è°ƒç”¨ remove()ï¼Œä»¥é¿å…å‡ºç° ThreadLocal ç»å…¸çš„å†…å­˜æ³„æ¼ç”šè‡³æ˜¯é€ æˆè‡ªèº«ä¸šåŠ¡æ··ä¹±çš„é£é™©ã€‚ 3. å¯é‡å…¥ä»£ç ï¼ˆReentrant Codeï¼‰ è¿™ç§ä»£ç ä¹Ÿå«åšçº¯ä»£ç ï¼ˆPure Codeï¼‰ï¼Œå¯ä»¥åœ¨ä»£ç æ‰§è¡Œçš„ä»»ä½•æ—¶åˆ»ä¸­æ–­å®ƒï¼Œè½¬è€Œå»æ‰§è¡Œå¦å¤–ä¸€æ®µä»£ç ï¼ˆåŒ…æ‹¬é€’å½’è°ƒç”¨å®ƒæœ¬èº«ï¼‰ï¼Œè€Œåœ¨æ§åˆ¶æƒè¿”å›åï¼ŒåŸæ¥çš„ç¨‹åºä¸ä¼šå‡ºç°ä»»ä½•é”™è¯¯ã€‚ å¯é‡å…¥ä»£ç æœ‰ä¸€äº›å…±åŒçš„ç‰¹å¾ï¼Œä¾‹å¦‚ä¸ä¾èµ–å­˜å‚¨åœ¨å †ä¸Šçš„æ•°æ®å’Œå…¬ç”¨çš„ç³»ç»Ÿèµ„æºã€ç”¨åˆ°çš„çŠ¶æ€é‡éƒ½ç”±å‚æ•°ä¸­ä¼ å…¥ã€ä¸è°ƒç”¨éå¯é‡å…¥çš„æ–¹æ³•ç­‰ã€‚ é”ä¼˜åŒ–è¿™é‡Œçš„é”ä¼˜åŒ–ä¸»è¦æ˜¯æŒ‡ JVM å¯¹ synchronized çš„ä¼˜åŒ–ã€‚ è‡ªæ—‹é”äº’æ–¥åŒæ­¥è¿›å…¥é˜»å¡çŠ¶æ€çš„å¼€é”€éƒ½å¾ˆå¤§ï¼Œåº”è¯¥å°½é‡é¿å…ã€‚åœ¨è®¸å¤šåº”ç”¨ä¸­ï¼Œå…±äº«æ•°æ®çš„é”å®šçŠ¶æ€åªä¼šæŒç»­å¾ˆçŸ­çš„ä¸€æ®µæ—¶é—´ã€‚è‡ªæ—‹é”çš„æ€æƒ³æ˜¯è®©ä¸€ä¸ªçº¿ç¨‹åœ¨è¯·æ±‚ä¸€ä¸ªå…±äº«æ•°æ®çš„é”æ—¶æ‰§è¡Œå¿™å¾ªç¯ï¼ˆè‡ªæ—‹ï¼‰ä¸€æ®µæ—¶é—´ï¼Œå¦‚æœåœ¨è¿™æ®µæ—¶é—´å†…èƒ½è·å¾—é”ï¼Œå°±å¯ä»¥é¿å…è¿›å…¥é˜»å¡çŠ¶æ€ã€‚ è‡ªæ—‹é”è™½ç„¶èƒ½é¿å…è¿›å…¥é˜»å¡çŠ¶æ€ä»è€Œå‡å°‘å¼€é”€ï¼Œä½†æ˜¯å®ƒéœ€è¦è¿›è¡Œå¿™å¾ªç¯æ“ä½œå ç”¨ CPU æ—¶é—´ï¼Œå®ƒåªé€‚ç”¨äºå…±äº«æ•°æ®çš„é”å®šçŠ¶æ€å¾ˆçŸ­çš„åœºæ™¯ã€‚ åœ¨ JDK 1.6 ä¸­å¼•å…¥äº†è‡ªé€‚åº”çš„è‡ªæ—‹é”ã€‚è‡ªé€‚åº”æ„å‘³ç€è‡ªæ—‹çš„æ¬¡æ•°ä¸å†å›ºå®šäº†ï¼Œè€Œæ˜¯ç”±å‰ä¸€æ¬¡åœ¨åŒä¸€ä¸ªé”ä¸Šçš„è‡ªæ—‹æ¬¡æ•°åŠé”çš„æ‹¥æœ‰è€…çš„çŠ¶æ€æ¥å†³å®šã€‚ é”æ¶ˆé™¤é”æ¶ˆé™¤æ˜¯æŒ‡å¯¹äºè¢«æ£€æµ‹å‡ºä¸å¯èƒ½å­˜åœ¨ç«äº‰çš„å…±äº«æ•°æ®çš„é”è¿›è¡Œæ¶ˆé™¤ã€‚ é”æ¶ˆé™¤ä¸»è¦æ˜¯é€šè¿‡é€ƒé€¸åˆ†ææ¥æ”¯æŒï¼Œå¦‚æœå †ä¸Šçš„å…±äº«æ•°æ®ä¸å¯èƒ½é€ƒé€¸å‡ºå»è¢«å…¶å®ƒçº¿ç¨‹è®¿é—®åˆ°ï¼Œé‚£ä¹ˆå°±å¯ä»¥æŠŠå®ƒä»¬å½“æˆç§æœ‰æ•°æ®å¯¹å¾…ï¼Œä¹Ÿå°±å¯ä»¥å°†å®ƒä»¬çš„é”è¿›è¡Œæ¶ˆé™¤ã€‚ å¯¹äºä¸€äº›çœ‹èµ·æ¥æ²¡æœ‰åŠ é”çš„ä»£ç ï¼Œå…¶å®éšå¼çš„åŠ äº†å¾ˆå¤šé”ã€‚ä¾‹å¦‚ä¸‹é¢çš„å­—ç¬¦ä¸²æ‹¼æ¥ä»£ç å°±éšå¼åŠ äº†é”ï¼š 123public static String concatString(String s1, String s2, String s3) { return s1 + s2 + s3;} String æ˜¯ä¸€ä¸ªä¸å¯å˜çš„ç±»ï¼Œç¼–è¯‘å™¨ä¼šå¯¹ String çš„æ‹¼æ¥è‡ªåŠ¨ä¼˜åŒ–ã€‚åœ¨ JDK 1.5 ä¹‹å‰ï¼Œä¼šè½¬åŒ–ä¸º StringBuffer å¯¹è±¡çš„è¿ç»­ append() æ“ä½œï¼š 1234567public static String concatString(String s1, String s2, String s3) { StringBuffer sb = new StringBuffer(); sb.append(s1); sb.append(s2); sb.append(s3); return sb.toString();} æ¯ä¸ª append() æ–¹æ³•ä¸­éƒ½æœ‰ä¸€ä¸ªåŒæ­¥å—ã€‚è™šæ‹Ÿæœºè§‚å¯Ÿå˜é‡ sbï¼Œå¾ˆå¿«å°±ä¼šå‘ç°å®ƒçš„åŠ¨æ€ä½œç”¨åŸŸè¢«é™åˆ¶åœ¨ concatString() æ–¹æ³•å†…éƒ¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œsb çš„æ‰€æœ‰å¼•ç”¨æ°¸è¿œä¸ä¼šé€ƒé€¸åˆ° concatString() æ–¹æ³•ä¹‹å¤–ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è®¿é—®åˆ°å®ƒï¼Œå› æ­¤å¯ä»¥è¿›è¡Œæ¶ˆé™¤ã€‚ é”ç²—åŒ–å¦‚æœä¸€ç³»åˆ—çš„è¿ç»­æ“ä½œéƒ½å¯¹åŒä¸€ä¸ªå¯¹è±¡åå¤åŠ é”å’Œè§£é”ï¼Œé¢‘ç¹çš„åŠ é”æ“ä½œå°±ä¼šå¯¼è‡´æ€§èƒ½æŸè€—ã€‚ ä¸Šä¸€èŠ‚çš„ç¤ºä¾‹ä»£ç ä¸­è¿ç»­çš„ append() æ–¹æ³•å°±å±äºè¿™ç±»æƒ…å†µã€‚å¦‚æœè™šæ‹Ÿæœºæ¢æµ‹åˆ°ç”±è¿™æ ·çš„ä¸€ä¸²é›¶ç¢çš„æ“ä½œéƒ½å¯¹åŒä¸€ä¸ªå¯¹è±¡åŠ é”ï¼Œå°†ä¼šæŠŠåŠ é”çš„èŒƒå›´æ‰©å±•ï¼ˆç²—åŒ–ï¼‰åˆ°æ•´ä¸ªæ“ä½œåºåˆ—çš„å¤–éƒ¨ã€‚å¯¹äºä¸Šä¸€èŠ‚çš„ç¤ºä¾‹ä»£ç å°±æ˜¯æ‰©å±•åˆ°ç¬¬ä¸€ä¸ª append() æ“ä½œä¹‹å‰ç›´è‡³æœ€åä¸€ä¸ª append() æ“ä½œä¹‹åï¼Œè¿™æ ·åªéœ€è¦åŠ é”ä¸€æ¬¡å°±å¯ä»¥äº†ã€‚ è½»é‡çº§é”JDK 1.6 å¼•å…¥äº†åå‘é”å’Œè½»é‡çº§é”ï¼Œä»è€Œè®©é”æ‹¥æœ‰äº†å››ä¸ªçŠ¶æ€ï¼šæ— é”çŠ¶æ€ï¼ˆunlockedï¼‰ã€åå‘é”çŠ¶æ€ï¼ˆbiasbleï¼‰ã€è½»é‡çº§é”çŠ¶æ€ï¼ˆlightweight lockedï¼‰å’Œé‡é‡çº§é”çŠ¶æ€ï¼ˆinflatedï¼‰ã€‚ ä»¥ä¸‹æ˜¯ HotSpot è™šæ‹Ÿæœºå¯¹è±¡å¤´çš„å†…å­˜å¸ƒå±€ï¼Œè¿™äº›æ•°æ®è¢«ç§°ä¸º Mark Wordã€‚å…¶ä¸­ tag bits å¯¹åº”äº†äº”ä¸ªçŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€åœ¨å³ä¾§çš„ state è¡¨æ ¼ä¸­ç»™å‡ºã€‚é™¤äº† marked for gc çŠ¶æ€ï¼Œå…¶å®ƒå››ä¸ªçŠ¶æ€å·²ç»åœ¨å‰é¢ä»‹ç»è¿‡äº†ã€‚ ä¸‹å›¾å·¦ä¾§æ˜¯ä¸€ä¸ªçº¿ç¨‹çš„è™šæ‹Ÿæœºæ ˆï¼Œå…¶ä¸­æœ‰ä¸€éƒ¨åˆ†ç§°ä¸º Lock Record çš„åŒºåŸŸï¼Œè¿™æ˜¯åœ¨è½»é‡çº§é”è¿è¡Œè¿‡ç¨‹åˆ›å»ºçš„ï¼Œç”¨äºå­˜æ”¾é”å¯¹è±¡çš„ Mark Wordã€‚è€Œå³ä¾§å°±æ˜¯ä¸€ä¸ªé”å¯¹è±¡ï¼ŒåŒ…å«äº† Mark Word å’Œå…¶å®ƒä¿¡æ¯ã€‚ è½»é‡çº§é”æ˜¯ç›¸å¯¹äºä¼ ç»Ÿçš„é‡é‡çº§é”è€Œè¨€ï¼Œå®ƒä½¿ç”¨ CAS æ“ä½œæ¥é¿å…é‡é‡çº§é”ä½¿ç”¨äº’æ–¥é‡çš„å¼€é”€ã€‚å¯¹äºç»å¤§éƒ¨åˆ†çš„é”ï¼Œåœ¨æ•´ä¸ªåŒæ­¥å‘¨æœŸå†…éƒ½æ˜¯ä¸å­˜åœ¨ç«äº‰çš„ï¼Œå› æ­¤ä¹Ÿå°±ä¸éœ€è¦éƒ½ä½¿ç”¨äº’æ–¥é‡è¿›è¡ŒåŒæ­¥ï¼Œå¯ä»¥å…ˆé‡‡ç”¨ CAS æ“ä½œè¿›è¡ŒåŒæ­¥ï¼Œå¦‚æœ CAS å¤±è´¥äº†å†æ”¹ç”¨äº’æ–¥é‡è¿›è¡ŒåŒæ­¥ã€‚ å½“å°è¯•è·å–ä¸€ä¸ªé”å¯¹è±¡æ—¶ï¼Œå¦‚æœé”å¯¹è±¡æ ‡è®°ä¸º 0 01ï¼Œè¯´æ˜é”å¯¹è±¡çš„é”æœªé”å®šï¼ˆunlockedï¼‰çŠ¶æ€ã€‚æ­¤æ—¶è™šæ‹Ÿæœºåœ¨å½“å‰çº¿ç¨‹çš„è™šæ‹Ÿæœºæ ˆä¸­åˆ›å»º Lock Recordï¼Œç„¶åä½¿ç”¨ CAS æ“ä½œå°†å¯¹è±¡çš„ Mark Word æ›´æ–°ä¸º Lock Record æŒ‡é’ˆã€‚å¦‚æœ CAS æ“ä½œæˆåŠŸäº†ï¼Œé‚£ä¹ˆçº¿ç¨‹å°±è·å–äº†è¯¥å¯¹è±¡ä¸Šçš„é”ï¼Œå¹¶ä¸”å¯¹è±¡çš„ Mark Word çš„é”æ ‡è®°å˜ä¸º 00ï¼Œè¡¨ç¤ºè¯¥å¯¹è±¡å¤„äºè½»é‡çº§é”çŠ¶æ€ã€‚ å¦‚æœ CAS æ“ä½œå¤±è´¥äº†ï¼Œè™šæ‹Ÿæœºé¦–å…ˆä¼šæ£€æŸ¥å¯¹è±¡çš„ Mark Word æ˜¯å¦æŒ‡å‘å½“å‰çº¿ç¨‹çš„è™šæ‹Ÿæœºæ ˆï¼Œå¦‚æœæ˜¯çš„è¯è¯´æ˜å½“å‰çº¿ç¨‹å·²ç»æ‹¥æœ‰äº†è¿™ä¸ªé”å¯¹è±¡ï¼Œé‚£å°±å¯ä»¥ç›´æ¥è¿›å…¥åŒæ­¥å—ç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™è¯´æ˜è¿™ä¸ªé”å¯¹è±¡å·²ç»è¢«å…¶ä»–çº¿ç¨‹çº¿ç¨‹æŠ¢å äº†ã€‚å¦‚æœæœ‰ä¸¤æ¡ä»¥ä¸Šçš„çº¿ç¨‹äº‰ç”¨åŒä¸€ä¸ªé”ï¼Œé‚£è½»é‡çº§é”å°±ä¸å†æœ‰æ•ˆï¼Œè¦è†¨èƒ€ä¸ºé‡é‡çº§é”ã€‚ åå‘é”åå‘é”çš„æ€æƒ³æ˜¯åå‘äºè®©ç¬¬ä¸€ä¸ªè·å–é”å¯¹è±¡çš„çº¿ç¨‹ï¼Œè¿™ä¸ªçº¿ç¨‹åœ¨ä¹‹åè·å–è¯¥é”å°±ä¸å†éœ€è¦è¿›è¡ŒåŒæ­¥æ“ä½œï¼Œç”šè‡³è¿ CAS æ“ä½œä¹Ÿä¸å†éœ€è¦ã€‚ å½“é”å¯¹è±¡ç¬¬ä¸€æ¬¡è¢«çº¿ç¨‹è·å¾—çš„æ—¶å€™ï¼Œè¿›å…¥åå‘çŠ¶æ€ï¼Œæ ‡è®°ä¸º 1 01ã€‚åŒæ—¶ä½¿ç”¨ CAS æ“ä½œå°†çº¿ç¨‹ ID è®°å½•åˆ° Mark Word ä¸­ï¼Œå¦‚æœ CAS æ“ä½œæˆåŠŸï¼Œè¿™ä¸ªçº¿ç¨‹ä»¥åæ¯æ¬¡è¿›å…¥è¿™ä¸ªé”ç›¸å…³çš„åŒæ­¥å—å°±ä¸éœ€è¦å†è¿›è¡Œä»»ä½•åŒæ­¥æ“ä½œã€‚ å½“æœ‰å¦å¤–ä¸€ä¸ªçº¿ç¨‹å»å°è¯•è·å–è¿™ä¸ªé”å¯¹è±¡æ—¶ï¼Œåå‘çŠ¶æ€å°±å®£å‘Šç»“æŸï¼Œæ­¤æ—¶æ’¤é”€åå‘ï¼ˆRevoke Biasï¼‰åæ¢å¤åˆ°æœªé”å®šçŠ¶æ€æˆ–è€…è½»é‡çº§é”çŠ¶æ€ã€‚ å¤šçº¿ç¨‹å¼€å‘è‰¯å¥½çš„å®è·µ ç»™çº¿ç¨‹èµ·ä¸ªæœ‰æ„ä¹‰çš„åå­—ï¼Œè¿™æ ·å¯ä»¥æ–¹ä¾¿æ‰¾ Bugã€‚ ç¼©å°åŒæ­¥èŒƒå›´ï¼Œä»è€Œå‡å°‘é”äº‰ç”¨ã€‚ä¾‹å¦‚å¯¹äº synchronizedï¼Œåº”è¯¥å°½é‡ä½¿ç”¨åŒæ­¥å—è€Œä¸æ˜¯åŒæ­¥æ–¹æ³•ã€‚ å¤šç”¨åŒæ­¥å·¥å…·å°‘ç”¨ wait() å’Œ notify()ã€‚é¦–å…ˆï¼ŒCountDownLatch, CyclicBarrier, Semaphore å’Œ Exchanger è¿™äº›åŒæ­¥ç±»ç®€åŒ–äº†ç¼–ç æ“ä½œï¼Œè€Œç”¨ wait() å’Œ notify() å¾ˆéš¾å®ç°å¤æ‚æ§åˆ¶æµï¼›å…¶æ¬¡ï¼Œè¿™äº›åŒæ­¥ç±»æ˜¯ç”±æœ€å¥½çš„ä¼ä¸šç¼–å†™å’Œç»´æŠ¤ï¼Œåœ¨åç»­çš„ JDK ä¸­è¿˜ä¼šä¸æ–­ä¼˜åŒ–å’Œå®Œå–„ã€‚ ä½¿ç”¨ BlockingQueue å®ç°ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜ã€‚ å¤šç”¨å¹¶å‘é›†åˆå°‘ç”¨åŒæ­¥é›†åˆï¼Œä¾‹å¦‚åº”è¯¥ä½¿ç”¨ ConcurrentHashMap è€Œä¸æ˜¯ Hashtableã€‚ ä½¿ç”¨æœ¬åœ°å˜é‡å’Œä¸å¯å˜ç±»æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚ ä½¿ç”¨çº¿ç¨‹æ± è€Œä¸æ˜¯ç›´æ¥åˆ›å»ºçº¿ç¨‹ï¼Œè¿™æ˜¯å› ä¸ºåˆ›å»ºçº¿ç¨‹ä»£ä»·å¾ˆé«˜ï¼Œçº¿ç¨‹æ± å¯ä»¥æœ‰æ•ˆåœ°åˆ©ç”¨æœ‰é™çš„çº¿ç¨‹æ¥å¯åŠ¨ä»»åŠ¡ã€‚ å‚è€ƒè‡ªæ¥æºæ„Ÿè°¢ä½œè€…çš„è¾›å‹¤æ•´ç†ï¼Œè½¬è½½æ”¶è—ï¼Œå¦‚æœ‰ä¾µæƒï¼Œè¯·è¯„è®ºè¯´æ˜ï¼Œç«‹å³å¤„ç†ã€‚","link":"/2019/08/07/Javaå¹¶å‘ç›¸å…³çŸ¥è¯†ç‚¹.html"},{"title":"Java åƒåœ¾å›æ”¶","text":"æ‘˜è¦ä¹‹å‰ä¸Šå­¦çš„æ—¶å€™æœ‰è¿™ä¸ªä¸€ä¸ªæ¢—ï¼Œè¯´åœ¨é£Ÿå ‚é‡Œåƒé¥­ï¼Œåƒå®ŒæŠŠé¤ç›˜ç«¯èµ°æ¸…ç†çš„ï¼Œæ˜¯ C++ ç¨‹åºå‘˜ï¼Œåƒå®Œç›´æ¥å°±èµ°çš„ï¼Œæ˜¯ Java ç¨‹åºå‘˜ã€‚ğŸ¤” ä¹‹å‰ä¸Šå­¦çš„æ—¶å€™æœ‰è¿™ä¸ªä¸€ä¸ªæ¢—ï¼Œè¯´åœ¨é£Ÿå ‚é‡Œåƒé¥­ï¼Œåƒå®ŒæŠŠé¤ç›˜ç«¯èµ°æ¸…ç†çš„ï¼Œæ˜¯ C++ ç¨‹åºå‘˜ï¼Œåƒå®Œç›´æ¥å°±èµ°çš„ï¼Œæ˜¯ Java ç¨‹åºå‘˜ã€‚ğŸ¤” ç¡®å®ï¼Œåœ¨ Java çš„ä¸–ç•Œé‡Œï¼Œä¼¼ä¹æˆ‘ä»¬ä¸ç”¨å¯¹åƒåœ¾å›æ”¶é‚£ä¹ˆçš„ä¸“æ³¨ï¼Œå¾ˆå¤šåˆå­¦è€…ä¸æ‡‚ GCï¼Œä¹Ÿä¾ç„¶èƒ½å†™å‡ºä¸€ä¸ªèƒ½ç”¨ç”šè‡³è¿˜ä¸é”™çš„ç¨‹åºæˆ–ç³»ç»Ÿã€‚ä½†å…¶å®è¿™å¹¶ä¸ä»£è¡¨ Java çš„ GC å°±ä¸é‡è¦ã€‚ç›¸åï¼Œå®ƒæ˜¯é‚£ä¹ˆçš„é‡è¦å’Œå¤æ‚ï¼Œä»¥è‡³äºå‡ºäº†é—®é¢˜ï¼Œé‚£äº›åˆå­¦è€…é™¤äº†æ‰“å¼€ GC æ—¥å¿—ï¼Œçœ‹ç€ä¸€å †0101çš„å¤©æ–‡ï¼Œå•¥ä¹Ÿåšä¸äº†ã€‚ğŸ˜¯ ä»Šå¤©æˆ‘ä»¬å°±ä»å¤´åˆ°å°¾å®Œæ•´åœ°èŠä¸€èŠ Java çš„åƒåœ¾å›æ”¶ ä»€ä¹ˆæ˜¯åƒåœ¾å›æ”¶ åƒåœ¾å›æ”¶ï¼ˆGarbage Collectionï¼ŒGCï¼‰ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯é‡Šæ”¾åƒåœ¾å ç”¨çš„ç©ºé—´ï¼Œé˜²æ­¢å†…å­˜æ³„éœ²ã€‚æœ‰æ•ˆçš„ä½¿ç”¨å¯ä»¥ä½¿ç”¨çš„å†…å­˜ï¼Œå¯¹å†…å­˜å †ä¸­å·²ç»æ­»äº¡çš„æˆ–è€…é•¿æ—¶é—´æ²¡æœ‰ä½¿ç”¨çš„å¯¹è±¡è¿›è¡Œæ¸…é™¤å’Œå›æ”¶ã€‚ Java è¯­è¨€å‡ºæ¥ä¹‹å‰ï¼Œå¤§å®¶éƒ½åœ¨æ‹¼å‘½çš„å†™ C æˆ–è€… C++ çš„ç¨‹åºï¼Œè€Œæ­¤æ—¶å­˜åœ¨ä¸€ä¸ªå¾ˆå¤§çš„çŸ›ç›¾ï¼ŒC++ ç­‰è¯­è¨€åˆ›å»ºå¯¹è±¡è¦ä¸æ–­çš„å»å¼€è¾Ÿç©ºé—´ï¼Œä¸ç”¨çš„æ—¶å€™åˆéœ€è¦ä¸æ–­çš„å»é‡Šæ”¾æ§ä»¶ï¼Œæ—¢è¦å†™æ„é€ å‡½æ•°ï¼Œåˆè¦å†™ææ„å‡½æ•°ï¼Œå¾ˆå¤šæ—¶å€™éƒ½åœ¨é‡å¤çš„ allocatedï¼Œç„¶åä¸åœçš„ææ„ã€‚äºæ˜¯ï¼Œæœ‰äººå°±æå‡ºï¼Œèƒ½ä¸èƒ½å†™ä¸€æ®µç¨‹åºå®ç°è¿™å—åŠŸèƒ½ï¼Œæ¯æ¬¡åˆ›å»ºï¼Œé‡Šæ”¾æ§ä»¶çš„æ—¶å€™å¤ç”¨è¿™æ®µä»£ç ï¼Œè€Œæ— éœ€é‡å¤çš„ä¹¦å†™å‘¢ï¼Ÿ 1960å¹´ï¼ŒåŸºäº MIT çš„ Lisp é¦–å…ˆæå‡ºäº†åƒåœ¾å›æ”¶çš„æ¦‚å¿µï¼Œè€Œè¿™æ—¶ Java è¿˜æ²¡æœ‰å‡ºä¸–å‘¢ï¼æ‰€ä»¥å®é™…ä¸Š GC å¹¶ä¸æ˜¯Javaçš„ä¸“åˆ©ï¼ŒGC çš„å†å²è¿œè¿œå¤§äº Java çš„å†å²ï¼ æ€ä¹ˆå®šä¹‰åƒåœ¾ æ—¢ç„¶æˆ‘ä»¬è¦åšåƒåœ¾å›æ”¶ï¼Œé¦–å…ˆæˆ‘ä»¬å¾—ææ¸…æ¥šåƒåœ¾çš„å®šä¹‰æ˜¯ä»€ä¹ˆï¼Œå“ªäº›å†…å­˜æ˜¯éœ€è¦å›æ”¶çš„ã€‚ å¼•ç”¨è®¡æ•°ç®—æ³•å¼•ç”¨è®¡æ•°ç®—æ³•ï¼ˆReachability Countingï¼‰æ˜¯é€šè¿‡åœ¨å¯¹è±¡å¤´ä¸­åˆ†é…ä¸€ä¸ªç©ºé—´æ¥ä¿å­˜è¯¥å¯¹è±¡è¢«å¼•ç”¨çš„æ¬¡æ•°ï¼ˆReference Countï¼‰ã€‚å¦‚æœè¯¥å¯¹è±¡è¢«å…¶å®ƒå¯¹è±¡å¼•ç”¨ï¼Œåˆ™å®ƒçš„å¼•ç”¨è®¡æ•°åŠ 1ï¼Œå¦‚æœåˆ é™¤å¯¹è¯¥å¯¹è±¡çš„å¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒçš„å¼•ç”¨è®¡æ•°å°±å‡1ï¼Œå½“è¯¥å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ä¸º0æ—¶ï¼Œé‚£ä¹ˆè¯¥å¯¹è±¡å°±ä¼šè¢«å›æ”¶ã€‚ 1String m = new String(\"jack\"); å…ˆåˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™æ—¶å€™â€jackâ€æœ‰ä¸€ä¸ªå¼•ç”¨ï¼Œå°±æ˜¯ mã€‚ ç„¶åå°† m è®¾ç½®ä¸º nullï¼Œè¿™æ—¶å€™â€jackâ€çš„å¼•ç”¨æ¬¡æ•°å°±ç­‰äº0äº†ï¼Œåœ¨å¼•ç”¨è®¡æ•°ç®—æ³•ä¸­ï¼Œæ„å‘³ç€è¿™å—å†…å®¹å°±éœ€è¦è¢«å›æ”¶äº†ã€‚ 1m = null; å¼•ç”¨è®¡æ•°ç®—æ³•æ˜¯å°†åƒåœ¾å›æ”¶åˆ†æ‘Šåˆ°æ•´ä¸ªåº”ç”¨ç¨‹åºçš„è¿è¡Œå½“ä¸­äº†ï¼Œè€Œä¸æ˜¯åœ¨è¿›è¡Œåƒåœ¾æ”¶é›†æ—¶ï¼Œè¦æŒ‚èµ·æ•´ä¸ªåº”ç”¨çš„è¿è¡Œï¼Œç›´åˆ°å¯¹å †ä¸­æ‰€æœ‰å¯¹è±¡çš„å¤„ç†éƒ½ç»“æŸã€‚å› æ­¤ï¼Œé‡‡ç”¨å¼•ç”¨è®¡æ•°çš„åƒåœ¾æ”¶é›†ä¸å±äºä¸¥æ ¼æ„ä¹‰ä¸Šçš„â€Stop-The-Worldâ€çš„åƒåœ¾æ”¶é›†æœºåˆ¶ã€‚ çœ‹ä¼¼å¾ˆç¾å¥½ï¼Œä½†æˆ‘ä»¬çŸ¥é“JVMçš„åƒåœ¾å›æ”¶å°±æ˜¯â€Stop-The-Worldâ€çš„ï¼Œé‚£æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´æˆ‘ä»¬æœ€ç»ˆæ”¾å¼ƒäº†å¼•ç”¨è®¡æ•°ç®—æ³•å‘¢ï¼Ÿçœ‹ä¸‹é¢çš„ä¾‹å­ã€‚ 1234567891011121314151617public class ReferenceCountingGC { public Object instance; public ReferenceCountingGC(String name){}}public static void testGC(){ ReferenceCountingGC a = new ReferenceCountingGC(\"objA\"); ReferenceCountingGC b = new ReferenceCountingGC(\"objB\"); a.instance = b; b.instance = a; a = null; b = null;} å®šä¹‰2ä¸ªå¯¹è±¡ ç›¸äº’å¼•ç”¨ ç½®ç©ºå„è‡ªçš„å£°æ˜å¼•ç”¨ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæœ€åè¿™2ä¸ªå¯¹è±¡å·²ç»ä¸å¯èƒ½å†è¢«è®¿é—®äº†ï¼Œä½†ç”±äºä»–ä»¬ç›¸äº’å¼•ç”¨ç€å¯¹æ–¹ï¼Œå¯¼è‡´å®ƒä»¬çš„å¼•ç”¨è®¡æ•°æ°¸è¿œéƒ½ä¸ä¼šä¸º0ï¼Œé€šè¿‡å¼•ç”¨è®¡æ•°ç®—æ³•ï¼Œä¹Ÿå°±æ°¸è¿œæ— æ³•é€šçŸ¥GCæ”¶é›†å™¨å›æ”¶å®ƒä»¬ã€‚ å¯è¾¾æ€§åˆ†æç®—æ³• å¯è¾¾æ€§åˆ†æç®—æ³•ï¼ˆReachability Analysisï¼‰çš„åŸºæœ¬æ€è·¯æ˜¯ï¼Œé€šè¿‡ä¸€äº›è¢«ç§°ä¸ºå¼•ç”¨é“¾ï¼ˆGC Rootsï¼‰çš„å¯¹è±¡ä½œä¸ºèµ·ç‚¹ï¼Œä»è¿™äº›èŠ‚ç‚¹å¼€å§‹å‘ä¸‹æœç´¢ï¼Œæœç´¢èµ°è¿‡çš„è·¯å¾„è¢«ç§°ä¸ºï¼ˆReference Chain)ï¼Œå½“ä¸€ä¸ªå¯¹è±¡åˆ° GC Roots æ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿æ—¶ï¼ˆå³ä» GC Roots èŠ‚ç‚¹åˆ°è¯¥èŠ‚ç‚¹ä¸å¯è¾¾ï¼‰ï¼Œåˆ™è¯æ˜è¯¥å¯¹è±¡æ˜¯ä¸å¯ç”¨çš„ã€‚ é€šè¿‡å¯è¾¾æ€§ç®—æ³•ï¼ŒæˆåŠŸè§£å†³äº†å¼•ç”¨è®¡æ•°æ‰€æ— æ³•è§£å†³çš„é—®é¢˜-â€œå¾ªç¯ä¾èµ–â€ï¼Œåªè¦ä½ æ— æ³•ä¸ GC Root å»ºç«‹ç›´æ¥æˆ–é—´æ¥çš„è¿æ¥ï¼Œç³»ç»Ÿå°±ä¼šåˆ¤å®šä½ ä¸ºå¯å›æ”¶å¯¹è±¡ã€‚é‚£è¿™æ ·å°±å¼•ç”³å‡ºäº†å¦ä¸€ä¸ªé—®é¢˜ï¼Œå“ªäº›å±äº GC Rootã€‚ Java å†…å­˜åŒºåŸŸåœ¨ Java è¯­è¨€ä¸­ï¼Œå¯ä½œä¸º GC Root çš„å¯¹è±¡åŒ…æ‹¬ä»¥ä¸‹4ç§ï¼š è™šæ‹Ÿæœºæ ˆï¼ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ä¸­å¼•ç”¨çš„å¯¹è±¡ æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ æœ¬åœ°æ–¹æ³•æ ˆä¸­ JNIï¼ˆå³ä¸€èˆ¬è¯´çš„ Native æ–¹æ³•ï¼‰å¼•ç”¨çš„å¯¹è±¡ è™šæ‹Ÿæœºæ ˆï¼ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ä¸­å¼•ç”¨çš„å¯¹è±¡æ­¤æ—¶çš„ sï¼Œå³ä¸º GC Rootï¼Œå½“sç½®ç©ºæ—¶ï¼ŒlocalParameter å¯¹è±¡ä¹Ÿæ–­æ‰äº†ä¸ GC Root çš„å¼•ç”¨é“¾ï¼Œå°†è¢«å›æ”¶ã€‚ 12345678public class StackLocalParameter { public StackLocalParameter(String name){}}public static void testGC(){ StackLocalParameter s = new StackLocalParameter(\"localParameter\"); s = null;} æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡s ä¸º GC Rootï¼Œs ç½®ä¸º nullï¼Œç»è¿‡ GC åï¼Œs æ‰€æŒ‡å‘çš„ properties å¯¹è±¡ç”±äºæ— æ³•ä¸ GC Root å»ºç«‹å…³ç³»è¢«å›æ”¶ã€‚ è€Œ m ä½œä¸ºç±»çš„é™æ€å±æ€§ï¼Œä¹Ÿå±äº GC Rootï¼Œparameter å¯¹è±¡ä¾ç„¶ä¸ GC root å»ºç«‹ç€è¿æ¥ï¼Œæ‰€ä»¥æ­¤æ—¶ parameter å¯¹è±¡å¹¶ä¸ä¼šè¢«å›æ”¶ã€‚ 12345678910public class MethodAreaStaicProperties { public static MethodAreaStaicProperties m; public MethodAreaStaicProperties(String name){}}public static void testGC(){ MethodAreaStaicProperties s = new MethodAreaStaicProperties(\"properties\"); s.m = new MethodAreaStaicProperties(\"parameter\"); s = null;} æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡m å³ä¸ºæ–¹æ³•åŒºä¸­çš„å¸¸é‡å¼•ç”¨ï¼Œä¹Ÿä¸º GC Rootï¼Œs ç½®ä¸º null åï¼Œfinal å¯¹è±¡ä¹Ÿä¸ä¼šå› æ²¡æœ‰ä¸ GC Root å»ºç«‹è”ç³»è€Œè¢«å›æ”¶ã€‚ 123456789public class MethodAreaStaicProperties { public static final MethodAreaStaicProperties m = MethodAreaStaicProperties(\"final\"); public MethodAreaStaicProperties(String name){}}public static void testGC(){ MethodAreaStaicProperties s = new MethodAreaStaicProperties(\"staticProperties\"); s = null;} æœ¬åœ°æ–¹æ³•æ ˆä¸­å¼•ç”¨çš„å¯¹è±¡ä»»ä½• Native æ¥å£éƒ½ä¼šä½¿ç”¨æŸç§æœ¬åœ°æ–¹æ³•æ ˆï¼Œå®ç°çš„æœ¬åœ°æ–¹æ³•æ¥å£æ˜¯ä½¿ç”¨ C è¿æ¥æ¨¡å‹çš„è¯ï¼Œé‚£ä¹ˆå®ƒçš„æœ¬åœ°æ–¹æ³•æ ˆå°±æ˜¯ C æ ˆã€‚å½“çº¿ç¨‹è°ƒç”¨ Java æ–¹æ³•æ—¶ï¼Œè™šæ‹Ÿæœºä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ ˆå¸§å¹¶å‹å…¥ Java æ ˆã€‚ç„¶è€Œå½“å®ƒè°ƒç”¨çš„æ˜¯æœ¬åœ°æ–¹æ³•æ—¶ï¼Œè™šæ‹Ÿæœºä¼šä¿æŒ Java æ ˆä¸å˜ï¼Œä¸å†åœ¨çº¿ç¨‹çš„ Java æ ˆä¸­å‹å…¥æ–°çš„å¸§ï¼Œè™šæ‹Ÿæœºåªæ˜¯ç®€å•åœ°åŠ¨æ€è¿æ¥å¹¶ç›´æ¥è°ƒç”¨æŒ‡å®šçš„æœ¬åœ°æ–¹æ³•ã€‚ æ€ä¹ˆå›æ”¶åƒåœ¾åœ¨ç¡®å®šäº†å“ªäº›åƒåœ¾å¯ä»¥è¢«å›æ”¶åï¼Œåƒåœ¾æ”¶é›†å™¨è¦åšçš„äº‹æƒ…å°±æ˜¯å¼€å§‹è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œä½†æ˜¯è¿™é‡Œé¢æ¶‰åŠåˆ°ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šå¦‚ä½•é«˜æ•ˆåœ°è¿›è¡Œåƒåœ¾å›æ”¶ã€‚ç”±äºJavaè™šæ‹Ÿæœºè§„èŒƒå¹¶æ²¡æœ‰å¯¹å¦‚ä½•å®ç°åƒåœ¾æ”¶é›†å™¨åšå‡ºæ˜ç¡®çš„è§„å®šï¼Œå› æ­¤å„ä¸ªå‚å•†çš„è™šæ‹Ÿæœºå¯ä»¥é‡‡ç”¨ä¸åŒçš„æ–¹å¼æ¥å®ç°åƒåœ¾æ”¶é›†å™¨ï¼Œè¿™é‡Œæˆ‘ä»¬è®¨è®ºå‡ ç§å¸¸è§çš„åƒåœ¾æ”¶é›†ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³ã€‚ æ ‡è®° â€” æ¸…é™¤ç®—æ³• æ ‡è®°æ¸…é™¤ç®—æ³•ï¼ˆMark-Sweepï¼‰æ˜¯æœ€åŸºç¡€çš„ä¸€ç§åƒåœ¾å›æ”¶ç®—æ³•ï¼Œå®ƒåˆ†ä¸º2éƒ¨åˆ†ï¼Œå…ˆæŠŠå†…å­˜åŒºåŸŸä¸­çš„è¿™äº›å¯¹è±¡è¿›è¡Œæ ‡è®°ï¼Œå“ªäº›å±äºå¯å›æ”¶æ ‡è®°å‡ºæ¥ï¼Œç„¶åæŠŠè¿™äº›åƒåœ¾æ‹å‡ºæ¥æ¸…ç†æ‰ã€‚å°±åƒä¸Šå›¾ä¸€æ ·ï¼Œæ¸…ç†æ‰çš„åƒåœ¾å°±å˜æˆæœªä½¿ç”¨çš„å†…å­˜åŒºåŸŸï¼Œç­‰å¾…è¢«å†æ¬¡ä½¿ç”¨ã€‚ è¿™é€»è¾‘å†æ¸…æ™°ä¸è¿‡äº†ï¼Œå¹¶ä¸”ä¹Ÿå¾ˆå¥½æ“ä½œï¼Œä½†å®ƒå­˜åœ¨ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯å†…å­˜ç¢ç‰‡ã€‚ ä¸Šå›¾ä¸­ç­‰æ–¹å—çš„å‡è®¾æ˜¯ 2Mï¼Œå°ä¸€äº›çš„æ˜¯ 1Mï¼Œå¤§ä¸€äº›çš„æ˜¯ 4Mã€‚ç­‰æˆ‘ä»¬å›æ”¶å®Œï¼Œå†…å­˜å°±ä¼šåˆ‡æˆäº†å¾ˆå¤šæ®µã€‚æˆ‘ä»¬çŸ¥é“å¼€è¾Ÿå†…å­˜ç©ºé—´æ—¶ï¼Œéœ€è¦çš„æ˜¯è¿ç»­çš„å†…å­˜åŒºåŸŸï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦ä¸€ä¸ª 2Mçš„å†…å­˜åŒºåŸŸï¼Œå…¶ä¸­æœ‰2ä¸ª 1M æ˜¯æ²¡æ³•ç”¨çš„ã€‚è¿™æ ·å°±å¯¼è‡´ï¼Œå…¶å®æˆ‘ä»¬æœ¬èº«è¿˜æœ‰è¿™ä¹ˆå¤šçš„å†…å­˜çš„ï¼Œä½†å´ç”¨ä¸äº†ã€‚ å¤åˆ¶ç®—æ³• å¤åˆ¶ç®—æ³•ï¼ˆCopyingï¼‰æ˜¯åœ¨æ ‡è®°æ¸…é™¤ç®—æ³•ä¸Šæ¼”åŒ–è€Œæ¥ï¼Œè§£å†³æ ‡è®°æ¸…é™¤ç®—æ³•çš„å†…å­˜ç¢ç‰‡é—®é¢˜ã€‚å®ƒå°†å¯ç”¨å†…å­˜æŒ‰å®¹é‡åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­çš„ä¸€å—ã€‚å½“è¿™ä¸€å—çš„å†…å­˜ç”¨å®Œäº†ï¼Œå°±å°†è¿˜å­˜æ´»ç€çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€å—ä¸Šé¢ï¼Œç„¶åå†æŠŠå·²ä½¿ç”¨è¿‡çš„å†…å­˜ç©ºé—´ä¸€æ¬¡æ¸…ç†æ‰ã€‚ä¿è¯äº†å†…å­˜çš„è¿ç»­å¯ç”¨ï¼Œå†…å­˜åˆ†é…æ—¶ä¹Ÿå°±ä¸ç”¨è€ƒè™‘å†…å­˜ç¢ç‰‡ç­‰å¤æ‚æƒ…å†µï¼Œé€»è¾‘æ¸…æ™°ï¼Œè¿è¡Œé«˜æ•ˆã€‚ ä¸Šé¢çš„å›¾å¾ˆæ¸…æ¥šï¼Œä¹Ÿå¾ˆæ˜æ˜¾çš„æš´éœ²äº†å¦ä¸€ä¸ªé—®é¢˜ï¼Œåˆç€æˆ‘è¿™140å¹³çš„å¤§ä¸‰æˆ¿ï¼Œåªèƒ½å½“70å¹³ç±³çš„å°ä¸¤æˆ¿æ¥ä½¿ï¼Ÿä»£ä»·å®åœ¨å¤ªé«˜ã€‚ æ ‡è®°æ•´ç†ç®—æ³• æ ‡è®°æ•´ç†ç®—æ³•ï¼ˆMark-Compactï¼‰æ ‡è®°è¿‡ç¨‹ä»ç„¶ä¸æ ‡è®° â€” æ¸…é™¤ç®—æ³•ä¸€æ ·ï¼Œä½†åç»­æ­¥éª¤ä¸æ˜¯ç›´æ¥å¯¹å¯å›æ”¶å¯¹è±¡è¿›è¡Œæ¸…ç†ï¼Œè€Œæ˜¯è®©æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡éƒ½å‘ä¸€ç«¯ç§»åŠ¨ï¼Œå†æ¸…ç†æ‰ç«¯è¾¹ç•Œä»¥å¤–çš„å†…å­˜åŒºåŸŸã€‚ æ ‡è®°æ•´ç†ç®—æ³•ä¸€æ–¹é¢åœ¨æ ‡è®°-æ¸…é™¤ç®—æ³•ä¸Šåšäº†å‡çº§ï¼Œè§£å†³äº†å†…å­˜ç¢ç‰‡çš„é—®é¢˜ï¼Œä¹Ÿè§„é¿äº†å¤åˆ¶ç®—æ³•åªèƒ½åˆ©ç”¨ä¸€åŠå†…å­˜åŒºåŸŸçš„å¼Šç«¯ã€‚çœ‹èµ·æ¥å¾ˆç¾å¥½ï¼Œä½†ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼Œå®ƒå¯¹å†…å­˜å˜åŠ¨æ›´é¢‘ç¹ï¼Œéœ€è¦æ•´ç†æ‰€æœ‰å­˜æ´»å¯¹è±¡çš„å¼•ç”¨åœ°å€ï¼Œåœ¨æ•ˆç‡ä¸Šæ¯”å¤åˆ¶ç®—æ³•è¦å·®å¾ˆå¤šã€‚ åˆ†ä»£æ”¶é›†ç®—æ³•åˆ†ä»£æ”¶é›†ç®—æ³•ï¼ˆGenerational Collectionï¼‰ä¸¥æ ¼æ¥è¯´å¹¶ä¸æ˜¯ä¸€ç§æ€æƒ³æˆ–ç†è®ºï¼Œè€Œæ˜¯èåˆä¸Šè¿°3ç§åŸºç¡€çš„ç®—æ³•æ€æƒ³ï¼Œè€Œäº§ç”Ÿçš„é’ˆå¯¹ä¸åŒæƒ…å†µæ‰€é‡‡ç”¨ä¸åŒç®—æ³•çš„ä¸€å¥—ç»„åˆæ‹³ã€‚å¯¹è±¡å­˜æ´»å‘¨æœŸçš„ä¸åŒå°†å†…å­˜åˆ’åˆ†ä¸ºå‡ å—ã€‚ä¸€èˆ¬æ˜¯æŠŠ Java å †åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®å„ä¸ªå¹´ä»£çš„ç‰¹ç‚¹é‡‡ç”¨æœ€é€‚å½“çš„æ”¶é›†ç®—æ³•ã€‚åœ¨æ–°ç”Ÿä»£ä¸­ï¼Œæ¯æ¬¡åƒåœ¾æ”¶é›†æ—¶éƒ½å‘ç°æœ‰å¤§æ‰¹å¯¹è±¡æ­»å»ï¼Œåªæœ‰å°‘é‡å­˜æ´»ï¼Œé‚£å°±é€‰ç”¨å¤åˆ¶ç®—æ³•ï¼Œåªéœ€è¦ä»˜å‡ºå°‘é‡å­˜æ´»å¯¹è±¡çš„å¤åˆ¶æˆæœ¬å°±å¯ä»¥å®Œæˆæ”¶é›†ã€‚è€Œè€å¹´ä»£ä¸­å› ä¸ºå¯¹è±¡å­˜æ´»ç‡é«˜ã€æ²¡æœ‰é¢å¤–ç©ºé—´å¯¹å®ƒè¿›è¡Œåˆ†é…æ‹…ä¿ï¼Œå°±å¿…é¡»ä½¿ç”¨æ ‡è®°-æ¸…ç†æˆ–è€…æ ‡è®° â€” æ•´ç†ç®—æ³•æ¥è¿›è¡Œå›æ”¶ã€‚soï¼Œå¦ä¸€ä¸ªé—®é¢˜æ¥äº†ï¼Œé‚£å†…å­˜åŒºåŸŸåˆ°åº•è¢«åˆ†ä¸ºå“ªå‡ å—ï¼Œæ¯ä¸€å—åˆæœ‰ä»€ä¹ˆç‰¹åˆ«é€‚åˆä»€ä¹ˆç®—æ³•å‘¢ï¼Ÿ å†…å­˜æ¨¡å‹ä¸å›æ”¶ç­–ç•¥ Java å †ï¼ˆJava Heapï¼‰æ˜¯JVMæ‰€ç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ï¼Œå †åˆæ˜¯åƒåœ¾æ”¶é›†å™¨ç®¡ç†çš„ä¸»è¦åŒºåŸŸï¼Œè¿™é‡Œæˆ‘ä»¬ä¸»è¦åˆ†æä¸€ä¸‹ Java å †çš„ç»“æ„ã€‚ Java å †ä¸»è¦åˆ†ä¸º2ä¸ªåŒºåŸŸ-å¹´è½»ä»£ä¸è€å¹´ä»£ï¼Œå…¶ä¸­å¹´è½»ä»£åˆåˆ† Eden åŒºå’Œ Survivor åŒºï¼Œå…¶ä¸­ Survivor åŒºåˆåˆ† From å’Œ To 2ä¸ªåŒºã€‚å¯èƒ½è¿™æ—¶å€™å¤§å®¶ä¼šæœ‰ç–‘é—®ï¼Œä¸ºä»€ä¹ˆéœ€è¦ Survivor åŒºï¼Œä¸ºä»€ä¹ˆSurvivor è¿˜è¦åˆ†2ä¸ªåŒºã€‚ä¸ç€æ€¥ï¼Œæˆ‘ä»¬ä»å¤´åˆ°å°¾ï¼Œçœ‹çœ‹å¯¹è±¡åˆ°åº•æ˜¯æ€ä¹ˆæ¥çš„ï¼Œè€Œå®ƒåˆæ˜¯æ€ä¹ˆæ²¡çš„ã€‚ Eden åŒºIBM å…¬å¸çš„ä¸“ä¸šç ”ç©¶è¡¨æ˜ï¼Œæœ‰å°†è¿‘98%çš„å¯¹è±¡æ˜¯æœç”Ÿå¤•æ­»ï¼Œæ‰€ä»¥é’ˆå¯¹è¿™ä¸€ç°çŠ¶ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¯¹è±¡ä¼šåœ¨æ–°ç”Ÿä»£ Eden åŒºä¸­è¿›è¡Œåˆ†é…ï¼Œå½“ Eden åŒºæ²¡æœ‰è¶³å¤Ÿç©ºé—´è¿›è¡Œåˆ†é…æ—¶ï¼Œè™šæ‹Ÿæœºä¼šå‘èµ·ä¸€æ¬¡ Minor GCï¼ŒMinor GC ç›¸æ¯” Major GC æ›´é¢‘ç¹ï¼Œå›æ”¶é€Ÿåº¦ä¹Ÿæ›´å¿«ã€‚ é€šè¿‡ Minor GC ä¹‹åï¼ŒEden ä¼šè¢«æ¸…ç©ºï¼ŒEden åŒºä¸­ç»å¤§éƒ¨åˆ†å¯¹è±¡ä¼šè¢«å›æ”¶ï¼Œè€Œé‚£äº›æ— éœ€å›æ”¶çš„å­˜æ´»å¯¹è±¡ï¼Œå°†ä¼šè¿›åˆ° Survivor çš„ From åŒºï¼ˆè‹¥ From åŒºä¸å¤Ÿï¼Œåˆ™ç›´æ¥è¿›å…¥ Old åŒºï¼‰ã€‚ Survivor åŒºSurvivor åŒºç›¸å½“äºæ˜¯ Eden åŒºå’Œ Old åŒºçš„ä¸€ä¸ªç¼“å†²ï¼Œç±»ä¼¼äºæˆ‘ä»¬äº¤é€šç¯ä¸­çš„é»„ç¯ã€‚Survivor åˆåˆ†ä¸º2ä¸ªåŒºï¼Œä¸€ä¸ªæ˜¯ From åŒºï¼Œä¸€ä¸ªæ˜¯ To åŒºã€‚æ¯æ¬¡æ‰§è¡Œ Minor GCï¼Œä¼šå°† Eden åŒºå’Œ From å­˜æ´»çš„å¯¹è±¡æ”¾åˆ° Survivor çš„ To åŒºï¼ˆå¦‚æœ To åŒºä¸å¤Ÿï¼Œåˆ™ç›´æ¥è¿›å…¥ Old åŒºï¼‰ã€‚ ä¸ºå•¥éœ€è¦ï¼Ÿä¸å°±æ˜¯æ–°ç”Ÿä»£åˆ°è€å¹´ä»£ä¹ˆï¼Œç›´æ¥ Eden åˆ° Old ä¸å¥½äº†å—ï¼Œä¸ºå•¥è¦è¿™ä¹ˆå¤æ‚ã€‚æƒ³æƒ³å¦‚æœæ²¡æœ‰ Survivor åŒºï¼ŒEden åŒºæ¯è¿›è¡Œä¸€æ¬¡ Minor GCï¼Œå­˜æ´»çš„å¯¹è±¡å°±ä¼šè¢«é€åˆ°è€å¹´ä»£ï¼Œè€å¹´ä»£å¾ˆå¿«å°±ä¼šè¢«å¡«æ»¡ã€‚è€Œæœ‰å¾ˆå¤šå¯¹è±¡è™½ç„¶ä¸€æ¬¡ Minor GC æ²¡æœ‰æ¶ˆç­ï¼Œä½†å…¶å®ä¹Ÿå¹¶ä¸ä¼šè¹¦è·¶å¤šä¹…ï¼Œæˆ–è®¸ç¬¬äºŒæ¬¡ï¼Œç¬¬ä¸‰æ¬¡å°±éœ€è¦è¢«æ¸…é™¤ã€‚è¿™æ—¶å€™ç§»å…¥è€å¹´åŒºï¼Œå¾ˆæ˜æ˜¾ä¸æ˜¯ä¸€ä¸ªæ˜æ™ºçš„å†³å®šã€‚ æ‰€ä»¥ï¼ŒSurvivor çš„å­˜åœ¨æ„ä¹‰å°±æ˜¯å‡å°‘è¢«é€åˆ°è€å¹´ä»£çš„å¯¹è±¡ï¼Œè¿›è€Œå‡å°‘ Major GC çš„å‘ç”Ÿã€‚Survivor çš„é¢„ç­›é€‰ä¿è¯ï¼Œåªæœ‰ç»å†16æ¬¡ Minor GC è¿˜èƒ½åœ¨æ–°ç”Ÿä»£ä¸­å­˜æ´»çš„å¯¹è±¡ï¼Œæ‰ä¼šè¢«é€åˆ°è€å¹´ä»£ã€‚ ä¸ºå•¥éœ€è¦ä¿©ï¼Ÿè®¾ç½®ä¸¤ä¸ª Survivor åŒºæœ€å¤§çš„å¥½å¤„å°±æ˜¯è§£å†³å†…å­˜ç¢ç‰‡åŒ–ã€‚ æˆ‘ä»¬å…ˆå‡è®¾ä¸€ä¸‹ï¼ŒSurvivor å¦‚æœåªæœ‰ä¸€ä¸ªåŒºåŸŸä¼šæ€æ ·ã€‚Minor GC æ‰§è¡Œåï¼ŒEden åŒºè¢«æ¸…ç©ºäº†ï¼Œå­˜æ´»çš„å¯¹è±¡æ”¾åˆ°äº† Survivor åŒºï¼Œè€Œä¹‹å‰ Survivor åŒºä¸­çš„å¯¹è±¡ï¼Œå¯èƒ½ä¹Ÿæœ‰ä¸€äº›æ˜¯éœ€è¦è¢«æ¸…é™¤çš„ã€‚é—®é¢˜æ¥äº†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬æ€ä¹ˆæ¸…é™¤å®ƒä»¬ï¼Ÿåœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬åªèƒ½æ ‡è®°æ¸…é™¤ï¼Œè€Œæˆ‘ä»¬çŸ¥é“æ ‡è®°æ¸…é™¤æœ€å¤§çš„é—®é¢˜å°±æ˜¯å†…å­˜ç¢ç‰‡ï¼Œåœ¨æ–°ç”Ÿä»£è¿™ç§ç»å¸¸ä¼šæ¶ˆäº¡çš„åŒºåŸŸï¼Œé‡‡ç”¨æ ‡è®°æ¸…é™¤å¿…ç„¶ä¼šè®©å†…å­˜äº§ç”Ÿä¸¥é‡çš„ç¢ç‰‡åŒ–ã€‚å› ä¸º Survivor æœ‰2ä¸ªåŒºåŸŸï¼Œæ‰€ä»¥æ¯æ¬¡ Minor GCï¼Œä¼šå°†ä¹‹å‰ Eden åŒºå’Œ From åŒºä¸­çš„å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ° To åŒºåŸŸã€‚ç¬¬äºŒæ¬¡ Minor GC æ—¶ï¼ŒFrom ä¸ To èŒè´£å…‘æ¢ï¼Œè¿™æ—¶å€™ä¼šå°† Eden åŒºå’Œ To åŒºä¸­çš„å­˜æ´»å¯¹è±¡å†å¤åˆ¶åˆ° From åŒºåŸŸï¼Œä»¥æ­¤åå¤ã€‚ è¿™ç§æœºåˆ¶æœ€å¤§çš„å¥½å¤„å°±æ˜¯ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ°¸è¿œæœ‰ä¸€ä¸ª Survivor space æ˜¯ç©ºçš„ï¼Œå¦ä¸€ä¸ªéç©ºçš„ Survivor space æ˜¯æ— ç¢ç‰‡çš„ã€‚é‚£ä¹ˆï¼ŒSurvivor ä¸ºä»€ä¹ˆä¸åˆ†æ›´å¤šå—å‘¢ï¼Ÿæ¯”æ–¹è¯´åˆ†æˆä¸‰ä¸ªã€å››ä¸ªã€äº”ä¸ª?æ˜¾ç„¶ï¼Œå¦‚æœ Survivor åŒºå†ç»†åˆ†ä¸‹å»ï¼Œæ¯ä¸€å—çš„ç©ºé—´å°±ä¼šæ¯”è¾ƒå°ï¼Œå®¹æ˜“å¯¼è‡´ Survivor åŒºæ»¡ï¼Œä¸¤å— Survivor åŒºå¯èƒ½æ˜¯ç»è¿‡æƒè¡¡ä¹‹åçš„æœ€ä½³æ–¹æ¡ˆã€‚ Old åŒºè€å¹´ä»£å æ®ç€2/3çš„å †å†…å­˜ç©ºé—´ï¼Œåªæœ‰åœ¨ Major GC çš„æ—¶å€™æ‰ä¼šè¿›è¡Œæ¸…ç†ï¼Œæ¯æ¬¡ GC éƒ½ä¼šè§¦å‘â€œStop-The-Worldâ€ã€‚å†…å­˜è¶Šå¤§ï¼ŒSTW çš„æ—¶é—´ä¹Ÿè¶Šé•¿ï¼Œæ‰€ä»¥å†…å­˜ä¹Ÿä¸ä»…ä»…æ˜¯è¶Šå¤§å°±è¶Šå¥½ã€‚ç”±äºå¤åˆ¶ç®—æ³•åœ¨å¯¹è±¡å­˜æ´»ç‡è¾ƒé«˜çš„è€å¹´ä»£ä¼šè¿›è¡Œå¾ˆå¤šæ¬¡çš„å¤åˆ¶æ“ä½œï¼Œæ•ˆç‡å¾ˆä½ï¼Œæ‰€ä»¥è€å¹´ä»£è¿™é‡Œé‡‡ç”¨çš„æ˜¯æ ‡è®° â€” æ•´ç†ç®—æ³•ã€‚ é™¤äº†ä¸Šè¿°æ‰€è¯´ï¼Œåœ¨å†…å­˜æ‹…ä¿æœºåˆ¶ä¸‹ï¼Œæ— æ³•å®‰ç½®çš„å¯¹è±¡ä¼šç›´æ¥è¿›åˆ°è€å¹´ä»£ï¼Œä»¥ä¸‹å‡ ç§æƒ…å†µä¹Ÿä¼šè¿›å…¥è€å¹´ä»£ã€‚ å¤§å¯¹è±¡å¤§å¯¹è±¡æŒ‡éœ€è¦å¤§é‡è¿ç»­å†…å­˜ç©ºé—´çš„å¯¹è±¡ï¼Œè¿™éƒ¨åˆ†å¯¹è±¡ä¸ç®¡æ˜¯ä¸æ˜¯â€œæœç”Ÿå¤•æ­»â€ï¼Œéƒ½ä¼šç›´æ¥è¿›åˆ°è€å¹´ä»£ã€‚è¿™æ ·åšä¸»è¦æ˜¯ä¸ºäº†é¿å…åœ¨ Eden åŒºåŠ2ä¸ª Survivor åŒºä¹‹é—´å‘ç”Ÿå¤§é‡çš„å†…å­˜å¤åˆ¶ã€‚å½“ä½ çš„ç³»ç»Ÿæœ‰éå¸¸å¤šâ€œæœç”Ÿå¤•æ­»â€çš„å¤§å¯¹è±¡æ—¶ï¼Œå¾—æ³¨æ„äº†ã€‚ é•¿æœŸå­˜æ´»å¯¹è±¡è™šæ‹Ÿæœºç»™æ¯ä¸ªå¯¹è±¡å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡å¹´é¾„ï¼ˆAgeï¼‰è®¡æ•°å™¨ã€‚æ­£å¸¸æƒ…å†µä¸‹å¯¹è±¡ä¼šä¸æ–­çš„åœ¨ Survivor çš„ From åŒºä¸ To åŒºä¹‹é—´ç§»åŠ¨ï¼Œå¯¹è±¡åœ¨ Survivor åŒºä¸­æ¯ç»å†ä¸€æ¬¡ Minor GCï¼Œå¹´é¾„å°±å¢åŠ 1å²ã€‚å½“å¹´é¾„å¢åŠ åˆ°15å²æ—¶ï¼Œè¿™æ—¶å€™å°±ä¼šè¢«è½¬ç§»åˆ°è€å¹´ä»£ã€‚å½“ç„¶ï¼Œè¿™é‡Œçš„15ï¼ŒJVM ä¹Ÿæ”¯æŒè¿›è¡Œç‰¹æ®Šè®¾ç½®ã€‚ åŠ¨æ€å¯¹è±¡å¹´é¾„è™šæ‹Ÿæœºå¹¶ä¸é‡è§†è¦æ±‚å¯¹è±¡å¹´é¾„å¿…é¡»åˆ°15å²ï¼Œæ‰ä¼šæ”¾å…¥è€å¹´åŒºï¼Œå¦‚æœ Survivor ç©ºé—´ä¸­ç›¸åŒå¹´é¾„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»åˆå¤§äº Survivor ç©ºé—´çš„ä¸€åŠï¼Œå¹´é¾„å¤§äºç­‰äºè¯¥å¹´é¾„çš„å¯¹è±¡å°±å¯ä»¥ç›´æ¥è¿›å»è€å¹´åŒºï¼Œæ— éœ€ç­‰ä½ â€œæˆå¹´â€ã€‚ è¿™å…¶å®æœ‰ç‚¹ç±»ä¼¼äºè´Ÿè½½å‡è¡¡ï¼Œè½®è¯¢æ˜¯è´Ÿè½½å‡è¡¡çš„ä¸€ç§ï¼Œä¿è¯æ¯å°æœºå™¨éƒ½åˆ†å¾—åŒæ ·çš„è¯·æ±‚ã€‚çœ‹ä¼¼å¾ˆå‡è¡¡ï¼Œä½†æ¯å°æœºçš„ç¡¬ä»¶ä¸é€šï¼Œå¥åº·çŠ¶å†µä¸åŒï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åŸºäºæ¯å°æœºæ¥å—çš„è¯·æ±‚æ•°ï¼Œæˆ–æ¯å°æœºçš„å“åº”æ—¶é—´ç­‰ï¼Œæ¥è°ƒæ•´æˆ‘ä»¬çš„è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚ å‚è€ƒè‡ª .","link":"/2019/07/24/Java-åƒåœ¾å›æ”¶.html"},{"title":"Java BIO NIO AIOåŒºåˆ«ä¸ä½¿ç”¨","text":"æ‘˜è¦BIO å…¨ç§°Block-IO æ˜¯ä¸€ç§åŒæ­¥ä¸”é˜»å¡çš„é€šä¿¡æ¨¡å¼ã€‚æ˜¯ä¸€ä¸ªæ¯”è¾ƒä¼ ç»Ÿçš„é€šä¿¡æ–¹å¼ï¼Œæ¨¡å¼ç®€å•ï¼Œä½¿ç”¨æ–¹ä¾¿ã€‚ä½†å¹¶å‘å¤„ç†èƒ½åŠ›ä½ï¼Œé€šä¿¡è€—æ—¶ï¼Œä¾èµ–ç½‘é€Ÿã€‚ Java BIOä½¿ç”¨BIOå®ç°æ–‡ä»¶çš„è¯»å–å’Œå†™å…¥ã€‚ 123456789101112131415161718192021222324252627282930313233343536//Initializes The ObjectUser1 user = new User1();user.setName(\"hollis\");user.setAge(23);System.out.println(user);//Write Obj to FileObjectOutputStream oos = null;try { oos = new ObjectOutputStream(new FileOutputStream(\"tempFile\")); oos.writeObject(user);} catch (IOException e) { e.printStackTrace();} finally { IOUtils.closeQuietly(oos);}//Read Obj from FileFile file = new File(\"tempFile\");ObjectInputStream ois = null;try { ois = new ObjectInputStream(new FileInputStream(file)); User1 newUser = (User1) ois.readObject(); System.out.println(newUser);} catch (IOException e) { e.printStackTrace();} catch (ClassNotFoundException e) { e.printStackTrace();} finally { IOUtils.closeQuietly(ois); try { FileUtils.forceDelete(file); } catch (IOException e) { e.printStackTrace(); }} Java NIOJava NIOï¼Œå…¨ç¨‹ Non-Block IO ï¼Œæ˜¯Java SE 1.4ç‰ˆä»¥åï¼Œé’ˆå¯¹ç½‘ç»œä¼ è¾“æ•ˆèƒ½ä¼˜åŒ–çš„æ–°åŠŸèƒ½ã€‚æ˜¯ä¸€ç§éé˜»å¡åŒæ­¥çš„é€šä¿¡æ¨¡å¼ã€‚NIO ä¸åŸæ¥çš„ I/O æœ‰åŒæ ·çš„ä½œç”¨å’Œç›®çš„, ä»–ä»¬ä¹‹é—´æœ€é‡è¦çš„åŒºåˆ«æ˜¯æ•°æ®æ‰“åŒ…å’Œä¼ è¾“çš„æ–¹å¼ã€‚åŸæ¥çš„ I/O ä»¥æµçš„æ–¹å¼å¤„ç†æ•°æ®ï¼Œè€Œ NIO ä»¥å—çš„æ–¹å¼å¤„ç†æ•°æ®ã€‚é¢å‘æµçš„ I/O ç³»ç»Ÿä¸€æ¬¡ä¸€ä¸ªå­—èŠ‚åœ°å¤„ç†æ•°æ®ã€‚ä¸€ä¸ªè¾“å…¥æµäº§ç”Ÿä¸€ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œä¸€ä¸ªè¾“å‡ºæµæ¶ˆè´¹ä¸€ä¸ªå­—èŠ‚çš„æ•°æ®ã€‚é¢å‘å—çš„ I/O ç³»ç»Ÿä»¥å—çš„å½¢å¼å¤„ç†æ•°æ®ã€‚æ¯ä¸€ä¸ªæ“ä½œéƒ½åœ¨ä¸€æ­¥ä¸­äº§ç”Ÿæˆ–è€…æ¶ˆè´¹ä¸€ä¸ªæ•°æ®å—ã€‚æŒ‰å—å¤„ç†æ•°æ®æ¯”æŒ‰(æµå¼çš„)å­—èŠ‚å¤„ç†æ•°æ®è¦å¿«å¾—å¤šã€‚ä½†æ˜¯é¢å‘å—çš„ I/O ç¼ºå°‘ä¸€äº›é¢å‘æµçš„ I/O æ‰€å…·æœ‰çš„ä¼˜é›…æ€§å’Œç®€å•æ€§ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364static void readNIO() { String pathname = \"C:\\\\Users\\\\adew\\\\Desktop\\\\jd-gui.cfg\"; FileInputStream fin = null; try { fin = new FileInputStream(new File(pathname)); FileChannel channel = fin.getChannel(); int capacity = 100;// å­—èŠ‚ ByteBuffer bf = ByteBuffer.allocate(capacity); int length = -1; while ((length = channel.read(bf)) != -1) { bf.clear(); byte[] bytes = bf.array(); System.out.write(bytes, 0, length); System.out.println(); } channel.close(); } catch (FileNotFoundException e) { e.printStackTrace(); } catch (IOException e) { e.printStackTrace(); } finally { if (fin != null) { try { fin.close(); } catch (IOException e) { e.printStackTrace(); } } } } static void writeNIO() { String filename = \"out.txt\"; FileOutputStream fos = null; try { fos = new FileOutputStream(new File(filename)); FileChannel channel = fos.getChannel(); ByteBuffer src = Charset.forName(\"utf8\").encode(\"ä½ å¥½ä½ å¥½ä½ å¥½ä½ å¥½ä½ å¥½\"); int length = 0; while ((length = channel.write(src)) != 0) { System.out.println(\"å†™å…¥é•¿åº¦:\" + length); } } catch (FileNotFoundException e) { e.printStackTrace(); } catch (IOException e) { e.printStackTrace(); } finally { if (fos != null) { try { fos.close(); } catch (IOException e) { e.printStackTrace(); } } } } Java AIOJava AIOï¼Œå…¨ç¨‹ Asynchronous IOï¼Œæ˜¯å¼‚æ­¥éé˜»å¡çš„IOã€‚æ˜¯ä¸€ç§éé˜»å¡å¼‚æ­¥çš„é€šä¿¡æ¨¡å¼ã€‚åœ¨NIOçš„åŸºç¡€ä¸Šå¼•å…¥äº†æ–°çš„å¼‚æ­¥é€šé“çš„æ¦‚å¿µï¼Œå¹¶æä¾›äº†å¼‚æ­¥æ–‡ä»¶é€šé“å’Œå¼‚æ­¥å¥—æ¥å­—é€šé“çš„å®ç°ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253public class ReadFromFile { public static void main(String[] args) throws Exception { Path file = Paths.get(\"/usr/a.txt\"); AsynchronousFileChannel channel = AsynchronousFileChannel.open(file); ByteBuffer buffer = ByteBuffer.allocate(100_000); Future&lt;Integer&gt; result = channel.read(buffer, 0); while (!result.isDone()) { ProfitCalculator.calculateTax(); } Integer bytesRead = result.get(); System.out.println(\"Bytes read [\" + bytesRead + \"]\"); }}class ProfitCalculator { public ProfitCalculator() { } public static void calculateTax() { }}public class WriteToFile { public static void main(String[] args) throws Exception { AsynchronousFileChannel fileChannel = AsynchronousFileChannel.open( Paths.get(\"/asynchronous.txt\"), StandardOpenOption.READ, StandardOpenOption.WRITE, StandardOpenOption.CREATE); CompletionHandler&lt;Integer, Object&gt; handler = new CompletionHandler&lt;Integer, Object&gt;() { @Override public void completed(Integer result, Object attachment) { System.out.println(\"Attachment: \" + attachment + \" \" + result + \" bytes written\"); System.out.println(\"CompletionHandler Thread ID: \" + Thread.currentThread().getId()); } @Override public void failed(Throwable e, Object attachment) { System.err.println(\"Attachment: \" + attachment + \" failed with:\"); e.printStackTrace(); } }; System.out.println(\"Main Thread ID: \" + Thread.currentThread().getId()); fileChannel.write(ByteBuffer.wrap(\"Sample\".getBytes()), 0, \"First Write\", handler); fileChannel.write(ByteBuffer.wrap(\"Box\".getBytes()), 0, \"Second Write\", handler); }} ä¸‰ç§IOçš„åŒºåˆ«é¦–å…ˆï¼Œæˆ‘ä»¬ç«™åœ¨å®è§‚çš„è§’åº¦ï¼Œé‡æ–°ç”»ä¸€ä¸‹é‡ç‚¹ï¼š BIO ï¼ˆBlocking I/Oï¼‰ï¼šåŒæ­¥é˜»å¡I/Oæ¨¡å¼ã€‚ NIO ï¼ˆNew I/Oï¼‰ï¼šåŒæ­¥éé˜»å¡æ¨¡å¼ã€‚ AIO ï¼ˆAsynchronous I/Oï¼‰ï¼šå¼‚æ­¥éé˜»å¡I/Oæ¨¡å‹ã€‚ åŒæ­¥è¯·æ±‚ï¼ŒAè°ƒç”¨Bï¼ŒBçš„å¤„ç†æ˜¯åŒæ­¥çš„ï¼Œåœ¨å¤„ç†å®Œä¹‹å‰ä»–ä¸ä¼šé€šçŸ¥Aï¼Œåªæœ‰å¤„ç†å®Œä¹‹åæ‰ä¼šæ˜ç¡®çš„é€šçŸ¥Aã€‚ å¼‚æ­¥è¯·æ±‚ï¼ŒAè°ƒç”¨Bï¼ŒBçš„å¤„ç†æ˜¯å¼‚æ­¥çš„ï¼ŒBåœ¨æ¥åˆ°è¯·æ±‚åå…ˆå‘Šè¯‰Aæˆ‘å·²ç»æ¥åˆ°è¯·æ±‚äº†ï¼Œç„¶åå¼‚æ­¥å»å¤„ç†ï¼Œå¤„ç†å®Œä¹‹åé€šè¿‡å›è°ƒç­‰æ–¹å¼å†é€šçŸ¥Aã€‚ æ‰€ä»¥è¯´ï¼ŒåŒæ­¥å’Œå¼‚æ­¥æœ€å¤§çš„åŒºåˆ«å°±æ˜¯è¢«è°ƒç”¨æ–¹çš„æ‰§è¡Œæ–¹å¼å’Œè¿”å›æ—¶æœºã€‚åŒæ­¥æŒ‡çš„æ˜¯è¢«è°ƒç”¨æ–¹åšå®Œäº‹æƒ…ä¹‹åå†è¿”å›ï¼Œå¼‚æ­¥æŒ‡çš„æ˜¯è¢«è°ƒç”¨æ–¹å…ˆè¿”å›ï¼Œç„¶åå†åšäº‹æƒ…ï¼Œåšå®Œä¹‹åå†æƒ³åŠæ³•é€šçŸ¥è°ƒç”¨æ–¹ã€‚ é˜»å¡è¯·æ±‚ï¼ŒAè°ƒç”¨Bï¼ŒAä¸€ç›´ç­‰ç€Bçš„è¿”å›ï¼Œåˆ«çš„äº‹æƒ…ä»€ä¹ˆä¹Ÿä¸å¹²ã€‚ éé˜»å¡è¯·æ±‚ï¼ŒAè°ƒç”¨Bï¼ŒAä¸ç”¨ä¸€ç›´ç­‰ç€Bçš„è¿”å›ï¼Œå…ˆå»å¿™åˆ«çš„äº‹æƒ…äº†ã€‚ æ‰€ä»¥è¯´ï¼Œé˜»å¡éé˜»å¡æœ€å¤§çš„åŒºåˆ«å°±æ˜¯åœ¨è¢«è°ƒç”¨æ–¹è¿”å›ç»“æœä¹‹å‰çš„è¿™æ®µæ—¶é—´å†…ï¼Œè°ƒç”¨æ–¹æ˜¯å¦ä¸€ç›´ç­‰å¾…ã€‚é˜»å¡æŒ‡çš„æ˜¯è°ƒç”¨æ–¹ä¸€ç›´ç­‰å¾…åˆ«çš„äº‹æƒ…ä»€ä¹ˆéƒ½ä¸åšã€‚éé˜»å¡æŒ‡çš„æ˜¯è°ƒç”¨æ–¹å…ˆå»å¿™åˆ«çš„äº‹æƒ…ã€‚ åŒæ­¥é˜»å¡æ¨¡å¼ï¼šè¿™ç§æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬çš„å·¥ä½œæ¨¡å¼æ˜¯å…ˆæ¥åˆ°å¨æˆ¿ï¼Œå¼€å§‹çƒ§æ°´ï¼Œå¹¶ååœ¨æ°´å£¶é¢å‰ä¸€ç›´ç­‰ç€æ°´çƒ§å¼€ã€‚ åŒæ­¥éé˜»å¡æ¨¡å¼ï¼šè¿™ç§æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬çš„å·¥ä½œæ¨¡å¼æ˜¯å…ˆæ¥åˆ°å¨æˆ¿ï¼Œå¼€å§‹çƒ§æ°´ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸ä¸€ç›´ååœ¨æ°´å£¶å‰é¢ç­‰ï¼Œè€Œæ˜¯å›åˆ°å®¢å…çœ‹ç”µè§†ï¼Œç„¶åæ¯éš”å‡ åˆ†é’Ÿåˆ°å¨æˆ¿çœ‹ä¸€ä¸‹æ°´æœ‰æ²¡æœ‰çƒ§å¼€ã€‚ å¼‚æ­¥éé˜»å¡I/Oæ¨¡å‹ï¼šè¿™ç§æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬çš„å·¥ä½œæ¨¡å¼æ˜¯å…ˆæ¥åˆ°å¨æˆ¿ï¼Œå¼€å§‹çƒ§æ°´ï¼Œæˆ‘ä»¬ä¸ä¸€ä¸€ç›´ååœ¨æ°´å£¶å‰é¢ç­‰ï¼Œä¹Ÿä¸éš”ä¸€æ®µæ—¶é—´å»çœ‹ä¸€ä¸‹ï¼Œè€Œæ˜¯åœ¨å®¢å…çœ‹ç”µè§†ï¼Œæ°´å£¶ä¸Šé¢æœ‰ä¸ªå¼€å…³ï¼Œæ°´çƒ§å¼€ä¹‹åä»–ä¼šé€šçŸ¥æˆ‘ã€‚ é˜»å¡VSéé˜»å¡ï¼šäººæ˜¯å¦ååœ¨æ°´å£¶å‰é¢ä¸€ç›´ç­‰ã€‚ åŒæ­¥VSå¼‚æ­¥ï¼šæ°´å£¶æ˜¯ä¸æ˜¯åœ¨æ°´çƒ§å¼€ä¹‹åä¸»åŠ¨é€šçŸ¥äººã€‚ é€‚ç”¨åœºæ™¯BIOæ–¹å¼é€‚ç”¨äºè¿æ¥æ•°ç›®æ¯”è¾ƒå°ä¸”å›ºå®šçš„æ¶æ„ï¼Œè¿™ç§æ–¹å¼å¯¹æœåŠ¡å™¨èµ„æºè¦æ±‚æ¯”è¾ƒé«˜ï¼Œå¹¶å‘å±€é™äºåº”ç”¨ä¸­ï¼ŒJDK1.4ä»¥å‰çš„å”¯ä¸€é€‰æ‹©ï¼Œä½†ç¨‹åºç›´è§‚ç®€å•æ˜“ç†è§£ã€‚ NIOæ–¹å¼é€‚ç”¨äºè¿æ¥æ•°ç›®å¤šä¸”è¿æ¥æ¯”è¾ƒçŸ­ï¼ˆè½»æ“ä½œï¼‰çš„æ¶æ„ï¼Œæ¯”å¦‚èŠå¤©æœåŠ¡å™¨ï¼Œå¹¶å‘å±€é™äºåº”ç”¨ä¸­ï¼Œç¼–ç¨‹æ¯”è¾ƒå¤æ‚ï¼ŒJDK1.4å¼€å§‹æ”¯æŒã€‚ AIOæ–¹å¼é€‚ç”¨äºè¿æ¥æ•°ç›®å¤šä¸”è¿æ¥æ¯”è¾ƒé•¿ï¼ˆé‡æ“ä½œï¼‰çš„æ¶æ„ï¼Œæ¯”å¦‚ç›¸å†ŒæœåŠ¡å™¨ï¼Œå……åˆ†è°ƒç”¨OSå‚ä¸å¹¶å‘æ“ä½œï¼Œç¼–ç¨‹æ¯”è¾ƒå¤æ‚ï¼ŒJDK7å¼€å§‹æ”¯æŒã€‚ å‚è€ƒè‡ª .","link":"/2019/07/19/Java-BIO-NIO-AIOåŒºåˆ«ä¸ä½¿ç”¨.html"},{"title":"å¸¸è§sqlé”™è¯¯å†™æ³•","text":"æ‘˜è¦sqlè¯­å¥åº”ç”¨ä¸å½“ï¼Œå¯èƒ½ä»…ä»…ä¸€ä¸ªé¡ºåºçš„ä¸åŒï¼Œå¾€å¾€ä¼šå¸¦æ¥æˆåƒä¸Šä¸‡å€çš„è€—æ—¶é—®é¢˜ã€‚ 1ã€LIMIT è¯­å¥åˆ†é¡µæŸ¥è¯¢æ˜¯æœ€å¸¸ç”¨çš„åœºæ™¯ä¹‹ä¸€ï¼Œä½†ä¹Ÿé€šå¸¸ä¹Ÿæ˜¯æœ€å®¹æ˜“å‡ºé—®é¢˜çš„åœ°æ–¹ã€‚æ¯”å¦‚å¯¹äºä¸‹é¢ç®€å•çš„è¯­å¥ï¼Œä¸€èˆ¬ DBA æƒ³åˆ°çš„åŠæ³•æ˜¯åœ¨ type, name, create_time å­—æ®µä¸ŠåŠ ç»„åˆç´¢å¼•ã€‚è¿™æ ·æ¡ä»¶æ’åºéƒ½èƒ½æœ‰æ•ˆçš„åˆ©ç”¨åˆ°ç´¢å¼•ï¼Œæ€§èƒ½è¿…é€Ÿæå‡ã€‚ 123456SELECT * FROM operation WHERE type = 'SQLStats' AND name = 'SlowLog' ORDER BY create_time LIMIT 1000, 10; å¥½å§ï¼Œå¯èƒ½90%ä»¥ä¸Šçš„ DBA è§£å†³è¯¥é—®é¢˜å°±åˆ°æ­¤ä¸ºæ­¢ã€‚ä½†å½“ LIMIT å­å¥å˜æˆ â€œLIMIT 1000000,10â€ æ—¶ï¼Œç¨‹åºå‘˜ä»ç„¶ä¼šæŠ±æ€¨ï¼šæˆ‘åªå–10æ¡è®°å½•ä¸ºä»€ä¹ˆè¿˜æ˜¯æ…¢ï¼Ÿ è¦çŸ¥é“æ•°æ®åº“ä¹Ÿå¹¶ä¸çŸ¥é“ç¬¬1000000æ¡è®°å½•ä»ä»€ä¹ˆåœ°æ–¹å¼€å§‹ï¼Œå³ä½¿æœ‰ç´¢å¼•ä¹Ÿéœ€è¦ä»å¤´è®¡ç®—ä¸€æ¬¡ã€‚å‡ºç°è¿™ç§æ€§èƒ½é—®é¢˜ï¼Œå¤šæ•°æƒ…å½¢ä¸‹æ˜¯ç¨‹åºå‘˜å·æ‡’äº†ã€‚ åœ¨å‰ç«¯æ•°æ®æµè§ˆç¿»é¡µï¼Œæˆ–è€…å¤§æ•°æ®åˆ†æ‰¹å¯¼å‡ºç­‰åœºæ™¯ä¸‹ï¼Œæ˜¯å¯ä»¥å°†ä¸Šä¸€é¡µçš„æœ€å¤§å€¼å½“æˆå‚æ•°ä½œä¸ºæŸ¥è¯¢æ¡ä»¶çš„ã€‚SQL é‡æ–°è®¾è®¡å¦‚ä¸‹ï¼š 123456SELECT * FROM operation WHERE type = 'SQLStats' AND name = 'SlowLog' AND create_time &gt; '2017-03-16 14:00:00' ORDER BY create_time limit 10; åœ¨æ–°è®¾è®¡ä¸‹æŸ¥è¯¢æ—¶é—´åŸºæœ¬å›ºå®šï¼Œä¸ä¼šéšç€æ•°æ®é‡çš„å¢é•¿è€Œå‘ç”Ÿå˜åŒ–ã€‚ 2ã€éšå¼è½¬æ¢SQLè¯­å¥ä¸­æŸ¥è¯¢å˜é‡å’Œå­—æ®µå®šä¹‰ç±»å‹ä¸åŒ¹é…æ˜¯å¦ä¸€ä¸ªå¸¸è§çš„é”™è¯¯ã€‚æ¯”å¦‚ä¸‹é¢çš„è¯­å¥ï¼š 123456mysql&gt; explain extended SELECT * &gt; FROM my_balance b &gt; WHERE b.bpn = 14000000123 &gt; AND b.isverified IS NULL ;mysql&gt; show warnings;| Warning | 1739 | Cannot use ref access on index 'bpn' due to type or collation conversion on field 'bpn' å…¶ä¸­å­—æ®µ bpn çš„å®šä¹‰ä¸º varchar(20)ï¼ŒMySQL çš„ç­–ç•¥æ˜¯å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—ä¹‹åå†æ¯”è¾ƒã€‚å‡½æ•°ä½œç”¨äºè¡¨å­—æ®µï¼Œç´¢å¼•å¤±æ•ˆã€‚ ä¸Šè¿°æƒ…å†µå¯èƒ½æ˜¯åº”ç”¨ç¨‹åºæ¡†æ¶è‡ªåŠ¨å¡«å…¥çš„å‚æ•°ï¼Œè€Œä¸æ˜¯ç¨‹åºå‘˜çš„åŸæ„ã€‚ç°åœ¨åº”ç”¨æ¡†æ¶å¾ˆå¤šå¾ˆç¹æ‚ï¼Œä½¿ç”¨æ–¹ä¾¿çš„åŒæ—¶ä¹Ÿå°å¿ƒå®ƒå¯èƒ½ç»™è‡ªå·±æŒ–å‘ã€‚ 3ã€å…³è”æ›´æ–°ã€åˆ é™¤è™½ç„¶ MySQL5.6 å¼•å…¥äº†ç‰©åŒ–ç‰¹æ€§ï¼Œä½†éœ€è¦ç‰¹åˆ«æ³¨æ„å®ƒç›®å‰ä»…ä»…é’ˆå¯¹æŸ¥è¯¢è¯­å¥çš„ä¼˜åŒ–ã€‚å¯¹äºæ›´æ–°æˆ–åˆ é™¤éœ€è¦æ‰‹å·¥é‡å†™æˆ JOINã€‚ æ¯”å¦‚ä¸‹é¢ UPDATE è¯­å¥ï¼ŒMySQL å®é™…æ‰§è¡Œçš„æ˜¯å¾ªç¯/åµŒå¥—å­æŸ¥è¯¢ï¼ˆDEPENDENT SUBQUERY)ï¼Œå…¶æ‰§è¡Œæ—¶é—´å¯æƒ³è€ŒçŸ¥ã€‚ 1234567891011UPDATE operation o SET status = 'applying' WHERE o.id IN (SELECT id FROM (SELECT o.id, o.status FROM operation o WHERE o.group = 123 AND o.status NOT IN ( 'done' ) ORDER BY o.parent, o.id LIMIT 1) t); æ‰§è¡Œè®¡åˆ’ï¼š 1234567+----+--------------------+-------+-------+---------------+---------+---------+-------+------+-----------------------------------------------------+| id | select_type | table | type | possible_keys | key | key_len | ref | rows | Extra |+----+--------------------+-------+-------+---------------+---------+---------+-------+------+-----------------------------------------------------+| 1 | PRIMARY | o | index | | PRIMARY | 8 | | 24 | Using where; Using temporary || 2 | DEPENDENT SUBQUERY | | | | | | | | Impossible WHERE noticed after reading const tables || 3 | DERIVED | o | ref | idx_2,idx_5 | idx_5 | 8 | const | 1 | Using where; Using filesort |+----+--------------------+-------+-------+---------------+---------+---------+-------+------+-----------------------------------------------------+ é‡å†™ä¸º JOIN ä¹‹åï¼Œå­æŸ¥è¯¢çš„é€‰æ‹©æ¨¡å¼ä» DEPENDENT SUBQUERY å˜æˆ DERIVEDï¼Œæ‰§è¡Œé€Ÿåº¦å¤§å¤§åŠ å¿«ï¼Œä»7ç§’é™ä½åˆ°2æ¯«ç§’ã€‚ 1234567891011UPDATE operation o JOIN (SELECT o.id, o.status FROM operation o WHERE o.group = 123 AND o.status NOT IN ( 'done' ) ORDER BY o.parent, o.id LIMIT 1) t ON o.id = t.id SET status = 'applying' æ‰§è¡Œè®¡åˆ’ç®€åŒ–ä¸ºï¼š 123456+----+-------------+-------+------+---------------+-------+---------+-------+------+-----------------------------------------------------+| id | select_type | table | type | possible_keys | key | key_len | ref | rows | Extra |+----+-------------+-------+------+---------------+-------+---------+-------+------+-----------------------------------------------------+| 1 | PRIMARY | | | | | | | | Impossible WHERE noticed after reading const tables || 2 | DERIVED | o | ref | idx_2,idx_5 | idx_5 | 8 | const | 1 | Using where; Using filesort |+----+-------------+-------+------+---------------+-------+---------+-------+------+-----------------------------------------------------+ 4ã€æ··åˆæ’åºMySQL ä¸èƒ½åˆ©ç”¨ç´¢å¼•è¿›è¡Œæ··åˆæ’åºã€‚ä½†åœ¨æŸäº›åœºæ™¯ï¼Œè¿˜æ˜¯æœ‰æœºä¼šä½¿ç”¨ç‰¹æ®Šæ–¹æ³•æå‡æ€§èƒ½çš„ã€‚ 123456SELECT * FROM my_order o INNER JOIN my_appraise a ON a.orderid = o.id ORDER BY a.is_reply ASC, a.appraise_time DESC LIMIT 0, 20 æ‰§è¡Œè®¡åˆ’æ˜¾ç¤ºä¸ºå…¨è¡¨æ‰«æï¼š 123456+----+-------------+-------+--------+-------------+---------+---------+---------------+---------+-+| id | select_type | table | type | possible_keys | key | key_len | ref | rows | Extra +----+-------------+-------+--------+-------------+---------+---------+---------------+---------+-+| 1 | SIMPLE | a | ALL | idx_orderid | NULL | NULL | NULL | 1967647 | Using filesort || 1 | SIMPLE | o | eq_ref | PRIMARY | PRIMARY | 122 | a.orderid | 1 | NULL |+----+-------------+-------+--------+---------+---------+---------+-----------------+---------+-+ ç”±äº is_reply åªæœ‰0å’Œ1ä¸¤ç§çŠ¶æ€ï¼Œæˆ‘ä»¬æŒ‰ç…§ä¸‹é¢çš„æ–¹æ³•é‡å†™åï¼Œæ‰§è¡Œæ—¶é—´ä»1.58ç§’é™ä½åˆ°2æ¯«ç§’ã€‚ 12345678910111213141516171819SELECT * FROM ((SELECT * FROM my_order o INNER JOIN my_appraise a ON a.orderid = o.id AND is_reply = 0 ORDER BY appraise_time DESC LIMIT 0, 20) UNION ALL (SELECT * FROM my_order o INNER JOIN my_appraise a ON a.orderid = o.id AND is_reply = 1 ORDER BY appraise_time DESC LIMIT 0, 20)) t ORDER BY is_reply ASC, appraisetime DESC LIMIT 20; 5ã€EXISTSè¯­å¥MySQL å¯¹å¾… EXISTS å­å¥æ—¶ï¼Œä»ç„¶é‡‡ç”¨åµŒå¥—å­æŸ¥è¯¢çš„æ‰§è¡Œæ–¹å¼ã€‚å¦‚ä¸‹é¢çš„ SQL è¯­å¥ï¼š 1234567891011SELECT *FROM my_neighbor n LEFT JOIN my_neighbor_apply sra ON n.id = sra.neighbor_id AND sra.user_id = 'xxx' WHERE n.topic_status &lt; 4 AND EXISTS(SELECT 1 FROM message_info m WHERE n.id = m.neighbor_id AND m.inuser = 'xxx') AND n.topic_type &lt;&gt; 5 æ‰§è¡Œè®¡åˆ’ä¸ºï¼š 1234567+----+--------------------+-------+------+-----+------------------------------------------+---------+-------+---------+ -----+| id | select_type | table | type | possible_keys | key | key_len | ref | rows | Extra |+----+--------------------+-------+------+ -----+------------------------------------------+---------+-------+---------+ -----+| 1 | PRIMARY | n | ALL | | NULL | NULL | NULL | 1086041 | Using where || 1 | PRIMARY | sra | ref | | idx_user_id | 123 | const | 1 | Using where || 2 | DEPENDENT SUBQUERY | m | ref | | idx_message_info | 122 | const | 1 | Using index condition; Using where |+----+--------------------+-------+------+ -----+------------------------------------------+---------+-------+---------+ -----+ å»æ‰ exists æ›´æ”¹ä¸º joinï¼Œèƒ½å¤Ÿé¿å…åµŒå¥—å­æŸ¥è¯¢ï¼Œå°†æ‰§è¡Œæ—¶é—´ä»1.93ç§’é™ä½ä¸º1æ¯«ç§’ã€‚ 12345678910SELECT *FROM my_neighbor n INNER JOIN message_info m ON n.id = m.neighbor_id AND m.inuser = 'xxx' LEFT JOIN my_neighbor_apply sra ON n.id = sra.neighbor_id AND sra.user_id = 'xxx' WHERE n.topic_status &lt; 4 AND n.topic_type &lt;&gt; 5 æ–°çš„æ‰§è¡Œè®¡åˆ’ï¼š 1234567+----+-------------+-------+--------+ -----+------------------------------------------+---------+ -----+------+ -----+| id | select_type | table | type | possible_keys | key | key_len | ref | rows | Extra |+----+-------------+-------+--------+ -----+------------------------------------------+---------+ -----+------+ -----+| 1 | SIMPLE | m | ref | | idx_message_info | 122 | const | 1 | Using index condition || 1 | SIMPLE | n | eq_ref | | PRIMARY | 122 | ighbor_id | 1 | Using where || 1 | SIMPLE | sra | ref | | idx_user_id | 123 | const | 1 | Using where |+----+-------------+-------+--------+ -----+------------------------------------------+---------+ -----+------+ -----+ 6ã€æ¡ä»¶ä¸‹æ¨å¤–éƒ¨æŸ¥è¯¢æ¡ä»¶ä¸èƒ½å¤Ÿä¸‹æ¨åˆ°å¤æ‚çš„è§†å›¾æˆ–å­æŸ¥è¯¢çš„æƒ…å†µæœ‰ï¼š èšåˆå­æŸ¥è¯¢ï¼› å«æœ‰ LIMIT çš„å­æŸ¥è¯¢ï¼› UNION æˆ– UNION ALL å­æŸ¥è¯¢ï¼› è¾“å‡ºå­—æ®µä¸­çš„å­æŸ¥è¯¢ï¼› å¦‚ä¸‹é¢çš„è¯­å¥ï¼Œä»æ‰§è¡Œè®¡åˆ’å¯ä»¥çœ‹å‡ºå…¶æ¡ä»¶ä½œç”¨äºèšåˆå­æŸ¥è¯¢ä¹‹åï¼š 123456SELECT * FROM (SELECT target, Count(*) FROM operation GROUP BY target) t WHERE target = 'rm-xxxx' 123456+----+-------------+------------+-------+---------------+-------------+---------+-------+------+-------------+| id | select_type | table | type | possible_keys | key | key_len | ref | rows | Extra |+----+-------------+------------+-------+---------------+-------------+---------+-------+------+-------------+| 1 | PRIMARY | &lt;derived2&gt; | ref | &lt;auto_key0&gt; | &lt;auto_key0&gt; | 514 | const | 2 | Using where || 2 | DERIVED | operation | index | idx_4 | idx_4 | 519 | NULL | 20 | Using index |+----+-------------+------------+-------+---------------+-------------+---------+-------+------+-------------+ ç¡®å®šä»è¯­ä¹‰ä¸ŠæŸ¥è¯¢æ¡ä»¶å¯ä»¥ç›´æ¥ä¸‹æ¨åï¼Œé‡å†™å¦‚ä¸‹ï¼š 12345SELECT target, Count(*) FROM operation WHERE target = 'rm-xxxx' GROUP BY target æ‰§è¡Œè®¡åˆ’å˜ä¸ºï¼š 12345+----+-------------+-----------+------+---------------+-------+---------+-------+------+--------------------+| id | select_type | table | type | possible_keys | key | key_len | ref | rows | Extra |+----+-------------+-----------+------+---------------+-------+---------+-------+------+--------------------+| 1 | SIMPLE | operation | ref | idx_4 | idx_4 | 514 | const | 1 | Using where; Using index |+----+-------------+-----------+------+---------------+-------+---------+-------+------+--------------------+ å…³äº MySQL å¤–éƒ¨æ¡ä»¶ä¸èƒ½ä¸‹æ¨çš„è¯¦ç»†è§£é‡Šè¯´æ˜è¯·å‚è€ƒæ–‡ç« ï¼š 7ã€æå‰ç¼©å°èŒƒå›´å…ˆä¸Šåˆå§‹ SQL è¯­å¥ï¼š 12345678910SELECT * FROM my_order o LEFT JOIN my_userinfo u ON o.uid = u.uid LEFT JOIN my_productinfo p ON o.pid = p.pid WHERE ( o.display = 0 ) AND ( o.ostaus = 1 ) ORDER BY o.selltime DESC LIMIT 0, 15 è¯¥SQLè¯­å¥åŸæ„æ˜¯ï¼šå…ˆåšä¸€ç³»åˆ—çš„å·¦è¿æ¥ï¼Œç„¶åæ’åºå–å‰15æ¡è®°å½•ã€‚ä»æ‰§è¡Œè®¡åˆ’ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œæœ€åä¸€æ­¥ä¼°ç®—æ’åºè®°å½•æ•°ä¸º90ä¸‡ï¼Œæ—¶é—´æ¶ˆè€—ä¸º12ç§’ã€‚ 1234567+----+-------------+-------+--------+---------------+---------+---------+-----------------+--------+----------------------------------------------------+| id | select_type | table | type | possible_keys | key | key_len | ref | rows | Extra |+----+-------------+-------+--------+---------------+---------+---------+-----------------+--------+----------------------------------------------------+| 1 | SIMPLE | o | ALL | NULL | NULL | NULL | NULL | 909119 | Using where; Using temporary; Using filesort || 1 | SIMPLE | u | eq_ref | PRIMARY | PRIMARY | 4 | o.uid | 1 | NULL || 1 | SIMPLE | p | ALL | PRIMARY | NULL | NULL | NULL | 6 | Using where; Using join buffer (Block Nested Loop) |+----+-------------+-------+--------+---------------+---------+---------+-----------------+--------+----------------------------------------------------+ ç”±äºæœ€å WHERE æ¡ä»¶ä»¥åŠæ’åºå‡é’ˆå¯¹æœ€å·¦ä¸»è¡¨ï¼Œå› æ­¤å¯ä»¥å…ˆå¯¹ my_order æ’åºæå‰ç¼©å°æ•°æ®é‡å†åšå·¦è¿æ¥ã€‚SQL é‡å†™åå¦‚ä¸‹ï¼Œæ‰§è¡Œæ—¶é—´ç¼©å°ä¸º1æ¯«ç§’å·¦å³ã€‚ 123456789101112131415SELECT * FROM (SELECT * FROM my_order o WHERE ( o.display = 0 ) AND ( o.ostaus = 1 ) ORDER BY o.selltime DESC LIMIT 0, 15) o LEFT JOIN my_userinfo u ON o.uid = u.uid LEFT JOIN my_productinfo p ON o.pid = p.pid ORDER BY o.selltime DESClimit 0, 15 å†æ£€æŸ¥æ‰§è¡Œè®¡åˆ’ï¼šå­æŸ¥è¯¢ç‰©åŒ–åï¼ˆselect_type=DERIVED)å‚ä¸ JOINã€‚è™½ç„¶ä¼°ç®—è¡Œæ‰«æä»ç„¶ä¸º90ä¸‡ï¼Œä½†æ˜¯åˆ©ç”¨äº†ç´¢å¼•ä»¥åŠ LIMIT å­å¥åï¼Œå®é™…æ‰§è¡Œæ—¶é—´å˜å¾—å¾ˆå°ã€‚ 12345678+----+-------------+------------+--------+---------------+---------+---------+-------+--------+----------------------------------------------------+| id | select_type | table | type | possible_keys | key | key_len | ref | rows | Extra |+----+-------------+------------+--------+---------------+---------+---------+-------+--------+----------------------------------------------------+| 1 | PRIMARY | &lt;derived2&gt; | ALL | NULL | NULL | NULL | NULL | 15 | Using temporary; Using filesort || 1 | PRIMARY | u | eq_ref | PRIMARY | PRIMARY | 4 | o.uid | 1 | NULL || 1 | PRIMARY | p | ALL | PRIMARY | NULL | NULL | NULL | 6 | Using where; Using join buffer (Block Nested Loop) || 2 | DERIVED | o | index | NULL | idx_1 | 5 | NULL | 909112 | Using where |+----+-------------+------------+--------+---------------+---------+---------+-------+--------+----------------------------------------------------+ 8ã€ä¸­é—´ç»“æœé›†ä¸‹æ¨å†æ¥çœ‹ä¸‹é¢è¿™ä¸ªå·²ç»åˆæ­¥ä¼˜åŒ–è¿‡çš„ä¾‹å­(å·¦è¿æ¥ä¸­çš„ä¸»è¡¨ä¼˜å…ˆä½œç”¨æŸ¥è¯¢æ¡ä»¶)ï¼š 1234567891011121314SELECT a.*, c.allocated FROM ( SELECT resourceid FROM my_distribute d WHERE isdelete = 0 AND cusmanagercode = '1234567' ORDER BY salecode limit 20) a LEFT JOIN ( SELECT resourcesidï¼Œ sum(ifnull(allocation, 0) * 12345) allocated FROM my_resources GROUP BY resourcesid) c ON a.resourceid = c.resourcesid é‚£ä¹ˆè¯¥è¯­å¥è¿˜å­˜åœ¨å…¶å®ƒé—®é¢˜å—ï¼Ÿä¸éš¾çœ‹å‡ºå­æŸ¥è¯¢ c æ˜¯å…¨è¡¨èšåˆæŸ¥è¯¢ï¼Œåœ¨è¡¨æ•°é‡ç‰¹åˆ«å¤§çš„æƒ…å†µä¸‹ä¼šå¯¼è‡´æ•´ä¸ªè¯­å¥çš„æ€§èƒ½ä¸‹é™ã€‚ å…¶å®å¯¹äºå­æŸ¥è¯¢ cï¼Œå·¦è¿æ¥æœ€åç»“æœé›†åªå…³å¿ƒèƒ½å’Œä¸»è¡¨ resourceid èƒ½åŒ¹é…çš„æ•°æ®ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥é‡å†™è¯­å¥å¦‚ä¸‹ï¼Œæ‰§è¡Œæ—¶é—´ä»åŸæ¥çš„2ç§’ä¸‹é™åˆ°2æ¯«ç§’ã€‚ 123456789101112131415161718192021SELECT a.*, c.allocated FROM ( SELECT resourceid FROM my_distribute d WHERE isdelete = 0 AND cusmanagercode = '1234567' ORDER BY salecode limit 20) a LEFT JOIN ( SELECT resourcesidï¼Œ sum(ifnull(allocation, 0) * 12345) allocated FROM my_resources r, ( SELECT resourceid FROM my_distribute d WHERE isdelete = 0 AND cusmanagercode = '1234567' ORDER BY salecode limit 20) a WHERE r.resourcesid = a.resourcesid GROUP BY resourcesid) c ON a.resourceid = c.resourcesid ä½†æ˜¯å­æŸ¥è¯¢ a åœ¨æˆ‘ä»¬çš„SQLè¯­å¥ä¸­å‡ºç°äº†å¤šæ¬¡ã€‚è¿™ç§å†™æ³•ä¸ä»…å­˜åœ¨é¢å¤–çš„å¼€é”€ï¼Œè¿˜ä½¿å¾—æ•´ä¸ªè¯­å¥æ˜¾çš„ç¹æ‚ã€‚ä½¿ç”¨ WITH è¯­å¥å†æ¬¡é‡å†™ï¼š 123456789101112131415161718WITH a AS ( SELECT resourceid FROM my_distribute d WHERE isdelete = 0 AND cusmanagercode = '1234567' ORDER BY salecode limit 20)SELECT a.*, c.allocated FROM a LEFT JOIN ( SELECT resourcesidï¼Œ sum(ifnull(allocation, 0) * 12345) allocated FROM my_resources r, a WHERE r.resourcesid = a.resourcesid GROUP BY resourcesid) c ON a.resourceid = c.resourcesid æ€»ç»“æ•°æ®åº“ç¼–è¯‘å™¨äº§ç”Ÿæ‰§è¡Œè®¡åˆ’ï¼Œå†³å®šç€SQLçš„å®é™…æ‰§è¡Œæ–¹å¼ã€‚ä½†æ˜¯ç¼–è¯‘å™¨åªæ˜¯å°½åŠ›æœåŠ¡ï¼Œæ‰€æœ‰æ•°æ®åº“çš„ç¼–è¯‘å™¨éƒ½ä¸æ˜¯å°½å–„å°½ç¾çš„ã€‚ ä¸Šè¿°æåˆ°çš„å¤šæ•°åœºæ™¯ï¼Œåœ¨å…¶å®ƒæ•°æ®åº“ä¸­ä¹Ÿå­˜åœ¨æ€§èƒ½é—®é¢˜ã€‚äº†è§£æ•°æ®åº“ç¼–è¯‘å™¨çš„ç‰¹æ€§ï¼Œæ‰èƒ½é¿è§„å…¶çŸ­å¤„ï¼Œå†™å‡ºé«˜æ€§èƒ½çš„SQLè¯­å¥ã€‚ ç¨‹åºå‘˜åœ¨è®¾è®¡æ•°æ®æ¨¡å‹ä»¥åŠç¼–å†™SQLè¯­å¥æ—¶ï¼Œè¦æŠŠç®—æ³•çš„æ€æƒ³æˆ–æ„è¯†å¸¦è¿›æ¥ã€‚ ç¼–å†™å¤æ‚SQLè¯­å¥è¦å…»æˆä½¿ç”¨ WITH è¯­å¥çš„ä¹ æƒ¯ã€‚ç®€æ´ä¸”æ€è·¯æ¸…æ™°çš„SQLè¯­å¥ä¹Ÿèƒ½å‡å°æ•°æ®åº“çš„è´Ÿæ‹… ã€‚è½¬è‡ª","link":"/2019/07/05/å¸¸è§sqlé”™è¯¯å†™æ³•.html"},{"title":"mysqlç´¢å¼•ä¼˜åŒ–æ–¹æ¡ˆ","text":"æ‘˜è¦mysqlè‡ªå¸¦ä¼˜åŒ–ï¼šå…ˆæ‰§è¡Œexplain sqlï¼Œåœ¨æ‰§è¡Œexplain extended sqlï¼Œå¾—åˆ°ä¼˜åŒ–ç»“æœï¼Œshow warningsæ˜¾ç¤ºä¼˜åŒ–åçš„ç»“æœsql. ç´¢å¼•åŸºæ•°åŸºæ•°æ˜¯æ•°æ®åˆ—æ‰€åŒ…å«çš„ä¸åŒå€¼çš„æ•°é‡ï¼Œä¾‹å¦‚ï¼ŒæŸä¸ªæ•°æ®åˆ—åŒ…å«å€¼ 1ã€3ã€7ã€4ã€7ã€3ï¼Œé‚£ä¹ˆå®ƒçš„åŸºæ•°å°±æ˜¯ 4ã€‚ç´¢å¼•çš„åŸºæ•°ç›¸å¯¹äºæ•°æ®è¡¨è¡Œæ•°è¾ƒé«˜ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ—ä¸­åŒ…å«å¾ˆå¤šä¸åŒçš„å€¼ï¼Œé‡å¤çš„å€¼å¾ˆå°‘ï¼‰çš„æ—¶å€™ï¼Œå®ƒçš„å·¥ä½œæ•ˆæœæœ€å¥½ã€‚å¦‚æœæŸæ•°æ®åˆ—å«æœ‰å¾ˆå¤šä¸åŒçš„å¹´é¾„ï¼Œç´¢å¼•ä¼šå¾ˆå¿«åœ°åˆ†è¾¨æ•°æ®è¡Œï¼›å¦‚æœæŸä¸ªæ•°æ®åˆ—ç”¨äºè®°å½•æ€§åˆ«ï¼ˆåªæœ‰â€œMâ€å’Œâ€œFâ€ä¸¤ç§å€¼ï¼‰ï¼Œé‚£ä¹ˆç´¢å¼•çš„ç”¨å¤„å°±ä¸å¤§ï¼›å¦‚æœå€¼å‡ºç°çš„å‡ ç‡å‡ ä¹ç›¸ç­‰ï¼Œé‚£ä¹ˆæ— è®ºæœç´¢å“ªä¸ªå€¼éƒ½å¯èƒ½å¾—åˆ°ä¸€åŠçš„æ•°æ®è¡Œã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæœ€å¥½æ ¹æœ¬ä¸è¦ä½¿ç”¨ç´¢å¼•ï¼Œå› ä¸ºæŸ¥è¯¢ä¼˜åŒ–å™¨å‘ç°æŸä¸ªå€¼å‡ºç°åœ¨è¡¨çš„æ•°æ®è¡Œä¸­çš„ç™¾åˆ†æ¯”å¾ˆé«˜çš„æ—¶å€™ï¼Œå®ƒä¸€èˆ¬ä¼šå¿½ç•¥ç´¢å¼•ï¼Œè¿›è¡Œå…¨è¡¨æ‰«æã€‚æƒ¯ç”¨çš„ç™¾åˆ†æ¯”ç•Œçº¿æ˜¯â€œ30%â€ã€‚ ç´¢å¼•å¤±æ•ˆåŸå› ç´¢å¼•å¤±æ•ˆçš„åŸå› æœ‰å¦‚ä¸‹å‡ ç‚¹ï¼š å¯¹ç´¢å¼•åˆ—è¿ç®—ï¼Œè¿ç®—åŒ…æ‹¬ï¼ˆ+ã€-ã€*ã€/ã€ï¼ã€&lt;&gt;ã€%ã€likeâ€™%_â€™ï¼ˆ% æ”¾åœ¨å‰é¢ï¼‰ã€‚ ç±»å‹é”™è¯¯ï¼Œå¦‚å­—æ®µç±»å‹ä¸º varcharï¼Œwhere æ¡ä»¶ç”¨ numberã€‚ å¯¹ç´¢å¼•åº”ç”¨å†…éƒ¨å‡½æ•°ï¼Œè¿™ç§æƒ…å†µä¸‹åº”è¯¥è¦å»ºç«‹åŸºäºå‡½æ•°çš„ç´¢å¼•ã€‚ä¾‹å¦‚ select * from template t where ROUND (t.logicdb_id) = 1ï¼Œæ­¤æ—¶åº”è¯¥å»º ROUND (t.logicdb_id) ä¸ºç´¢å¼•ã€‚ MySQL 8.0 å¼€å§‹æ”¯æŒå‡½æ•°ç´¢å¼•ï¼Œ5.7 å¯ä»¥é€šè¿‡è™šæ‹Ÿåˆ—çš„æ–¹å¼æ¥æ”¯æŒï¼Œä¹‹å‰åªèƒ½æ–°å»ºä¸€ä¸ª ROUND (t.logicdb_id) åˆ—ç„¶åå»ç»´æŠ¤ã€‚ å¦‚æœæ¡ä»¶æœ‰ orï¼Œå³ä½¿å…¶ä¸­æœ‰æ¡ä»¶å¸¦ç´¢å¼•ä¹Ÿä¸ä¼šä½¿ç”¨ï¼ˆè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå»ºè®®å°‘ä½¿ç”¨ or çš„åŸå› ï¼‰ï¼Œå¦‚æœæƒ³ä½¿ç”¨ orï¼Œåˆæƒ³ç´¢å¼•æœ‰æ•ˆï¼Œåªèƒ½å°† or æ¡ä»¶ä¸­çš„æ¯ä¸ªåˆ—åŠ ä¸Šç´¢å¼•ã€‚ å¦‚æœåˆ—ç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¸€å®šè¦åœ¨æ¡ä»¶ä¸­æ•°æ®ä½¿ç”¨å¼•å·ï¼Œå¦åˆ™ä¸ä½¿ç”¨ç´¢å¼•ã€‚ B-tree ç´¢å¼• is null ä¸ä¼šèµ°ï¼Œis not null ä¼šèµ°ï¼Œä½å›¾ç´¢å¼• is nullï¼Œis not null éƒ½ä¼šèµ°ã€‚ ç»„åˆç´¢å¼•éµå¾ªæœ€å·¦åŸåˆ™ã€‚ ç´¢å¼•çš„å»ºç«‹ç´¢å¼•çš„å»ºç«‹éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š æœ€é‡è¦çš„è‚¯å®šæ˜¯æ ¹æ®ä¸šåŠ¡ç»å¸¸æŸ¥è¯¢çš„è¯­å¥ã€‚ å°½é‡é€‰æ‹©åŒºåˆ†åº¦é«˜çš„åˆ—ä½œä¸ºç´¢å¼•ï¼ŒåŒºåˆ†åº¦çš„å…¬å¼æ˜¯$$COUNT(DISTINCTç©ºæ ¼col) / COUNT(*):è¡¨ç¤ºå­—æ®µä¸é‡å¤çš„æ¯”ç‡ï¼Œæ¯”ç‡è¶Šå¤§æˆ‘ä»¬æ‰«æçš„è®°å½•æ•°å°±è¶Šå°‘ã€‚$$ å¦‚æœä¸šåŠ¡ä¸­å”¯ä¸€ç‰¹æ€§æœ€å¥½å»ºç«‹å”¯ä¸€é”®ï¼Œä¸€æ–¹é¢å¯ä»¥ä¿è¯æ•°æ®çš„æ­£ç¡®æ€§ï¼Œå¦ä¸€æ–¹é¢ç´¢å¼•çš„æ•ˆç‡èƒ½å¤§å¤§æé«˜ã€‚ EXPLIAN ä¸­æœ‰ç”¨çš„ä¿¡æ¯EXPLIAN åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š desc æˆ–è€… explain åŠ ä¸Šä½ çš„ SQLã€‚ explain extended åŠ ä¸Šä½ çš„ SQLï¼Œç„¶åé€šè¿‡ show warnings å¯ä»¥æŸ¥çœ‹å®é™…æ‰§è¡Œçš„è¯­å¥ï¼Œè¿™ä¸€ç‚¹ä¹Ÿæ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œå¾ˆå¤šæ—¶å€™ä¸åŒçš„å†™æ³•ç» SQL åˆ†æåï¼Œå®é™…æ‰§è¡Œçš„ä»£ç æ˜¯ä¸€æ ·çš„ã€‚ æé«˜æ€§èƒ½çš„ç‰¹æ€§EXPLIAN æé«˜æ€§èƒ½çš„ç‰¹æ€§å¦‚ä¸‹ï¼š ç´¢å¼•è¦†ç›–(covering index)ï¼šéœ€è¦æŸ¥è¯¢çš„æ•°æ®åœ¨ç´¢å¼•ä¸Šéƒ½å¯ä»¥æŸ¥åˆ°ä¸éœ€è¦å›è¡¨ EXTRA åˆ—æ˜¾ç¤º using indexã€‚ ICPç‰¹æ€§(Index Condition Pushdown)ï¼šæœ¬æ¥ index ä»…ä»…æ˜¯ data access çš„ä¸€ç§è®¿é—®æ¨¡å¼ï¼Œå­˜æ•°å¼•æ“é€šè¿‡ç´¢å¼•å›è¡¨è·å–çš„æ•°æ®ä¼šä¼ é€’åˆ° MySQL Server å±‚è¿›è¡Œ where æ¡ä»¶è¿‡æ»¤ã€‚ 5.6 ç‰ˆæœ¬å¼€å§‹å½“ ICP æ‰“å¼€æ—¶ï¼Œå¦‚æœéƒ¨åˆ† where æ¡ä»¶èƒ½ä½¿ç”¨ç´¢å¼•çš„å­—æ®µï¼ŒMySQL Server ä¼šæŠŠè¿™éƒ¨åˆ†ä¸‹æ¨åˆ°å¼•æ“å±‚ï¼Œå¯ä»¥åˆ©ç”¨ index è¿‡æ»¤çš„ where æ¡ä»¶åœ¨å­˜å‚¨å¼•æ“å±‚è¿›è¡Œæ•°æ®è¿‡æ»¤ã€‚ EXTRA æ˜¾ç¤º using index conditionã€‚éœ€è¦äº†è§£ MySQL çš„æ¶æ„å›¾åˆ†ä¸º Server å’Œå­˜å‚¨å¼•æ“å±‚ã€‚ ç´¢å¼•åˆå¹¶(index merge)ï¼šå¯¹å¤šä¸ªç´¢å¼•åˆ†åˆ«è¿›è¡Œæ¡ä»¶æ‰«æï¼Œç„¶åå°†å®ƒä»¬å„è‡ªçš„ç»“æœè¿›è¡Œåˆå¹¶(intersect/union)ã€‚ ä¸€èˆ¬ç”¨ or ä¼šç”¨åˆ°ï¼Œå¦‚æœæ˜¯ AND æ¡ä»¶ï¼Œè€ƒè™‘å»ºç«‹å¤åˆç´¢å¼•ã€‚EXPLAIN æ˜¾ç¤ºçš„ç´¢å¼•ç±»å‹ä¼šæ˜¾ç¤º index_mergeï¼ŒEXTRA ä¼šæ˜¾ç¤ºå…·ä½“çš„åˆå¹¶ç®—æ³•å’Œç”¨åˆ°çš„ç´¢å¼•ã€‚ Extraå­—æ®µExtra å­—æ®µä½¿ç”¨ï¼š using filesortï¼šè¯´æ˜ MySQL ä¼šå¯¹æ•°æ®ä½¿ç”¨ä¸€ä¸ªå¤–éƒ¨çš„ç´¢å¼•æ’åºï¼Œè€Œä¸æ˜¯æŒ‰ç…§è¡¨å†…çš„ç´¢å¼•é¡ºåºè¿›è¡Œè¯»å–ã€‚ MySQL ä¸­æ— æ³•åˆ©ç”¨ç´¢å¼•å®Œæˆçš„æ’åºæ“ä½œç§°ä¸ºâ€œæ–‡ä»¶æ’åºâ€ï¼Œå…¶å®ä¸ä¸€å®šæ˜¯æ–‡ä»¶æ’åºï¼Œå†…éƒ¨ä½¿ç”¨çš„æ˜¯å¿«æ’ã€‚ using temporaryï¼šä½¿ç”¨äº†ä¸´æ—¶è¡¨ä¿å­˜ä¸­é—´ç»“æœï¼ŒMySQL åœ¨å¯¹æŸ¥è¯¢ç»“æœæ’åºæ—¶ä½¿ç”¨ä¸´æ—¶è¡¨ã€‚å¸¸è§äºæ’åº order by å’Œåˆ†ç»„æŸ¥è¯¢ group byã€‚ using indexï¼šè¡¨ç¤ºç›¸åº”çš„ SELECT æ“ä½œä¸­ä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ï¼ˆCovering Indexï¼‰ï¼Œé¿å…è®¿é—®äº†è¡¨çš„æ•°æ®è¡Œï¼Œæ•ˆç‡ä¸é”™ã€‚ impossible whereï¼šwhere å­å¥çš„å€¼æ€»æ˜¯ falseï¼Œä¸èƒ½ç”¨æ¥è·å–ä»»ä½•å…ƒç»„ã€‚ select tables optimized awayï¼šåœ¨æ²¡æœ‰ group by å­å¥çš„æƒ…å†µä¸‹åŸºäºç´¢å¼•ä¼˜åŒ– MIN/MAX æ“ä½œæˆ–è€…å¯¹äº MyISAM å­˜å‚¨å¼•æ“ä¼˜åŒ– COUNT(*) æ“ä½œï¼Œä¸å¿…ç­‰åˆ°æ‰§è¡Œé˜¶æ®µå†è¿›è¡Œè®¡ç®—ï¼ŒæŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ç”Ÿæˆçš„é˜¶æ®µå³å®Œæˆä¼˜åŒ–ã€‚ distinctï¼šä¼˜åŒ– distinct æ“ä½œï¼Œåœ¨æ‰¾åˆ°ç¬¬ä¸€åŒ¹é…çš„å…ƒç»„åå³åœæ­¢æ‰¾åŒæ ·å€¼çš„æ“ä½œã€‚ using filesortã€using temporary è¿™ä¸¤é¡¹å‡ºç°æ—¶éœ€è¦æ³¨æ„ä¸‹ï¼Œè¿™ä¸¤é¡¹æ˜¯ååˆ†è€—è´¹æ€§èƒ½çš„ åœ¨ä½¿ç”¨ group by çš„æ—¶å€™ï¼Œè™½ç„¶æ²¡æœ‰ä½¿ç”¨ order byï¼Œå¦‚æœæ²¡æœ‰ç´¢å¼•ï¼Œæ˜¯å¯èƒ½åŒæ—¶å‡ºç° using filesortï¼Œusing temporary çš„ã€‚å› ä¸º group by å°±æ˜¯å…ˆæ’åºåœ¨åˆ†ç»„ï¼Œå¦‚æœæ²¡æœ‰æ’åºçš„éœ€è¦ï¼Œå¯ä»¥åŠ ä¸Šä¸€ä¸ª order by NULL æ¥é¿å…æ’åºï¼Œè¿™æ · using filesort å°±ä¼šå»é™¤ï¼Œèƒ½æå‡ä¸€ç‚¹æ€§èƒ½ã€‚ typeå­—æ®µ systemï¼šè¡¨åªæœ‰ä¸€è¡Œè®°å½•ï¼ˆç­‰äºç³»ç»Ÿè¡¨ï¼‰ï¼Œè¿™æ˜¯ const ç±»å‹çš„ç‰¹ä¾‹ï¼Œå¹³æ—¶ä¸ä¼šå‡ºç°ã€‚ constï¼šå¦‚æœé€šè¿‡ç´¢å¼•ä¾æ¬¡å°±æ‰¾åˆ°äº†ï¼Œconst ç”¨äºæ¯”è¾ƒä¸»é”®ç´¢å¼•æˆ–è€… unique ç´¢å¼•ã€‚å› ä¸ºåªèƒ½åŒ¹é…ä¸€è¡Œæ•°æ®ï¼Œæ‰€ä»¥å¾ˆå¿«ã€‚å¦‚æœå°†ä¸»é”®ç½®äº where åˆ—è¡¨ä¸­ï¼ŒMySQL å°±èƒ½å°†è¯¥æŸ¥è¯¢è½¬æ¢ä¸ºä¸€ä¸ªå¸¸é‡ã€‚ eq_refï¼šå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œå¯¹äºæ¯ä¸ªç´¢å¼•é”®ï¼Œè¡¨ä¸­åªæœ‰ä¸€æ¡è®°å½•ä¸ä¹‹åŒ¹é…ã€‚å¸¸è§äºä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•æ‰«æã€‚ refï¼šéå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œè¿”å›åŒ¹é…æŸä¸ªå•ç‹¬å€¼çš„æ‰€æœ‰è¡Œã€‚æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ç§ç´¢å¼•è®¿é—®ï¼Œå®ƒè¿”å›æ‰€æœ‰åŒ¹é…æŸä¸ªå•ç‹¬å€¼çš„è¡Œï¼Œç„¶è€Œå®ƒå¯èƒ½ä¼šæ‰¾åˆ°å¤šä¸ªç¬¦åˆæ¡ä»¶çš„è¡Œï¼Œæ‰€ä»¥å®ƒåº”è¯¥å±äºæŸ¥æ‰¾å’Œæ‰«æçš„æ··åˆä½“ã€‚ rangeï¼šåªæ£€ç´¢ç»™å®šèŒƒå›´çš„è¡Œï¼Œä½¿ç”¨ä¸€ä¸ªç´¢å¼•æ¥é€‰æ‹©è¡Œã€‚key åˆ—æ˜¾ç¤ºä½¿ç”¨äº†å“ªä¸ªç´¢å¼•ï¼Œä¸€èˆ¬å°±æ˜¯åœ¨ä½ çš„ where è¯­å¥ä¸­å‡ºç° betweenã€&lt;ã€&gt;ã€in ç­‰çš„æŸ¥è¯¢ã€‚ è¿™ç§èŒƒå›´æ‰«æç´¢å¼•æ¯”å…¨è¡¨æ‰«æè¦å¥½ï¼Œå› ä¸ºåªéœ€è¦å¼€å§‹äºç¼©å°çš„æŸä¸€ç‚¹ï¼Œè€Œç»“æŸäºå¦ä¸€ç‚¹ï¼Œä¸ç”¨æ‰«æå…¨éƒ¨ç´¢å¼•ã€‚ indexï¼šFull Index Scan ï¼Œindex ä¸ ALL çš„åŒºåˆ«ä¸º index ç±»å‹åªéå†ç´¢å¼•æ ‘ï¼Œè¿™é€šå¸¸æ¯” ALL å¿«ï¼Œå› ä¸ºç´¢å¼•æ–‡ä»¶é€šå¸¸æ¯”æ•°æ®æ–‡ä»¶å°ã€‚ ä¹Ÿå°±æ˜¯è¯´è™½ç„¶ ALL å’Œ index éƒ½æ˜¯è¯»å…¨è¡¨ï¼Œä½† index æ˜¯ä»ç´¢å¼•ä¸­è¯»å–çš„ï¼Œè€Œ ALL æ˜¯ä»ç¡¬ç›˜è¯»å–çš„ã€‚ allï¼šFull Table Scanï¼Œéå†å…¨è¡¨è·å¾—åŒ¹é…çš„è¡Œã€‚ å­—æ®µç±»å‹å’Œç¼–ç  MySQL è¿”å›å­—ç¬¦ä¸²é•¿åº¦ CHARACTER_LENGTH(åŒCHAR_LENGTH)æ–¹æ³•è¿”å›çš„æ˜¯å­—ç¬¦æ•°ï¼ŒLENGTH å‡½æ•°è¿”å›çš„æ˜¯å­—èŠ‚æ•°ï¼Œä¸€ä¸ªæ±‰å­—ä¸‰ä¸ªå­—èŠ‚ã€‚ varchar ç­‰å­—æ®µå»ºç«‹ç´¢å¼•é•¿åº¦è®¡ç®—è¯­å¥ select count(distinct left(test,5))/count(*) from tableï¼›è¶Šè¶‹è¿‘ 1 è¶Šå¥½ã€‚ MySQL çš„ utf8 MySQL çš„ utf8 æœ€å¤§æ˜¯ 3 ä¸ªå­—èŠ‚ä¸æ”¯æŒ emoji è¡¨æƒ…ç¬¦å·ï¼Œå¿…é¡»åªç”¨ utf8mb4ã€‚éœ€è¦åœ¨ MySQL é…ç½®æ–‡ä»¶ä¸­é…ç½®å®¢æˆ·ç«¯å­—ç¬¦é›†ä¸º utf8mb4ã€‚ JDBC çš„è¿æ¥ä¸²ä¸æ”¯æŒé…ç½® characterEncoding=utf8mb4ï¼Œæœ€å¥½çš„åŠæ³•æ˜¯åœ¨è¿æ¥æ± ä¸­æŒ‡å®šåˆå§‹åŒ– SQLã€‚ä¾‹å¦‚ï¼šhikari è¿æ¥æ± ï¼Œå…¶ä»–è¿æ¥æ± ç±»ä¼¼ spring . datasource . hikari . connection - init - sql =set names utf8mb4ã€‚å¦åˆ™éœ€è¦æ¯æ¬¡æ‰§è¡Œ SQL å‰éƒ½å…ˆæ‰§è¡Œ set names utf8mb4ã€‚ MySQL æ’åºè§„åˆ™ä¸€èˆ¬ä½¿ç”¨ _bin å’Œ _genera_ciï¼š utf8_genera_ci ä¸åŒºåˆ†å¤§å°å†™ï¼Œci ä¸º case insensitive çš„ç¼©å†™ï¼Œå³å¤§å°å†™ä¸æ•æ„Ÿã€‚ utf8_general_cs åŒºåˆ†å¤§å°å†™ï¼Œcs ä¸º case sensitive çš„ç¼©å†™ï¼Œå³å¤§å°å†™æ•æ„Ÿï¼Œä½†æ˜¯ç›®å‰ MySQL ç‰ˆæœ¬ä¸­å·²ç»ä¸æ”¯æŒç±»ä¼¼äº _genera_cs çš„æ’åºè§„åˆ™ï¼Œç›´æ¥ä½¿ç”¨ utf8_bin æ›¿ä»£ã€‚ utf8_bin å°†å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸€ä¸ªå­—ç¬¦ç”¨äºŒè¿›åˆ¶æ•°æ®å­˜å‚¨ï¼ŒåŒºåˆ†å¤§å°å†™ã€‚ é‚£ä¹ˆï¼ŒåŒæ ·æ˜¯åŒºåˆ†å¤§å°å†™ï¼Œutf8_general_cs å’Œ utf8_bin æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ cs ä¸º case sensitive çš„ç¼©å†™ï¼Œå³å¤§å°å†™æ•æ„Ÿï¼›bin çš„æ„æ€æ˜¯äºŒè¿›åˆ¶ï¼Œä¹Ÿå°±æ˜¯äºŒè¿›åˆ¶ç¼–ç æ¯”è¾ƒã€‚ utf8_general_cs æ’åºè§„åˆ™ä¸‹ï¼Œå³ä¾¿æ˜¯åŒºåˆ†äº†å¤§å°å†™ï¼Œä½†æ˜¯æŸäº›è¥¿æ¬§çš„å­—ç¬¦å’Œæ‹‰ä¸å­—ç¬¦æ˜¯ä¸åŒºåˆ†çš„ï¼Œæ¯”å¦‚ Ã¤=aï¼Œä½†æ˜¯æœ‰æ—¶å¹¶ä¸éœ€è¦ Ã¤=aï¼Œæ‰€ä»¥æ‰æœ‰ utf8_binã€‚ utf8_bin çš„ç‰¹ç‚¹åœ¨äºä½¿ç”¨å­—ç¬¦çš„äºŒè¿›åˆ¶çš„ç¼–ç è¿›è¡Œè¿ç®—ï¼Œä»»ä½•ä¸åŒçš„äºŒè¿›åˆ¶ç¼–ç éƒ½æ˜¯ä¸åŒçš„ï¼Œå› æ­¤åœ¨ utf8_bin æ’åºè§„åˆ™ä¸‹ï¼šÃ¤&lt;&gt;aã€‚ SQLè¯­å¥æ€»ç»“å¸¸ç”¨ä½†å®¹æ˜“å¿˜çš„ å¦‚æœæœ‰ä¸»é”®æˆ–è€…å”¯ä¸€é”®å†²çªåˆ™ä¸æ’å…¥ï¼šinsert ignore intoã€‚ å¦‚æœæœ‰ä¸»é”®æˆ–è€…å”¯ä¸€é”®å†²çªåˆ™æ›´æ–°ï¼Œæ³¨æ„è¿™ä¸ªä¼šå½±å“è‡ªå¢çš„å¢é‡ï¼šINSERT INTO room_remarks(room_id,room_remarks)VALUE(1,â€sdfâ€) ON DUPLICATE KEY UPDATE room_remarks = â€œ234â€ã€‚ å¦‚æœæœ‰å°±ç”¨æ–°çš„æ›¿ä»£ï¼Œvalues å¦‚æœä¸åŒ…å«è‡ªå¢åˆ—ï¼Œè‡ªå¢åˆ—çš„å€¼ä¼šå˜åŒ–ï¼šREPLACE INTO room_remarks(room_id,room_remarks) VALUE(1,â€sdfâ€)ã€‚ å¤‡ä»½è¡¨ï¼šCREATE TABLE user_info SELECT * FROM user_infoã€‚ å¤åˆ¶è¡¨ç»“æ„ï¼šCREATE TABLE user_v2 LIKE userã€‚ ä»æŸ¥è¯¢è¯­å¥ä¸­å¯¼å…¥ï¼šINSERT INTO user_v2 SELECT * FROM user æˆ–è€… INSERT INTO user_v2(id,num) SELECT id,num FROM userã€‚ è¿è¡¨æ›´æ–°ï¼šUPDATE user a, room b SET a.num=a.num+1 WHERE a.room_id=b.idã€‚ è¿è¡¨åˆ é™¤ï¼šDELETE user FROM user,black WHERE user.id=black.idã€‚ é”ç›¸å…³é”ç›¸å…³(ä½œä¸ºäº†è§£ï¼Œå¾ˆå°‘ç”¨)ï¼š å…±äº«é”ï¼šselect id from tb_test where id = 1 lock in share modeã€‚ æ’å®ƒé”ï¼šselect id from tb_test where id = 1 for updateã€‚ ä¼˜åŒ–æ—¶ç”¨åˆ° å¼ºåˆ¶ä½¿ç”¨æŸä¸ªç´¢å¼•ï¼šselect * from table force index(idx_user) limit 2ã€‚ ç¦æ­¢ä½¿ç”¨æŸä¸ªç´¢å¼•ï¼šselect * from table ignore index(idx_user) limit 2ã€‚ ç¦ç”¨ç¼“å­˜(åœ¨æµ‹è¯•æ—¶å»é™¤ç¼“å­˜çš„å½±å“)ï¼šselect SQL_NO_CACHE from table limit 2ã€‚ æŸ¥çœ‹çŠ¶æ€ æŸ¥çœ‹å­—ç¬¦é›†ï¼šSHOW VARIABLES LIKE â€˜character_set%â€™ã€‚ æŸ¥çœ‹æ’åºè§„åˆ™ï¼šSHOW VARIABLES LIKE â€˜collation%â€™ã€‚ SQLç¼–å†™æ³¨æ„ where è¯­å¥çš„è§£æé¡ºåºæ˜¯ä»å³åˆ°å·¦ï¼Œæ¡ä»¶å°½é‡æ”¾ where ä¸è¦æ”¾ havingã€‚ é‡‡ç”¨å»¶è¿Ÿå…³è”(deferred join)æŠ€æœ¯ä¼˜åŒ–è¶…å¤šåˆ†é¡µåœºæ™¯ï¼Œæ¯”å¦‚ limit 10000,10,å»¶è¿Ÿå…³è”å¯ä»¥é¿å…å›è¡¨ã€‚ distinct è¯­å¥éå¸¸æŸè€—æ€§èƒ½ï¼Œå¯ä»¥é€šè¿‡ group by æ¥ä¼˜åŒ–ã€‚ è¿è¡¨å°½é‡ä¸è¦è¶…è¿‡ä¸‰ä¸ªè¡¨ã€‚ è¸©å‘ å¦‚æœæœ‰è‡ªå¢åˆ—ï¼Œtruncate è¯­å¥ä¼šæŠŠè‡ªå¢åˆ—çš„åŸºæ•°é‡ç½®ä¸º 0ï¼Œæœ‰äº›åœºæ™¯ç”¨è‡ªå¢åˆ—ä½œä¸ºä¸šåŠ¡ä¸Šçš„ ID éœ€è¦ååˆ†é‡è§†ã€‚ èšåˆå‡½æ•°ä¼šè‡ªåŠ¨æ»¤ç©ºï¼Œæ¯”å¦‚ a åˆ—çš„ç±»å‹æ˜¯ int ä¸”å…¨éƒ¨æ˜¯ NULLï¼Œåˆ™ SUM(a) è¿”å›çš„æ˜¯ NULL è€Œä¸æ˜¯ 0ã€‚ MySQL åˆ¤æ–­ null ç›¸ç­‰ä¸èƒ½ç”¨ â€œa=nullâ€ï¼Œè¿™ä¸ªç»“æœæ°¸è¿œä¸º UnKnownï¼Œwhere å’Œ having ä¸­ï¼ŒUnKnown æ°¸è¿œè¢«è§†ä¸º falseï¼Œcheck çº¦æŸä¸­ï¼ŒUnKnown å°±ä¼šè§†ä¸º true æ¥å¤„ç†ã€‚æ‰€ä»¥è¦ç”¨â€œa is nullâ€å¤„ç†ã€‚ åƒä¸‡å¤§è¡¨åœ¨çº¿ä¿®æ”¹MySQL åœ¨è¡¨æ•°æ®é‡å¾ˆå¤§çš„æ—¶å€™ï¼Œå¦‚æœä¿®æ”¹è¡¨ç»“æ„ä¼šå¯¼è‡´é”è¡¨ï¼Œä¸šåŠ¡è¯·æ±‚è¢«é˜»å¡ã€‚MySQL åœ¨ 5.6 ä¹‹åå¼•å…¥äº†åœ¨çº¿æ›´æ–°ï¼Œä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹è¿˜æ˜¯ä¼šé”è¡¨ï¼Œæ‰€ä»¥ä¸€èˆ¬éƒ½é‡‡ç”¨ PT å·¥å…·( Percona Toolkit)ã€‚å¦‚å¯¹è¡¨æ·»åŠ ç´¢å¼•ï¼š 123pt-online-schema-change --user='root' --host='localhost' --ask-pass --alter \"add index idx_user_id(room_id,create_time)\" D=fission_show_room_v2,t=room_favorite_info --execute æ…¢æŸ¥è¯¢æ—¥å¿— æœ‰æ—¶å€™å¦‚æœçº¿ä¸Šè¯·æ±‚è¶…æ—¶ï¼Œåº”è¯¥å»å…³æ³¨ä¸‹æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œæ…¢æŸ¥è¯¢çš„åˆ†æå¾ˆç®€å•ï¼Œå…ˆæ‰¾åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶çš„ä½ç½®ï¼Œç„¶ååˆ©ç”¨ mysqldumpslow å»åˆ†æã€‚ æŸ¥è¯¢æ…¢æŸ¥è¯¢æ—¥å¿—ä¿¡æ¯å¯ä»¥ç›´æ¥é€šè¿‡æ‰§è¡Œ SQL å‘½ä»¤æŸ¥çœ‹ç›¸å…³å˜é‡ï¼Œå¸¸ç”¨çš„ SQL å¦‚ä¸‹ï¼š mysqldumpslow çš„å·¥å…·ååˆ†ç®€å•ï¼Œæˆ‘ä¸»è¦ç”¨åˆ°çš„å‚æ•°å¦‚ä¸‹ï¼š -tï¼šé™åˆ¶è¾“å‡ºçš„è¡Œæ•°ï¼Œæˆ‘ä¸€èˆ¬å–å‰åæ¡å°±å¤Ÿäº†ã€‚ -sï¼šæ ¹æ®ä»€ä¹ˆæ¥æ’åºé»˜è®¤æ˜¯å¹³å‡æŸ¥è¯¢æ—¶é—´ atï¼Œæˆ‘è¿˜ç»å¸¸ç”¨åˆ° c æŸ¥è¯¢æ¬¡æ•°ï¼Œå› ä¸ºæŸ¥è¯¢æ¬¡æ•°å¾ˆé¢‘ç¹ä½†æ˜¯æ—¶é—´ä¸é«˜ä¹Ÿæ˜¯æœ‰å¿…è¦ä¼˜åŒ–çš„ï¼Œè¿˜æœ‰ t æŸ¥è¯¢æ—¶é—´ï¼ŒæŸ¥çœ‹é‚£ä¸ªè¯­å¥ç‰¹åˆ«å¡ã€‚ -vï¼šè¾“å‡ºè¯¦ç»†ä¿¡æ¯ã€‚ ä¾‹å­ï¼šmysqldumpslow -v -s t -t 10 mysql_slow.log.2018-11-20-0500ã€‚ ä¸€äº›æ•°æ®åº“æ€§èƒ½çš„æ€è€ƒ åœ¨å¯¹å…¬å¸æ…¢æŸ¥è¯¢æ—¥å¿—åšä¼˜åŒ–çš„æ—¶å€™ï¼Œå¾ˆå¤šæ—¶å€™å¯èƒ½æ˜¯å¿˜äº†å»ºç´¢å¼•ï¼Œåƒè¿™ç§é—®é¢˜å¾ˆå®¹æ˜“è§£å†³ï¼ŒåŠ ä¸ªç´¢å¼•å°±è¡Œäº†ã€‚ä½†æ˜¯æœ‰å‡ ç§æƒ…å†µå°±ä¸æ˜¯ç®€å•åŠ ç´¢å¼•èƒ½è§£å†³äº† ä¸šåŠ¡ä»£ç å¾ªç¯è¯»æ•°æ®åº“ â€‹ è€ƒè™‘è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼Œè·å–ç”¨æˆ·ç²‰ä¸åˆ—è¡¨ä¿¡æ¯ï¼ŒåŠ å…¥åˆ†é¡µæ˜¯åä¸ªï¼Œå…¶å®åƒè¿™æ ·çš„ SQL æ˜¯ååˆ†ç®€å•çš„ï¼Œé€šè¿‡è¿è¡¨æŸ¥è¯¢æ€§èƒ½ä¹Ÿå¾ˆé«˜ã€‚ â€‹ ä½†æ˜¯æœ‰æ—¶å€™ï¼Œå¾ˆå¤šå¼€å‘é‡‡ç”¨äº†å–å‡ºä¸€ä¸² IDï¼Œç„¶åå¾ªç¯è¯»æ¯ä¸ª ID çš„ä¿¡æ¯ï¼Œè¿™æ ·å¦‚æœ ID å¾ˆå¤šå¯¹æ•°æ®åº“çš„å‹åŠ›æ˜¯å¾ˆå¤§çš„ï¼Œè€Œä¸”æ€§èƒ½ä¹Ÿå¾ˆä½ã€‚ ç»Ÿè®¡ SQL â€‹ å¾ˆå¤šæ—¶å€™ï¼Œä¸šåŠ¡ä¸Šéƒ½ä¼šæœ‰æ’è¡Œæ¦œè¿™ç§ï¼Œå‘ç°å…¬å¸æœ‰å¾ˆå¤šåœ°æ–¹ç›´æ¥é‡‡ç”¨æ•°æ®åº“åšè®¡ç®—ï¼Œåœ¨å¯¹ä¸€äº›å¤§è¡¨åšèšåˆè¿ç®—çš„æ—¶å€™ï¼Œç»å¸¸è¶…è¿‡äº”ç§’ï¼Œè¿™äº› SQL ä¸€èˆ¬å¾ˆé•¿è€Œä¸”å¾ˆéš¾ä¼˜åŒ–ã€‚åƒè¿™ç§åœºæ™¯ï¼Œå¦‚æœä¸šåŠ¡å…è®¸ï¼ˆæ¯”å¦‚ä¸€è‡´æ€§è¦æ±‚ä¸é«˜æˆ–è€…æ˜¯éš”ä¸€æ®µæ—¶é—´æ‰ç»Ÿè®¡çš„ï¼‰ï¼Œå¯ä»¥ä¸“é—¨åœ¨ä»åº“é‡Œé¢åšç»Ÿè®¡ã€‚å¦å¤–æˆ‘å»ºè®®è¿˜æ˜¯é‡‡ç”¨ Redis ç¼“å­˜æ¥å¤„ç†è¿™ç§ä¸šåŠ¡ã€‚ è¶…å¤§åˆ†é¡µ â€‹ åœ¨æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­å‘ç°äº†ä¸€äº›è¶…å¤§åˆ†é¡µçš„æ…¢æŸ¥è¯¢å¦‚ Limit 40000ï¼Œ1000ï¼Œå› ä¸º MySQL çš„åˆ†é¡µæ˜¯åœ¨ Server å±‚åšçš„ï¼Œå¯ä»¥é‡‡ç”¨å»¶è¿Ÿå…³è”åœ¨å‡å°‘å›è¡¨ã€‚ä½†æ˜¯çœ‹äº†ç›¸å…³çš„ä¸šåŠ¡ä»£ç æ­£å¸¸çš„ä¸šåŠ¡é€»è¾‘æ˜¯ä¸ä¼šå‡ºç°è¿™æ ·çš„è¯·æ±‚çš„ï¼Œæ‰€ä»¥å¾ˆæœ‰å¯èƒ½æ˜¯æœ‰æ¶æ„ç”¨æˆ·åœ¨åˆ·æ¥å£ï¼Œæœ€å¥½åœ¨å¼€å‘çš„æ—¶å€™ä¹Ÿå¯¹æ¥å£åŠ ä¸Šæ ¡éªŒæ‹¦æˆªè¿™äº›æ¶æ„è¯·æ±‚ã€‚","link":"/2019/07/03/mysqlç´¢å¼•ä¼˜åŒ–æ–¹æ¡ˆ.html"},{"title":"ä¸€æ¬¡æ•°æ®åº“çš„æ­»é”é—®é¢˜æ’æŸ¥è¿‡ç¨‹","text":"æ‘˜è¦æŸå¤©æ™šä¸Šï¼ŒåŒäº‹æ­£åœ¨å‘å¸ƒï¼Œçªç„¶çº¿ä¸Šå¤§é‡æŠ¥è­¦ï¼Œå¾ˆå¤šæ˜¯å…³äºæ•°æ®åº“æ­»é”çš„ï¼ŒæŠ¥è­¦æç¤ºä¿¡æ¯å¦‚ä¸‹ï¼š ç°è±¡æŸå¤©æ™šä¸Šï¼ŒåŒäº‹æ­£åœ¨å‘å¸ƒï¼Œçªç„¶çº¿ä¸Šå¤§é‡æŠ¥è­¦ï¼Œå¾ˆå¤šæ˜¯å…³äºæ•°æ®åº“æ­»é”çš„ï¼ŒæŠ¥è­¦æç¤ºä¿¡æ¯å¦‚ä¸‹ï¼š 123456789{\"errorCode\":\"SYSTEM_ERROR\",\"errorMsg\":\"nested exception is org.apache.ibatis.exceptions.PersistenceException: Error updating database. Cause: ERR-CODE: [TDDL-4614][ERR_EXECUTE_ON_MYSQL] Deadlock found when trying to get lock; The error occurred while setting parameters\\n### SQL: update fund_transfer_stream set gmt_modified=now(),state = ? where fund_transfer_order_no = ? and seller_id = ? and state = 'NEW' é€šè¿‡æŠ¥è­¦ï¼Œæˆ‘ä»¬åŸºæœ¬å¯ä»¥å®šä½åˆ°å‘ç”Ÿæ­»é”çš„æ•°æ®åº“ä»¥åŠæ•°æ®åº“è¡¨ã€‚å…ˆæ¥ä»‹ç»ä¸‹æœ¬æ–‡æ¡ˆä¾‹ä¸­æ¶‰åŠåˆ°çš„æ•°æ®åº“ç›¸å…³ä¿¡æ¯ã€‚ èƒŒæ™¯æƒ…å†µæˆ‘ä»¬ä½¿ç”¨çš„æ•°æ®åº“æ˜¯Mysql 5.7ï¼Œå¼•æ“æ˜¯InnoDBï¼Œäº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯READ-COMMITEDã€‚ æ•°æ®åº“ç‰ˆæœ¬æŸ¥è¯¢æ–¹æ³•ï¼š 1SELECT version(); å¼•æ“æŸ¥è¯¢æ–¹æ³•ï¼š 1show create table fund_transfer_stream; å»ºè¡¨è¯­å¥ä¸­ä¼šæ˜¾ç¤ºå­˜å‚¨å¼•æ“ä¿¡æ¯ï¼Œå½¢å¦‚ï¼šENGINE=InnoDB äº‹åŠ¡éš”ç¦»çº§åˆ«æŸ¥è¯¢æ–¹æ³•ï¼š 1select @@tx_isolation; äº‹åŠ¡éš”ç¦»çº§åˆ«è®¾ç½®æ–¹æ³•ï¼ˆåªå¯¹å½“å‰Sessionç”Ÿæ•ˆï¼‰ï¼š 1set session transaction isolation level read committed; PSï¼šæ³¨æ„ï¼Œå¦‚æœæ•°æ®åº“æ˜¯åˆ†åº“çš„ï¼Œä»¥ä¸Šå‡ æ¡SQLè¯­å¥éœ€è¦åœ¨å•åº“ä¸Šæ‰§è¡Œï¼Œä¸è¦åœ¨é€»è¾‘åº“æ‰§è¡Œã€‚ å‘ç”Ÿæ­»é”çš„è¡¨ç»“æ„åŠç´¢å¼•æƒ…å†µï¼ˆéšå»äº†éƒ¨åˆ†æ— å…³å­—æ®µå’Œç´¢å¼•ï¼‰ï¼š 1234567891011121314CREATE TABLE `fund_transfer_stream` ( `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®', `gmt_create` datetime NOT NULL COMMENT 'åˆ›å»ºæ—¶é—´', `gmt_modified` datetime NOT NULL COMMENT 'ä¿®æ”¹æ—¶é—´', `pay_scene_name` varchar(256) NOT NULL COMMENT 'æ”¯ä»˜åœºæ™¯åç§°', `pay_scene_version` varchar(256) DEFAULT NULL COMMENT 'æ”¯ä»˜åœºæ™¯ç‰ˆæœ¬', `identifier` varchar(256) NOT NULL COMMENT 'å”¯ä¸€æ€§æ ‡è¯†', `seller_id` varchar(64) NOT NULL COMMENT 'å–å®¶Id', `state` varchar(64) DEFAULT NULL COMMENT 'çŠ¶æ€', `fund_transfer_order_no` varchar(256) DEFAULT NULL COMMENT 'èµ„é‡‘å¹³å°è¿”å›çš„çŠ¶æ€', PRIMARY KEY (`id`),UNIQUE KEY `uk_scene_identifier` (KEY `idx_seller` (`seller_id`), KEY `idx_seller_transNo` (`seller_id`,`fund_transfer_order_no`(20)) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='èµ„é‡‘æµæ°´'; è¯¥æ•°æ®åº“å…±æœ‰ä¸‰ä¸ªç´¢å¼•ï¼Œ1ä¸ªèšç°‡ç´¢å¼•ï¼ˆä¸»é”®ç´¢å¼•ï¼‰ï¼Œ2ä¸ªéèšç°‡ç´¢ï¼ˆéä¸»é”®ç´¢å¼•ï¼‰å¼•ã€‚ èšç°‡ç´¢å¼•ï¼š 1PRIMARY KEY (`id`) éèšç°‡ç´¢å¼•ï¼š 123KEY `idx_seller` (`seller_id`),KEY `idx_seller_transNo` (`seller_id`,`fund_transfer_order_no`(20)) ä»¥ä¸Šä¸¤ä¸ªç´¢å¼•ï¼Œå…¶å®idx_seller_transNoå·²ç»è¦†ç›–åˆ°äº†idx_sellerï¼Œç”±äºå†å²åŸå› ï¼Œå› ä¸ºè¯¥è¡¨ä»¥seller_idåˆ†è¡¨ï¼Œæ‰€ä»¥æ˜¯å…ˆæœ‰çš„idx_sellerï¼Œåæœ‰çš„idx_seller_transNo æ­»é”æ—¥å¿—å½“æ•°æ®åº“å‘ç”Ÿæ­»é”æ—¶ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤è·å–æ­»é”æ—¥å¿—ï¼š 1show engine innodb status å‘ç”Ÿæ­»é”ï¼Œç¬¬ä¸€æ—¶é—´æŸ¥çœ‹æ­»é”æ—¥å¿—ï¼Œå¾—åˆ°æ­»é”æ—¥å¿—å†…å®¹å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243Transactions deadlock detected, dumping detailed information.2019-03-19T21:44:23.516263+08:00 5877341 [Note] InnoDB: *** (1) TRANSACTION:TRANSACTION 173268495, ACTIVE 0 sec fetching rowsmysql tables in use 1, locked 1LOCK WAIT 304 lock struct(s), heap size 41168, 6 row lock(s), undo log entries 1MySQL thread id 5877358, OS thread handle 47356539049728, query id 557970181 11.183.244.150 fin_instant_app updatingupdate `fund_transfer_stream` set `gmt_modified` = NOW(), `state` = 'PROCESSING' where ((`state` = 'NEW') AND (`seller_id` = '38921111') AND (`fund_transfer_order_no` = '99010015000805619031958363857'))2019-03-19T21:44:23.516321+08:00 5877341 [Note] InnoDB: *** (1) HOLDS THE LOCK(S):RECORD LOCKS space id 173 page no 13726 n bits 248 index idx_seller_transNo of table `xxx`.`fund_transfer_stream` trx id 173268495 lock_mode X locks rec but not gapRecord lock, heap no 168 PHYSICAL RECORD: n_fields 3; compact format; info bits 02019-03-19T21:44:23.516565+08:00 5877341 [Note] InnoDB: *** (1) WAITING FOR THIS LOCK TO BE GRANTED:RECORD LOCKS space id 173 page no 12416 n bits 128 index PRIMARY of table `xxx`.`fund_transfer_stream` trx id 173268495 lock_mode X locks rec but not gap waitingRecord lock, heap no 56 PHYSICAL RECORD: n_fields 17; compact format; info bits 02019-03-19T21:44:23.517793+08:00 5877341 [Note] InnoDB: *** (2) TRANSACTION:TRANSACTION 173268500, ACTIVE 0 sec fetching rows, thread declared inside InnoDB 81mysql tables in use 1, locked 1302 lock struct(s), heap size 41168, 2 row lock(s), undo log entries 1MySQL thread id 5877341, OS thread handle 47362313119488, query id 557970189 11.131.81.107 fin_instant_app updatingupdate `fund_transfer_stream_0056` set `gmt_modified` = NOW(), `state` = 'PROCESSING' where ((`state` = 'NEW') AND (`seller_id` = '38921111') AND (`fund_transfer_order_no` = '99010015000805619031957477256'))2019-03-19T21:44:23.517855+08:00 5877341 [Note] InnoDB: *** (2) HOLDS THE LOCK(S):RECORD LOCKS space id 173 page no 12416 n bits 128 index PRIMARY of table `fin_instant_0003`.`fund_transfer_stream_0056` trx id 173268500 lock_mode X locks rec but not gapRecord lock, heap no 56 PHYSICAL RECORD: n_fields 17; compact format; info bits 02019-03-19T21:44:23.519053+08:00 5877341 [Note] InnoDB: *** (2) WAITING FOR THIS LOCK TO BE GRANTED:RECORD LOCKS space id 173 page no 13726 n bits 248 index idx_seller_transNo of table `fin_instant_0003`.`fund_transfer_stream_0056` trx id 173268500 lock_mode X locks rec but not gap waitingRecord lock, heap no 168 PHYSICAL RECORD: n_fields 3; compact format; info bits 02019-03-19T21:44:23.519297+08:00 5877341 [Note] InnoDB: *** WE ROLL BACK TRANSACTION (2) ç®€å•è§£è¯»ä¸€ä¸‹æ­»é”æ—¥å¿—ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š 1ã€å¯¼è‡´æ­»é”çš„ä¸¤æ¡SQLè¯­å¥åˆ†åˆ«æ˜¯ï¼š 123update `fund_transfer_stream_0056` set `gmt_modified` = NOW(), `state` = 'PROCESSING' where ((`state` = 'NEW') AND (`seller_id` = '38921111') AND (`fund_transfer_order_no` = '99010015000805619031957477256')) å’Œ 123update `fund_transfer_stream_0056` set `gmt_modified` = NOW(), `state` = 'PROCESSING' where ((`state` = 'NEW') AND (`seller_id` = '38921111') AND (`fund_transfer_order_no` = '99010015000805619031958363857')) 2ã€äº‹åŠ¡1ï¼ŒæŒæœ‰ç´¢å¼•idx_seller_transNoçš„é”ï¼Œåœ¨ç­‰å¾…è·å–PRIMARYçš„é”ã€‚ 3ã€äº‹åŠ¡2ï¼ŒæŒæœ‰PRIMARYçš„é”ï¼Œåœ¨ç­‰å¾…è·å–idx_seller_transNoçš„é”ã€‚ 4ã€å› äº‹åŠ¡1å’Œäº‹åŠ¡2ä¹‹é—´å‘ç”Ÿå¾ªç¯ç­‰å¾…ï¼Œæ•…å‘ç”Ÿæ­»é”ã€‚ 5ã€äº‹åŠ¡1å’Œäº‹åŠ¡2å½“å‰æŒæœ‰çš„é”å‡ä¸ºï¼šlock_mode X locks rec but not gap ä¸¤ä¸ªäº‹åŠ¡å¯¹è®°å½•åŠ çš„éƒ½æ˜¯X é”ï¼ŒNo Gapé”ï¼Œå³å¯¹å½“è¡Œè®°å½•åŠ é”ï¼Œå¹¶ä¸ºåŠ é—´éš™é”ã€‚ Xé”ï¼šæ’ä»–é”ã€åˆç§°å†™é”ã€‚è‹¥äº‹åŠ¡Tå¯¹æ•°æ®å¯¹è±¡AåŠ ä¸ŠXé”ï¼Œäº‹åŠ¡Tå¯ä»¥è¯»Aä¹Ÿå¯ä»¥ä¿®æ”¹Aï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½å†å¯¹AåŠ ä»»ä½•é”ï¼Œç›´åˆ°Té‡Šæ”¾Aä¸Šçš„é”ã€‚è¿™ä¿è¯äº†å…¶ä»–äº‹åŠ¡åœ¨Té‡Šæ”¾Aä¸Šçš„é”ä¹‹å‰ä¸èƒ½å†è¯»å–å’Œä¿®æ”¹Aã€‚ ä¸ä¹‹å¯¹åº”çš„æ˜¯Sé”ï¼šå…±äº«é”ï¼Œåˆç§°è¯»é”ï¼Œè‹¥äº‹åŠ¡Tå¯¹æ•°æ®å¯¹è±¡AåŠ ä¸ŠSé”ï¼Œåˆ™äº‹åŠ¡Tå¯ä»¥è¯»Aä½†ä¸èƒ½ä¿®æ”¹Aï¼Œå…¶ä»–äº‹åŠ¡åªèƒ½å†å¯¹AåŠ Sé”ï¼Œè€Œä¸èƒ½åŠ Xé”ï¼Œç›´åˆ°Té‡Šæ”¾Aä¸Šçš„Sé”ã€‚è¿™ä¿è¯äº†å…¶ä»–äº‹åŠ¡å¯ä»¥è¯»Aï¼Œä½†åœ¨Té‡Šæ”¾Aä¸Šçš„Sé”ä¹‹å‰ä¸èƒ½å¯¹Aåšä»»ä½•ä¿®æ”¹ã€‚ Gap Lockï¼šé—´éš™é”ï¼Œé”å®šä¸€ä¸ªèŒƒå›´ï¼Œä½†ä¸åŒ…æ‹¬è®°å½•æœ¬èº«ã€‚GAPé”çš„ç›®çš„ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢åŒä¸€äº‹åŠ¡çš„ä¸¤æ¬¡å½“å‰è¯»ï¼Œå‡ºç°å¹»è¯»çš„æƒ…å†µã€‚ Next-Key Lockï¼š1+2ï¼Œé”å®šä¸€ä¸ªèŒƒå›´ï¼Œå¹¶ä¸”é”å®šè®°å½•æœ¬èº«ã€‚å¯¹äºè¡Œçš„æŸ¥è¯¢ï¼Œéƒ½æ˜¯é‡‡ç”¨è¯¥æ–¹æ³•ï¼Œä¸»è¦ç›®çš„æ˜¯è§£å†³å¹»è¯»çš„é—®é¢˜ã€‚ è¯¦è§ï¼šhttps://www.cnblogs.com/zhoujinyi/p/3435982.html ã€ https://dev.mysql.com/doc/refman/5.7/en/innodb-transaction-isolation-levels.html é—®é¢˜æ’æŸ¥æ ¹æ®æˆ‘ä»¬ç›®å‰å·²çŸ¥çš„æ•°æ®åº“ç›¸å…³ä¿¡æ¯ï¼Œä»¥åŠæ­»é”çš„æ—¥å¿—ï¼Œæˆ‘ä»¬åŸºæœ¬å¯ä»¥åšä¸€äº›ç®€å•çš„åˆ¤å®šã€‚ é¦–å…ˆï¼Œæ­¤æ¬¡æ­»é”ä¸€å®šæ˜¯å’ŒGapé”ä»¥åŠNext-Key Lockæ²¡æœ‰å…³ç³»çš„ã€‚å› ä¸ºæˆ‘ä»¬çš„æ•°æ®åº“éš”ç¦»çº§åˆ«æ˜¯RCï¼ˆREAD-COMMITEDï¼‰çš„ï¼Œè¿™ç§éš”ç¦»çº§åˆ«æ˜¯ä¸ä¼šæ·»åŠ Gapé”çš„ã€‚å‰é¢çš„æ­»é”æ—¥å¿—ä¹Ÿæåˆ°è¿™ä¸€ç‚¹ã€‚ ç„¶åï¼Œå°±è¦ç¿»ä»£ç äº†ï¼Œçœ‹çœ‹æˆ‘ä»¬çš„ä»£ç ä¸­äº‹åŠ¡åˆ°åº•æ˜¯æ€ä¹ˆåšçš„ã€‚æ ¸å¿ƒä»£ç åŠSQLå¦‚ä¸‹ï¼š 12345@Transactional(rollbackFor = Exception.class)public int doProcessing(String sellerId, Long id, String fundTransferOrderNo) { fundTreansferStreamDAO.updateFundStreamId(sellerId, id, fundTransferOrderNo); return fundTreansferStreamDAO.updateStatus(sellerId, fundTransferOrderNo, FundTransferStreamState.PROCESSING.name());} è¯¥ä»£ç çš„ç›®çš„æ˜¯å…ˆåä¿®æ”¹åŒä¸€æ¡è®°å½•çš„ä¸¤ä¸ªä¸åŒå­—æ®µï¼ŒupdateFundStreamId SQLï¼š 123update fund_transfer_stream set gmt_modified=now(),fund_transfer_order_no = #{fundTransferOrderNo} where id = #{id} and seller_id = #{sellerId} updateStatus SQLï¼š 1234update fund_transfer_stream set gmt_modified=now(),state = #{state} where fund_transfer_order_no = #{fundTransferOrderNo} and seller_id = #{sellerId} and state = 'NEW' å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„åŒä¸€ä¸ªäº‹åŠ¡ä¸­æ‰§è¡Œäº†ä¸¤æ¡Updateè¯­å¥ï¼Œè¿™é‡Œåˆ†åˆ«æŸ¥çœ‹ä¸‹ä¸¤æ¡SQLçš„æ‰§è¡Œè®¡åˆ’ï¼š updateFundStreamIdæ‰§è¡Œçš„æ—¶å€™ä½¿ç”¨åˆ°çš„æ˜¯PRIMARYç´¢å¼•ã€‚ updateStatusæ‰§è¡Œçš„æ—¶å€™ä½¿ç”¨åˆ°çš„æ˜¯idx_seller_transNoç´¢å¼•ã€‚ é€šè¿‡æ‰§è¡Œè®¡åˆ’ï¼Œæˆ‘ä»¬å‘ç°updateStatuså…¶å®æ˜¯æœ‰ä¸¤ä¸ªç´¢å¼•å¯ä»¥ç”¨çš„ï¼Œæ‰§è¡Œçš„æ—¶å€™çœŸæ­£ä½¿ç”¨çš„æ˜¯idx_seller_transNoç´¢å¼•ã€‚è¿™æ˜¯å› ä¸ºMySQLæŸ¥è¯¢ä¼˜åŒ–å™¨æ˜¯åŸºäºä»£ä»·ï¼ˆcost-basedï¼‰çš„æŸ¥è¯¢æ–¹å¼ã€‚å› æ­¤ï¼Œåœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­ï¼Œæœ€é‡è¦çš„ä¸€éƒ¨åˆ†æ˜¯æ ¹æ®æŸ¥è¯¢çš„SQLè¯­å¥ï¼Œä¾æ®å¤šç§ç´¢å¼•ï¼Œè®¡ç®—æŸ¥è¯¢éœ€è¦çš„ä»£ä»·ï¼Œä»è€Œé€‰æ‹©æœ€ä¼˜çš„ç´¢å¼•æ–¹å¼ç”ŸæˆæŸ¥è¯¢è®¡åˆ’ã€‚ æˆ‘ä»¬æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’æ˜¯åœ¨æ­»é”å‘ç”Ÿä¹‹ååšçš„ï¼Œäº‹åæŸ¥è¯¢çš„æ‰§è¡Œè®¡åˆ’å’Œå‘ç»³æ­»é”é‚£ä¸€åˆ»çš„ç´¢å¼•ä½¿ç”¨æƒ…å†µå¹¶ä¸ä¸€å®šç›¸åŒçš„ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ç»“åˆæ­»é”æ—¥å¿—ï¼Œä¹Ÿå¯ä»¥å®šä½åˆ°ä»¥ä¸Šä¸¤æ¡SQLè¯­å¥æ‰§è¡Œçš„æ—¶å€™ä½¿ç”¨åˆ°çš„ç´¢å¼•ã€‚å³updateFundStreamIdæ‰§è¡Œçš„æ—¶å€™ä½¿ç”¨åˆ°çš„æ˜¯PRIMARYç´¢å¼•ï¼ŒupdateStatusæ‰§è¡Œçš„æ—¶å€™ä½¿ç”¨åˆ°çš„æ˜¯idx_seller_transNoç´¢å¼•ã€‚ æœ‰äº†ä»¥ä¸Šè¿™äº›å·²çŸ¥ä¿¡æ¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ’æŸ¥æ­»é”åŸå› åŠå…¶èƒŒåçš„åŸç†äº†ã€‚é€šè¿‡åˆ†ææ­»é”æ—¥å¿—ï¼Œå†ç»“åˆæˆ‘ä»¬çš„ä»£ç ä»¥åŠæ•°æ®åº“å»ºè¡¨è¯­å¥ï¼Œæˆ‘ä»¬å‘ç°ä¸»è¦é—®é¢˜å‡ºåœ¨æˆ‘ä»¬çš„idx_seller_transNoç´¢å¼•ä¸Šé¢ï¼š 1KEY `idx_seller_transNo` (`seller_id`,`fund_transfer_order_no`(20)) ç´¢å¼•åˆ›å»ºè¯­å¥ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å‰ç¼€ç´¢å¼•ï¼Œä¸ºäº†èŠ‚çº¦ç´¢å¼•ç©ºé—´ï¼Œæé«˜ç´¢å¼•æ•ˆç‡ï¼Œæˆ‘ä»¬åªé€‰æ‹©äº†fund_transfer_order_noå­—æ®µçš„å‰20ä½ä½œä¸ºç´¢å¼•å€¼ã€‚ å› ä¸ºfund_transfer_order_noåªæ˜¯æ™®é€šç´¢å¼•ï¼Œè€Œéå”¯ä¸€æ€§ç´¢å¼•ã€‚åˆå› ä¸ºåœ¨ä¸€ç§ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œä¼šæœ‰åŒä¸€ä¸ªç”¨æˆ·çš„ä¸¤ä¸ªfund_transfer_order_noçš„å‰20ä½ç›¸åŒï¼Œè¿™å°±å¯¼è‡´ä¸¤æ¡ä¸åŒçš„è®°å½•çš„ç´¢å¼•å€¼ä¸€æ ·ï¼ˆå› ä¸ºseller_id å’Œfund_transfer_order_no(20)éƒ½ç›¸åŒ ï¼‰ã€‚ å°±å¦‚æœ¬æ–‡ä¸­çš„ä¾‹å­ï¼Œå‘ç”Ÿæ­»é”çš„ä¸¤æ¡è®°å½•çš„fund_transfer_order_noå­—æ®µçš„å€¼ï¼š99010015000805619031958363857å’Œ99010015000805619031957477256è¿™ä¸¤ä¸ªå°±æ˜¯å‰20ä½ç›¸åŒçš„ã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆfund_transfer_order_noçš„å‰20ä½ç›¸åŒä¼šå¯¼è‡´æ­»é”å‘¢ï¼Ÿ åŠ é”åŸç†æˆ‘ä»¬å°±æ‹¿æœ¬æ¬¡çš„æ¡ˆä¾‹æ¥çœ‹ä¸€ä¸‹MySqlæ•°æ®åº“åŠ é”çš„åŸç†æ˜¯æ€æ ·çš„ï¼Œæœ¬æ–‡çš„æ­»é”èƒŒååˆå‘ç”Ÿäº†ä»€ä¹ˆã€‚ æˆ‘ä»¬åœ¨æ•°æ®åº“ä¸Šæ¨¡æ‹Ÿæ­»é”åœºæ™¯ï¼Œæ‰§è¡Œé¡ºåºå¦‚ä¸‹ï¼š äº‹åŠ¡1 äº‹åŠ¡2 æ‰§è¡Œç»“æœ begin update fund_transfer_stream set gmt_modified=now(),fund_transfer_order_no = â€˜99010015000805619031958363857â€™ where id = 1 and seller_id = 3111095611; æ‰§è¡ŒæˆåŠŸ begin update fund_transfer_stream set gmt_modified=now(),fund_transfer_order_no = â€˜99010015000805619031957477256â€™ where id = 2 and seller_id = 3111095611; æ‰§è¡ŒæˆåŠŸ update fund_transfer_stream set gmt_modified = NOW(), state = â€˜PROCESSINGâ€™ where ((state = â€˜NEWâ€™) AND (seller_id = â€˜3111095611â€™) AND (fund_transfer_order_no = â€˜99010015000805619031958363857â€™)); é˜»å¡ update fund_transfer_stream set gmt_modified = NOW(), state = â€˜PROCESSINGâ€™ where ((state = â€˜NEWâ€™) AND (seller_id = â€˜3111095611â€™) AND (fund_transfer_order_no = â€˜99010015000805619031957477256â€™)); æ­»é” æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨MySQLä¸­ï¼Œè¡Œçº§é”å¹¶ä¸æ˜¯ç›´æ¥é”è®°å½•ï¼Œè€Œæ˜¯é”ç´¢å¼•ã€‚ç´¢å¼•åˆ†ä¸ºä¸»é”®ç´¢å¼•å’Œéä¸»é”®ç´¢å¼•ä¸¤ç§ï¼Œå¦‚æœä¸€æ¡sqlè¯­å¥æ“ä½œäº†ä¸»é”®ç´¢å¼•ï¼ŒMySQLå°±ä¼šé”å®šè¿™æ¡ä¸»é”®ç´¢å¼•ï¼›å¦‚æœä¸€æ¡è¯­å¥æ“ä½œäº†éä¸»é”®ç´¢å¼•ï¼ŒMySQLä¼šå…ˆé”å®šè¯¥éä¸»é”®ç´¢å¼•ï¼Œå†é”å®šç›¸å…³çš„ä¸»é”®ç´¢å¼•ã€‚ ä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜çš„æ˜¯æ•´è¡Œæ•°æ®ã€‚åœ¨InnoDBä¸­ï¼Œä¸»é”®ç´¢å¼•ä¹Ÿè¢«ç§°ä¸ºèšç°‡ç´¢å¼•ï¼ˆclustered indexï¼‰ éä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹çš„å†…å®¹æ˜¯ä¸»é”®çš„å€¼ï¼Œåœ¨InnoDBä¸­ï¼Œéä¸»é”®ç´¢å¼•ä¹Ÿè¢«ç§°ä¸ºéèšç°‡ç´¢å¼•ï¼ˆsecondary indexï¼‰ æ‰€ä»¥ï¼Œæœ¬æ–‡çš„ç¤ºä¾‹ä¸­æ¶‰åŠåˆ°çš„ç´¢å¼•ç»“æ„ï¼ˆç´¢å¼•æ˜¯B+æ ‘ï¼Œç®€åŒ–æˆè¡¨æ ¼äº†ï¼‰å¦‚å›¾ï¼š æ­»é”çš„å‘ç”Ÿä¸å¦ï¼Œå¹¶ä¸åœ¨äºäº‹åŠ¡ä¸­æœ‰å¤šå°‘æ¡SQLè¯­å¥ï¼Œæ­»é”çš„å…³é”®åœ¨äºï¼šä¸¤ä¸ª(æˆ–ä»¥ä¸Š)çš„SessionåŠ é”çš„é¡ºåºä¸ä¸€è‡´ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥å°±çœ‹ä¸‹ä¸Šé¢çš„ä¾‹å­ä¸­ä¸¤ä¸ªäº‹åŠ¡çš„åŠ é”é¡ºåºæ˜¯æ€æ ·çš„ï¼š ä¸‹å›¾æ˜¯åˆ†è§£å›¾ï¼Œæ¯ä¸€æ¡SQLæ‰§è¡Œçš„æ—¶å€™åŠ é”æƒ…å†µï¼š ç»“åˆä»¥ä¸Šä¸¤å¼ å›¾ï¼Œæˆ‘ä»¬å‘ç°äº†å¯¼è‡´æ­»é”çš„åŸå› ï¼š äº‹åŠ¡1æ‰§è¡Œupdate1å ç”¨PRIMARY = 1çš„é” â€”â€”&gt; äº‹åŠ¡2æ‰§è¡Œupdate1 å æœ‰PRIMARY = 2çš„é”ï¼› äº‹åŠ¡1æ‰§è¡Œupdate2å æœ‰idx_seller_transNo = (3111095611ï¼Œ99010015000805619031)çš„é”ï¼Œå°è¯•å æœ‰PRIMARY = 2é”å¤±è´¥ï¼ˆé˜»å¡ï¼‰ï¼› äº‹åŠ¡2æ‰§è¡Œupdate2å°è¯•å æœ‰idx_seller_transNo = (3111095611ï¼Œ99010015000805619031)çš„é”å¤±è´¥ï¼ˆæ­»é”ï¼‰ï¼› äº‹åŠ¡åœ¨ä»¥éä¸»é”®ç´¢å¼•ä¸ºwhereæ¡ä»¶è¿›è¡ŒUpdateçš„æ—¶å€™ï¼Œä¼šå…ˆå¯¹è¯¥éä¸»é”®ç´¢å¼•åŠ é”ï¼Œç„¶åå†æŸ¥è¯¢è¯¥éä¸»é”®ç´¢å¼•å¯¹åº”çš„ä¸»é”®ç´¢å¼•éƒ½æœ‰å“ªäº›ï¼Œå†å¯¹è¿™äº›ä¸»é”®ç´¢å¼•è¿›è¡ŒåŠ é”ã€‚ï¼‰ è§£å†³æ–¹æ³•è‡³æ­¤ï¼Œæˆ‘ä»¬åˆ†ææ¸…æ¥šäº†å¯¼è‡´æ­»é”çš„æ ¹æœ¬åŸç†ä»¥åŠå…¶èƒŒåçš„åŸç†ã€‚é‚£ä¹ˆè¿™ä¸ªé—®é¢˜è§£å†³èµ·æ¥å°±ä¸éš¾äº†ã€‚ å¯ä»¥ä»ä¸¤æ–¹é¢å…¥æ‰‹ï¼Œåˆ†åˆ«æ˜¯ä¿®æ”¹ç´¢å¼•å’Œä¿®æ”¹ä»£ç ï¼ˆåŒ…å«SQLè¯­å¥ï¼‰ã€‚ ä¿®æ”¹ç´¢å¼•ï¼šåªè¦æˆ‘ä»¬æŠŠå‰ç¼€ç´¢å¼• idx_seller_transNoä¸­fund_transfer_order_noçš„å‰ç¼€é•¿åº¦ä¿®æ”¹ä¸‹å°±å¯ä»¥äº†ã€‚æ¯”å¦‚æ”¹æˆ50ã€‚å³å¯é¿å…æ­»é”ã€‚ ä½†æ˜¯ï¼Œæ”¹äº†idx_seller_transNoçš„å‰ç¼€é•¿åº¦åï¼Œå¯ä»¥è§£å†³æ­»é”çš„å‰ææ¡ä»¶æ˜¯updateè¯­å¥çœŸæ­£æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šç”¨åˆ°fund_transfer_order_noç´¢å¼•ã€‚å¦‚æœMySQLæŸ¥è¯¢ä¼˜åŒ–å™¨åœ¨ä»£ä»·åˆ†æä¹‹åï¼Œå†³å®šä½¿ç”¨ç´¢å¼• KEY idx_seller(seller_id)ï¼Œé‚£ä¹ˆè¿˜æ˜¯ä¼šå­˜åœ¨æ­»é”é—®é¢˜ã€‚åŸç†å’Œæœ¬æ–‡ç±»ä¼¼ã€‚ æ‰€ä»¥ï¼Œæ ¹æœ¬è§£å†³åŠæ³•å°±æ˜¯æ”¹ä»£ç ï¼š 12* æ‰€æœ‰updateéƒ½é€šè¿‡ä¸»é”®IDè¿›è¡Œã€‚* åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œé¿å…å‡ºç°å¤šæ¡updateè¯­å¥ä¿®æ”¹åŒä¸€æ¡è®°å½•ã€‚ æ€»ç»“ä¸æ€è€ƒåœ¨æ­»é”å‘ç”Ÿä¹‹åçš„ä¸€å‘¨å†…ï¼Œæˆ‘å‡ ä¹æ¯å¤©éƒ½ä¼šæŠ½ç©ºç ”ç©¶ä¸€ä¼šï¼Œé—®é¢˜æ—©æ—©çš„å°±å®šä½åˆ°äº†ï¼Œä¿®æ”¹æ–¹æ¡ˆä¹Ÿæœ‰äº†ï¼Œä½†æ˜¯å…¶ä¸­åŸç†ä¸€ç›´æ²¡ææ¸…æ¥šã€‚ å‰å‰åååšè¿‡å¾ˆå¤šä¸­ç§æ¨æ–­åŠå‡è®¾ï¼Œåˆéƒ½è¢«è‡ªå·±ä¸€æ¬¡æ¬¡æ¨ç¿»ã€‚æœ€ç»ˆè¿˜æ˜¯è¦é å®è·µæ¥éªŒè¯è‡ªå·±çš„æƒ³æ³•ã€‚äºæ˜¯æˆ‘è‡ªå·±åœ¨æœ¬åœ°å®‰è£…äº†æ•°æ®åº“ï¼Œå®æˆ˜çš„åšäº†äº›æµ‹è¯•ï¼Œå¹¶å®æ—¶æŸ¥çœ‹æ•°æ®åº“é”æƒ…å†µã€‚show engine innodb status ;å¯ä»¥æŸ¥çœ‹é”æƒ…å†µã€‚æœ€ç»ˆæ‰ææ¸…æ¥šåŸç†ã€‚ ç®€å•è¯´å‡ ç‚¹æ€è€ƒï¼š 1ã€é‡åˆ°é—®é¢˜ï¼Œä¸è¦çŒœï¼ï¼ï¼äº²æ‰‹å¤ç°ä¸‹é—®é¢˜ï¼Œç„¶åå†æ¥åˆ†æã€‚ 2ã€ä¸è¦å¿½ç•¥ä¸Šä¸‹æ–‡ï¼ï¼ï¼æˆ‘åˆšå¼€å§‹å°±æ˜¯åªå…³æ³¨æ­»é”æ—¥å¿—ï¼Œä¸€ç›´å¿½ç•¥äº†ä»£ç ä¸­çš„äº‹åŠ¡å…¶å®è¿˜æ‰§è¡Œäº†å¦å¤–ä¸€æ¡SQLè¯­å¥ï¼ˆupdateFundStreamIdï¼‰ã€‚ 3ã€ç†è®ºçŸ¥è¯†å†å……è¶³ï¼Œå…³é”®æ—¶åˆ»ä¸ä¸€å®šæƒ³çš„èµ·æ¥ï¼ï¼ï¼ 4ã€å‘éƒ½æ˜¯è‡ªå·±åŸ‹çš„ï¼ï¼ï¼ å‚è€ƒèµ„æ–™ï¼šMySQL åŠ é”å¤„ç†åˆ†æ innodb äº‹åŠ¡éš”ç¦»çº§åˆ« ã€ŠMySqlå®æˆ˜45è®²ã€‹ MySQLä¸­çš„è¡Œçº§é”,è¡¨çº§é”,é¡µçº§é” æŸ¥çœ‹åŸæ–‡","link":"/2019/06/25/ä¸€æ¬¡æ•°æ®åº“çš„æ­»é”é—®é¢˜æ’æŸ¥è¿‡ç¨‹.html"},{"title":"åšå®¢å›¾ç‰‡ä¸Šä¼ picgoå·¥å…·githubå›¾ä¼ ä½¿ç”¨","text":"æ‘˜è¦å¯¹äºæ¯ä¸€ä¸ªå†™åšå®¢çš„äººæ¥è¯´ï¼Œå›¾ç‰‡æ˜¯è‡³å…³é‡è¦ã€‚è¿™ä¸€è·¯ç»å†äº†å¤šæ¬¡å›¾ç‰‡çš„çƒ¦æ¼ï¼Œä¹‹å‰é€‰æ‹©äº†å¾®åšä¸ªäººæ–‡ç« é‚£é‡Œç²˜è´´å›¾ç‰‡çš„æ–¹å¼ä¸Šä¼ ï¼Œæ„Ÿè§‰ä¹ŸæŒºæ–¹ä¾¿çš„ã€‚ä½†æ˜¯ç”±äºæ–°æµªçš„å›¾ç‰‡æ˜¾ç¤ºé—®é¢˜ï¼Œå¦‚æœheaderä¸­ä¸è®¾ç½® æ ‡ç­¾å°±ä¸èƒ½å¼‚æ­¥è®¿é—®å›¾ç‰‡ï¼Œå¯¼è‡´å›¾è£‚ï¼Œé‚£ä¹‹æ¶å¿ƒã€‚ç„¶è€Œè®¾ç½®ä¹‹ååˆä¸ç½‘ç«™è®¿å®¢ç»Ÿè®¡çš„æ’ä»¶å†²çªï¼Œä½¿ä¹‹ä¸èƒ½ç»Ÿè®¡ï¼ŒçœŸæ˜¯ç¥ä»™æ‰“æ¶ã€‚æ— èµ–ä¹‹ä¸‹ä½¿ç”¨äº†PicGoå·¥å…·ï¼Œä½¿ç”¨åæ„Ÿè§‰çœŸXXæ–¹ä¾¿ï¼ PicGoå·¥å…·ä¸‹è½½å®‰è£…é…ç½®ä¸‹è½½ .PicGoä¸‹è½½ githubç½‘ç«™æä¾›ä¸‰ä¸ªç‰ˆæœ¬çš„ä¸‹è½½ï¼ŒMacOsã€linuxã€windowsè¦†ç›–å¸‚é¢ä¸Š90%ç³»ç»Ÿï¼Œè¿˜æ˜¯å¾ˆç»™åŠ›äº†ã€‚ æˆ‘æ˜¯macç”¨æˆ·ï¼Œç›´æ¥ä½¿ç”¨brew caskæ¥å®‰è£…PicGo: brew cask install picgoï¼Œç®€ç›´æ–¹ä¾¿åˆ°çˆ†ã€‚ é…ç½® PicGoé…ç½®(ä½¿ç”¨githubå›¾ä¼ ï¼Œå…è´¹æ–¹ä¾¿ï¼ŒåŒæ—¶é…åˆgithub.ioåšå®¢çœŸæ˜¯æ–¹ä¾¿) é€‰ä¸Šå¿…å¡«çš„å°±ok,ä¸€å¼€å§‹ä¸çŸ¥é“tokençš„è®¾ç½®ï¼Œé™„èµ tokenè·å–æ–¹æ³• å›¾ç‰‡ä¸Šä¼ ç›¸å…³çš„è®¾ç½® é“¾æ¥æ ¼å¼ï¼šé€‰æ‹©é€‚åˆè‡ªå·±çš„ï¼Œä¸€èˆ¬ç”¨æˆ·mdæ–‡ä»¶ä¸­ï¼Œé€‰ç¬¬ä¸€ä¸ªï¼Œç„¶åå°±å¯ä»¥ç–¯ç‹‚ä½¿ç”¨äº†ã€‚ ä½¿ç”¨githubå›¾ä¼ ï¼Œè·å–tokenåœ¨github-&gt;setting-&gt;developer settings é€‰æ‹©generate new token å‹¾é€‰å¥½ä¹‹åç”Ÿæˆå°±å¥½äº† ä½¿ç”¨ PicGoä½¿ç”¨ï¼Œç®€ç›´æ–¹ä¾¿ 1).é»˜è®¤ç½‘é¡µä¸Šç›´æ¥å³é”®å¤åˆ¶å›¾ç‰‡ 2).ç‚¹å‡»ç­‰å¾…ä¸­çš„å›¾ç‰‡ï¼Œå¼€å§‹ä¸Šä¼  3).ä¸Šä¼ å®Œä¹‹åæœ‰ä¸ªæç¤ºï¼ŒåŒæ—¶ç²˜è´´æ¿ä¹Ÿä¼šè‡ªåŠ¨ç²˜è´´ä¸Š 4).ç›´æ¥ç²˜è´´åˆ°æƒ³è¦çš„åœ°æ–¹ æˆ–è€…ä¹Ÿå¯ä»¥ç›´æ¥æˆªå›¾ï¼Œç„¶åç‚¹å‡»å›¾ç‰‡é‡Œçš„å›¾ç‰‡ä¸Šä¼ ï¼Œå¾ˆæ–¹ä¾¿ PicGoä¸Šä¼ åŠ¨å›¾gif å¦‚æœç›´æ¥å¤åˆ¶ç½‘é¡µä¸Šçš„åŠ¨å›¾ï¼Œå»ä¸Šä¼ çš„è¯æ˜¯æˆªå–çš„æŸå¸§ï¼Œæ˜¯é™å›¾ã€‚åº”è¯¥ä¸‹è½½åˆ°æœ¬åœ°ï¼Œç„¶ååœ¨æ‹–è¿›å»ä¸Šä¼ å°±å¯ä»¥äº†ã€‚","link":"/2019/06/20/åšå®¢å›¾ç‰‡ä¸Šä¼ picgoå·¥å…·githubå›¾ä¼ ä½¿ç”¨.html"},{"title":"é˜¿é‡Œä¸€å¹´çš„æˆé•¿ç»å†","text":"æ‘˜è¦ä»»ä½•å·¥ä½œä¸€å®šå¯¹ä¸ªäººéƒ½æ˜¯æœ‰æå‡çš„ï¼Œä½†æ˜¯ä¸ä¼šæ€»ç»“çš„äººï¼Œåœ¨æ¯ä¸ªé¡¹ç›®/éœ€æ±‚ä¸­æˆé•¿çš„ä¸œè¥¿éƒ½æ˜¯æ•£çš„ï¼Œä¹…è€Œä¹…ä¹‹å°±å¿˜äº†ã€‚é€šè¿‡å……åˆ†çš„æ€»ç»“ä¹‹åï¼ŒçŠ¯è¿‡çš„é”™è¯¯æˆ‘ä»¬ä¸ä¼šäºŒæ¬¡å†çŠ¯ï¼Œç†æ¸…æ¥šçš„ä¸šåŠ¡çš„æ¥é¾™å»è„‰é“­è®°åœ¨å¿ƒï¼Œå¯¹è‡ªå·±æ˜¯ä¸€ç§æå‡ï¼Œåˆ†äº«ç»™åˆ«äººå¯¹åˆ«äººä¹Ÿæ˜¯å¾ˆå¤§çš„å¸®åŠ©ã€‚å¤±è´¥è€…å¤±è´¥çš„åŸå› å„æœ‰ä¸åŒï¼ŒæˆåŠŸè€…çš„åšäº‹æ–¹å¼æ€»æ˜¯ç›¸ä¼¼çš„ï¼Œä»å®è§‚è§’åº¦å»çœ‹ï¼Œæˆ‘è®¤ä¸ºæ€»ç»“å°±æ˜¯æˆåŠŸè€…ä¹‹æ‰€ä»¥èƒ½æˆåŠŸï¼Œå¾ˆé‡è¦ä¸€ä¸ªåŸå› ã€‚ åº”å½“å¦‚ä½•é¢å¯¹çº¿ä¸Šçš„å¼‚å¸¸/æ•…éšœçœ‹èµ·æ¥æ¯«æ— æ„ä¹‰çš„ä¸€ä¸ªé—®é¢˜ï¼Œç¢°åˆ°çº¿ä¸Šå¼‚å¸¸/æ•…éšœå¦‚ä½•é¢å¯¹ï¼Œæ’æŸ¥è§£å†³äº†ä¸å°±å¥½äº†ï¼Œä½†æ˜¯è¿™çœŸçš„åªæ˜¯ç¬¬ä¸€å±‚ æœ€è¿‘åœ¨æƒ³â€œæ¶ˆé˜²â€è¿™ä¸ªè¯è¯­å¾ˆæœ‰æ„æ€ï¼Œå®ƒå…¶å®æ˜¯ä¸¤å±‚æ„æ€ï¼š â€œæ¶ˆâ€æ˜¯æ¶ˆé™¤é—®é¢˜ â€œé˜²â€æ˜¯é˜²æ­¢é—®é¢˜ å³â€œæ¶ˆé˜²â€è¿™ä¸ªè¯è¯­è¡¨è¾¾çš„æ„æ€åº”è¯¥æ˜¯å…ˆæ¶ˆé™¤é—®é¢˜å†é˜²æ­¢ç›¸åŒçš„é—®é¢˜å†æ¬¡å‘ç”Ÿã€‚å…¶å®çº¿ä¸Šçš„å¼‚å¸¸/æ•…éšœä¹Ÿæ˜¯åŒæ ·çš„é“ç†ï¼Œæˆ‘ä»¬åº”å½“å…ˆåŠæ—¶æ­¢è¡€ï¼ŒæŠŠé—®é¢˜å¤„ç†æ‰ï¼Œç„¶åæ·±æŒ–é—®é¢˜ï¼Œæ¢ç©¶æ ¹å› ï¼Œä¸¾å‡ ä¸ªä¾‹å­ï¼š å‡è®¾æ˜¯æŸæ®µä»£ç çš„ç©ºæŒ‡é’ˆå¼‚å¸¸å¯¼è‡´çš„ï¼Œé‚£ä¹ˆæ˜¯å¦è€ƒè™‘åŠ å¼ºCode Reviewï¼Œæˆ–è€…ä½¿ç”¨findbugsæ’ä»¶å»è‡ªåŠ¨æ‰«æä»£ç ä¸­å¯èƒ½çš„å¼‚å¸¸ï¼Ÿ å‡è®¾æ˜¯çº¿ä¸ŠæŸä¸ªé…ç½®ä¿®æ”¹å¯¼è‡´çš„ï¼Œé‚£ä¹ˆæ˜¯å¦ä»Šåå˜æ›´çš„ä¿®æ”¹å¿…é¡»æœ‰äººåŒé‡æ£€æŸ¥ä¸€éæ‰å¯ä»¥ä¿®æ”¹ï¼Ÿ å‡è®¾æ˜¯æœ¬åœ°å†…å­˜ä¸­æŸäº›å€¼å› ä¸ºç³»ç»Ÿé‡å¯ä¸¢å¤±å¯¼è‡´çš„ï¼Œé‚£ä¹ˆæ˜¯å¦å¼•å…¥å®šæ—¶ä»»åŠ¡ï¼Œå®šæ—¶æŠŠå€¼å†™å…¥æœ¬åœ°å†…å­˜ä¸­ï¼Ÿ å‡è®¾æ˜¯æŸæ®µä»£ç é€»è¾‘æ²¡æµ‹è¯•åˆ°å¯¼è‡´çš„ï¼Œé‚£ä¹ˆæ˜¯å¦å¯ä»¥åæ€æ€»ç»“ä¸ºä»€ä¹ˆè¿™æ®µé€»è¾‘æ²¡æœ‰æµ‹è¯•åˆ°ï¼Œæœªæ¥çš„æµ‹è¯•åº”è¯¥å¦‚ä½•æ”¹è¿›ï¼Ÿ æ ¹æ®æˆ‘è¿‡å¾€çš„ç»éªŒï¼Œå¤ªå¤šå…¬å¸ã€å¤ªå¤šå›¢é˜Ÿå¤„ç†çº¿ä¸Šçš„é—®é¢˜ä»…ä»…æ»¡è¶³äºæŠŠé—®é¢˜å¤„ç†å®Œå°±å®Œäº‹ï¼Œå¿½ç•¥äº†å¯¹é—®é¢˜çš„å¤ç›˜ï¼Œè¿™å¯¹å›¢é˜Ÿ/å¯¹å…¬å¸çš„å‘å±•éƒ½æ˜¯ä¸åˆ©çš„ã€‚ ä»€ä¹ˆæ˜¯çœŸæ­£çš„æŠ€æœ¯èƒ½åŠ›ä¹‹å‰åŠ äº†å‡ ä¸ªæŠ€æœ¯å¾®ä¿¡ç¾¤ï¼Œçœ‹åˆ°å¾ˆå¤šæŠ€æœ¯æœ‹å‹åœ¨å…´é«˜é‡‡çƒˆåœ°è®¨è®ºå„ç§æºç ï¼Œspringæºç æˆ‘å½»åº•æ’¸äº†ä¸€éã€æœ€è¿‘æ·±å…¥å­¦ä¹ äº†dubboåº•å±‚å®ç°æ–¹å¼ï¼Œå½“ç„¶æ›¾ç»çš„æˆ‘ä¹Ÿæ˜¯è¿™æ ·çš„ï¼Œè®°å¾—å­¦ä¹ volatileçš„æ—¶å€™ä¸€ç›´æŒ–åˆ°äº†volatileåœ¨ç¡¬ä»¶å±‚é¢ä¸Šçš„å®ç°æ–¹å¼ï¼Œä½†æ˜¯è¿™çœŸçš„è¯´æ˜æŠ€æœ¯èƒ½åŠ›å¼ºå—ï¼Ÿä»ä»Šå¤©çš„æ€è€ƒå»çœ‹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘è®¤ä¸ºè¿™æ›´å¤šååº”çš„æ˜¯ä¸€ä¸ªäººçš„å­¦ä¹ èƒ½åŠ›ã€é’»ç ”èƒ½åŠ›ä»¥åŠå¯¹æŠ€æœ¯çš„çƒ­æƒ…ï¼Œé™¤æ­¤ä¹‹å¤–å†ä½“ç°ä¸å‡ºå¤ªå¤šå…¶ä»–ä¸œè¥¿äº†ã€‚ è¿™ä¸ªè¯é¢˜ï¼Œå¯èƒ½æ˜¯è¿™ä¸€å¹´æ€è€ƒçš„æœ€å¤šä¸ªçš„ä¸€ä¸ªç‚¹ï¼Œé’»ç ”æ˜¯å¥½äº‹ï¼Œä½†æ˜¯å®é™…ä¸Šå¤§å¤šæ—¶å€™çš„æ·±å…¥é’»ç ”å¹¶ä¸åœ¨å®é™…å·¥ä½œä¸­æœ‰ç”¨ï¼Œä¸”ç ”ç©¶å¾—è¶Šæ·±ï¼Œå¿˜å¾—è¶Šå¿«ï¼Œå› ä¸ºç ”ç©¶å¾—è¶Šæ·±ï¼Œé‚£ä¹ˆè¿™ä¸ªæŠ€æœ¯ç‚¹å…³è”çš„æŠ€æœ¯ç‚¹å°±è¶Šå¤šï¼Œè¾¹è¾¹è§’è§’çš„å¿˜äº†ï¼Œæ ¸å¿ƒçš„ä¸œè¥¿ä¸å®¹æ˜“ä¸²èµ·æ¥ã€‚é‚£ä¹ˆä»€ä¹ˆæ˜¯çœŸæ­£çš„æŠ€æœ¯èƒ½åŠ›ï¼Œæˆ‘ç”»ä¸€å¼ å›¾æ¦‚æ‹¬ä¸€ä¸‹ï¼š æŠ€æœ¯èƒ½åŠ›=è§£å†³é—®é¢˜çš„èƒ½åŠ›(è§£å†³å½“ä¸‹é—®é¢˜+è§£å†³é•¿è¿œé—®é¢˜) ç®€è€Œè¨€ä¹‹ï¼ŒæŠ€æœ¯èƒ½åŠ› = è§£å†³é—®é¢˜çš„èƒ½åŠ›ï¼Œé‚£ä¹ˆåŒæ ·éƒ½åœ¨è§£å†³é—®é¢˜ï¼Œå¤§å®¶ä¹‹é—´çš„æŠ€æœ¯é«˜ä½åˆæœ‰ä»€ä¹ˆåŒºåˆ†å‘¢ï¼Ÿæˆ‘è®¤ä¸ºæœ‰ä»¥ä¸‹å‡ ä¸ªå±‚æ¬¡ï¼š ç¬¬ä¸€å±‚çº§ï¼Œè§£å†³å½“ä¸‹é—®é¢˜ ç¬¬äºŒå±‚çº§ï¼Œä»¥ä¼˜é›…ä¸”å¯å¤ç”¨çš„æ–¹å¼è§£å†³å½“ä¸‹é—®é¢˜ ç¬¬ä¸‰å±‚çº§ï¼Œè§£å†³çš„é—®é¢˜ä¸ä»…ä»…èƒ½æ»¡è¶³å½“ä¸‹ï¼Œè¿˜èƒ½æ»¡è¶³æœªæ¥ä¸€æ®µæ—¶é—´ å…¶å®ä»è¿™ä¸ªè§’åº¦ä¸Šæ¥çœ‹ï¼Œä¸åŒçš„æŠ€æœ¯èƒ½åŠ›ï¼Œåœ¨å·¥ä½œè¿‡ç¨‹ä¸­åŒºåˆ†åº¦æ˜¯å¾ˆæ˜æ˜¾çš„ï¼š å†™çš„ä»£ç æ˜¯å¦å­˜åœ¨å¼‚å¸¸é£é™©ï¼Œå¤šçº¿ç¨‹è¿è¡Œä¸‹æ˜¯å¦å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼ŒæŸæ®µä»£ç æ˜¯å¦ä¼šå¯¼è‡´å†…å­˜æ³„éœ² å†™çš„ä»£ç æ˜¯å¦ä¼˜é›…å¯å¤ç”¨ï¼Œè®¾è®¡çš„æ¡†æ¶æ˜¯å¦è¶³å¤Ÿç¬¦åˆå¼€é—­åŸåˆ™ï¼Œä»£ç ç»“æ„å±‚æ¬¡æ˜¯å¦æ¸…æ™°æ˜äº† é’ˆå¯¹ç‰¹å®šçš„åœºæ™¯ï¼ŒæŠ€æœ¯é€‰å‹ã€åº“è¡¨ç»“æ„è®¾è®¡æ˜¯å¦è¶³å¤Ÿåˆç†ï¼Œä»Šå¤©ä½ è®¾è®¡çš„æ¡†æ¶æ˜¯åªèƒ½ç”¨ä¸€å¹´ï¼Œè¿˜æ˜¯æœªæ¥ä¸‰å¹´äº”å¹´éƒ½å¯ä»¥æŒç»­ä½¿ç”¨ æ¥äº†ä¸€ä¸ªå¤§çš„éœ€æ±‚ï¼Œå°±æ¯”å¦‚åšä¸€ä¸ªAppçš„ä¼šå‘˜ä½“ç³»åŠŸèƒ½å¥½äº†ï¼Œæ˜¯å¦å¯ä»¥åœ¨å……åˆ†åˆ†æéœ€æ±‚åï¼Œç²¾ç¡®å°†éœ€æ±‚åˆ’åˆ†ä¸ºå‡ ä¸ªç‰¹å®šçš„å­æ¨¡å—å¹¶æ¢³ç†æ¸…æ¥šæ¨¡å—ä¹‹é—´çš„å…³ç³» è¶Šå‰å®³çš„äººï¼Œåœ¨ä»£ç è®¾è®¡ä¸å¼€å‘è¿‡ç¨‹ä¸­ï¼Œè¶Šèƒ½çœ‹åˆ°æƒ³åˆ°ä¸€äº›åˆ«äººçœ‹ä¸åˆ°æƒ³ä¸åˆ°çš„é—®é¢˜ï¼Œè¿™å«åšé«˜å±‹å»ºç“´ï¼›å½“ä»£ç è¿è¡Œå‡ºç°é—®é¢˜çš„æ—¶å€™ï¼Œæœ‰äºº1å°æ—¶æ’æŸ¥å‡ºé—®é¢˜ï¼Œæœ‰äºº1åˆ†é’Ÿå‘ç°é—®é¢˜ï¼Œè¿™å«åšä¸¾é‡è‹¥è½»ã€‚ å› æ­¤æˆ‘è®¤ä¸ºè§£å†³é—®é¢˜çš„èƒ½åŠ›æ‰æ˜¯æŠ€æœ¯èƒ½åŠ›çš„çœŸæ­£ä½“ç°ï¼Œè¿™ä¸€å¹´å¯¹æŠ€æœ¯çš„æ¢ç©¶æˆ‘ä¹Ÿä»ç ”ç©¶æºç æ›´å¤šçš„è½¬å˜å»å­¦ä¹ è®¾è®¡æ¨¡å¼ã€å»å­¦ä¹ åˆ†å¸ƒå¼ç¯å¢ƒä¸‹å„ç§NoSqlçš„é€‰å‹å¯¹æ¯”ã€å»å­¦ä¹ ä½¿ç”¨Lambdaè®©ä»£ç æ›´ç®€æ´ï¼Œå¾€çœŸæ­£åœ¨å®é™…å·¥ä½œä¸­è§£å†³é—®é¢˜çš„æ–¹å‘å»åŠªåŠ›ã€‚ å¦å¤–ï¼ŒæŠ›å¼€è¿™ä¸ªç‚¹ï¼Œè¿™ä¸¤å¤©æˆ‘åœ¨æ€è€ƒï¼Œè¿˜æœ‰ä¸€ä¸ªä½“ç°æŠ€æœ¯èƒ½åŠ›çš„ç‚¹ï¼Œå°±æ˜¯å­¦ä¹ èƒ½åŠ›ã€‚ç°å®ä¸­çš„å…¨æ ˆæ˜¯å¾ˆå°‘çš„ï¼Œäº’è”ç½‘è¿™ä¸ªè¡Œä¸šçš„ç¨‹åºå‘˜çš„æ–¹å‘é€šå¸¸æœ‰å‡ ç±»ï¼š æœåŠ¡ç«¯ å‰ç«¯ ç§»åŠ¨ç«¯ AI åµŒå…¥å¼ å¤§æ•°æ® åœ¨åŒä¸€ç±»ä¸­ï¼ŒåŸºç¡€çŸ¥è¯†ã€åŸºæœ¬æ¦‚å¿µã€æ€ç»´æ–¹å‘æ˜¯ä¸€è‡´çš„ï¼Œæ›´å¤šå¯èƒ½å·®å¼‚åœ¨å¼€å‘å·¥å…·ã€è¯­è¨€ä¸Šï¼Œæˆ‘ç²¾é€šJavaï¼Œä½†æ˜¯å¦‚æœæ˜å¤©æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œä½¿ç”¨nodejsã€scalaã€goæ›´å¥½ï¼Œé‚£ä¹ˆæ˜¯å¦å¯ä»¥å¿«é€Ÿå­¦ä¹ ã€å¿«é€Ÿä¸Šæ‰‹ï¼Ÿç”šè‡³æ˜å¤©æœ‰ä¸€ä¸ªéœ€æ±‚éœ€è¦å†™å‰ç«¯ä»£ç ï¼Œæ˜¯å¦å¯ä»¥å¿«é€Ÿå¼€å‘ã€æ— bugä¸Šçº¿ï¼Ÿ æ‰€ä»¥ï¼Œè§£å†³é—®é¢˜çš„èƒ½åŠ› + å­¦ä¹ èƒ½åŠ›ï¼Œæ˜¯æˆ‘è®¤ä¸ºçœŸæ­£çš„æŠ€æœ¯èƒ½åŠ›ï¼Œä¸è¿‡è¯´åˆ°åº•ï¼Œå­¦ä¹ èƒ½åŠ›æŸç§ç¨‹åº¦ä¸Šä¹Ÿåªæ˜¯ä¸ºäº†è§£å†³é—®é¢˜è€Œå·²ã€‚ ä¸è¦é€ è½®å­æ›¾å‡ ä½•æ—¶ï¼Œå½“æˆ‘ä»¬çœ‹ç€githubä¸Šè¿™ä¹ˆå¤šä¼˜ç§€çš„æºä»£ç çš„æ—¶å€™ï¼Œé»˜é»˜ç«‹èª“ï¼Œè¿™è¾ˆå­æˆ‘ä¸€å®šè¦å†™å‡ºä¸€ä¸ªç‰›é€¼çš„æ¡†æ¶ï¼Œå¼€æºåœ¨ç½‘ä¸Šã€‚ æ›¾å‡ ä½•æ—¶ï¼Œå…¬å¸æ‹›è˜çš„æ—¶å€™ï¼ŒæŠ€æœ¯è´Ÿè´£äººæ¿€æƒ…æ»¡æ»¡åœ°ä»‹ç»ç€å…¬å¸å†…éƒ¨è‡ªç ”äº†å¤šå°‘ç³»ç»Ÿå¹¶åœ¨çº¿ä¸ŠæŠ•å…¥ä½¿ç”¨ã€‚ å¾ˆå¤šå¯¹æŠ€æœ¯æœ‰è¿½æ±‚çš„æœ‹å‹ï¼Œè¿›å…¥ä¸€å®¶å…¬å¸å¯èƒ½æ—¶æ—¶åˆ»åˆ»åœ¨å¯»æ‰¾æœºä¼šå»åšä¸€äº›è‡ªå·±é€ è½®å­çš„äº‹æƒ…ï¼Œä½†æ˜¯å°±å¦‚åŒå‰é¢æ‰€è¯´çš„ï¼Œè¡¡é‡çœŸæ­£å¥½æŠ€æœ¯çš„æ ‡å‡†å°±æ˜¯èƒ½å¦å®å®åœ¨åœ¨åœ°è§£å†³é—®é¢˜ï¼Œè‡ªå·±é€ è½®å­é£é™©é«˜ã€å‘¨æœŸé•¿ï¼Œä¸”éœ€è¦é•¿æ—¶é—´çš„éªŒè¯ã€æ’å‘æ‰èƒ½è¾¾åˆ°æ¯”è¾ƒå¥½çš„æ•ˆæœã€‚ éšä¾¿ä¸¾å‡ ä¸ªä¾‹å­ï¼Œåœ¨äº’è”ç½‘å‘å±•çš„ä»Šå¤©ï¼š æ•°æ®åº“è¿æ¥æ± æœ‰dbcpã€c3p0ã€druid æœ¬åœ°ç¼“å­˜æœ‰ehcacheã€è¦ç”¨ä¸­å¿ƒç¼“å­˜æœ‰redisã€tail æœåŠ¡åŒ–æœ‰dubboã€è·¨è¯­è¨€å¯ä»¥ç”¨thrift åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¯ä»¥è€ƒè™‘schedulex æœç´¢å¯ä»¥é€‰esã€solr æ›´é«˜çº§ä¸€ç‚¹å›¾ç‰‡å­˜å‚¨å¯ä»¥ç”¨ä¸ƒç‰›ã€imå¯ä»¥ç”¨èäº‘/ç¯ä¿¡ã€éŸ³è§†é¢‘è¿™å—å£°ç½‘åšå¾—æ¯”è¾ƒæˆç†Ÿï¼Œæ‰€æœ‰è¿™äº›éƒ½æä¾›äº†å„ä¸ªå¼€å‘ç‰ˆæœ¬çš„sdkï¼Œæ¥å…¥ç®€å• åªè¦ä½ æœ‰çš„æŠ€æœ¯æ–¹é¢çš„éœ€æ±‚ï¼Œç»å¤§å¤šæ•°ä¸šç•Œå·²ç»æœ‰äº†æˆç†Ÿçš„è§£å†³æ–¹æ¡ˆäº†ï¼Œæ ¹æœ¬ä¸éœ€è¦å»ä¸“é—¨è‡ªå·±æä¸€å¥—ã€‚å› æ­¤æˆ‘è®¤ä¸ºè½»æ˜“ä¸€å®šä¸è¦é€ è½®å­ï¼Œå¦‚æœä¸€å®šè¦é€ è½®å­ï¼Œé‚£ä¹ˆè¯·æƒ³æ¸…æ¥šä¸‹é¢å‡ ä¸ªé—®é¢˜ï¼š ä½ è¦åšçš„äº‹æƒ…æ˜¯å¦å½“å‰å·²ç»æœ‰äº†ç±»ä¼¼è§£å†³æ–¹æ¡ˆï¼Ÿ å¦‚æœæœ‰ï¼Œé‚£ä¹ˆä½ è‡ªå·±åšçš„è¿™ä¸€å¥—ä¸œè¥¿å’Œç±»ä¼¼è§£å†³æ–¹æ¡ˆçš„å·®å¼‚ç‚¹åœ¨å“ªé‡Œï¼Ÿå‡è®¾ä¸ç”¨ä½ è¿™å¥—ï¼ŒåŸºäºå·²æœ‰çš„è§£å†³æ–¹æ¡ˆç¨åŠ æ”¹é€ æ˜¯å¦å°±èƒ½è¾¾åˆ°ç›®çš„ï¼Ÿ å¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¹‹å‰æ²¡æœ‰ï¼Ÿæ˜¯ä½ ä»¬å…¬å¸è¿™ç§åœºæ™¯æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Ÿè¿˜æ˜¯è¿™ç§åœºæ™¯å¯¹åº”çš„è§£å†³æ–¹æ¡ˆæ ¹æœ¬å°±æ˜¯ä¸å¯è¡Œçš„æ‰€ä»¥ä¹‹å‰æ²¡äººå»æï¼Ÿ å¦‚æœæƒ³æ¸…æ¥šäº†è¿™äº›é—®é¢˜ï¼Œé‚£ä¹ˆå°±å»å¹²å§ã€‚ å»æå‡çœ‹é—®é¢˜çš„é«˜åº¦è¿‡å»æœ‰å¤ªå¤šäººåœ¨æˆ‘çš„å…¬ä¼—å·æˆ–è€…åšå®¢ä¸‹åé¦ˆäº†ä¸€ä¸ªé—®é¢˜ï¼šåœ¨è¿™ä¸ªå…¬å¸ï¼Œæ•´å¤©åšç€å¢åˆ æ”¹æŸ¥çš„å·¥ä½œï¼Œå¯¹è‡ªå·±ä¸€ç‚¹éƒ½æ²¡æœ‰æé«˜ã€‚ å¯¹äºè¿™ç§çœ‹æ³•ï¼Œè¯´éš¾å¬ç‚¹å°±æ˜¯å››ä¸ªå­—â€”-ç›®å…‰çŸ­æµ…ã€‚æˆ‘ä»¬çœ‹ï¼šå¦‚æœä»¥æ™®é€šçš„è§†è§’å»çœ‹ï¼Œé‚£ä¹ˆä¸€é¢—æ ‘é‚£ä¹Ÿå°±åªæ˜¯ä¸€æ£µæ ‘è€Œå·²ï¼Œä½†æ˜¯å¦‚æœè·³è„±å‡ºç›®å‰çš„è§†è§’ï¼Œç«™åœ¨æ›´é«˜çš„è§’åº¦å»çœ‹ï¼Œå®ƒå…¶å®æ˜¯æ£®æ—çš„ä¸€éƒ¨åˆ†ã€‚ä½ çš„ä¸»ç®¡å¹¶ä¸æ˜¯å› ä¸ºä»–æ˜¯ä½ çš„ä¸»ç®¡æ‰€ä»¥ä»–å°±åº”è¯¥ä½ æ¯”æ›´é«˜ç»è¿œç©ï¼Œè€Œæ˜¯å› ä¸ºä»–çœ‹é—®é¢˜çš„é«˜åº¦æ¯”ä½ æ›´é«˜ã€æƒ³å¾—æ›´è¿œã€åšå¾—æ›´æ·±ï¼Œæ‰€ä»¥æ‰æˆä¸ºäº†ä½ çš„ä¸»ç®¡ã€‚ æŠŠè¿™ä¸ªé—®é¢˜è¯´å¾—å®é™…ç‚¹ï¼š å‡è®¾ä»Šå¤©ä½ è´Ÿè´£çš„æ˜¯ä¸€ä¸ªç³»ç»Ÿï¼Œé‚£ä¹ˆä½ ä»…ä»…æ˜¯æŠŠè¿™ä¸ªç³»ç»Ÿçš„åŸºæœ¬åŸç†ææ‡‚äº†ï¼Ÿè¿˜æ˜¯å¯ä»¥æŠŠä¸Šä¸‹æ¸¸æœ‰å‡ ä¸ªç³»ç»Ÿã€æ¯ä¸ªç³»ç»Ÿä¹‹é—´å¦‚ä½•è°ƒç”¨ã€ä¾èµ–æ–¹å¼éƒ½ç†é¡ºï¼Ÿ å‡è®¾ä»Šå¤©ä½ è´Ÿè´£çš„æ˜¯ä¸€å—ä¸šåŠ¡ï¼Œé‚£ä¹ˆä½ ä»…ä»…æŠŠè‡ªå·±è´Ÿè´£çš„åŠŸèƒ½ç‚¹å¼„æ¸…æ¥šäº†ï¼Ÿè¿˜æ˜¯ä½ å¯ä»¥ä»æœ€ä¸Šæ¸¸å¼€å§‹ï¼Œåˆ°ä½ è´Ÿè´£çš„ç³»ç»Ÿï¼Œå†åˆ°æœ€ä¸‹æ¸¸ï¼Œéƒ½æ€è€ƒå¾—éå¸¸é€å½»ï¼Ÿ ä»Šå¤©ä¸å…¶åœ¨æŠ±æ€¨æ²¡æœ‰æœºä¼šã€æŠ±æ€¨å…¬å¸å¯¹è‡ªå·±èƒ½åŠ›æ²¡æœ‰æå‡ï¼Œä¸ºä»€ä¹ˆä¸å»æ€è€ƒæœºä¼šä¸ºä»€ä¹ˆé™ä¸´åœ¨åˆ«äººå¤´ä¸Šä¸é™ä¸´åœ¨ä½ å¤´ä¸Šï¼Ÿä¸ºä»€ä¹ˆåˆ«äººå¯ä»¥ä»å°å…¬å¸å†™ç€ä¸€æ ·çš„å¢åˆ æ”¹æŸ¥èµ°å‘BATè€Œä½ å¹´å¤ä¸€å¹´è¿˜åœ¨å°å…¬å¸å†™ç€å¢åˆ æ”¹æŸ¥ï¼Ÿå½“ä½ çœŸæ­£èƒ½è½¬å˜è‡ªå·±çš„æ€ç»´æ¨¡å¼ï¼Œè·³è„±å‡ºç°åœ¨çš„åœˆå­å¾€æ›´é«˜ä¸€ä¸ªå±‚æ¬¡å»çœ‹é—®é¢˜ã€å»æå‡è‡ªå·±ï¼Œæˆ‘ç›¸ä¿¡æ€»ä¼šæœ‰å‘å…‰å‘çƒ­çš„ä¸€å¤©çš„ã€‚ åŒæ ·åœ¨é˜¿é‡Œå·´å·´ï¼Œé©¬è€å¸ˆæ€è€ƒè‡ªç„¶ã€æ€è€ƒç¯ä¿ã€æ€è€ƒäººç±»çš„å‘å±•ï¼Œä½ çš„ä¸»ç®¡æ€è€ƒå›¢é˜Ÿæœªæ¥çš„æ–¹å‘å’Œæ‰“æ³•ï¼Œæˆ‘ä»¬åœ¨æ€è€ƒå¦‚ä½•æŠŠæŸä¸ªå®¢æˆ·éœ€æ±‚å®Œæ•´è½åœ°ï¼Œè¿™å°±æ˜¯é«˜åº¦ï¼Œä½ æœªå¿…èƒ½æƒ³åˆ°é©¬è€å¸ˆæƒ³çš„ï¼Œä½†æ˜¯ä½ å¯¹æ ‡å±‚çº§é«˜ä¸€ç‚¹çš„äººï¼Œä¸€æ­¥ä¸€æ­¥å°è¯•å¾€ä»–ä»¬çš„é«˜åº¦å»é ã€‚ æ€»è€Œè¨€ä¹‹ï¼šçœ¼ç•Œå†³å®šé«˜åº¦ï¼Œå¤šçœ‹ã€å¤šæƒ³ã€å¤šä¿æŒå¥½å¥‡å¿ƒã€å¤šé—®å‡ ä¸ªä¸ºä»€ä¹ˆï¼Œä¹…è€Œä¹…ä¹‹è‡ªç„¶å°±è¿ˆä¸Šäº†ä¸€ä¸ªæ–°çš„å°é˜¶ã€‚ å­¦ä¼šæ€»ç»“éœ€æ±‚ã€é¡¹ç›®çš„å¤ç›˜æ˜¯éå¸¸é‡è¦çš„ä¸€éƒ¨åˆ†å†…å®¹ï¼Œç„¶è€Œæˆ‘ä¹‹å‰è§è¿‡çš„å¤ªå¤šå›¢é˜Ÿã€å¤ªå¤šLeaderï¼Œåªé¡¾ç€ä¸€ä¸ªè¿­ä»£æ¥ç€ä¸€ä¸ªè¿­ä»£ï¼Œä¸€ä¸ªç‰ˆæœ¬æ¥ç€ä¸€ä¸ªç‰ˆæœ¬ï¼Œåªæ»¡è¶³äºæŠŠéœ€æ±‚åšå¥½ï¼Œè€Œå¿½ç•¥äº†æ€»ç»“çš„é‡è¦æ€§ã€‚ æˆ‘è®¤ä¸ºå¤§åˆ°é¡¹ç›®ã€å°åˆ°éœ€æ±‚ï¼Œå¦‚æœåœ¨å®Œæˆä¹‹åç¼ºä¹æ€»ç»“é‚£ä¹ˆæŸç§ç¨‹åº¦ä¸Šæ¥è¯´æ˜¯å¤±è´¥çš„ï¼Œå¯ä»¥æ€»ç»“çš„ç‚¹éå¸¸å¤šï¼š é€šè¿‡è¿™ä¸ªé¡¹ç›®/éœ€æ±‚ï¼Œæ˜¯å¦åƒé€äº†æŸä¸€å—ä¸šåŠ¡ï¼Œææ‡‚äº†æ¥é¾™å»è„‰ é€šè¿‡è¿™ä¸ªé¡¹ç›®/éœ€æ±‚ï¼Œæ˜¯å¦å……åˆ†ç†è§£äº†å…¬å¸æŸä¸ªæŠ€æœ¯æ¡†æ¶/åŸºç¡€ç»„ä»¶çš„ç”¨æ³• åœ¨æ•´ä¸ªé¡¹ç›®çš„è®¾è®¡ä¸Šï¼Œæœ‰å“ªäº›åšçš„ä¸å¥½çš„åœ°æ–¹ åœ¨æ•´ä¸ªé¡¹ç›®çš„å¼€å‘ï¼ˆé’ˆå¯¹ç¨‹åºå‘˜è€Œè¨€ï¼‰ï¼Œæ˜¯å¦è¸©äº†å‘ï¼ŒçŠ¯äº†ä½çº§çš„é”™è¯¯ åœ¨æ•´ä¸ªé¡¹ç›®çš„è¿›åº¦æŠŠæ§ä¸Šã€äººå‘˜å®‰æ’ä¸Šã€ä¸Šä¸‹æ¸¸åè°ƒä¸Šï¼Œæ˜¯å¦å­˜åœ¨ä¸è¶³ä¹‹å¤„ ç»å†äº†æŸæ¬¡å¤§ä¿ƒçš„å€¼ç­ï¼Œæ˜¯å¦å¯¹å¯ä»¥ç†Ÿç»ƒä½¿ç”¨å…¬å¸çš„ç›‘æ§å·¥å…·ï¼Œé‡åˆ°çªå‘äº‹ä»¶ï¼Œæ˜¯å¦å¿«é€Ÿæœ‰æ•ˆåœ°è¿›è¡Œäº†è§£å†³ ä»»ä½•å·¥ä½œä¸€å®šå¯¹ä¸ªäººéƒ½æ˜¯æœ‰æå‡çš„ï¼Œä½†æ˜¯ä¸ä¼šæ€»ç»“çš„äººï¼Œåœ¨æ¯ä¸ªé¡¹ç›®/éœ€æ±‚ä¸­æˆé•¿çš„ä¸œè¥¿éƒ½æ˜¯æ•£çš„ï¼Œä¹…è€Œä¹…ä¹‹å°±å¿˜äº†ã€‚é€šè¿‡å……åˆ†çš„æ€»ç»“ä¹‹åï¼ŒçŠ¯è¿‡çš„é”™è¯¯æˆ‘ä»¬ä¸ä¼šäºŒæ¬¡å†çŠ¯ï¼Œç†æ¸…æ¥šçš„ä¸šåŠ¡çš„æ¥é¾™å»è„‰é“­è®°åœ¨å¿ƒï¼Œå¯¹è‡ªå·±æ˜¯ä¸€ç§æå‡ï¼Œåˆ†äº«ç»™åˆ«äººå¯¹åˆ«äººä¹Ÿæ˜¯å¾ˆå¤§çš„å¸®åŠ©ã€‚ å¤±è´¥è€…å¤±è´¥çš„åŸå› å„æœ‰ä¸åŒï¼ŒæˆåŠŸè€…çš„åšäº‹æ–¹å¼æ€»æ˜¯ç›¸ä¼¼çš„ï¼Œä»å®è§‚è§’åº¦å»çœ‹ï¼Œæˆ‘è®¤ä¸ºæ€»ç»“å°±æ˜¯æˆåŠŸè€…ä¹‹æ‰€ä»¥èƒ½æˆåŠŸï¼Œå¾ˆé‡è¦ä¸€ä¸ªåŸå› ã€‚ å‚è€ƒèµ„æ–™","link":"/2019/06/13/é˜¿é‡Œä¸€å¹´çš„æˆé•¿ç»å†.html"},{"title":"mysqlæ•°æ®åº“ç´¢å¼•è§£æ","text":"æ‘˜è¦çœ‹äº†å¾ˆå¤šå…³äºç´¢å¼•çš„åšå®¢ï¼Œè®²çš„å¤§åŒå°å¼‚ã€‚ä½†æ˜¯å§‹ç»ˆæ²¡æœ‰è®©æˆ‘æ˜ç™½å…³äºç´¢å¼•çš„ä¸€äº›æ¦‚å¿µï¼Œå¦‚B-Treeç´¢å¼•ï¼ŒHashç´¢å¼•ï¼Œå”¯ä¸€ç´¢å¼•â€¦.æˆ–è®¸æœ‰å¾ˆå¤šäººå’Œæˆ‘ä¸€æ ·ï¼Œæ²¡ææ¸…æ¥šæ¦‚å¿µå°±å¼€å§‹ç ”ç©¶B-Treeï¼ŒB+Treeç­‰ç»“æ„ï¼Œå¯¼è‡´åœ¨é¢è¯•çš„æ—¶å€™ç­”éæ‰€é—®ï¼ ç´¢å¼•æ˜¯ä»€ä¹ˆ?ç´¢å¼•æ˜¯å¸®åŠ©MySQLé«˜æ•ˆè·å–æ•°æ®çš„æ•°æ®ç»“æ„ã€‚ ç´¢å¼•èƒ½å¹²ä»€ä¹ˆ?ç´¢å¼•éå¸¸å…³é”®ï¼Œå°¤å…¶æ˜¯å½“è¡¨ä¸­çš„æ•°æ®é‡è¶Šæ¥è¶Šå¤§æ—¶ï¼Œç´¢å¼•å¯¹äºæ€§èƒ½çš„å½±å“æ„ˆå‘é‡è¦ã€‚ ç´¢å¼•èƒ½å¤Ÿè½»æ˜“å°†æŸ¥è¯¢æ€§èƒ½æé«˜å¥½å‡ ä¸ªæ•°é‡çº§ï¼Œæ€»çš„æ¥è¯´å°±æ˜¯å¯ä»¥æ˜æ˜¾çš„æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚ ç´¢å¼•çš„åˆ†ç±»? ä»å­˜å‚¨ç»“æ„ä¸Šæ¥åˆ’åˆ†ï¼šBTreeç´¢å¼•ï¼ˆB-Treeæˆ–B+Treeç´¢å¼•ï¼‰ï¼ŒHashç´¢å¼•ï¼Œfull-indexå…¨æ–‡ç´¢å¼•ï¼ŒR-Treeç´¢å¼•ã€‚è¿™é‡Œæ‰€æè¿°çš„æ˜¯ç´¢å¼•å­˜å‚¨æ—¶ä¿å­˜çš„å½¢å¼ï¼Œ ä»åº”ç”¨å±‚æ¬¡æ¥åˆ†ï¼šæ™®é€šç´¢å¼•ï¼Œå”¯ä¸€ç´¢å¼•ï¼Œå¤åˆç´¢å¼• æ ¹æ®ä¸­æ•°æ®çš„ç‰©ç†é¡ºåºä¸é”®å€¼çš„é€»è¾‘ï¼ˆç´¢å¼•ï¼‰é¡ºåºå…³ç³»ï¼šèšé›†ç´¢å¼•ï¼Œéèšé›†ç´¢å¼•ã€‚ å¹³æ—¶è®²çš„ç´¢å¼•ç±»å‹ä¸€èˆ¬æ˜¯æŒ‡åœ¨åº”ç”¨å±‚æ¬¡çš„åˆ’åˆ†ã€‚å°±åƒæ‰‹æœºåˆ†ç±»ï¼šå®‰å“æ‰‹æœºï¼ŒIOSæ‰‹æœº ä¸ åä¸ºæ‰‹æœºï¼Œè‹¹æœæ‰‹æœºï¼ŒOPPOæ‰‹æœºä¸€æ ·ã€‚ æ™®é€šç´¢å¼•**ï¼š**å³ä¸€ä¸ªç´¢å¼•åªåŒ…å«å•ä¸ªåˆ—ï¼Œä¸€ä¸ªè¡¨å¯ä»¥æœ‰å¤šä¸ªå•åˆ—ç´¢å¼• å”¯ä¸€ç´¢å¼•ï¼šç´¢å¼•åˆ—çš„å€¼å¿…é¡»å”¯ä¸€ï¼Œä½†å…è®¸æœ‰ç©ºå€¼ å¤åˆç´¢å¼•ï¼šå¤šåˆ—å€¼ç»„æˆä¸€ä¸ªç´¢å¼•ï¼Œä¸“é—¨ç”¨äºç»„åˆæœç´¢ï¼Œå…¶æ•ˆç‡å¤§äºç´¢å¼•åˆå¹¶ èšç°‡ç´¢å¼•(èšé›†ç´¢å¼•)ï¼šå¹¶ä¸æ˜¯ä¸€ç§å•ç‹¬çš„ç´¢å¼•ç±»å‹ï¼Œè€Œæ˜¯ä¸€ç§æ•°æ®å­˜å‚¨æ–¹å¼ã€‚å…·ä½“ç»†èŠ‚å–å†³äºä¸åŒçš„å®ç°ï¼ŒInnoDBçš„èšç°‡ç´¢å¼•å…¶å®å°±æ˜¯åœ¨åŒä¸€ä¸ªç»“æ„ä¸­ä¿å­˜äº†B-Treeç´¢å¼•(æŠ€æœ¯ä¸Šæ¥è¯´æ˜¯B+Tree)å’Œæ•°æ®è¡Œã€‚ éèšç°‡ç´¢å¼•ï¼šä¸æ˜¯èšç°‡ç´¢å¼•ï¼Œå°±æ˜¯éèšç°‡ç´¢å¼• ç´¢å¼•çš„åº•å±‚å®ç°mysqlé»˜è®¤å­˜å‚¨å¼•æ“innodbåªæ˜¾å¼æ”¯æŒB-Tree( ä»æŠ€æœ¯ä¸Šæ¥è¯´æ˜¯B+Tree)ç´¢å¼•ï¼Œå¯¹äºé¢‘ç¹è®¿é—®çš„è¡¨ï¼Œinnodbä¼šé€æ˜å»ºç«‹è‡ªé€‚åº”hashç´¢å¼•ï¼Œå³åœ¨Bæ ‘ç´¢å¼•åŸºç¡€ä¸Šå»ºç«‹hashç´¢å¼•ï¼Œå¯ä»¥æ˜¾è‘—æé«˜æŸ¥æ‰¾æ•ˆç‡ï¼Œå¯¹äºå®¢æˆ·ç«¯æ˜¯é€æ˜çš„ï¼Œä¸å¯æ§åˆ¶çš„ï¼Œéšå¼çš„ã€‚ ä¸è°ˆå­˜å‚¨å¼•æ“ï¼Œåªè®¨è®ºå®ç°(æŠ½è±¡) Hashç´¢å¼•åŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œåªæœ‰ç²¾ç¡®åŒ¹é…ç´¢å¼•æ‰€æœ‰åˆ—çš„æŸ¥è¯¢æ‰æœ‰æ•ˆï¼Œå¯¹äºæ¯ä¸€è¡Œæ•°æ®ï¼Œå­˜å‚¨å¼•æ“éƒ½ä¼šå¯¹æ‰€æœ‰çš„ç´¢å¼•åˆ—è®¡ç®—ä¸€ä¸ªå“ˆå¸Œç ï¼ˆhash codeï¼‰ï¼Œå¹¶ä¸”Hashç´¢å¼•å°†æ‰€æœ‰çš„å“ˆå¸Œç å­˜å‚¨åœ¨ç´¢å¼•ä¸­ï¼ŒåŒæ—¶åœ¨ç´¢å¼•è¡¨ä¸­ä¿å­˜æŒ‡å‘æ¯ä¸ªæ•°æ®è¡Œçš„æŒ‡é’ˆã€‚ B-Treeç´¢å¼•ï¼ˆMySQLä½¿ç”¨B+Treeï¼‰B-Treeèƒ½åŠ å¿«æ•°æ®çš„è®¿é—®é€Ÿåº¦ï¼Œå› ä¸ºå­˜å‚¨å¼•æ“ä¸å†éœ€è¦è¿›è¡Œå…¨è¡¨æ‰«ææ¥è·å–æ•°æ®ï¼Œæ•°æ®åˆ†å¸ƒåœ¨å„ä¸ªèŠ‚ç‚¹ä¹‹ä¸­ã€‚ B+Treeç´¢å¼• æ˜¯B-Treeçš„æ”¹è¿›ç‰ˆæœ¬ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æ•°æ®åº“ç´¢å¼•ç´¢å¼•æ‰€é‡‡ç”¨çš„å­˜å‚¨ç»“æ„ã€‚æ•°æ®éƒ½åœ¨å¶å­èŠ‚ç‚¹ä¸Šï¼Œå¹¶ä¸”å¢åŠ äº†é¡ºåºè®¿é—®æŒ‡é’ˆï¼Œæ¯ä¸ªå¶å­èŠ‚ç‚¹éƒ½æŒ‡å‘ç›¸é‚»çš„å¶å­èŠ‚ç‚¹çš„åœ°å€ã€‚ç›¸æ¯”B-Treeæ¥è¯´ï¼Œè¿›è¡ŒèŒƒå›´æŸ¥æ‰¾æ—¶åªéœ€è¦æŸ¥æ‰¾ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œè¿›è¡Œéå†å³å¯ã€‚è€ŒB-Treeéœ€è¦è·å–æ‰€æœ‰èŠ‚ç‚¹ï¼Œç›¸æ¯”ä¹‹ä¸‹B+Treeæ•ˆç‡æ›´é«˜ã€‚ ç»“åˆå­˜å‚¨å¼•æ“æ¥è®¨è®ºï¼ˆä¸€èˆ¬é»˜è®¤ä½¿ç”¨B+Treeï¼‰ æ¡ˆä¾‹ï¼šå‡è®¾æœ‰ä¸€å¼ å­¦ç”Ÿè¡¨ï¼Œidä¸ºä¸»é”® id name birthday 1 Tom 1996-01-01 2 Jann 1996-01-04 3 Ray 1996-01-08 4 Michael 1996-01-10 5 Jack 1996-01-13 6 Steven 1996-01-23 7 Lily 1996-01-25 åœ¨MyISAMå¼•æ“ä¸­çš„å®ç°ï¼ˆäºŒçº§ç´¢å¼•ä¹Ÿæ˜¯è¿™æ ·å®ç°çš„ï¼‰ åœ¨InnoDBä¸­çš„å®ç° ä¸ºä»€ä¹ˆç´¢å¼•ç»“æ„é»˜è®¤ä½¿ç”¨B+Treeï¼Œè€Œä¸æ˜¯Hashï¼ŒäºŒå‰æ ‘ï¼Œçº¢é»‘æ ‘ï¼ŸB+treeï¼šå› ä¸ºBæ ‘ä¸ç®¡å¶å­èŠ‚ç‚¹è¿˜æ˜¯éå¶å­èŠ‚ç‚¹ï¼Œéƒ½ä¼šä¿å­˜æ•°æ®ï¼Œè¿™æ ·å¯¼è‡´åœ¨éå¶å­èŠ‚ç‚¹ä¸­èƒ½ä¿å­˜çš„æŒ‡é’ˆæ•°é‡å˜å°‘ï¼ˆæœ‰äº›èµ„æ–™ä¹Ÿç§°ä¸ºæ‰‡å‡ºï¼‰ï¼ŒæŒ‡é’ˆå°‘çš„æƒ…å†µä¸‹è¦ä¿å­˜å¤§é‡æ•°æ®ï¼Œåªèƒ½å¢åŠ æ ‘çš„é«˜åº¦ï¼Œå¯¼è‡´IOæ“ä½œå˜å¤šï¼ŒæŸ¥è¯¢æ€§èƒ½å˜ä½ï¼› Hashï¼šè™½ç„¶å¯ä»¥å¿«é€Ÿå®šä½ï¼Œä½†æ˜¯æ²¡æœ‰é¡ºåºï¼ŒIOå¤æ‚åº¦é«˜ã€‚ äºŒå‰æ ‘ï¼šæ ‘çš„é«˜åº¦ä¸å‡åŒ€ï¼Œä¸èƒ½è‡ªå¹³è¡¡ï¼ŒæŸ¥æ‰¾æ•ˆç‡è·Ÿæ•°æ®æœ‰å…³ï¼ˆæ ‘çš„é«˜åº¦ï¼‰ï¼Œå¹¶ä¸”IOä»£ä»·é«˜ã€‚ çº¢é»‘æ ‘ï¼šæ ‘çš„é«˜åº¦éšç€æ•°æ®é‡å¢åŠ è€Œå¢åŠ ï¼ŒIOä»£ä»·é«˜ã€‚ çº¢é»‘æ ‘: æ¯ä¸ªèŠ‚ç‚¹æˆ–è€…æ˜¯é»‘è‰²ï¼Œæˆ–è€…æ˜¯çº¢è‰²ã€‚ æ ¹èŠ‚ç‚¹æ˜¯é»‘è‰²ã€‚ æ¯ä¸ªå¶å­èŠ‚ç‚¹æ˜¯é»‘è‰²ã€‚ [æ³¨æ„ï¼šè¿™é‡Œå¶å­èŠ‚ç‚¹ï¼Œæ˜¯æŒ‡ä¸ºç©ºçš„å¶å­èŠ‚ç‚¹ï¼] å¦‚æœä¸€ä¸ªèŠ‚ç‚¹æ˜¯çº¢è‰²çš„ï¼Œåˆ™å®ƒçš„å­èŠ‚ç‚¹å¿…é¡»æ˜¯é»‘è‰²çš„ã€‚ ä»ä¸€ä¸ªèŠ‚ç‚¹åˆ°è¯¥èŠ‚ç‚¹çš„å­å­™èŠ‚ç‚¹çš„æ‰€æœ‰è·¯å¾„ä¸ŠåŒ…å«ç›¸åŒæ•°ç›®çš„é»‘èŠ‚ç‚¹ã€‚ ä¸ºä»€ä¹ˆå®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢é•¿ä¸»é”®ä½œä¸ºç´¢å¼•ï¼Ÿç»“åˆB+Treeçš„ç‰¹ç‚¹ï¼Œè‡ªå¢ä¸»é”®æ˜¯è¿ç»­çš„ï¼Œåœ¨æ’å…¥è¿‡ç¨‹ä¸­å°½é‡å‡å°‘é¡µåˆ†è£‚ï¼Œå³ä½¿è¦è¿›è¡Œé¡µåˆ†è£‚ï¼Œä¹Ÿåªä¼šåˆ†è£‚å¾ˆå°‘ä¸€éƒ¨åˆ†ã€‚å¹¶ä¸”èƒ½å‡å°‘æ•°æ®çš„ç§»åŠ¨ï¼Œæ¯æ¬¡æ’å…¥éƒ½æ˜¯æ’å…¥åˆ°æœ€åã€‚æ€»ä¹‹å°±æ˜¯å‡å°‘åˆ†è£‚å’Œç§»åŠ¨çš„é¢‘ç‡ã€‚ æ’å…¥è¿ç»­çš„æ•°æ®ï¼š æ’å…¥éè¿ç»­çš„æ•°æ® ç®€å•æ€»ç»“ä¸‹ MySQLä½¿ç”¨B+Treeä½œä¸ºç´¢å¼•æ•°æ®ç»“æ„ã€‚ B+Treeåœ¨æ–°å¢æ•°æ®æ—¶ï¼Œä¼šæ ¹æ®ç´¢å¼•æŒ‡å®šåˆ—çš„å€¼å¯¹æ—§çš„B+Treeåšè°ƒæ•´ã€‚ ä»ç‰©ç†å­˜å‚¨ç»“æ„ä¸Šè¯´ï¼ŒB-Treeå’ŒB+Treeéƒ½ä»¥é¡µ(4K)æ¥åˆ’åˆ†èŠ‚ç‚¹çš„å¤§å°ï¼Œä½†æ˜¯ç”±äºB+Treeä¸­ä¸­é—´èŠ‚ç‚¹ä¸å­˜å‚¨æ•°æ®ï¼Œå› æ­¤B+Treeèƒ½å¤Ÿåœ¨åŒæ ·å¤§å°çš„èŠ‚ç‚¹ä¸­ï¼Œå­˜å‚¨æ›´å¤šçš„keyï¼Œæé«˜æŸ¥æ‰¾æ•ˆç‡ã€‚ å½±å“MySQLæŸ¥æ‰¾æ€§èƒ½çš„ä¸»è¦è¿˜æ˜¯ç£ç›˜IOæ¬¡æ•°ï¼Œå¤§éƒ¨åˆ†æ˜¯ç£å¤´ç§»åŠ¨åˆ°æŒ‡å®šç£é“çš„æ—¶é—´èŠ±è´¹ã€‚ MyISAMå­˜å‚¨å¼•æ“ä¸‹ç´¢å¼•å’Œæ•°æ®å­˜å‚¨æ˜¯åˆ†ç¦»çš„ï¼ŒInnoDBç´¢å¼•å’Œæ•°æ®å­˜å‚¨åœ¨ä¸€èµ·ã€‚ InnoDBå­˜å‚¨å¼•æ“ä¸‹ç´¢å¼•çš„å®ç°ï¼Œ(è¾…åŠ©ç´¢å¼•)å…¨éƒ¨æ˜¯ä¾èµ–äºä¸»ç´¢å¼•å»ºç«‹çš„(è¾…åŠ©ç´¢å¼•ä¸­å¶å­ç»“ç‚¹å­˜å‚¨çš„å¹¶ä¸æ˜¯æ•°æ®çš„åœ°å€ï¼Œè¿˜æ˜¯ä¸»ç´¢å¼•çš„å€¼ï¼Œå› æ­¤ï¼Œæ‰€æœ‰ä¾èµ–äºè¾…åŠ©ç´¢å¼•çš„éƒ½æ˜¯å…ˆæ ¹æ®è¾…åŠ©ç´¢å¼•æŸ¥åˆ°ä¸»ç´¢å¼•ï¼Œå†æ ¹æ®ä¸»ç´¢å¼•æŸ¥æ•°æ®çš„åœ°å€)ã€‚ ç”±äºInnoDBç´¢å¼•çš„ç‰¹æ€§ï¼Œå› æ­¤å¦‚æœä¸»ç´¢å¼•ä¸æ˜¯è‡ªå¢çš„(idä½œä¸»é”®)ï¼Œé‚£ä¹ˆæ¯æ¬¡æ’å…¥æ–°çš„æ•°æ®ï¼Œéƒ½å¾ˆå¯èƒ½å¯¹B+Treeçš„ä¸»ç´¢å¼•è¿›è¡Œé‡æ•´ï¼Œå½±å“æ€§èƒ½ã€‚å› æ­¤ï¼Œå°½é‡ä»¥è‡ªå¢idä½œä¸ºInnoDBçš„ä¸»ç´¢å¼•ã€‚ InnoDBä¸€æ£µB+æ ‘èƒ½å­˜å¤šå°‘è¡Œæ•°æ®ï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨B+æ ‘ï¼Ÿè€Œä¸æ˜¯å…¶ä»–æ ‘ï¼ŸInnoDBä¸€æ£µB+æ ‘å¯ä»¥å­˜æ”¾å¤šå°‘è¡Œæ•°æ®ï¼Ÿè¿™ä¸ªé—®é¢˜çš„ç®€å•å›ç­”æ˜¯ï¼šçº¦2åƒä¸‡ã€‚ä¸ºä»€ä¹ˆæ˜¯è¿™ä¹ˆå¤šå‘¢ï¼Ÿå› ä¸ºè¿™æ˜¯å¯ä»¥ç®—å‡ºæ¥çš„ï¼Œè¦ææ¸…æ¥šè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å…ˆä»InnoDBç´¢å¼•æ•°æ®ç»“æ„ã€æ•°æ®ç»„ç»‡æ–¹å¼è¯´èµ·ã€‚ æˆ‘ä»¬éƒ½çŸ¥é“è®¡ç®—æœºåœ¨å­˜å‚¨æ•°æ®çš„æ—¶å€™ï¼Œæœ‰æœ€å°å­˜å‚¨å•å…ƒï¼Œè¿™å°±å¥½æ¯”æˆ‘ä»¬ä»Šå¤©è¿›è¡Œç°é‡‘çš„æµé€šæœ€å°å•ä½æ˜¯ä¸€æ¯›ã€‚åœ¨è®¡ç®—æœºä¸­ç£ç›˜å­˜å‚¨æ•°æ®æœ€å°å•å…ƒæ˜¯æ‰‡åŒºï¼Œä¸€ä¸ªæ‰‡åŒºçš„å¤§å°æ˜¯512å­—èŠ‚ï¼Œè€Œæ–‡ä»¶ç³»ç»Ÿï¼ˆä¾‹å¦‚XFS/EXT4ï¼‰ä»–çš„æœ€å°å•å…ƒæ˜¯å—ï¼Œä¸€ä¸ªå—çš„å¤§å°æ˜¯4kï¼Œè€Œå¯¹äºæˆ‘ä»¬çš„InnoDBå­˜å‚¨å¼•æ“ä¹Ÿæœ‰è‡ªå·±çš„æœ€å°å‚¨å­˜å•å…ƒâ€”â€”é¡µï¼ˆPageï¼‰ï¼Œä¸€ä¸ªé¡µçš„å¤§å°æ˜¯16Kã€‚ innodbçš„æ‰€æœ‰æ•°æ®æ–‡ä»¶ï¼ˆåç¼€ä¸ºibdçš„æ–‡ä»¶ï¼‰ï¼Œä»–çš„å¤§å°å§‹ç»ˆéƒ½æ˜¯16384ï¼ˆ16kï¼‰çš„æ•´æ•°å€ã€‚ ç£ç›˜æ‰‡åŒºã€æ–‡ä»¶ç³»ç»Ÿã€InnoDBå­˜å‚¨å¼•æ“éƒ½æœ‰å„è‡ªçš„æœ€å°å­˜å‚¨å•å…ƒã€‚ åœ¨MySQLä¸­æˆ‘ä»¬çš„InnoDBé¡µçš„å¤§å°é»˜è®¤æ˜¯16kï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡å‚æ•°è®¾ç½®ï¼š 12345678mysql&gt; show variables like &apos;innodb_page_size&apos;;+------------------+-------+| Variable_name| Value|+------------------+-------+| innodb_page_size | 16384|+------------------+-------+1 row in set(0.00sec) æ•°æ®è¡¨ä¸­çš„æ•°æ®éƒ½æ˜¯å­˜å‚¨åœ¨é¡µä¸­çš„ï¼Œæ‰€ä»¥ä¸€ä¸ªé¡µä¸­èƒ½å­˜å‚¨å¤šå°‘è¡Œæ•°æ®å‘¢ï¼Ÿå‡è®¾ä¸€è¡Œæ•°æ®çš„å¤§å°æ˜¯1kï¼Œé‚£ä¹ˆä¸€ä¸ªé¡µå¯ä»¥å­˜æ”¾16è¡Œè¿™æ ·çš„æ•°æ®ã€‚ å¦‚æœæ•°æ®åº“åªæŒ‰è¿™æ ·çš„æ–¹å¼å­˜å‚¨ï¼Œé‚£ä¹ˆå¦‚ä½•æŸ¥æ‰¾æ•°æ®å°±æˆä¸ºä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“è¦æŸ¥æ‰¾çš„æ•°æ®å­˜åœ¨å“ªä¸ªé¡µä¸­ï¼Œä¹Ÿä¸å¯èƒ½æŠŠæ‰€æœ‰çš„é¡µéå†ä¸€éï¼Œé‚£æ ·å¤ªæ…¢äº†ã€‚æ‰€ä»¥äººä»¬æƒ³äº†ä¸€ä¸ªåŠæ³•ï¼Œç”¨B+æ ‘çš„æ–¹å¼ç»„ç»‡è¿™äº›æ•°æ®ã€‚å¦‚å›¾æ‰€ç¤ºï¼š æˆ‘ä»¬å…ˆå°†æ•°æ®è®°å½•æŒ‰ä¸»é”®è¿›è¡Œæ’åºï¼Œåˆ†åˆ«å­˜æ”¾åœ¨ä¸åŒçš„é¡µä¸­ï¼ˆä¸ºäº†ä¾¿äºç†è§£æˆ‘ä»¬è¿™é‡Œä¸€ä¸ªé¡µä¸­åªå­˜æ”¾3æ¡è®°å½•ï¼Œå®é™…æƒ…å†µå¯ä»¥å­˜æ”¾å¾ˆå¤šï¼‰ï¼Œé™¤äº†å­˜æ”¾æ•°æ®çš„é¡µä»¥å¤–ï¼Œè¿˜æœ‰å­˜æ”¾é”®å€¼+æŒ‡é’ˆçš„é¡µï¼Œå¦‚å›¾ä¸­page number=3çš„é¡µï¼Œè¯¥é¡µå­˜æ”¾é”®å€¼å’ŒæŒ‡å‘æ•°æ®é¡µçš„æŒ‡é’ˆï¼Œè¿™æ ·çš„é¡µç”±Nä¸ªé”®å€¼+æŒ‡é’ˆç»„æˆã€‚å½“ç„¶å®ƒä¹Ÿæ˜¯æ’å¥½åºçš„ã€‚è¿™æ ·çš„æ•°æ®ç»„ç»‡å½¢å¼ï¼Œæˆ‘ä»¬ç§°ä¸ºç´¢å¼•ç»„ç»‡è¡¨ã€‚ç°åœ¨æ¥çœ‹ä¸‹ï¼Œè¦æŸ¥æ‰¾ä¸€æ¡æ•°æ®ï¼Œæ€ä¹ˆæŸ¥ï¼Ÿ å¦‚select * from user where id=5; è¿™é‡Œidæ˜¯ä¸»é”®,æˆ‘ä»¬é€šè¿‡è¿™æ£µB+æ ‘æ¥æŸ¥æ‰¾ï¼Œé¦–å…ˆæ‰¾åˆ°æ ¹é¡µï¼Œä½ æ€ä¹ˆçŸ¥é“userè¡¨çš„æ ¹é¡µåœ¨å“ªå‘¢ï¼Ÿå…¶å®æ¯å¼ è¡¨çš„æ ¹é¡µä½ç½®åœ¨è¡¨ç©ºé—´æ–‡ä»¶ä¸­æ˜¯å›ºå®šçš„ï¼Œå³page number=3çš„é¡µï¼ˆè¿™ç‚¹æˆ‘ä»¬ä¸‹æ–‡è¿˜ä¼šè¿›ä¸€æ­¥è¯æ˜ï¼‰ï¼Œæ‰¾åˆ°æ ¹é¡µåé€šè¿‡äºŒåˆ†æŸ¥æ‰¾æ³•ï¼Œå®šä½åˆ°id=5çš„æ•°æ®åº”è¯¥åœ¨æŒ‡é’ˆP5æŒ‡å‘çš„é¡µä¸­ï¼Œé‚£ä¹ˆè¿›ä¸€æ­¥å»page number=5çš„é¡µä¸­æŸ¥æ‰¾ï¼ŒåŒæ ·é€šè¿‡äºŒåˆ†æŸ¥è¯¢æ³•å³å¯æ‰¾åˆ°id=5çš„è®°å½•ï¼š | 5 | zhao2 | 27 | ç°åœ¨æˆ‘ä»¬æ¸…æ¥šäº†InnoDBä¸­ä¸»é”®ç´¢å¼•B+æ ‘æ˜¯å¦‚ä½•ç»„ç»‡æ•°æ®ã€æŸ¥è¯¢æ•°æ®çš„ï¼Œæˆ‘ä»¬æ€»ç»“ä¸€ä¸‹ï¼š 1ã€InnoDBå­˜å‚¨å¼•æ“çš„æœ€å°å­˜å‚¨å•å…ƒæ˜¯é¡µï¼Œé¡µå¯ä»¥ç”¨äºå­˜æ”¾æ•°æ®ä¹Ÿå¯ä»¥ç”¨äºå­˜æ”¾é”®å€¼+æŒ‡é’ˆï¼Œåœ¨B+æ ‘ä¸­å¶å­èŠ‚ç‚¹å­˜æ”¾æ•°æ®ï¼Œéå¶å­èŠ‚ç‚¹å­˜æ”¾é”®å€¼+æŒ‡é’ˆã€‚ 2ã€ç´¢å¼•ç»„ç»‡è¡¨é€šè¿‡éå¶å­èŠ‚ç‚¹çš„äºŒåˆ†æŸ¥æ‰¾æ³•ä»¥åŠæŒ‡é’ˆç¡®å®šæ•°æ®åœ¨å“ªä¸ªé¡µä¸­ï¼Œè¿›è€Œåœ¨å»æ•°æ®é¡µä¸­æŸ¥æ‰¾åˆ°éœ€è¦çš„æ•°æ®ï¼› é‚£ä¹ˆå›åˆ°æˆ‘ä»¬å¼€å§‹çš„é—®é¢˜ï¼Œé€šå¸¸ä¸€æ£µB+æ ‘å¯ä»¥å­˜æ”¾å¤šå°‘è¡Œæ•°æ®ï¼Ÿè¿™é‡Œæˆ‘ä»¬å…ˆå‡è®¾B+æ ‘é«˜ä¸º2ï¼Œå³å­˜åœ¨ä¸€ä¸ªæ ¹èŠ‚ç‚¹å’Œè‹¥å¹²ä¸ªå¶å­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¿™æ£µB+æ ‘çš„å­˜æ”¾æ€»è®°å½•æ•°ä¸ºï¼šæ ¹èŠ‚ç‚¹æŒ‡é’ˆæ•°*å•ä¸ªå¶å­èŠ‚ç‚¹è®°å½•è¡Œæ•°ã€‚ ä¸Šæ–‡æˆ‘ä»¬å·²ç»è¯´æ˜å•ä¸ªå¶å­èŠ‚ç‚¹ï¼ˆé¡µï¼‰ä¸­çš„è®°å½•æ•°=16K/1K=16ã€‚ï¼ˆè¿™é‡Œå‡è®¾ä¸€è¡Œè®°å½•çš„æ•°æ®å¤§å°ä¸º1kï¼Œå®é™…ä¸Šç°åœ¨å¾ˆå¤šäº’è”ç½‘ä¸šåŠ¡æ•°æ®è®°å½•å¤§å°é€šå¸¸å°±æ˜¯1Kå·¦å³ï¼‰ã€‚ é‚£ä¹ˆç°åœ¨æˆ‘ä»¬éœ€è¦è®¡ç®—å‡ºéå¶å­èŠ‚ç‚¹èƒ½å­˜æ”¾å¤šå°‘æŒ‡é’ˆï¼Ÿ å…¶å®è¿™ä¹Ÿå¾ˆå¥½ç®—ï¼Œæˆ‘ä»¬å‡è®¾ä¸»é”®IDä¸ºbigintç±»å‹ï¼Œé•¿åº¦ä¸º8å­—èŠ‚ï¼Œè€ŒæŒ‡é’ˆå¤§å°åœ¨InnoDBæºç ä¸­è®¾ç½®ä¸º6å­—èŠ‚ï¼Œè¿™æ ·ä¸€å…±14å­—èŠ‚ï¼Œæˆ‘ä»¬ä¸€ä¸ªé¡µä¸­èƒ½å­˜æ”¾å¤šå°‘è¿™æ ·çš„å•å…ƒï¼Œå…¶å®å°±ä»£è¡¨æœ‰å¤šå°‘æŒ‡é’ˆï¼Œå³16384/14=1170ã€‚é‚£ä¹ˆå¯ä»¥ç®—å‡ºä¸€æ£µé«˜åº¦ä¸º2çš„B+æ ‘ï¼Œèƒ½å­˜æ”¾1170*16=18720æ¡è¿™æ ·çš„æ•°æ®è®°å½•ã€‚ æ ¹æ®åŒæ ·çš„åŸç†æˆ‘ä»¬å¯ä»¥ç®—å‡ºä¸€ä¸ªé«˜åº¦ä¸º3çš„B+æ ‘å¯ä»¥å­˜æ”¾ï¼š1170*1170*16=21902400æ¡è¿™æ ·çš„è®°å½•ã€‚ æ‰€ä»¥åœ¨InnoDBä¸­B+æ ‘é«˜åº¦ä¸€èˆ¬ä¸º1-3å±‚ï¼Œå®ƒå°±èƒ½æ»¡è¶³åƒä¸‡çº§çš„æ•°æ®å­˜å‚¨ã€‚åœ¨æŸ¥æ‰¾æ•°æ®æ—¶ä¸€æ¬¡é¡µçš„æŸ¥æ‰¾ä»£è¡¨ä¸€æ¬¡IOï¼Œæ‰€ä»¥é€šè¿‡ä¸»é”®ç´¢å¼•æŸ¥è¯¢é€šå¸¸åªéœ€è¦1-3æ¬¡IOæ“ä½œå³å¯æŸ¥æ‰¾åˆ°æ•°æ®ã€‚ æ€ä¹ˆå¾—åˆ°InnoDBä¸»é”®ç´¢å¼•B+æ ‘çš„é«˜åº¦ï¼Ÿä¸Šé¢æˆ‘ä»¬é€šè¿‡æ¨æ–­å¾—å‡ºB+æ ‘çš„é«˜åº¦é€šå¸¸æ˜¯1-3ï¼Œä¸‹é¢æˆ‘ä»¬ä»å¦å¤–ä¸€ä¸ªä¾§é¢è¯æ˜è¿™ä¸ªç»“è®ºã€‚åœ¨InnoDBçš„è¡¨ç©ºé—´æ–‡ä»¶ä¸­ï¼Œçº¦å®špage numberä¸º3çš„ä»£è¡¨ä¸»é”®ç´¢å¼•çš„æ ¹é¡µï¼Œè€Œåœ¨æ ¹é¡µåç§»é‡ä¸º64çš„åœ°æ–¹å­˜æ”¾äº†è¯¥B+æ ‘çš„page levelã€‚å¦‚æœpage levelä¸º1ï¼Œæ ‘é«˜ä¸º2ï¼Œpage levelä¸º2ï¼Œåˆ™æ ‘é«˜ä¸º3ã€‚å³B+æ ‘çš„é«˜åº¦=page level+1ï¼›ä¸‹é¢æˆ‘ä»¬å°†ä»å®é™…ç¯å¢ƒä¸­å°è¯•æ‰¾åˆ°è¿™ä¸ªpage levelã€‚ åœ¨å®é™…æ“ä½œä¹‹å‰ï¼Œä½ å¯ä»¥é€šè¿‡InnoDBå…ƒæ•°æ®è¡¨ç¡®è®¤ä¸»é”®ç´¢å¼•æ ¹é¡µçš„page numberä¸º3ï¼Œä½ ä¹Ÿå¯ä»¥ä»ã€ŠInnoDBå­˜å‚¨å¼•æ“ã€‹è¿™æœ¬ä¹¦ä¸­å¾—åˆ°ç¡®è®¤ã€‚ 1234567SELECTb.name, a.name, index_id, type, a.space, a.PAGE_NOFROMinformation_schema.INNODB_SYS_INDEXES a,information_schema.INNODB_SYS_TABLES bWHEREa.table_id = b.table_id AND a.space &lt;&gt; 0; æ‰§è¡Œç»“æœï¼š å¯ä»¥çœ‹å‡ºæ•°æ®åº“dbt3ä¸‹çš„customerè¡¨ã€lineitemè¡¨ä¸»é”®ç´¢å¼•æ ¹é¡µçš„page numberå‡ä¸º3ï¼Œè€Œå…¶ä»–çš„äºŒçº§ç´¢å¼•page numberä¸º4ã€‚å…³äºäºŒçº§ç´¢å¼•ä¸ä¸»é”®ç´¢å¼•çš„åŒºåˆ«è¯·å‚è€ƒMySQLç›¸å…³ä¹¦ç±ï¼Œæœ¬æ–‡ä¸åœ¨æ­¤ä»‹ç»ã€‚ ä¸‹é¢æˆ‘ä»¬å¯¹æ•°æ®åº“è¡¨ç©ºé—´æ–‡ä»¶åšæƒ³ç›¸å…³çš„è§£æï¼š å› ä¸ºä¸»é”®ç´¢å¼•B+æ ‘çš„æ ¹é¡µåœ¨æ•´ä¸ªè¡¨ç©ºé—´æ–‡ä»¶ä¸­çš„ç¬¬3ä¸ªé¡µå¼€å§‹ï¼Œæ‰€ä»¥å¯ä»¥ç®—å‡ºå®ƒåœ¨æ–‡ä»¶ä¸­çš„åç§»é‡ï¼š16384*3=49152ï¼ˆ16384ä¸ºé¡µå¤§å°ï¼‰ã€‚ å¦å¤–æ ¹æ®ã€ŠInnoDBå­˜å‚¨å¼•æ“ã€‹ä¸­æè¿°åœ¨æ ¹é¡µçš„64åç§»é‡ä½ç½®å‰2ä¸ªå­—èŠ‚ï¼Œä¿å­˜äº†page levelçš„å€¼ï¼Œå› æ­¤æˆ‘ä»¬æƒ³è¦çš„page levelçš„å€¼åœ¨æ•´ä¸ªæ–‡ä»¶ä¸­çš„åç§»é‡ä¸ºï¼š16384*3+64=49152+64=49216ï¼Œå‰2ä¸ªå­—èŠ‚ä¸­ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨hexdumpå·¥å…·ï¼ŒæŸ¥çœ‹è¡¨ç©ºé—´æ–‡ä»¶æŒ‡å®šåç§»é‡ä¸Šçš„æ•°æ®ï¼š linetemè¡¨çš„page levelä¸º2ï¼ŒB+æ ‘é«˜åº¦ä¸ºpage level+1=3ï¼›**regionè¡¨çš„page levelä¸º0ï¼ŒB+æ ‘é«˜åº¦ä¸ºpage level+1=1ï¼›**customerè¡¨çš„page levelä¸º2ï¼ŒB+æ ‘é«˜åº¦ä¸ºpage level+1=3ï¼› è¿™ä¸‰å¼ è¡¨çš„æ•°æ®é‡å¦‚ä¸‹ï¼š å°ç»“lineitemè¡¨çš„æ•°æ®è¡Œæ•°ä¸º600å¤šä¸‡ï¼ŒB+æ ‘é«˜åº¦ä¸º3ï¼Œcustomerè¡¨æ•°æ®è¡Œæ•°åªæœ‰15ä¸‡ï¼ŒB+æ ‘é«˜åº¦ä¹Ÿä¸º3ã€‚å¯ä»¥çœ‹å‡ºå°½ç®¡æ•°æ®é‡å·®å¼‚è¾ƒå¤§ï¼Œè¿™ä¸¤ä¸ªè¡¨æ ‘çš„é«˜åº¦éƒ½æ˜¯3ï¼Œæ¢å¥è¯è¯´è¿™ä¸¤ä¸ªè¡¨é€šè¿‡ç´¢å¼•æŸ¥è¯¢æ•ˆç‡å¹¶æ²¡æœ‰å¤ªå¤§å·®å¼‚ï¼Œå› ä¸ºéƒ½åªéœ€è¦åš3æ¬¡IOã€‚é‚£ä¹ˆå¦‚æœæœ‰ä¸€å¼ è¡¨è¡Œæ•°æ˜¯ä¸€åƒä¸‡ï¼Œé‚£ä¹ˆä»–çš„B+æ ‘é«˜åº¦ä¾æ—§æ˜¯3ï¼ŒæŸ¥è¯¢æ•ˆç‡ä»ç„¶ä¸ä¼šç›¸å·®å¤ªå¤§ã€‚ regionè¡¨åªæœ‰5è¡Œæ•°æ®ï¼Œå½“ç„¶ä»–çš„B+æ ‘é«˜åº¦ä¸º1ã€‚ æœ€åå›é¡¾ä¸€é“é¢è¯•é¢˜æœ‰ä¸€é“MySQLçš„é¢è¯•é¢˜ï¼Œä¸ºä»€ä¹ˆMySQLçš„ç´¢å¼•è¦ä½¿ç”¨B+æ ‘è€Œä¸æ˜¯å…¶å®ƒæ ‘å½¢ç»“æ„ï¼Ÿæ¯”å¦‚Bæ ‘ï¼Ÿ ç°åœ¨è¿™ä¸ªé—®é¢˜çš„å¤æ‚ç‰ˆæœ¬å¯ä»¥å‚è€ƒæœ¬æ–‡ï¼› ä»–çš„ç®€å•ç‰ˆæœ¬å›ç­”æ˜¯ï¼š å› ä¸ºBæ ‘ä¸ç®¡å¶å­èŠ‚ç‚¹è¿˜æ˜¯éå¶å­èŠ‚ç‚¹ï¼Œéƒ½ä¼šä¿å­˜æ•°æ®ï¼Œè¿™æ ·å¯¼è‡´åœ¨éå¶å­èŠ‚ç‚¹ä¸­èƒ½ä¿å­˜çš„æŒ‡é’ˆæ•°é‡å˜å°‘ï¼ˆæœ‰äº›èµ„æ–™ä¹Ÿç§°ä¸ºæ‰‡å‡ºï¼‰ï¼ŒæŒ‡é’ˆå°‘çš„æƒ…å†µä¸‹è¦ä¿å­˜å¤§é‡æ•°æ®ï¼Œåªèƒ½å¢åŠ æ ‘çš„é«˜åº¦ï¼Œå¯¼è‡´IOæ“ä½œå˜å¤šï¼ŒæŸ¥è¯¢æ€§èƒ½å˜ä½ï¼› æ€»ç»“æœ¬æ–‡ä»ä¸€ä¸ªé—®é¢˜å‡ºå‘ï¼Œé€æ­¥ä»‹ç»äº†InnoDBç´¢å¼•ç»„ç»‡è¡¨çš„åŸç†ã€æŸ¥è¯¢æ–¹å¼ï¼Œå¹¶ç»“åˆå·²æœ‰çŸ¥è¯†ï¼Œå›ç­”è¯¥é—®é¢˜ï¼Œç»“åˆå®è·µæ¥è¯æ˜ã€‚å½“ç„¶ä¸ºäº†è¡¨è¿°ç®€å•æ˜“æ‡‚ï¼Œæ–‡ä¸­å¿½ç•¥äº†ä¸€äº›ç»†ææœ«èŠ‚ï¼Œæ¯”å¦‚ä¸€ä¸ªé¡µä¸­ä¸å¯èƒ½æ‰€æœ‰ç©ºé—´éƒ½ç”¨äºå­˜æ”¾æ•°æ®ï¼Œå®ƒè¿˜ä¼šå­˜æ”¾ä¸€äº›å°‘é‡çš„å…¶ä»–å­—æ®µæ¯”å¦‚page levelï¼Œindex numberç­‰ç­‰ï¼Œå¦å¤–è¿˜æœ‰é¡µçš„å¡«å……å› å­ä¹Ÿå¯¼è‡´ä¸€ä¸ªé¡µä¸å¯èƒ½å…¨éƒ¨ç”¨äºä¿å­˜æ•°æ®ã€‚å…³äºäºŒçº§ç´¢å¼•æ•°æ®å­˜å–æ–¹å¼å¯ä»¥å‚è€ƒMySQLç›¸å…³ä¹¦ç±ï¼Œä»–çš„è¦ç‚¹æ˜¯ç»“åˆä¸»é”®ç´¢å¼•è¿›è¡Œå›è¡¨æŸ¥è¯¢ã€‚å‚è€ƒå‚è€ƒ","link":"/2019/06/04/mysqlæ•°æ®åº“ç´¢å¼•è§£æ.html"},{"title":"javaæ³¨è§£Annotationè¯´æ˜å®ä¾‹","text":"æ‘˜è¦Java æ³¨è§£æ˜¯é™„åŠ åœ¨ä»£ç ä¸­çš„ä¸€äº›å…ƒä¿¡æ¯ï¼Œç”¨äºä¸€äº›å·¥å…·åœ¨ç¼–è¯‘ã€è¿è¡Œæ—¶è¿›è¡Œè§£æå’Œä½¿ç”¨ï¼Œèµ·åˆ°è¯´æ˜ã€é…ç½®çš„åŠŸèƒ½ã€‚æ³¨è§£ä¸ä¼šä¹Ÿä¸èƒ½å½±å“ä»£ç çš„å®é™…é€»è¾‘ï¼Œä»…ä»…èµ·åˆ°è¾…åŠ©æ€§çš„ä½œç”¨ã€‚ ä»€ä¹ˆæ˜¯æ³¨è§£ï¼Ÿå¯¹äºå¾ˆå¤šåˆæ¬¡æ¥è§¦çš„å¼€å‘è€…æ¥è¯´åº”è¯¥éƒ½æœ‰è¿™ä¸ªç–‘é—®ï¼ŸAnnontationæ˜¯Java5å¼€å§‹å¼•å…¥çš„æ–°ç‰¹å¾ï¼Œä¸­æ–‡åç§°å«æ³¨è§£ã€‚å®ƒæä¾›äº†ä¸€ç§å®‰å…¨çš„ç±»ä¼¼æ³¨é‡Šçš„æœºåˆ¶ï¼Œç”¨æ¥å°†ä»»ä½•çš„ä¿¡æ¯æˆ–å…ƒæ•°æ®ï¼ˆmetadataï¼‰ä¸ç¨‹åºå…ƒç´ ï¼ˆç±»ã€æ–¹æ³•ã€æˆå‘˜å˜é‡ç­‰ï¼‰è¿›è¡Œå…³è”ã€‚ä¸ºç¨‹åºçš„å…ƒç´ ï¼ˆç±»ã€æ–¹æ³•ã€æˆå‘˜å˜é‡ï¼‰åŠ ä¸Šæ›´ç›´è§‚æ›´æ˜äº†çš„è¯´æ˜ï¼Œè¿™äº›è¯´æ˜ä¿¡æ¯æ˜¯ä¸ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘æ— å…³ï¼Œå¹¶ä¸”ä¾›æŒ‡å®šçš„å·¥å…·æˆ–æ¡†æ¶ä½¿ç”¨ã€‚Annontationåƒä¸€ç§ä¿®é¥°ç¬¦ä¸€æ ·ï¼Œåº”ç”¨äºåŒ…ã€ç±»å‹ã€æ„é€ æ–¹æ³•ã€æ–¹æ³•ã€æˆå‘˜å˜é‡ã€å‚æ•°åŠæœ¬åœ°å˜é‡çš„å£°æ˜è¯­å¥ä¸­ã€‚ Javaæ³¨è§£æ˜¯é™„åŠ åœ¨ä»£ç ä¸­çš„ä¸€äº›å…ƒä¿¡æ¯ï¼Œç”¨äºä¸€äº›å·¥å…·åœ¨ç¼–è¯‘ã€è¿è¡Œæ—¶è¿›è¡Œè§£æå’Œä½¿ç”¨ï¼Œèµ·åˆ°è¯´æ˜ã€é…ç½®çš„åŠŸèƒ½ã€‚æ³¨è§£ä¸ä¼šä¹Ÿä¸èƒ½å½±å“ä»£ç çš„å®é™…é€»è¾‘ï¼Œä»…ä»…èµ·åˆ°è¾…åŠ©æ€§çš„ä½œç”¨ã€‚åŒ…å«åœ¨ java.lang.annotation åŒ…ä¸­ã€‚ æ³¨è§£çš„ç”¨å¤„ ç”Ÿæˆæ–‡æ¡£ã€‚è¿™æ˜¯æœ€å¸¸è§çš„ï¼Œä¹Ÿæ˜¯java æœ€æ—©æä¾›çš„æ³¨è§£ã€‚å¸¸ç”¨çš„æœ‰@param @return ç­‰ è·Ÿè¸ªä»£ç ä¾èµ–æ€§ï¼Œå®ç°æ›¿ä»£é…ç½®æ–‡ä»¶åŠŸèƒ½ã€‚æ¯”å¦‚Dagger 2 ä¾èµ–æ³¨å…¥ï¼Œæœªæ¥java å¼€å‘ï¼Œå°†å¤§é‡æ³¨è§£é…ç½®ï¼Œå…·æœ‰å¾ˆå¤§ç”¨å¤„; åœ¨ç¼–è¯‘æ—¶è¿›è¡Œæ ¼å¼æ£€æŸ¥ã€‚å¦‚@override æ”¾åœ¨æ–¹æ³•å‰ï¼Œå¦‚æœä½ è¿™ä¸ªæ–¹æ³•å¹¶ä¸æ˜¯è¦†ç›–äº†è¶…ç±»æ–¹æ³•ï¼Œåˆ™ç¼–è¯‘æ—¶å°±èƒ½æ£€æŸ¥å‡ºã€‚ æ³¨è§£åŸç†æ³¨è§£æœ¬è´¨æ˜¯ä¸€ä¸ªç»§æ‰¿äº†Annotation çš„ç‰¹æ®Šæ¥å£ï¼Œå…¶å…·ä½“å®ç°ç±»æ˜¯Java è¿è¡Œæ—¶ç”Ÿæˆçš„åŠ¨æ€ä»£ç†ç±»ã€‚è€Œæˆ‘ä»¬é€šè¿‡åå°„è·å–æ³¨è§£æ—¶ï¼Œè¿”å›çš„æ˜¯Java è¿è¡Œæ—¶ç”Ÿæˆçš„åŠ¨æ€ä»£ç†å¯¹è±¡$Proxy1ã€‚é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨è‡ªå®šä¹‰æ³¨è§£ï¼ˆæ¥å£ï¼‰çš„æ–¹æ³•ï¼Œä¼šæœ€ç»ˆè°ƒç”¨AnnotationInvocationHandler çš„invoke æ–¹æ³•ã€‚è¯¥æ–¹æ³•ä¼šä»memberValues è¿™ä¸ªMap ä¸­ç´¢å¼•å‡ºå¯¹åº”çš„å€¼ã€‚è€ŒmemberValues çš„æ¥æºæ˜¯Java å¸¸é‡æ± ã€‚ å…ƒæ³¨è§£java.lang.annotation æä¾›äº†å››ç§å…ƒæ³¨è§£ï¼Œä¸“é—¨æ³¨è§£å…¶ä»–çš„æ³¨è§£ï¼ˆåœ¨è‡ªå®šä¹‰æ³¨è§£çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨åˆ°å…ƒæ³¨è§£ï¼‰ï¼š @Documented â€“ æ³¨è§£æ˜¯å¦å°†åŒ…å«åœ¨JavaDocä¸­ @Retention â€“ ä»€ä¹ˆæ—¶å€™ä½¿ç”¨è¯¥æ³¨è§£ @Target â€“ æ³¨è§£ç”¨äºä»€ä¹ˆåœ°æ–¹ @Inherited â€“ æ˜¯å¦å…è®¸å­ç±»ç»§æ‰¿è¯¥æ³¨è§£ @Retention å®šä¹‰è¯¥æ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸ â— RetentionPolicy.SOURCE : åœ¨ç¼–è¯‘é˜¶æ®µä¸¢å¼ƒã€‚è¿™äº›æ³¨è§£åœ¨ç¼–è¯‘ç»“æŸä¹‹åå°±ä¸å†æœ‰ä»»ä½•æ„ä¹‰ï¼Œæ‰€ä»¥å®ƒä»¬ä¸ä¼šå†™å…¥å­—èŠ‚ç ã€‚@Override, @SuppressWarningséƒ½å±äºè¿™ç±»æ³¨è§£ã€‚ â— RetentionPolicy.CLASS : åœ¨ç±»åŠ è½½çš„æ—¶å€™ä¸¢å¼ƒã€‚åœ¨å­—èŠ‚ç æ–‡ä»¶çš„å¤„ç†ä¸­æœ‰ç”¨ã€‚æ³¨è§£é»˜è®¤ä½¿ç”¨è¿™ç§æ–¹å¼ â— RetentionPolicy.RUNTIME : å§‹ç»ˆä¸ä¼šä¸¢å¼ƒï¼Œè¿è¡ŒæœŸä¹Ÿä¿ç•™è¯¥æ³¨è§£ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨åå°„æœºåˆ¶è¯»å–è¯¥æ³¨è§£çš„ä¿¡æ¯ã€‚æˆ‘ä»¬è‡ªå®šä¹‰çš„æ³¨è§£é€šå¸¸ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚ @Target è¡¨ç¤ºè¯¥æ³¨è§£ç”¨äºä»€ä¹ˆåœ°æ–¹ã€‚é»˜è®¤å€¼ä¸ºä»»ä½•å…ƒç´ ï¼Œè¡¨ç¤ºè¯¥æ³¨è§£ç”¨äºä»€ä¹ˆåœ°æ–¹ã€‚å¯ç”¨çš„ElementType å‚æ•°åŒ…æ‹¬ â— ElementType.CONSTRUCTOR: ç”¨äºæè¿°æ„é€ å™¨ â— ElementType.FIELD: æˆå‘˜å˜é‡ã€å¯¹è±¡ã€å±æ€§ï¼ˆåŒ…æ‹¬enumå®ä¾‹ï¼‰ â— ElementType.LOCAL_VARIABLE: ç”¨äºæè¿°å±€éƒ¨å˜é‡ â— ElementType.METHOD: ç”¨äºæè¿°æ–¹æ³• â— ElementType.PACKAGE: ç”¨äºæè¿°åŒ… â— ElementType.PARAMETER: ç”¨äºæè¿°å‚æ•° â— ElementType.TYPE: ç”¨äºæè¿°ç±»ã€æ¥å£(åŒ…æ‹¬æ³¨è§£ç±»å‹) æˆ–enumå£°æ˜ @Documented ä¸€ä¸ªç®€å•çš„Annotations æ ‡è®°æ³¨è§£ï¼Œè¡¨ç¤ºæ˜¯å¦å°†æ³¨è§£ä¿¡æ¯æ·»åŠ åœ¨java æ–‡æ¡£ä¸­ã€‚ @Inherited å®šä¹‰è¯¥æ³¨é‡Šå’Œå­ç±»çš„å…³ç³»@Inherited å…ƒæ³¨è§£æ˜¯ä¸€ä¸ªæ ‡è®°æ³¨è§£ï¼Œ@Inherited é˜è¿°äº†æŸä¸ªè¢«æ ‡æ³¨çš„ç±»å‹æ˜¯è¢«ç»§æ‰¿çš„ã€‚å¦‚æœä¸€ä¸ªä½¿ç”¨äº†@Inherited ä¿®é¥°çš„annotation ç±»å‹è¢«ç”¨äºä¸€ä¸ªclassï¼Œåˆ™è¿™ä¸ªannotation å°†è¢«ç”¨äºè¯¥class çš„å­ç±»ã€‚ å¸¸è§æ ‡å‡†çš„Annotation Overridejava.lang.Override æ˜¯ä¸€ä¸ªæ ‡è®°ç±»å‹æ³¨è§£ï¼Œå®ƒè¢«ç”¨ä½œæ ‡æ³¨æ–¹æ³•ã€‚å®ƒè¯´æ˜äº†è¢«æ ‡æ³¨çš„æ–¹æ³•é‡è½½äº†çˆ¶ç±»çš„æ–¹æ³•ï¼Œèµ·åˆ°äº†æ–­è¨€çš„ä½œç”¨ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨äº†è¿™ç§æ³¨è§£åœ¨ä¸€ä¸ªæ²¡æœ‰è¦†ç›–çˆ¶ç±»æ–¹æ³•çš„æ–¹æ³•æ—¶ï¼Œjava ç¼–è¯‘å™¨å°†ä»¥ä¸€ä¸ªç¼–è¯‘é”™è¯¯æ¥è­¦ç¤º DeprecatedDeprecated ä¹Ÿæ˜¯ä¸€ç§æ ‡è®°ç±»å‹æ³¨è§£ã€‚å½“ä¸€ä¸ªç±»å‹æˆ–è€…ç±»å‹æˆå‘˜ä½¿ç”¨@Deprecated ä¿®é¥°çš„è¯ï¼Œç¼–è¯‘å™¨å°†ä¸é¼“åŠ±ä½¿ç”¨è¿™ä¸ªè¢«æ ‡æ³¨çš„ç¨‹åºå…ƒç´ ã€‚æ‰€ä»¥ä½¿ç”¨è¿™ç§ä¿®é¥°å…·æœ‰ä¸€å®šçš„â€œå»¶ç»­æ€§â€ï¼šå¦‚æœæˆ‘ä»¬åœ¨ä»£ç ä¸­é€šè¿‡ç»§æ‰¿æˆ–è€…è¦†ç›–çš„æ–¹å¼ä½¿ç”¨äº†è¿™ä¸ªè¿‡æ—¶çš„ç±»å‹æˆ–è€…æˆå‘˜ï¼Œè™½ç„¶ç»§æ‰¿æˆ–è€…è¦†ç›–åçš„ç±»å‹æˆ–è€…æˆå‘˜å¹¶ä¸æ˜¯è¢«å£°æ˜ä¸º@Deprecatedï¼Œä½†ç¼–è¯‘å™¨ä»ç„¶è¦æŠ¥è­¦ã€‚ SuppressWarningsSuppressWarning ä¸æ˜¯ä¸€ä¸ªæ ‡è®°ç±»å‹æ³¨è§£ã€‚å®ƒæœ‰ä¸€ä¸ªç±»å‹ä¸ºString[] çš„æˆå‘˜ï¼Œè¿™ä¸ªæˆå‘˜çš„å€¼ä¸ºè¢«ç¦æ­¢çš„è­¦å‘Šåã€‚å¯¹äºjavac ç¼–è¯‘å™¨æ¥è®²ï¼Œè¢«-Xlint é€‰é¡¹æœ‰æ•ˆçš„è­¦å‘Šåä¹ŸåŒæ ·å¯¹@SuppressWarings æœ‰æ•ˆï¼ŒåŒæ—¶ç¼–è¯‘å™¨å¿½ç•¥æ‰æ— æ³•è¯†åˆ«çš„è­¦å‘Šåã€‚ @SuppressWarnings(â€œuncheckedâ€) è‡ªå®šä¹‰æ³¨è§£è‡ªå®šä¹‰æ³¨è§£ç±»ç¼–å†™çš„ä¸€äº›è§„åˆ™: Annotation å‹å®šä¹‰ä¸º@interface, æ‰€æœ‰çš„Annotation ä¼šè‡ªåŠ¨ç»§æ‰¿java.lang.Annotationè¿™ä¸€æ¥å£,å¹¶ä¸”ä¸èƒ½å†å»ç»§æ‰¿åˆ«çš„ç±»æˆ–æ˜¯æ¥å£. å‚æ•°æˆå‘˜åªèƒ½ç”¨public æˆ–é»˜è®¤(default) è¿™ä¸¤ä¸ªè®¿é—®æƒä¿®é¥° å‚æ•°æˆå‘˜åªèƒ½ç”¨åŸºæœ¬ç±»å‹byteã€shortã€charã€intã€longã€floatã€doubleã€booleanå…«ç§åŸºæœ¬æ•°æ®ç±»å‹å’ŒStringã€Enumã€Classã€annotationsç­‰æ•°æ®ç±»å‹ï¼Œä»¥åŠè¿™ä¸€äº›ç±»å‹çš„æ•°ç»„. è¦è·å–ç±»æ–¹æ³•å’Œå­—æ®µçš„æ³¨è§£ä¿¡æ¯ï¼Œå¿…é¡»é€šè¿‡Javaçš„åå°„æŠ€æœ¯æ¥è·å– Annotation å¯¹è±¡ï¼Œå› ä¸ºä½ é™¤æ­¤ä¹‹å¤–æ²¡æœ‰åˆ«çš„è·å–æ³¨è§£å¯¹è±¡çš„æ–¹æ³• æ³¨è§£ä¹Ÿå¯ä»¥æ²¡æœ‰å®šä¹‰æˆå‘˜,ï¼Œä¸è¿‡è¿™æ ·æ³¨è§£å°±æ²¡å•¥ç”¨äº†PS:è‡ªå®šä¹‰æ³¨è§£éœ€è¦ä½¿ç”¨åˆ°å…ƒæ³¨è§£ å®ä¾‹FruitName.java 123456789101112131415import java.lang.annotation.Documented;import java.lang.annotation.Retention;import java.lang.annotation.Target;import static java.lang.annotation.ElementType.FIELD;import static java.lang.annotation.RetentionPolicy.RUNTIME;/** * æ°´æœåç§°æ³¨è§£ */@Target(FIELD)@Retention(RUNTIME)@Documentedpublic @interface FruitName { String value() default \"\";} FruitColor.java 123456789101112131415161718192021222324import java.lang.annotation.Documented;import java.lang.annotation.Retention;import java.lang.annotation.Target;import static java.lang.annotation.ElementType.FIELD;import static java.lang.annotation.RetentionPolicy.RUNTIME;/** * æ°´æœé¢œè‰²æ³¨è§£ */@Target(FIELD)@Retention(RUNTIME)@Documentedpublic @interface FruitColor { /** * é¢œè‰²æšä¸¾ */ public enum Color{ BLUE,RED,GREEN}; /** * é¢œè‰²å±æ€§ */ Color fruitColor() default Color.GREEN;} FruitProvider.java 12345678910111213141516171819202122232425262728import java.lang.annotation.Documented;import java.lang.annotation.Retention;import java.lang.annotation.Target;import static java.lang.annotation.ElementType.FIELD;import static java.lang.annotation.RetentionPolicy.RUNTIME;/** * æ°´æœä¾›åº”è€…æ³¨è§£ */@Target(FIELD)@Retention(RUNTIME)@Documentedpublic @interface FruitProvider { /** * ä¾›åº”å•†ç¼–å· */ public int id() default -1; /** * ä¾›åº”å•†åç§° */ public String name() default \"\"; /** * ä¾›åº”å•†åœ°å€ */ public String address() default \"\";} FruitInfoUtil.java 1234567891011121314151617181920212223242526272829303132import java.lang.reflect.Field;/** * æ³¨è§£å¤„ç†å™¨ */public class FruitInfoUtil { public static void getFruitInfo(Class&lt;?&gt; clazz){ String strFruitName=\" æ°´æœåç§°ï¼š\"; String strFruitColor=\" æ°´æœé¢œè‰²ï¼š\"; String strFruitProvicer=\"ä¾›åº”å•†ä¿¡æ¯ï¼š\"; Field[] fields = clazz.getDeclaredFields(); for(Field field :fields){ if(field.isAnnotationPresent(FruitName.class)){ FruitName fruitName = (FruitName) field.getAnnotation(FruitName.class); strFruitName=strFruitName+fruitName.value(); System.out.println(strFruitName); } else if(field.isAnnotationPresent(FruitColor.class)){ FruitColor fruitColor= (FruitColor) field.getAnnotation(FruitColor.class); strFruitColor=strFruitColor+fruitColor.fruitColor().toString(); System.out.println(strFruitColor); } else if(field.isAnnotationPresent(FruitProvider.class)){ FruitProvider fruitProvider= (FruitProvider) field.getAnnotation(FruitProvider.class); strFruitProvicer=\" ä¾›åº”å•†ç¼–å·ï¼š\"+fruitProvider.id()+\" ä¾›åº”å•†åç§°ï¼š\"+fruitProvider.name()+\" ä¾›åº”å•†åœ°å€ï¼š\"+fruitProvider.address(); System.out.println(strFruitProvicer); } } }} Apple.java 1234567891011121314151617181920212223242526272829303132333435363738394041import test.FruitColor.Color;/** * æ³¨è§£ä½¿ç”¨ */public class Apple { @FruitName(\"Apple\") private String appleName; @FruitColor(fruitColor=Color.RED) private String appleColor; @FruitProvider(id=1,name=\"é™•è¥¿çº¢å¯Œå£«é›†å›¢\",address=\"é™•è¥¿çœè¥¿å®‰å¸‚å»¶å®‰è·¯89å·çº¢å¯Œå£«å¤§å¦\") private String appleProvider; public void setAppleColor(String appleColor) { this.appleColor = appleColor; } public String getAppleColor() { return appleColor; } public void setAppleName(String appleName) { this.appleName = appleName; } public String getAppleName() { return appleName; } public void setAppleProvider(String appleProvider) { this.appleProvider = appleProvider; } public String getAppleProvider() { return appleProvider; } public void displayName(){ System.out.println(\"æ°´æœçš„åå­—æ˜¯ï¼šè‹¹æœ\"); }} FruitRun.java 12345678/** * è¾“å‡ºç»“æœ */public class FruitRun { public static void main(String[] args) { FruitInfoUtil.getFruitInfo(Apple.class); }} è¿è¡Œç»“æœï¼š 123æ°´æœåç§°ï¼šAppleæ°´æœé¢œè‰²ï¼šREDä¾›åº”å•†ç¼–å·ï¼š1 ä¾›åº”å•†åç§°ï¼šé™•è¥¿çº¢å¯Œå£«é›†å›¢ ä¾›åº”å•†åœ°å€ï¼šé™•è¥¿çœè¥¿å®‰å¸‚å»¶å®‰è·¯89å·çº¢å¯Œå£«å¤§å¦ å‚è€ƒèµ„æ–™","link":"/2019/05/31/javaæ³¨è§£Annotationè¯´æ˜å®ä¾‹.html"},{"title":"elasticsearch6.xå€’æ’ç´¢å¼•å’Œåˆ†è¯","text":"æ‘˜è¦å€’æ’ç´¢å¼•ï¼ˆInverted Indexï¼‰ä¹Ÿå«åå‘ç´¢å¼•ï¼Œæœ‰åå‘ç´¢å¼•å¿…æœ‰æ­£å‘ç´¢å¼•ã€‚é€šä¿—åœ°æ¥è®²ï¼Œæ­£å‘ç´¢å¼•æ˜¯é€šè¿‡keyæ‰¾valueï¼Œåå‘ç´¢å¼•åˆ™æ˜¯é€šè¿‡valueæ‰¾keyã€‚ å€’æ’ç´¢å¼•ï¼ˆInverted Indexï¼‰ä¹Ÿå«åå‘ç´¢å¼•ï¼Œæœ‰åå‘ç´¢å¼•å¿…æœ‰æ­£å‘ç´¢å¼•ã€‚é€šä¿—åœ°æ¥è®²ï¼Œæ­£å‘ç´¢å¼•æ˜¯é€šè¿‡keyæ‰¾valueï¼Œåå‘ç´¢å¼•åˆ™æ˜¯é€šè¿‡valueæ‰¾keyã€‚ å€’æ’ç´¢å¼• æ­£æ’ç´¢å¼•ï¼šæ–‡æ¡£idåˆ°å•è¯çš„å…³è”å…³ç³» å€’æ’ç´¢å¼•ï¼šå•è¯åˆ°æ–‡æ¡£idçš„å…³è”å…³ç³» ç¤ºä¾‹ï¼šå¯¹ä»¥ä¸‹ä¸‰ä¸ªæ–‡æ¡£å»é™¤åœç”¨è¯åæ„é€ å€’æ’ç´¢å¼• å€’æ’ç´¢å¼•-æŸ¥è¯¢è¿‡ç¨‹æŸ¥è¯¢åŒ…å«â€œæœç´¢å¼•æ“â€çš„æ–‡æ¡£ é€šè¿‡å€’æ’ç´¢å¼•è·å¾—â€œæœç´¢å¼•æ“â€å¯¹åº”çš„æ–‡æ¡£idåˆ—è¡¨ï¼Œæœ‰1ï¼Œ3 é€šè¿‡æ­£æ’ç´¢å¼•æŸ¥è¯¢1å’Œ3çš„å®Œæ•´å†…å®¹ è¿”å›æœ€ç»ˆç»“æœ å€’æ’ç´¢å¼•-ç»„æˆ å•è¯è¯å…¸ï¼ˆTerm Dictionaryï¼‰ å€’æ’åˆ—è¡¨ï¼ˆPosting Listï¼‰ å•è¯è¯å…¸ï¼ˆTerm Dictionaryï¼‰å•è¯è¯å…¸çš„å®ç°ä¸€èˆ¬ç”¨B+æ ‘ï¼ŒB+æ ‘æ„é€ çš„å¯è§†åŒ–è¿‡ç¨‹ç½‘å€: B+ Tree Visualization å…³äºBæ ‘å’ŒB+æ ‘ ç»´åŸºç™¾ç§‘-Bæ ‘ ç»´åŸºç™¾ç§‘-B+æ ‘ Bæ ‘å’ŒB+æ ‘çš„æ’å…¥ã€åˆ é™¤å›¾æ–‡è¯¦è§£ å€’æ’åˆ—è¡¨ï¼ˆPosting Listï¼‰ å€’æ’åˆ—è¡¨è®°å½•äº†å•è¯å¯¹åº”çš„æ–‡æ¡£é›†åˆï¼Œæœ‰å€’æ’ç´¢å¼•é¡¹ï¼ˆPostingï¼‰ç»„æˆ å€’æ’ç´¢å¼•é¡¹ä¸»è¦åŒ…å«å¦‚ä¸‹ä¿¡æ¯ï¼š æ–‡æ¡£idç”¨äºè·å–åŸå§‹ä¿¡æ¯ å•è¯é¢‘ç‡ï¼ˆTFï¼ŒTerm Frequencyï¼‰ï¼Œè®°å½•è¯¥å•è¯åœ¨è¯¥æ–‡æ¡£ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œç”¨äºåç»­ç›¸å…³æ€§ç®—åˆ† ä½ç½®ï¼ˆPostingï¼‰ï¼Œè®°å½•å•è¯åœ¨æ–‡æ¡£ä¸­çš„åˆ†è¯ä½ç½®ï¼ˆå¤šä¸ªï¼‰ï¼Œç”¨äºåšè¯è¯­æœç´¢ï¼ˆPhrase Queryï¼‰ åç§»ï¼ˆOffsetï¼‰ï¼Œè®°å½•å•è¯åœ¨æ–‡æ¡£çš„å¼€å§‹å’Œç»“æŸä½ç½®ï¼Œç”¨äºé«˜äº®æ˜¾ç¤º B+æ ‘å†…éƒ¨ç»“ç‚¹å­˜ç´¢å¼•ï¼Œå¶å­ç»“ç‚¹å­˜æ•°æ®ï¼Œè¿™é‡Œçš„ å•è¯è¯å…¸å°±æ˜¯B+æ ‘ç´¢å¼•ï¼Œå€’æ’åˆ—è¡¨å°±æ˜¯æ•°æ®ï¼Œæ•´åˆåœ¨ä¸€èµ·åå¦‚ä¸‹æ‰€ç¤º ESå­˜å‚¨çš„æ˜¯ä¸€ä¸ªJSONæ ¼å¼çš„æ–‡æ¡£ï¼Œå…¶ä¸­åŒ…å«å¤šä¸ªå­—æ®µï¼Œæ¯ä¸ªå­—æ®µä¼šæœ‰è‡ªå·±çš„å€’æ’ç´¢å¼• åˆ†è¯åˆ†è¯æ˜¯å°†æ–‡æœ¬è½¬æ¢æˆä¸€ç³»åˆ—å•è¯ï¼ˆTerm or Tokenï¼‰çš„è¿‡ç¨‹ï¼Œä¹Ÿå¯ä»¥å«æ–‡æœ¬åˆ†æï¼Œåœ¨ESé‡Œé¢ç§°ä¸ºAnalysis åˆ†è¯å™¨åˆ†è¯å™¨æ˜¯ESä¸­ä¸“é—¨å¤„ç†åˆ†è¯çš„ç»„ä»¶ï¼Œè‹±æ–‡ä¸ºAnalyzerï¼Œå®ƒçš„ç»„æˆå¦‚ä¸‹ï¼š Character Filtersï¼šé’ˆå¯¹åŸå§‹æ–‡æœ¬è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚å»é™¤htmlæ ‡ç­¾ Tokenizerï¼šå°†åŸå§‹æ–‡æœ¬æŒ‰ç…§ä¸€å®šè§„åˆ™åˆ‡åˆ†ä¸ºå•è¯ Token Filtersï¼šé’ˆå¯¹Tokenizerå¤„ç†çš„å•è¯è¿›è¡Œå†åŠ å·¥ï¼Œæ¯”å¦‚è½¬å°å†™ã€åˆ é™¤æˆ–å¢æ–°ç­‰å¤„ç† åˆ†è¯å™¨è°ƒç”¨é¡ºåº Analyze APIESæä¾›äº†ä¸€ä¸ªå¯ä»¥æµ‹è¯•åˆ†è¯çš„APIæ¥å£ï¼Œæ–¹ä¾¿éªŒè¯åˆ†è¯æ•ˆæœï¼Œendpointæ˜¯_analyze å¯ä»¥ç›´æ¥æŒ‡å®šanalyzerè¿›è¡Œæµ‹è¯• å¯ä»¥ç›´æ¥æŒ‡å®šç´¢å¼•ä¸­çš„å­—æ®µè¿›è¡Œæµ‹è¯• 1234567891011POST test_index/doc{ \"username\": \"whirly\", \"age\":22}POST test_index/_analyze{ \"field\": \"username\", \"text\": [\"hello world\"]} å¯ä»¥è‡ªå®šä¹‰åˆ†è¯å™¨è¿›è¡Œæµ‹è¯• 123456POST _analyze{ &quot;tokenizer&quot;: &quot;standard&quot;, &quot;filter&quot;: [&quot;lowercase&quot;], &quot;text&quot;: [&quot;Hello World&quot;]} é¢„å®šä¹‰çš„åˆ†è¯å™¨ESè‡ªå¸¦çš„åˆ†è¯å™¨æœ‰å¦‚ä¸‹ï¼š Standard Analyzer é»˜è®¤åˆ†è¯å™¨ æŒ‰è¯åˆ‡åˆ†ï¼Œæ”¯æŒå¤šè¯­è¨€ å°å†™å¤„ç† Simple Analyzer æŒ‰ç…§éå­—æ¯åˆ‡åˆ† å°å†™å¤„ç† Whitespace Analyzer ç©ºç™½å­—ç¬¦ä½œä¸ºåˆ†éš”ç¬¦ Stop Analyzer ç›¸æ¯”Simple Analyzerå¤šäº†å»é™¤è¯·ç”¨è¯å¤„ç† åœç”¨è¯æŒ‡è¯­æ°”åŠ©è¯ç­‰ä¿®é¥°æ€§è¯è¯­ï¼Œå¦‚the, an, çš„ï¼Œ è¿™ç­‰ Keyword Analyzer ä¸åˆ†è¯ï¼Œç›´æ¥å°†è¾“å…¥ä½œä¸ºä¸€ä¸ªå•è¯è¾“å‡º Pattern Analyzer é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼è‡ªå®šä¹‰åˆ†éš”ç¬¦ é»˜è®¤æ˜¯\\W+ï¼Œå³éå­—è¯çš„ç¬¦å·ä½œä¸ºåˆ†éš”ç¬¦ Language Analyzer æä¾›äº†30+ç§å¸¸è§è¯­è¨€çš„åˆ†è¯å™¨ ç¤ºä¾‹ï¼šåœç”¨è¯åˆ†è¯å™¨ 12345POST _analyze{ \"analyzer\": \"stop\", \"text\": [\"The 2 QUICK Brown Foxes jumped over the lazy dog's bone.\"]} ç»“æœ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667{ \"tokens\": [ { \"token\": \"quick\", \"start_offset\": 6, \"end_offset\": 11, \"type\": \"word\", \"position\": 1 }, { \"token\": \"brown\", \"start_offset\": 12, \"end_offset\": 17, \"type\": \"word\", \"position\": 2 }, { \"token\": \"foxes\", \"start_offset\": 18, \"end_offset\": 23, \"type\": \"word\", \"position\": 3 }, { \"token\": \"jumped\", \"start_offset\": 24, \"end_offset\": 30, \"type\": \"word\", \"position\": 4 }, { \"token\": \"over\", \"start_offset\": 31, \"end_offset\": 35, \"type\": \"word\", \"position\": 5 }, { \"token\": \"lazy\", \"start_offset\": 40, \"end_offset\": 44, \"type\": \"word\", \"position\": 7 }, { \"token\": \"dog\", \"start_offset\": 45, \"end_offset\": 48, \"type\": \"word\", \"position\": 8 }, { \"token\": \"s\", \"start_offset\": 49, \"end_offset\": 50, \"type\": \"word\", \"position\": 9 }, { \"token\": \"bone\", \"start_offset\": 51, \"end_offset\": 55, \"type\": \"word\", \"position\": 10 } ]} ä¸­æ–‡åˆ†è¯ éš¾ç‚¹ ä¸­æ–‡åˆ†è¯æŒ‡çš„æ˜¯å°†ä¸€ä¸ªæ±‰å­—åºåˆ—åˆ‡åˆ†ä¸ºä¸€ä¸ªä¸€ä¸ªçš„å•ç‹¬çš„è¯ã€‚åœ¨è‹±æ–‡ä¸­ï¼Œå•è¯ä¹‹é—´ä»¥ç©ºæ ¼ä½œä¸ºè‡ªç„¶åˆ†ç•Œè¯ï¼Œæ±‰è¯­ä¸­è¯æ²¡æœ‰ä¸€ä¸ªå½¢å¼ä¸Šçš„åˆ†ç•Œç¬¦ ä¸Šä¸‹æ–‡ä¸åŒï¼Œåˆ†è¯ç»“æœè¿¥å¼‚ï¼Œæ¯”å¦‚äº¤å‰æ­§ä¹‰é—®é¢˜ å¸¸è§åˆ†è¯ç³»ç»Ÿ IKï¼šå®ç°ä¸­è‹±æ–‡å•è¯çš„åˆ‡åˆ†ï¼Œå¯è‡ªå®šä¹‰è¯åº“ï¼Œæ”¯æŒçƒ­æ›´æ–°åˆ†è¯è¯å…¸ jiebaï¼šæ”¯æŒåˆ†è¯å’Œè¯æ€§æ ‡æ³¨ï¼Œæ”¯æŒç¹ä½“åˆ†è¯ï¼Œè‡ªå®šä¹‰è¯å…¸ï¼Œå¹¶è¡Œåˆ†è¯ç­‰ Hanlpï¼šç”±ä¸€ç³»åˆ—æ¨¡å‹ä¸ç®—æ³•ç»„æˆçš„Javaå·¥å…·åŒ…ï¼Œç›®æ ‡æ˜¯æ™®åŠè‡ªç„¶è¯­è¨€å¤„ç†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­çš„åº”ç”¨ THUACï¼šä¸­æ–‡åˆ†è¯å’Œè¯æ€§æ ‡æ³¨ å®‰è£…ikä¸­æ–‡åˆ†è¯æ’ä»¶12345# åœ¨Elasticsearchå®‰è£…ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤ï¼Œç„¶åé‡å¯esbin/elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v6.3.0/elasticsearch-analysis-ik-6.3.0.zip# å¦‚æœç”±äºç½‘ç»œæ…¢ï¼Œå®‰è£…å¤±è´¥ï¼Œå¯ä»¥å…ˆä¸‹è½½å¥½zipå‹ç¼©åŒ…ï¼Œå°†ä¸‹é¢å‘½ä»¤æ”¹ä¸ºå®é™…çš„è·¯å¾„ï¼Œæ‰§è¡Œï¼Œç„¶åé‡å¯esbin/elasticsearch-plugin install file:///path/to/elasticsearch-analysis-ik-6.3.0.zip ikæµ‹è¯• - ik_smart 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667POST _analyze{ \"analyzer\": \"ik_smart\", \"text\": [\"å…¬å®‰éƒ¨ï¼šå„åœ°æ ¡è½¦å°†äº«æœ€é«˜è·¯æƒ\"]}# ç»“æœ{ \"tokens\": [ { \"token\": \"å…¬å®‰éƒ¨\", \"start_offset\": 0, \"end_offset\": 3, \"type\": \"CN_WORD\", \"position\": 0 }, { \"token\": \"å„åœ°\", \"start_offset\": 4, \"end_offset\": 6, \"type\": \"CN_WORD\", \"position\": 1 }, { \"token\": \"æ ¡è½¦\", \"start_offset\": 6, \"end_offset\": 8, \"type\": \"CN_WORD\", \"position\": 2 }, { \"token\": \"å°†\", \"start_offset\": 8, \"end_offset\": 9, \"type\": \"CN_CHAR\", \"position\": 3 }, { \"token\": \"äº«\", \"start_offset\": 9, \"end_offset\": 10, \"type\": \"CN_CHAR\", \"position\": 4 }, { \"token\": \"æœ€é«˜\", \"start_offset\": 10, \"end_offset\": 12, \"type\": \"CN_WORD\", \"position\": 5 }, { \"token\": \"è·¯\", \"start_offset\": 12, \"end_offset\": 13, \"type\": \"CN_CHAR\", \"position\": 6 }, { \"token\": \"æƒ\", \"start_offset\": 13, \"end_offset\": 14, \"type\": \"CN_CHAR\", \"position\": 7 } ]} ikæµ‹è¯• - ik_max_word 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081POST _analyze{ \"analyzer\": \"ik_max_word\", \"text\": [\"å…¬å®‰éƒ¨ï¼šå„åœ°æ ¡è½¦å°†äº«æœ€é«˜è·¯æƒ\"]}# ç»“æœ{ \"tokens\": [ { \"token\": \"å…¬å®‰éƒ¨\", \"start_offset\": 0, \"end_offset\": 3, \"type\": \"CN_WORD\", \"position\": 0 }, { \"token\": \"å…¬å®‰\", \"start_offset\": 0, \"end_offset\": 2, \"type\": \"CN_WORD\", \"position\": 1 }, { \"token\": \"éƒ¨\", \"start_offset\": 2, \"end_offset\": 3, \"type\": \"CN_CHAR\", \"position\": 2 }, { \"token\": \"å„åœ°\", \"start_offset\": 4, \"end_offset\": 6, \"type\": \"CN_WORD\", \"position\": 3 }, { \"token\": \"æ ¡è½¦\", \"start_offset\": 6, \"end_offset\": 8, \"type\": \"CN_WORD\", \"position\": 4 }, { \"token\": \"å°†\", \"start_offset\": 8, \"end_offset\": 9, \"type\": \"CN_CHAR\", \"position\": 5 }, { \"token\": \"äº«\", \"start_offset\": 9, \"end_offset\": 10, \"type\": \"CN_CHAR\", \"position\": 6 }, { \"token\": \"æœ€é«˜\", \"start_offset\": 10, \"end_offset\": 12, \"type\": \"CN_WORD\", \"position\": 7 }, { \"token\": \"è·¯\", \"start_offset\": 12, \"end_offset\": 13, \"type\": \"CN_CHAR\", \"position\": 8 }, { \"token\": \"æƒ\", \"start_offset\": 13, \"end_offset\": 14, \"type\": \"CN_CHAR\", \"position\": 9 } ]} ikä¸¤ç§åˆ†è¯æ¨¡å¼ik_max_word å’Œ ik_smart ä»€ä¹ˆåŒºåˆ«? ik_max_word: ä¼šå°†æ–‡æœ¬åšæœ€ç»†ç²’åº¦çš„æ‹†åˆ†ï¼Œæ¯”å¦‚ä¼šå°†â€œä¸­åäººæ°‘å…±å’Œå›½å›½æ­Œâ€æ‹†åˆ†ä¸ºâ€œä¸­åäººæ°‘å…±å’Œå›½,ä¸­åäººæ°‘,ä¸­å,åäºº,äººæ°‘å…±å’Œå›½,äººæ°‘,äºº,æ°‘,å…±å’Œå›½,å…±å’Œ,å’Œ,å›½å›½,å›½æ­Œâ€ï¼Œä¼šç©·å°½å„ç§å¯èƒ½çš„ç»„åˆï¼› ik_smart: ä¼šåšæœ€ç²—ç²’åº¦çš„æ‹†åˆ†ï¼Œæ¯”å¦‚ä¼šå°†â€œä¸­åäººæ°‘å…±å’Œå›½å›½æ­Œâ€æ‹†åˆ†ä¸ºâ€œä¸­åäººæ°‘å…±å’Œå›½,å›½æ­Œâ€ã€‚ è‡ªå®šä¹‰åˆ†è¯å½“è‡ªå¸¦çš„åˆ†è¯æ— æ³•æ»¡è¶³éœ€æ±‚æ—¶ï¼Œå¯ä»¥è‡ªå®šä¹‰åˆ†è¯ï¼Œé€šè¿‡å®šä¹‰Character Filtersã€Tokenizerå’ŒToken Filterså®ç° Character Filters åœ¨Tokenizerä¹‹å‰å¯¹åŸå§‹æ–‡æœ¬è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚å¢åŠ ã€åˆ é™¤æˆ–æ›¿æ¢å­—ç¬¦ç­‰ è‡ªå¸¦çš„å¦‚ä¸‹: HTML Strip Character Filterï¼šå»é™¤HTMLæ ‡ç­¾å’Œè½¬æ¢HTMLå®ä½“ Mapping Character Filterï¼šè¿›è¡Œå­—ç¬¦æ›¿æ¢æ“ä½œ Pattern Replace Character Filterï¼šè¿›è¡Œæ­£åˆ™åŒ¹é…æ›¿æ¢ ä¼šå½±å“åç»­tokenizerè§£æçš„positionå’Œoffsetä¿¡æ¯ Character Filtersæµ‹è¯•1234567891011121314151617181920212223POST _analyze{ \"tokenizer\": \"keyword\", \"char_filter\": [\"html_strip\"], \"text\": [\"&lt;p&gt;I&amp;apos;m so &lt;b&gt;happy&lt;/b&gt;!&lt;/p&gt;\"]}# ç»“æœ{ \"tokens\": [ { \"token\": \"\"\"I'm so happy!\"\"\", \"start_offset\": 0, \"end_offset\": 32, \"type\": \"word\", \"position\": 0 } ]} Tokenizers å°†åŸå§‹æ–‡æœ¬æŒ‰ç…§ä¸€å®šè§„åˆ™åˆ‡åˆ†ä¸ºå•è¯ï¼ˆterm or tokenï¼‰ è‡ªå¸¦çš„å¦‚ä¸‹ï¼š standard æŒ‰ç…§å•è¯è¿›è¡Œåˆ†å‰² letter æŒ‰ç…§éå­—ç¬¦ç±»è¿›è¡Œåˆ†å‰² whitespace æŒ‰ç…§ç©ºæ ¼è¿›è¡Œåˆ†å‰² UAX URL Email æŒ‰ç…§standardè¿›è¡Œåˆ†å‰²ï¼Œä½†ä¸ä¼šåˆ†å‰²é‚®ç®±å’ŒURL Ngram å’Œ Edge NGram è¿è¯åˆ†å‰² Path Hierarchy æŒ‰ç…§æ–‡ä»¶è·¯å¾„è¿›è¡Œåˆ†å‰² Tokenizers æµ‹è¯•1234567891011121314151617181920212223242526272829303132POST _analyze{ \"tokenizer\": \"path_hierarchy\", \"text\": [\"/path/to/file\"]}# ç»“æœ{ \"tokens\": [ { \"token\": \"/path\", \"start_offset\": 0, \"end_offset\": 5, \"type\": \"word\", \"position\": 0 }, { \"token\": \"/path/to\", \"start_offset\": 0, \"end_offset\": 8, \"type\": \"word\", \"position\": 0 }, { \"token\": \"/path/to/file\", \"start_offset\": 0, \"end_offset\": 13, \"type\": \"word\", \"position\": 0 } ]} Token Filters å¯¹äºtokenizerè¾“å‡ºçš„å•è¯ï¼ˆtermï¼‰è¿›è¡Œå¢åŠ ã€åˆ é™¤ã€ä¿®æ”¹ç­‰æ“ä½œ è‡ªå¸¦çš„å¦‚ä¸‹ï¼š lowercase å°†æ‰€æœ‰termè½¬ä¸ºå°å†™ stop åˆ é™¤åœç”¨è¯ Ngram å’Œ Edge NGram è¿è¯åˆ†å‰² Synonym æ·»åŠ è¿‘ä¹‰è¯çš„term Token Filtersæµ‹è¯•1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950POST _analyze{ \"text\": [ \"a Hello World!\" ], \"tokenizer\": \"standard\", \"filter\": [ \"stop\", \"lowercase\", { \"type\": \"ngram\", \"min_gram\": 4, \"max_gram\": 4 } ]}# ç»“æœ{ \"tokens\": [ { \"token\": \"hell\", \"start_offset\": 2, \"end_offset\": 7, \"type\": \"&lt;ALPHANUM&gt;\", \"position\": 1 }, { \"token\": \"ello\", \"start_offset\": 2, \"end_offset\": 7, \"type\": \"&lt;ALPHANUM&gt;\", \"position\": 1 }, { \"token\": \"worl\", \"start_offset\": 8, \"end_offset\": 13, \"type\": \"&lt;ALPHANUM&gt;\", \"position\": 2 }, { \"token\": \"orld\", \"start_offset\": 8, \"end_offset\": 13, \"type\": \"&lt;ALPHANUM&gt;\", \"position\": 2 } ]} è‡ªå®šä¹‰åˆ†è¯è‡ªå®šä¹‰åˆ†è¯éœ€è¦åœ¨ç´¢å¼•é…ç½®ä¸­è®¾å®š char_filterã€tokenizerã€filterã€analyzerç­‰ è‡ªå®šä¹‰åˆ†è¯ç¤ºä¾‹: åˆ†è¯å™¨åç§°ï¼šmy_custom\\ è¿‡æ»¤å™¨å°†tokenè½¬ä¸ºå¤§å†™ 1234567891011121314151617181920PUT test_index_1{ \"settings\": { \"analysis\": { \"analyzer\": { \"my_custom_analyzer\": { \"type\": \"custom\", \"tokenizer\": \"standard\", \"char_filter\": [ \"html_strip\" ], \"filter\": [ \"uppercase\", \"asciifolding\" ] } } } }} 12345678910111213141516171819202122232425262728293031323334353637383940// javaXContentFactory.jsonBuilder() .startObject().startObject(\"analysis\") .startObject(\"normalizer\").startObject(Normalizers.CASE_INSENSITIVE) .field(\"type\", \"custom\") .field(\"filter\", \"lowercase\") .endObject().endObject() // åŠ¨æ€åŒä¹‰è¯ .startObject(\"filter\") .startObject(\"dynamic_synonym\").field(\"type\", \"dynamic_synonym\").field(\"tokenizer\", \"ik_smart\").endObject().endObject() .startObject(\"analyzer\") // è‡ªå®šä¹‰åˆ†è¯å™¨ .startObject(\"ik\") .field(\"filter\", \"\") .field(\"char_filter\", Arrays.asList(\"char_mapper\")) .field(\"type\", \"custom\") .field(\"tokenizer\", \"ik_max_word\") .endObject() // æœç´¢æ—¶å¤„ç†åŒä¹‰è¯ .startObject(\"ikt\") .field(\"filter\", Arrays.asList(\"dynamic_synonym\")) .field(\"char_filter\", Arrays.asList(\"char_mapper\")) .field(\"type\", \"custom\") .field(\"tokenizer\", \"ik_smart\") .endObject() .endObject() // è‡ªå®šä¹‰å­—ç¬¦è¿‡æ»¤ .startObject(\"char_filter\") .startObject(\"char_mapper\") .field(\"type\", \"mapping\") .field(\"mappings_path\", \"analysis/mapping.txt\") .endObject() .endObject() .endObject().endObject(); è‡ªå®šä¹‰åˆ†è¯å™¨æµ‹è¯•1234567891011121314151617181920212223242526272829303132POST test_index_1/_analyze{ \"analyzer\": \"my_custom_analyzer\", \"text\": [\"&lt;p&gt;I&amp;apos;m so &lt;b&gt;happy&lt;/b&gt;!&lt;/p&gt;\"]}# ç»“æœ{ \"tokens\": [ { \"token\": \"I'M\", \"start_offset\": 3, \"end_offset\": 11, \"type\": \"&lt;ALPHANUM&gt;\", \"position\": 0 }, { \"token\": \"SO\", \"start_offset\": 12, \"end_offset\": 14, \"type\": \"&lt;ALPHANUM&gt;\", \"position\": 1 }, { \"token\": \"HAPPY\", \"start_offset\": 18, \"end_offset\": 27, \"type\": \"&lt;ALPHANUM&gt;\", \"position\": 2 } ]} åˆ†è¯ä½¿ç”¨è¯´æ˜åˆ†è¯ä¼šåœ¨å¦‚ä¸‹ä¸¤ä¸ªæ—¶æœºä½¿ç”¨ï¼š åˆ›å»ºæˆ–æ›´æ–°æ–‡æ¡£æ—¶(Index Time)ï¼Œä¼šå¯¹ç›¸åº”çš„æ–‡æ¡£è¿›è¡Œåˆ†è¯å¤„ç† æŸ¥è¯¢æ—¶ï¼ˆSearch Timeï¼‰ï¼Œä¼šå¯¹æŸ¥è¯¢è¯­å¥è¿›è¡Œåˆ†è¯ æŸ¥è¯¢æ—¶é€šè¿‡analyzeræŒ‡å®šåˆ†è¯å™¨ é€šè¿‡index mappingè®¾ç½®search_analyzerå®ç° ä¸€èˆ¬ä¸éœ€è¦ç‰¹åˆ«æŒ‡å®šæŸ¥è¯¢æ—¶åˆ†è¯å™¨ï¼Œç›´æ¥ä½¿ç”¨ç´¢å¼•åˆ†è¯å™¨å³å¯ï¼Œå¦åˆ™ä¼šå‡ºç°æ— æ³•åŒ¹é…çš„æƒ…å†µ åˆ†è¯ä½¿ç”¨å»ºè®® æ˜ç¡®å­—æ®µæ˜¯å¦éœ€è¦åˆ†è¯ï¼Œä¸éœ€è¦åˆ†è¯çš„å­—æ®µå°±å°†typeè®¾ç½®ä¸ºkeywordï¼Œå¯ä»¥èŠ‚çœç©ºé—´å’Œæé«˜å†™æ€§èƒ½ å–„ç”¨_analyze APIï¼ŒæŸ¥çœ‹æ–‡æ¡£çš„åˆ†è¯ç»“æœ å‚è€ƒè‡ª","link":"/2019/05/06/elasticsearch6-xå€’æ’ç´¢å¼•å’Œåˆ†è¯.html"},{"title":"Javaç‰ˆå¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼è¯´æ˜","text":"æ‘˜è¦æ­£åˆ™è¡¨è¾¾å¼åœ¨å‡ ä¹æ‰€æœ‰è¯­è¨€ä¸­éƒ½å¯ä»¥ä½¿ç”¨ï¼Œæ— è®ºæ˜¯å‰ç«¯çš„JavaScriptã€è¿˜æ˜¯åç«¯çš„Javaã€c#ã€‚ä»–ä»¬éƒ½æä¾›ç›¸åº”çš„æ¥å£/å‡½æ•°æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ã€‚ å…ƒå­—ç¬¦å…ƒå­—ç¬¦è¯´æ˜ï¼šåŒ¹é…é™¤æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å­—ç¬¦ wï¼šåŒ¹é…å­—æ¯æˆ–æ•°å­—æˆ–ä¸‹åˆ’çº¿æˆ–æ±‰å­— sï¼šåŒ¹é…ä»»æ„çš„ç©ºç™½ç¬¦ dï¼šåŒ¹é…æ•°å­—åŒ¹é…å•è¯çš„å¼€å§‹æˆ–ç»“æŸ ^ï¼šåŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹ $ï¼šåŒ¹é…å­—ç¬¦ä¸²çš„ç»“æŸ eg:åŒ¹é…æœ‰abcå¼€å¤´çš„å­—ç¬¦ä¸²ï¼šabcæˆ–è€…^abc åŒ¹é…8ä½æ•°å­—çš„QQå·ç ï¼š^dddddddd$ åŒ¹é…1å¼€å¤´11ä½æ•°å­—çš„æ‰‹æœºå·ç ï¼š^1dddddddddd$ é‡å¤é™å®šç¬¦ä¸ºäº†å¤„ç†è¿™äº›é‡å¤é—®é¢˜ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¸­ä¸€äº›é‡å¤é™å®šç¬¦ï¼ŒæŠŠé‡å¤éƒ¨åˆ†ç”¨åˆé€‚çš„é™å®šç¬¦æ›¿ä»£ è¯­æ³•è¯´æ˜ï¼š *é‡å¤é›¶æ¬¡æˆ–æ›´å¤šæ¬¡ +é‡å¤ä¸€æ¬¡æˆ–æ›´å¤šæ¬¡ ?é‡å¤é›¶æ¬¡æˆ–ä¸€æ¬¡ {n}é‡å¤næ¬¡ {n,}é‡å¤næ¬¡æˆ–æ›´å¤šæ¬¡ {n,m}é‡å¤nåˆ°mæ¬¡ åŒ¹é…8ä½æ•°å­—çš„QQå·ç ï¼š^d{8}$ åŒ¹é…1å¼€å¤´11ä½æ•°å­—çš„æ‰‹æœºå·ç ï¼š^1d{10}$ åŒ¹é…é“¶è¡Œå¡å·æ˜¯14~18ä½çš„æ•°å­—ï¼š^d{14,18}$ åŒ¹é…ä»¥aå¼€å¤´çš„ï¼Œ0ä¸ªæˆ–å¤šä¸ªbç»“å°¾çš„å­—ç¬¦ä¸²^ab*$ åˆ†ç»„æ­£åˆ™è¡¨è¾¾å¼ä¸­ç”¨å°æ‹¬å·()æ¥åšåˆ†ç»„ï¼Œä¹Ÿå°±æ˜¯æ‹¬å·ä¸­çš„å†…å®¹ä½œä¸ºä¸€ä¸ªæ•´ä½“ã€‚ å› æ­¤å½“æˆ‘ä»¬è¦åŒ¹é…å¤šä¸ªabæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ã€‚ å¦‚åŒ¹é…å­—ç¬¦ä¸²ä¸­åŒ…å«0åˆ°å¤šä¸ªabå¼€å¤´ï¼š^(ab)* è½¬ä¹‰æˆ‘ä»¬çœ‹åˆ°æ­£åˆ™è¡¨è¾¾å¼ç”¨å°æ‹¬å·æ¥åšåˆ†ç»„ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼š å¦‚æœè¦åŒ¹é…çš„å­—ç¬¦ä¸²ä¸­æœ¬èº«å°±åŒ…å«å°æ‹¬å·ï¼Œé‚£æ˜¯ä¸æ˜¯å†²çªï¼Ÿåº”è¯¥æ€ä¹ˆåŠï¼Ÿ é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œæ­£åˆ™æä¾›äº†è½¬ä¹‰çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è¦æŠŠè¿™äº›å…ƒå­—ç¬¦ã€é™å®šç¬¦æˆ–è€…å…³é”®å­—è½¬ä¹‰æˆæ™®é€šçš„å­—ç¬¦ï¼Œåšæ³•å¾ˆç®€ç­”ï¼Œå°±æ˜¯åœ¨è¦è½¬ä¹‰çš„å­—ç¬¦å‰é¢åŠ ä¸ªæ–œæ ï¼Œä¹Ÿå°±æ˜¯\\å³å¯ã€‚ å¦‚è¦åŒ¹é…ä»¥(ab)å¼€å¤´ï¼š^\\(ab\\)* æ¡ä»¶æˆ–å›åˆ°æˆ‘ä»¬åˆšæ‰çš„æ‰‹æœºå·åŒ¹é…ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ï¼šå›½å†…å·ç éƒ½æ¥è‡ªä¸‰å¤§ç½‘ï¼Œå®ƒä»¬éƒ½æœ‰å±äºè‡ªå·±çš„å·æ®µï¼Œæ¯”å¦‚è”é€šæœ‰130/131/132/155/156/185/186/145/176ç­‰å·æ®µï¼Œå‡å¦‚è®©æˆ‘ä»¬åŒ¹é…ä¸€ä¸ªè”é€šçš„å·ç ï¼Œé‚£æŒ‰ç…§æˆ‘ä»¬ç›®å‰æ‰€å­¦åˆ°çš„æ­£åˆ™ï¼Œåº”è¯¥æ— ä»ä¸‹æ‰‹çš„ï¼Œå› ä¸ºè¿™é‡ŒåŒ…å«äº†ä¸€äº›å¹¶åˆ—çš„æ¡ä»¶ï¼Œä¹Ÿå°±æ˜¯â€œæˆ–â€ï¼Œé‚£ä¹ˆåœ¨æ­£åˆ™ä¸­æ˜¯å¦‚ä½•è¡¨ç¤ºâ€œæˆ–â€çš„å‘¢ï¼Ÿ æ­£åˆ™ç”¨ç¬¦å· | æ¥è¡¨ç¤ºæˆ–ï¼Œä¹Ÿå«åšåˆ†æ”¯æ¡ä»¶ï¼Œå½“æ»¡è¶³æ­£åˆ™é‡Œçš„åˆ†æ”¯æ¡ä»¶çš„ä»»ä½•ä¸€ç§æ¡ä»¶æ—¶ï¼Œéƒ½ä¼šå½“æˆæ˜¯åŒ¹é…æˆåŠŸã€‚ é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨â€œæˆ–â€æ¡ä»¶æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ï¼š^(130|131|132|155|156|185|186|145|176)d{8}$ åŒºé—´æ­£åˆ™æä¾›ä¸€ä¸ªå…ƒå­—ç¬¦ä¸­æ‹¬å· [] æ¥è¡¨ç¤ºåŒºé—´æ¡ä»¶ã€‚ é™å®š0åˆ°9 å¯ä»¥å†™æˆ[0-9] é™å®šA-Z å†™æˆ[A-Z] é™å®šæŸäº›æ•°å­— [165] é‚£ä¸Šé¢çš„æ­£åˆ™æˆ‘ä»¬è¿˜æ”¹æˆè¿™æ ·ï¼š ^((13[0-2])|(15[56])|(18[5-6])|145|176)d{8}$ å¥½äº†ï¼Œæ­£åˆ™è¡¨è¾¾å¼çš„åŸºæœ¬ç”¨æ³•å°±è®²åˆ°è¿™é‡Œäº†ï¼Œå…¶å®å®ƒè¿˜æœ‰éå¸¸å¤šçš„çŸ¥è¯†ç‚¹ä»¥åŠå…ƒå­—ç¬¦ï¼Œæˆ‘ä»¬åœ¨æ­¤åªåˆ—ä¸¾äº†éƒ¨åˆ†å…ƒå­—ç¬¦å’Œè¯­æ³•æ¥è®²ï¼Œæ—¨åœ¨ç»™é‚£äº›ä¸æ‡‚æ­£åˆ™æˆ–è€…æƒ³å­¦æ­£åˆ™ä½†æœ‰çœ‹ä¸ä¸‹å»æ–‡æ¡£çš„äººåšä¸€ä¸ªå¿«é€Ÿå…¥é—¨çº§çš„æ•™ç¨‹ï¼Œçœ‹å®Œæœ¬æ•™ç¨‹ï¼Œå³ä½¿ä½ ä¸èƒ½å†™å‡ºé«˜å¤§ä¸Šçš„æ­£åˆ™ï¼Œè‡³å°‘ä¹Ÿèƒ½å†™ä¸€äº›ç®€å•çš„æ­£åˆ™æˆ–è€…çœ‹å¾—æ‡‚åˆ«äººå†™çš„æ­£åˆ™äº†ã€‚ æ­£åˆ™è¿›é˜¶çŸ¥è¯†ç‚¹1.é›¶å®½æ–­è¨€æ–­è¨€ï¼šä¿—è¯çš„æ–­è¨€å°±æ˜¯â€œæˆ‘æ–­å®šä»€ä¹ˆä»€ä¹ˆâ€ï¼Œè€Œæ­£åˆ™ä¸­çš„æ–­è¨€ï¼Œå°±æ˜¯è¯´æ­£åˆ™å¯ä»¥æŒ‡æ˜åœ¨æŒ‡å®šçš„å†…å®¹çš„å‰é¢æˆ–åé¢ä¼šå‡ºç°æ»¡è¶³æŒ‡å®šè§„åˆ™çš„å†…å®¹ï¼Œæ„æ€æ­£åˆ™ä¹Ÿå¯ä»¥åƒäººç±»é‚£æ ·æ–­å®šä»€ä¹ˆä»€ä¹ˆï¼Œæ¯”å¦‚â€ss1aa2bb3â€,æ­£åˆ™å¯ä»¥ç”¨æ–­è¨€æ‰¾å‡ºaa2å‰é¢æœ‰bb3ï¼Œä¹Ÿå¯ä»¥æ‰¾å‡ºaa2åé¢æœ‰ss1. é›¶å®½ï¼šå°±æ˜¯æ²¡æœ‰å®½åº¦ï¼Œåœ¨æ­£åˆ™ä¸­ï¼Œæ–­è¨€åªæ˜¯åŒ¹é…ä½ç½®ï¼Œä¸å å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒ¹é…ç»“æœé‡Œæ˜¯ä¸ä¼šè¿”å›æ–­è¨€æœ¬èº«ã€‚ eg:å‡è®¾æˆ‘ä»¬è¦ç”¨çˆ¬è™«æŠ“å–csdné‡Œçš„æ–‡ç« é˜…è¯»é‡ã€‚é€šè¿‡æŸ¥çœ‹æºä»£ç å¯ä»¥çœ‹åˆ°æ–‡ç« é˜…è¯»é‡è¿™ä¸ªå†…å®¹æ˜¯è¿™æ ·çš„ç»“æ„ â€œé˜…è¯»æ•°ï¼š641â€œ å…¶ä¸­ä¹Ÿå°±â€˜641â€™è¿™ä¸ªæ˜¯å˜é‡ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸åŒæ–‡ç« ä¸åŒçš„å€¼ï¼Œå½“æˆ‘ä»¬æ‹¿åˆ°è¿™ä¸ªå­—ç¬¦ä¸²æ—¶ï¼Œéœ€è¦è·å¾—è¿™é‡Œè¾¹çš„â€˜641â€™æœ‰å¾ˆå¤šç§åŠæ³•ï¼Œä½†å¦‚æœæ­£åˆ™åº”è¯¥æ€ä¹ˆåŒ¹é…å‘¢ï¼Ÿ æ­£å‘å…ˆè¡Œæ–­è¨€ï¼ˆæ­£å‰ç»ï¼‰è¯­æ³•ï¼šï¼ˆ?=patternï¼‰ ä½œç”¨ï¼šåŒ¹é…patternè¡¨è¾¾å¼çš„å‰é¢å†…å®¹ï¼Œä¸è¿”å›æœ¬èº«ã€‚ è¿™æ ·å­è¯´ï¼Œè¿˜æ˜¯ä¸€è„¸æ‡µé€¼ï¼Œå¥½å§ï¼Œå›å½’åˆšæ‰é‚£ä¸ªæ —å­ï¼Œè¦å–åˆ°é˜…è¯»é‡ï¼Œåœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­å°±æ„å‘³ç€è¦èƒ½åŒ¹é…åˆ°â€˜â€™å‰é¢çš„æ•°å­—å†…å®¹ã€‚ æŒ‰ç…§ä¸Šæ‰€è¯´çš„æ­£å‘å…ˆè¡Œæ–­è¨€å¯ä»¥åŒ¹é…è¡¨è¾¾å¼å‰é¢çš„å†…å®¹ï¼Œé‚£æ„æ€å°±æ˜¯:(?=) å°±å¯ä»¥åŒ¹é…åˆ°å‰é¢çš„å†…å®¹äº†ã€‚ åŒ¹é…ä»€ä¹ˆå†…å®¹å‘¢ï¼Ÿå¦‚æœè¦æ‰€æœ‰å†…å®¹é‚£å°±æ˜¯ï¼š 12345678910 String reg=\".+(?=&lt;/span&gt;)\";String test = \"&lt;span class=\"read-count\"&gt;é˜…è¯»æ•°ï¼š641&lt;/span&gt;\"; Pattern pattern = Pattern.compile(reg); Matcher mc= pattern.matcher(test); while(mc.find()){ System.out.println(\"åŒ¹é…ç»“æœï¼š\") System.out.println(mc.group()); } //åŒ¹é…ç»“æœï¼š//&lt;span class=\"read-count\"&gt;é˜…è¯»æ•°ï¼š641 å¯æ˜¯è€å“¥æˆ‘ä»¬è¦çš„åªæ˜¯å‰é¢çš„æ•°å­—å‘€ï¼Œé‚£ä¹Ÿç®€å•å’¯ï¼ŒåŒ¹é…æ•°å­— d,é‚£å¯ä»¥æ”¹æˆï¼š 123456789String reg=\"\\d+(?=&lt;/span&gt;)\";String test = \"&lt;span class=\\\"read-count\\\"&gt;é˜…è¯»æ•°ï¼š641&lt;/span&gt;\";Pattern pattern = Pattern.compile(reg);Matcher mc= pattern.matcher(test);while(mc.find()){ System.out.println(mc.group());}//åŒ¹é…ç»“æœï¼š//641 å¤§åŠŸå‘Šæˆï¼ æ­£å‘åè¡Œæ–­è¨€ï¼ˆæ­£åé¡¾ï¼‰è¯­æ³•ï¼šï¼ˆ?&lt;=patternï¼‰ ä½œç”¨ï¼šåŒ¹é…patternè¡¨è¾¾å¼çš„åé¢çš„å†…å®¹ï¼Œä¸è¿”å›æœ¬èº«ã€‚ æœ‰å…ˆè¡Œå°±æœ‰åè¡Œï¼Œå…ˆè¡Œæ˜¯åŒ¹é…å‰é¢çš„å†…å®¹ï¼Œé‚£åè¡Œå°±æ˜¯åŒ¹é…åé¢çš„å†…å®¹å•¦ã€‚ ä¸Šé¢çš„æ —å­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨åè¡Œæ–­è¨€æ¥å¤„ç†ã€‚ 12345678910//(?&lt;=&lt;span class=\"read-count\"&gt;é˜…è¯»æ•°ï¼š)d+String reg=\"(?&lt;=&lt;span class=\\\"read-count\\\"&gt;é˜…è¯»æ•°ï¼š)\\d+\";String test = \"&lt;span class=\\\"read-count\\\"&gt;é˜…è¯»æ•°ï¼š641&lt;/span&gt;\"; Pattern pattern = Pattern.compile(reg); Matcher mc= pattern.matcher(test); while(mc.find()){ System.out.println(mc.group()); }//åŒ¹é…ç»“æœï¼š//641 å°±è¿™ä¹ˆç®€å•ã€‚ è´Ÿå‘å…ˆè¡Œæ–­è¨€ï¼ˆè´Ÿå‰ç»ï¼‰è¯­æ³•ï¼š(?!pattern) ä½œç”¨ï¼šåŒ¹é…épatternè¡¨è¾¾å¼çš„å‰é¢å†…å®¹ï¼Œä¸è¿”å›æœ¬èº«ã€‚ æœ‰æ­£å‘ä¹Ÿæœ‰è´Ÿå‘ï¼Œè´Ÿå‘åœ¨è¿™é‡Œå…¶å®å°±æ˜¯éçš„æ„æ€ã€‚ ä¸¾ä¸ªæ —å­ï¼šæ¯”å¦‚æœ‰ä¸€å¥ â€œæˆ‘çˆ±ç¥–å›½ï¼Œæˆ‘æ˜¯ç¥–å›½çš„èŠ±æœµâ€ ç°åœ¨è¦æ‰¾åˆ°ä¸æ˜¯â€™çš„èŠ±æœµâ€™å‰é¢çš„ç¥–å›½ ç”¨æ­£åˆ™å°±å¯ä»¥è¿™æ ·å†™ï¼šç¥–å›½(?!çš„èŠ±æœµ)ã€‚ è´Ÿå‘åè¡Œæ–­è¨€ï¼ˆè´Ÿåé¡¾ï¼‰è¯­æ³•ï¼š(?&lt;!pattern) ä½œç”¨ï¼šåŒ¹é…épatternè¡¨è¾¾å¼çš„åé¢å†…å®¹ï¼Œä¸è¿”å›æœ¬èº«ã€‚ 2.æ•è·å’Œéæ•è·å•çº¯è¯´åˆ°æ•è·ï¼Œä»–çš„æ„æ€æ˜¯åŒ¹é…è¡¨è¾¾å¼ï¼Œä½†æ•è·é€šå¸¸å’Œåˆ†ç»„è”ç³»åœ¨ä¸€èµ·ï¼Œä¹Ÿå°±æ˜¯â€œæ•è·ç»„â€ã€‚ æ•è·ç»„ï¼šåŒ¹é…å­è¡¨è¾¾å¼çš„å†…å®¹ï¼ŒæŠŠåŒ¹é…ç»“æœä¿å­˜åˆ°å†…å­˜ä¸­ä¸­æ•°å­—ç¼–å·æˆ–æ˜¾ç¤ºå‘½åçš„ç»„é‡Œï¼Œä»¥æ·±åº¦ä¼˜å…ˆè¿›è¡Œç¼–å·ï¼Œä¹‹åå¯ä»¥é€šè¿‡åºå·æˆ–åç§°æ¥ä½¿ç”¨è¿™äº›åŒ¹é…ç»“æœã€‚ è€Œæ ¹æ®å‘½åæ–¹å¼çš„ä¸åŒï¼Œåˆå¯ä»¥åˆ†ä¸ºä¸¤ç§ç»„ã€‚ æ•°å­—ç¼–å·æ•è·ç»„ è¯­æ³•ï¼š(exp) è§£é‡Šï¼šä»è¡¨è¾¾å¼å·¦ä¾§å¼€å§‹ï¼Œæ¯å‡ºç°ä¸€ä¸ªå·¦æ‹¬å·å’Œå®ƒå¯¹åº”çš„å³æ‹¬å·ä¹‹é—´çš„å†…å®¹ä¸ºä¸€ä¸ªåˆ†ç»„ï¼Œåœ¨åˆ†ç»„ä¸­ï¼Œç¬¬0ç»„ä¸ºæ•´ä¸ªè¡¨è¾¾å¼ï¼Œç¬¬ä¸€ç»„å¼€å§‹ä¸ºåˆ†ç»„ã€‚ æ¯”å¦‚å›ºå®šç”µè¯çš„ï¼š020-85653333 ä»–çš„æ­£åˆ™è¡¨è¾¾å¼ä¸ºï¼š(0d{2})-(d{8}) æŒ‰ç…§å·¦æ‹¬å·çš„é¡ºåºï¼Œè¿™ä¸ªè¡¨è¾¾å¼æœ‰å¦‚ä¸‹åˆ†ç»„ï¼š åºå·ç¼–å·åˆ†ç»„å†…å®¹00(0d{2})-(d{8})020-8565333311(0d{2})02022(d{8})85653333 æˆ‘ä»¬ç”¨Javaæ¥éªŒè¯ä¸€ä¸‹ï¼š 12345678910String test = \"020-85653333\"; String reg=\"(0\\d{2})-(\\d{8})\"; Pattern pattern = Pattern.compile(reg); Matcher mc= pattern.matcher(test); if(mc.find()){ System.out.println(\"åˆ†ç»„çš„ä¸ªæ•°æœ‰ï¼š\"+mc.groupCount()); for(int i=0;i&lt;=mc.groupCount();i++){ System.out.println(\"ç¬¬\"+i+\"ä¸ªåˆ†ç»„ä¸ºï¼š\"+mc.group(i)); } } è¾“å‡ºç»“æœï¼š 1234åˆ†ç»„çš„ä¸ªæ•°æœ‰ï¼š2ç¬¬0ä¸ªåˆ†ç»„ä¸ºï¼š020-85653333ç¬¬1ä¸ªåˆ†ç»„ä¸ºï¼š020ç¬¬2ä¸ªåˆ†ç»„ä¸ºï¼š85653333 å¯è§ï¼Œåˆ†ç»„ä¸ªæ•°æ˜¯2ï¼Œä½†æ˜¯å› ä¸ºç¬¬0ä¸ªä¸ºæ•´ä¸ªè¡¨è¾¾å¼æœ¬èº«ï¼Œå› æ­¤ä¹Ÿä¸€èµ·è¾“å‡ºäº†ã€‚ å‘½åç¼–å·æ•è·ç»„ è¯­æ³•ï¼š(?exp) è§£é‡Šï¼šåˆ†ç»„çš„å‘½åç”±è¡¨è¾¾å¼ä¸­çš„nameæŒ‡å®š æ¯”å¦‚åŒºå·ä¹Ÿå¯ä»¥è¿™æ ·å†™:(?d{2})-(?d{8}) æŒ‰ç…§å·¦æ‹¬å·çš„é¡ºåºï¼Œè¿™ä¸ªè¡¨è¾¾å¼æœ‰å¦‚ä¸‹åˆ†ç»„ï¼šåºå·åç§°åˆ†ç»„å†…å®¹00(0d{2})-(d{8})020-856533331quhao(0d{2})0202haoma(d{8})85653333 ç”¨ä»£ç æ¥éªŒè¯ä¸€ä¸‹ï¼š 123456789String test = \"020-85653333\";String reg=\"(?&lt;quhao&gt;0\\d{2})-(?&lt;haoma&gt;\\d{8})\";Pattern pattern = Pattern.compile(reg);Matcher mc= pattern.matcher(test);if(mc.find()){ System.out.println(\"åˆ†ç»„çš„ä¸ªæ•°æœ‰ï¼š\"+mc.groupCount()); System.out.println(mc.group(\"quhao\")); System.out.println(mc.group(\"haoma\"));} è¾“å‡ºç»“æœï¼š 123åˆ†ç»„çš„ä¸ªæ•°æœ‰ï¼š2åˆ†ç»„åç§°ä¸º:quhao,åŒ¹é…å†…å®¹ä¸ºï¼š020åˆ†ç»„åç§°ä¸º:haoma,åŒ¹é…å†…å®¹ä¸ºï¼š85653333 éæ•è·ç»„ è¯­æ³•ï¼š(?:exp) è§£é‡Šï¼šå’Œæ•è·ç»„åˆšå¥½ç›¸åï¼Œå®ƒç”¨æ¥æ ‡è¯†é‚£äº›ä¸éœ€è¦æ•è·çš„åˆ†ç»„ï¼Œè¯´çš„é€šä¿—ä¸€ç‚¹ï¼Œå°±æ˜¯ä½ å¯ä»¥æ ¹æ®éœ€è¦å»ä¿å­˜ä½ çš„åˆ†ç»„ã€‚ æ¯”å¦‚ä¸Šé¢çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œç¨‹åºä¸éœ€è¦ç”¨åˆ°ç¬¬ä¸€ä¸ªåˆ†ç»„ï¼Œé‚£å°±å¯ä»¥è¿™æ ·å†™ï¼š(?:d{2})-(d{8}) åºå·ç¼–å·åˆ†ç»„å†…å®¹00(0d{2})-(d{8})020-8565333311(d{8})85653333 éªŒè¯ä¸€ä¸‹ï¼š 12345678910String test = \"020-85653333\";String reg=\"(?:0\\d{2})-(\\d{8})\";Pattern pattern = Pattern.compile(reg);Matcher mc= pattern.matcher(test);if(mc.find()){ System.out.println(\"åˆ†ç»„çš„ä¸ªæ•°æœ‰ï¼š\"+mc.groupCount()); for(inti=0;i&lt;=mc.groupCount();i++){ System.out.println(\"ç¬¬\"+i+\"ä¸ªåˆ†ç»„ä¸ºï¼š\"+mc.group(i)); }} è¾“å‡ºç»“æœï¼š 123åˆ†ç»„çš„ä¸ªæ•°æœ‰ï¼š1ç¬¬0ä¸ªåˆ†ç»„ä¸ºï¼š020-85653333ç¬¬1ä¸ªåˆ†ç»„ä¸ºï¼š85653333 3.åå‘å¼•ç”¨ä¸Šé¢è®²åˆ°æ•è·ï¼Œæˆ‘ä»¬çŸ¥é“ï¼šæ•è·ä¼šè¿”å›ä¸€ä¸ªæ•è·ç»„ï¼Œè¿™ä¸ªåˆ†ç»„æ˜¯ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œä¸ä»…å¯ä»¥åœ¨æ­£åˆ™è¡¨è¾¾å¼å¤–éƒ¨é€šè¿‡ç¨‹åºè¿›è¡Œå¼•ç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨æ­£åˆ™è¡¨è¾¾å¼å†…éƒ¨è¿›è¡Œå¼•ç”¨ï¼Œè¿™ç§å¼•ç”¨æ–¹å¼å°±æ˜¯åå‘å¼•ç”¨ã€‚ æ ¹æ®æ•è·ç»„çš„å‘½åè§„åˆ™ï¼Œåå‘å¼•ç”¨å¯åˆ†ä¸ºï¼š æ•°å­—ç¼–å·ç»„åå‘å¼•ç”¨ï¼škæˆ– umber å‘½åç¼–å·ç»„åå‘å¼•ç”¨ï¼škæˆ–è€…â€™nameâ€™ å¥½äº† è®²å®Œäº†ï¼Œæ‡‚å—ï¼Ÿä¸æ‡‚ï¼ï¼ï¼ å¯èƒ½è¿å‰é¢è®²çš„æ•è·æœ‰ä»€ä¹ˆç”¨éƒ½è¿˜ä¸æ‡‚å§ï¼Ÿ å…¶å®åªæ˜¯çœ‹å®Œæ•è·ä¸æ‡‚ä¸ä¼šç”¨æ˜¯å¾ˆæ­£å¸¸çš„ï¼ å› ä¸ºæ•è·ç»„é€šå¸¸æ˜¯å’Œåå‘å¼•ç”¨ä¸€èµ·ä½¿ç”¨çš„ã€‚ ä¸Šé¢è¯´åˆ°æ•è·ç»„æ˜¯åŒ¹é…å­è¡¨è¾¾å¼çš„å†…å®¹æŒ‰åºå·æˆ–è€…å‘½åä¿å­˜èµ·æ¥ä»¥ä¾¿ä½¿ç”¨ã€‚ æ³¨æ„ä¸¤ä¸ªå­—çœ¼ï¼šâ€œå†…å®¹â€ å’Œ â€œä½¿ç”¨â€ã€‚ è¿™é‡Œæ‰€è¯´çš„â€œå†…å®¹â€ï¼Œæ˜¯åŒ¹é…ç»“æœï¼Œè€Œä¸æ˜¯å­è¡¨è¾¾å¼æœ¬èº«ï¼Œå¼ºè°ƒè¿™ä¸ªæœ‰ä»€ä¹ˆç”¨ï¼Ÿå—¯ï¼Œå…ˆè®°ä½ã€‚ é‚£è¿™é‡Œæ‰€è¯´çš„â€œä½¿ç”¨â€æ˜¯æ€æ ·ä½¿ç”¨å‘¢ï¼Ÿ å› ä¸ºå®ƒçš„ä½œç”¨ä¸»è¦æ˜¯ç”¨æ¥æŸ¥æ‰¾ä¸€äº›é‡å¤çš„å†…å®¹æˆ–è€…åšæ›¿æ¢æŒ‡å®šå­—ç¬¦ã€‚ è¿˜æ˜¯ä¸¾æ —å­å§ã€‚ æ¯”å¦‚è¦æŸ¥æ‰¾ä¸€ä¸²å­—æ¯â€aabbbbgbddesddfiidâ€é‡Œæˆå¯¹çš„å­—æ¯ å¦‚æœæŒ‰ç…§æˆ‘ä»¬ä¹‹å‰å­¦åˆ°çš„æ­£åˆ™ï¼Œä»€ä¹ˆåŒºé—´å•Šé™å®šå•Šæ–­è¨€å•Šå¯èƒ½æ˜¯åŠä¸åˆ°çš„ï¼Œ ç°åœ¨æˆ‘ä»¬å…ˆç”¨ç¨‹åºæ€ç»´ç†ä¸€ä¸‹æ€è·¯ï¼š 1ï¼‰åŒ¹é…åˆ°ä¸€ä¸ªå­—æ¯ 2ï¼‰åŒ¹é…ç¬¬ä¸‹ä¸€ä¸ªå­—æ¯ï¼Œæ£€æŸ¥æ˜¯å¦å’Œä¸Šä¸€ä¸ªå­—æ¯æ˜¯å¦ä¸€æ · 3ï¼‰å¦‚æœä¸€æ ·ï¼Œåˆ™åŒ¹é…æˆåŠŸï¼Œå¦åˆ™å¤±è´¥ è¿™é‡Œçš„æ€è·¯2ä¸­åŒ¹é…ä¸‹ä¸€ä¸ªå­—æ¯æ—¶ï¼Œéœ€è¦ç”¨åˆ°ä¸Šä¸€ä¸ªå­—æ¯ï¼Œé‚£æ€ä¹ˆè®°ä½ä¸Šä¸€ä¸ªå­—æ¯å‘¢ï¼Ÿï¼Ÿï¼Ÿ è¿™ä¸‹å­æ•è·å°±æœ‰ç”¨å¤„å•¦ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ•è·æŠŠä¸Šä¸€ä¸ªåŒ¹é…æˆåŠŸçš„å†…å®¹ç”¨æ¥ä½œä¸ºæœ¬æ¬¡åŒ¹é…çš„æ¡ä»¶ å¥½äº†ï¼Œæœ‰æ€è·¯å°±è¦å®è·µ é¦–å…ˆåŒ¹é…ä¸€ä¸ªå­—æ¯ï¼šw æˆ‘ä»¬éœ€è¦åšæˆåˆ†ç»„æ‰èƒ½æ•è·ï¼Œå› æ­¤å†™æˆè¿™æ ·ï¼š(w) é‚£è¿™ä¸ªè¡¨è¾¾å¼å°±æœ‰ä¸€ä¸ªæ•è·ç»„ï¼šï¼ˆwï¼‰ ç„¶åæˆ‘ä»¬è¦ç”¨è¿™ä¸ªæ•è·ç»„ä½œä¸ºæ¡ä»¶ï¼Œé‚£å°±å¯ä»¥ï¼š(w) è¿™æ ·å°±å¤§åŠŸå‘Šæˆäº† å¯èƒ½æœ‰äººä¸æ˜ç™½äº†ï¼Œæ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ è¿˜è®°å¾—æ•è·ç»„æœ‰ä¸¤ç§å‘½åæ–¹å¼å—ï¼Œä¸€ç§æ˜¯æ˜¯æ ¹æ®æ•è·åˆ†ç»„é¡ºåºå‘½åï¼Œä¸€ç§æ˜¯è‡ªå®šä¹‰å‘½åæ¥ä½œä¸ºæ•è·ç»„çš„å‘½å åœ¨é»˜è®¤æƒ…å†µä¸‹éƒ½æ˜¯ä»¥æ•°å­—æ¥å‘½åï¼Œè€Œä¸”æ•°å­—å‘½åçš„é¡ºåºæ˜¯ä»1å¼€å§‹çš„ å› æ­¤è¦å¼•ç”¨ç¬¬ä¸€ä¸ªæ•è·ç»„ï¼Œæ ¹æ®åå‘å¼•ç”¨çš„æ•°å­—å‘½åè§„åˆ™ å°±éœ€è¦ kæˆ–è€… å½“ç„¶ï¼Œé€šå¸¸éƒ½æ˜¯æ˜¯åè€…ã€‚ æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼š 1234567String test = \"aabbbbgbddesddfiid\";Pattern pattern = Pattern.compile(\"(\\w)\\1\");Matcher mc= pattern.matcher(test);while(mc.find()){ System.out.println(mc.group());} è¾“å‡ºç»“æœï¼š 1aabbbbddddii å—¯ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„äº†ã€‚ åœ¨ä¸¾ä¸ªæ›¿æ¢çš„ä¾‹å­ï¼Œå‡å¦‚æƒ³è¦æŠŠå­—ç¬¦ä¸²ä¸­abcæ¢æˆaã€‚ 123String test = \"abcbbabcbcgbddesddfiid\";String reg=\"(a)(b)c\";System.out.println(test.replaceAll(reg, \"$1\")); è¾“å‡ºç»“æœï¼š 1abbabcgbddesddfiid 4.è´ªå©ªå’Œéè´ªå©ª è´ªå©ª æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œè´ªå©ªå°±æ˜¯ä¸æ»¡è¶³ï¼Œå°½å¯èƒ½å¤šçš„è¦ã€‚ åœ¨æ­£åˆ™ä¸­ï¼Œè´ªå©ªä¹Ÿæ˜¯å·®ä¸å¤šçš„æ„æ€: è´ªå©ªåŒ¹é…ï¼šå½“æ­£åˆ™è¡¨è¾¾å¼ä¸­åŒ…å«èƒ½æ¥å—é‡å¤çš„é™å®šç¬¦æ—¶ï¼Œé€šå¸¸çš„è¡Œä¸ºæ˜¯ï¼ˆåœ¨ä½¿æ•´ä¸ªè¡¨è¾¾å¼èƒ½å¾—åˆ°åŒ¹é…çš„å‰æä¸‹ï¼‰åŒ¹é…å°½å¯èƒ½å¤šçš„å­—ç¬¦ï¼Œè¿™åŒ¹é…æ–¹å¼å«åšè´ªå©ªåŒ¹é…ã€‚ ç‰¹æ€§ï¼šä¸€æ¬¡æ€§è¯»å…¥æ•´ä¸ªå­—ç¬¦ä¸²è¿›è¡ŒåŒ¹é…ï¼Œæ¯å½“ä¸åŒ¹é…å°±èˆå¼ƒæœ€å³è¾¹ä¸€ä¸ªå­—ç¬¦ï¼Œç»§ç»­åŒ¹é…ï¼Œä¾æ¬¡åŒ¹é…å’Œèˆå¼ƒï¼ˆè¿™ç§åŒ¹é…-èˆå¼ƒçš„æ–¹å¼ä¹Ÿå«åšå›æº¯ï¼‰ï¼Œç›´åˆ°åŒ¹é…æˆåŠŸæˆ–è€…æŠŠæ•´ä¸ªå­—ç¬¦ä¸²èˆå¼ƒå®Œä¸ºæ­¢ï¼Œå› æ­¤å®ƒæ˜¯ä¸€ç§æœ€å¤§åŒ–çš„æ•°æ®è¿”å›ï¼Œèƒ½å¤šä¸ä¼šå°‘ã€‚ å‰é¢æˆ‘ä»¬è®²è¿‡é‡å¤é™å®šç¬¦ï¼Œå…¶å®è¿™äº›é™å®šç¬¦å°±æ˜¯è´ªå©ªé‡è¯ï¼Œæ¯”å¦‚è¡¨è¾¾å¼ï¼šd{3,6}ã€‚ ç”¨æ¥åŒ¹é…3åˆ°6ä½æ•°å­—ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒæ˜¯ä¸€ç§è´ªå©ªæ¨¡å¼çš„åŒ¹é…ï¼Œä¹Ÿå°±æ˜¯å‡å¦‚å­—ç¬¦ä¸²é‡Œæœ‰6ä¸ªä¸ªæ•°å­—å¯ä»¥åŒ¹é…ï¼Œé‚£å®ƒå°±æ˜¯å…¨éƒ¨åŒ¹é…åˆ°ã€‚ å¦‚ä¸‹é¢çš„ä»£ç ã€‚ 123456789String reg=\"\\d{3,6}\";String test=\"61762828 176 2991 871\";System.out.println(\"æ–‡æœ¬ï¼š\"+test);System.out.println(\"è´ªå©ªæ¨¡å¼ï¼š\"+reg);Pattern p1 =Pattern.compile(reg);Matcher m1 = p1.matcher(test);while(m1.find()){ System.out.println(\"åŒ¹é…ç»“æœï¼š\"+m1.group(0));} è¾“å‡ºç»“æœï¼š 123456æ–‡æœ¬ï¼š61762828 176 2991 44 871è´ªå©ªæ¨¡å¼ï¼šd{3,6}åŒ¹é…ç»“æœï¼š617628åŒ¹é…ç»“æœï¼š176åŒ¹é…ç»“æœï¼š2991åŒ¹é…ç»“æœï¼š871 ç”±ç»“æœå¯è§ï¼šæœ¬æ¥å­—ç¬¦ä¸²ä¸­çš„â€œ61762828â€è¿™ä¸€æ®µï¼Œå…¶å®åªéœ€è¦å‡ºç°3ä¸ªï¼ˆ617ï¼‰å°±å·²ç»åŒ¹é…æˆåŠŸäº†çš„ï¼Œä½†æ˜¯ä»–å¹¶ä¸æ»¡è¶³ï¼Œè€Œæ˜¯åŒ¹é…åˆ°äº†æœ€å¤§èƒ½åŒ¹é…çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯6ä¸ªã€‚ ä¸€ä¸ªé‡è¯å°±å¦‚æ­¤è´ªå©ªäº†ï¼Œ é‚£æœ‰äººä¼šé—®ï¼Œå¦‚æœå¤šä¸ªè´ªå©ªé‡è¯å‡‘åœ¨ä¸€èµ·ï¼Œé‚£ä»–ä»¬æ˜¯å¦‚ä½•æ”¯é…è‡ªå·±çš„åŒ¹é…æƒçš„å‘¢ï¼Ÿ æ˜¯è¿™æ ·çš„ï¼Œå¤šä¸ªè´ªå©ªåœ¨ä¸€èµ·æ—¶ï¼Œå¦‚æœå­—ç¬¦ä¸²èƒ½æ»¡è¶³ä»–ä»¬å„è‡ªæœ€å¤§ç¨‹åº¦çš„åŒ¹é…æ—¶ï¼Œå°±äº’ä¸å¹²æ‰°ï¼Œä½†å¦‚æœä¸èƒ½æ»¡è¶³æ—¶ï¼Œä¼šæ ¹æ®æ·±åº¦ä¼˜å…ˆåŸåˆ™ï¼Œä¹Ÿå°±æ˜¯ä»å·¦åˆ°å³çš„æ¯ä¸€ä¸ªè´ªå©ªé‡è¯ï¼Œä¼˜å…ˆæœ€å¤§æ•°é‡çš„æ»¡è¶³ï¼Œå‰©ä½™å†åˆ†é…ä¸‹ä¸€ä¸ªé‡è¯åŒ¹é…ã€‚ 123456789String reg=\"(\\d{1,2})(\\d{3,4})\";String test=\"61762828 176 2991 87321\";System.out.println(\"æ–‡æœ¬ï¼š\"+test);System.out.println(\"è´ªå©ªæ¨¡å¼ï¼š\"+reg);Pattern p1 =Pattern.compile(reg);Matcher m1 = p1.matcher(test);while(m1.find()){ System.out.println(\"åŒ¹é…ç»“æœï¼š\"+m1.group(0));} è¾“å‡ºç»“æœï¼š 12345æ–‡æœ¬ï¼š61762828 176 2991 87321è´ªå©ªæ¨¡å¼ï¼š(d{1,2})(d{3,4})åŒ¹é…ç»“æœï¼š617628åŒ¹é…ç»“æœï¼š2991åŒ¹é…ç»“æœï¼š87321 â€œ617628â€ æ˜¯å‰é¢çš„d{1,2}åŒ¹é…å‡ºäº†61ï¼Œåé¢çš„åŒ¹é…å‡ºäº†7628 â€œ2991â€ æ˜¯å‰é¢çš„d{1,2}åŒ¹é…å‡ºäº†29 ï¼Œåé¢çš„åŒ¹é…å‡ºäº†91 â€œ87321â€æ˜¯å‰é¢çš„d{1,2}åŒ¹é…å‡ºäº†87ï¼Œåé¢çš„åŒ¹é…å‡ºäº†321 æ‡’æƒ°ï¼ˆéè´ªå©ªï¼‰ æ‡’æƒ°åŒ¹é…ï¼šå½“æ­£åˆ™è¡¨è¾¾å¼ä¸­åŒ…å«èƒ½æ¥å—é‡å¤çš„é™å®šç¬¦æ—¶ï¼Œé€šå¸¸çš„è¡Œä¸ºæ˜¯ï¼ˆåœ¨ä½¿æ•´ä¸ªè¡¨è¾¾å¼èƒ½å¾—åˆ°åŒ¹é…çš„å‰æä¸‹ï¼‰åŒ¹é…å°½å¯èƒ½å°‘çš„å­—ç¬¦ï¼Œè¿™åŒ¹é…æ–¹å¼å«åšæ‡’æƒ°åŒ¹é…ã€‚ ç‰¹æ€§ï¼šä»å·¦åˆ°å³ï¼Œä»å­—ç¬¦ä¸²çš„æœ€å·¦è¾¹å¼€å§‹åŒ¹é…ï¼Œæ¯æ¬¡è¯•å›¾ä¸è¯»å…¥å­—ç¬¦åŒ¹é…ï¼ŒåŒ¹é…æˆåŠŸï¼Œåˆ™å®ŒæˆåŒ¹é…ï¼Œå¦åˆ™è¯»å…¥ä¸€ä¸ªå­—ç¬¦å†åŒ¹é…ï¼Œä¾æ­¤å¾ªç¯ï¼ˆè¯»å…¥å­—ç¬¦ã€åŒ¹é…ï¼‰ç›´åˆ°åŒ¹é…æˆåŠŸæˆ–è€…æŠŠå­—ç¬¦ä¸²çš„å­—ç¬¦åŒ¹é…å®Œä¸ºæ­¢ã€‚ æ‡’æƒ°é‡è¯æ˜¯åœ¨è´ªå©ªé‡è¯åé¢åŠ ä¸ªâ€œï¼Ÿâ€ ä»£ç è¯´æ˜ *?é‡å¤ä»»æ„æ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤ +?é‡å¤1æ¬¡æˆ–æ›´å¤šæ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤ ??é‡å¤0æ¬¡æˆ–1æ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤ {n,m}?é‡å¤nåˆ°mæ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤ {n,}?é‡å¤næ¬¡ä»¥ä¸Šï¼Œä½†å°½å¯èƒ½å°‘é‡å¤ã€‚ 123456789String reg=\"(\\d{1,2}?)(\\d{3,4})\";String test=\"61762828 176 2991 87321\";System.out.println(\"æ–‡æœ¬ï¼š\"+test);System.out.println(\"è´ªå©ªæ¨¡å¼ï¼š\"+reg);Pattern p1 =Pattern.compile(reg);Matcher m1 = p1.matcher(test);while(m1.find()){ System.out.println(\"åŒ¹é…ç»“æœï¼š\"+m1.group(0));} è¾“å‡ºç»“æœï¼š 12345æ–‡æœ¬ï¼š61762828 176 2991 87321è´ªå©ªæ¨¡å¼ï¼š(d{1,2}?)(d{3,4})åŒ¹é…ç»“æœï¼š61762åŒ¹é…ç»“æœï¼š2991åŒ¹é…ç»“æœï¼š87321 â€œ61762â€ æ˜¯å·¦è¾¹çš„æ‡’æƒ°åŒ¹é…å‡º6ï¼Œå³è¾¹çš„è´ªå©ªåŒ¹é…å‡º1762 â€œ2991â€ æ˜¯å·¦è¾¹çš„æ‡’æƒ°åŒ¹é…å‡º2ï¼Œå³è¾¹çš„è´ªå©ªåŒ¹é…å‡º991 â€œ87321â€ å·¦è¾¹çš„æ‡’æƒ°åŒ¹é…å‡º8ï¼Œå³è¾¹çš„è´ªå©ªåŒ¹é…å‡º7321 5.åä¹‰å‰é¢è¯´åˆ°å…ƒå­—ç¬¦çš„éƒ½æ˜¯è¦åŒ¹é…ä»€ä¹ˆä»€ä¹ˆï¼Œå½“ç„¶å¦‚æœä½ æƒ³åç€æ¥ï¼Œä¸æƒ³åŒ¹é…æŸäº›å­—ç¬¦ï¼Œæ­£åˆ™ä¹Ÿæä¾›äº†ä¸€äº›å¸¸ç”¨çš„åä¹‰å…ƒå­—ç¬¦ã€‚ å…ƒå­—ç¬¦è§£é‡Š: WåŒ¹é…ä»»æ„ä¸æ˜¯å­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿ï¼Œæ±‰å­—çš„å­—ç¬¦ SåŒ¹é…ä»»æ„ä¸æ˜¯ç©ºç™½ç¬¦çš„å­—ç¬¦ DåŒ¹é…ä»»æ„éæ•°å­—çš„å­—ç¬¦ BåŒ¹é…ä¸æ˜¯å•è¯å¼€å¤´æˆ–ç»“æŸçš„ä½ç½® [x]åŒ¹é…é™¤äº†xä»¥å¤–çš„ä»»æ„å­—ç¬¦ [aeiou]åŒ¹é…é™¤äº†aeiouè¿™å‡ ä¸ªå­—æ¯ä»¥å¤–çš„ä»»æ„å­—ç¬¦ æ­£åˆ™è¿›é˜¶çŸ¥è¯†å°±è®²åˆ°è¿™é‡Œï¼Œæ­£åˆ™æ˜¯ä¸€é—¨åšå¤§ç²¾æ·±çš„è¯­è¨€ï¼Œå…¶å®å­¦ä¼šå®ƒçš„ä¸€äº›è¯­æ³•å’ŒçŸ¥è¯†ç‚¹è¿˜ç®—ä¸å¤ªéš¾ï¼Œä½†æƒ³è¦åšåˆ°çœŸæ­£å­¦ä»¥è‡´ç”¨èƒ½å†™å‡ºéå¸¸6çš„æ­£åˆ™ï¼Œè¿˜æœ‰å¾ˆè¿œçš„è·ç¦»ï¼Œåªæœ‰çœŸæ­£å¯¹å®ƒæ„Ÿå…´è¶£çš„ï¼Œå¹¶ä¸”ç»å¸¸ç ”ç©¶å’Œä½¿ç”¨å®ƒï¼Œæ‰ä¼šæ¸æ¸çš„ç†è§£å®ƒçš„åšå¤§ç²¾æ·±ä¹‹å¤„ï¼Œæˆ‘å°±å¸¦ä½ ä»¬èµ°åˆ°è¿™ï¼Œå‰©ä¸‹çš„ï¼Œé è‡ªå·±å•¦ã€‚ å‚è€ƒèµ„æ–™","link":"/2019/04/28/Javaç‰ˆå¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼è¯´æ˜.html"},{"title":"Elasticsearchå¸¸ç”¨å·¥å…·api","text":"æ‘˜è¦Elasticsearch æ˜¯ä¸€ä¸ªé«˜åº¦å¯æ‰©å±•ä¸”å¼€æºçš„å…¨æ–‡æ£€ç´¢å’Œåˆ†æå¼•æ“ã€‚å®ƒå¯ä»¥è®©æ‚¨å¿«é€Ÿä¸”è¿‘å®æ—¶åœ°å­˜å‚¨ï¼Œæ£€ç´¢ä»¥åŠåˆ†ææµ·é‡æ•°æ®ã€‚å®ƒé€šå¸¸ç”¨ä½œé‚£äº›å…·æœ‰å¤æ‚æœç´¢åŠŸèƒ½å’Œéœ€æ±‚çš„åº”ç”¨çš„åº•å±‚å¼•æ“æˆ–è€…æŠ€æœ¯ã€‚ ä¸‹é¢æ˜¯ Elasticsearch ä¸€äº›ç®€å•çš„ä½¿ç”¨æ¡ˆä¾‹ : æ‚¨è¿è¡Œä¸€ä¸ªå¯ä»¥è®©æ‚¨é¡¾å®¢æ¥æœç´¢æ‚¨æ‰€å”®äº§å“çš„åœ¨çº¿çš„ç½‘ç»œå•†åº—ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Elasticsearch æ¥å­˜å‚¨æ‚¨çš„æ•´ä¸ªäº§å“çš„ç›®å½•å’Œåº“å­˜ï¼Œå¹¶ä¸”ä¸ºä»–ä»¬æä¾›æœç´¢å’Œè‡ªåŠ¨å®Œæˆçš„å»ºè®®ã€‚ æ‚¨æƒ³è¦å»æ”¶é›†æ—¥å¿—æˆ–äº¤æ˜“æ•°æ®ï¼Œå¹¶ä¸”æ‚¨è¿˜æƒ³è¦å»åˆ†æå’ŒæŒ–æ˜è¿™äº›æ•°æ®ä»¥æ¥æ‰¾å‡ºè¶‹åŠ¿ï¼Œç»Ÿè®¡ï¼Œæ¦‚è¿°ï¼Œæˆ–è€…å¼‚å¸¸ç°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Logstashï¼ˆElasticsearch/Logstash/Kibana æŠ€æœ¯æ ˆä¸­çš„ä¸€éƒ¨åˆ†ï¼‰æ¥æ”¶é›†ï¼Œèšåˆï¼Œä»¥åŠè§£ææ•°æ®ï¼Œç„¶åè®© Logstash å‘é€è¿™äº›æ•°æ®åˆ° Elasticsearchã€‚å¦‚æœè¿™äº›æ•°æ®å­˜åœ¨äº Elasticsearch ä¸­ï¼Œé‚£ä¹ˆæ‚¨å°±å¯ä»¥æ‰§è¡Œæœç´¢å’Œèšåˆä»¥æŒ–æ˜å‡ºä»»ä½•æ‚¨æ„Ÿå…´è¶£çš„ä¿¡æ¯ã€‚ æ‚¨è¿è¡Œä¸€ä¸ªä»·æ ¼è­¦å‘Šå¹³å°ï¼Œå®ƒå…è®¸å®¢æˆ·æŒ‡å®šç²¾ç¡®çš„ä»·æ ¼ï¼Œå¦‚â€œæˆ‘æ„Ÿå…´è¶£çš„æ˜¯è´­ä¹°æŒ‡å®šçš„ç”µå­äº§å“ï¼Œå¦‚æœä»»ä½•ä¾›åº”å•†è¯¥äº§å“çš„ä»·æ ¼åœ¨æœªæ¥ä¸€ä¸ªæœˆå†…ä½äº $X è¿™ä¸ªä»·é’±çš„è¯æˆ‘åº”è¯¥è¢«é€šçŸ¥åˆ°â€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥æ”¶é›†ä¾›åº”å•†çš„ä»·æ ¼ï¼Œæ¨é€å®ƒä»¬åˆ° Elasticsearch ä¸­å»ï¼Œç„¶åä½¿ç”¨ reverse-searchï¼ˆPercolatorï¼‰ï¼ˆåå‘æœç´¢ï¼ˆè¿‡æ»¤å™¨ï¼‰ï¼‰åŠŸèƒ½ä»¥åŒ¹é…å®¢æˆ·æŸ¥è¯¢ä»·æ ¼çš„å˜åŠ¨ï¼Œæœ€åå¦‚æœå‘ç°åŒ¹é…æˆåŠŸå°±ç»™å®¢æˆ·å‘å‡ºé€šçŸ¥ã€‚ æ‚¨å¿…é¡»åˆ†æ/å•†ä¸šæ™ºèƒ½çš„éœ€æ±‚ï¼Œå¹¶å¸Œæœ›å¿«é€Ÿçš„ç ”ç©¶ï¼Œåˆ†æï¼Œå¯è§†åŒ–ï¼Œå¹¶ä¸”éœ€è¦ ad-hocï¼ˆå³å¸­æŸ¥è¯¢ï¼‰æµ·é‡æ•°æ®ï¼ˆåƒæ•°ç™¾ä¸‡æˆ–è€…æ•°åäº¿æ¡è®°å½•ï¼‰ä¸Šçš„è´¨ç–‘ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Elasticsearch æ¥å­˜å‚¨æ•°æ®ï¼Œç„¶åä½¿ç”¨ Kibanaï¼ˆElasticsearch/Logstash/Kibana æŠ€æœ¯æ ˆä¸­çš„ä¸€éƒ¨åˆ†ï¼‰ä»¥å»ºç«‹ä¸€ä¸ªèƒ½å¤Ÿå¯è§†åŒ–çš„å¯¹æ‚¨å¾ˆé‡è¦çš„æ•°æ®æ–¹é¢çš„å®šåˆ¶çš„ dashboardsï¼ˆé¢æ¿ï¼‰ã€‚æ­¤å¤–ï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨ Elasticsearch çš„èšåˆåŠŸèƒ½å¯¹æ‚¨çš„æ•°æ®æ‰§è¡Œå¤æ‚çš„å•†ä¸šæ™ºèƒ½æŸ¥è¯¢ å¯¹äºæœ¬æ•™ç¨‹çš„å…¶ä½™éƒ¨åˆ†ï¼Œæˆ‘å°†å¼•å¯¼æ‚¨å®Œæˆ Elasticsearch çš„å¯åŠ¨å’Œè¿è¡Œçš„è¿‡ç¨‹ï¼ŒåŒæ—¶äº†è§£å…¶åŸç†ï¼Œå¹¶æ‰§è¡Œåƒ indexingï¼ˆç´¢å¼•ï¼‰ï¼Œsearchingï¼ˆæŸ¥è¯¢ï¼‰å’Œ modifingï¼ˆä¿®æ”¹ï¼‰æ•°æ®çš„åŸºç¡€æ“ä½œã€‚åœ¨æœ¬æ•™ç¨‹çš„æœ€åä¸€éƒ¨åˆ†ï¼Œæ‚¨åº”è¯¥å¯ä»¥æ¸…æ¥šçš„äº†è§£åˆ° Elasticsearch æ˜¯ä»€ä¹ˆï¼Œå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå¹¶æœ‰å¸Œæœ›è·å¾—å¯å‘ã€‚çœ‹æ‚¨å¦‚ä½•ä½¿ç”¨å®ƒæ¥æ„å»ºå¤æ‚çš„æœç´¢åº”ç”¨ç¨‹åºæˆ–è€…ä»æ•°æ®ä¸­æŒ–æ˜å‡ºæƒ³è¦çš„ä¿¡æ¯ã€‚ å¸¸ç”¨å®ä¾‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238# å¸¸ç”¨kibanaè„šæœ¬(å¯ä»¥è‡ªåŠ¨å¡«å……ï¼Œæ¯”è¾ƒå¥½ç”¨)PUT /test_business/data/1 #æ›´æ”¹æ•°æ®{ \"name\":\"zhe\"}}POST _analyze #å®æ—¶åˆ†è¯{ \"text\": \"å¼ æœˆè¶…\", \"analyzer\": \"ik_max_word\"}DELETE /analyze_index #åˆ é™¤ç´¢å¼•GET analyze_index/_settings #æŸ¥çœ‹ç´¢å¼•_settingsGET analyze_index/_mapping #æŸ¥çœ‹ç´¢å¼•_mappingPOST /analyze_index/data/_mapping #è®¾ç½®mapping{ \"dynamic\": \"false\", \"properties\": { \"name\": { \"type\": \"text\", \"analyzer\": \"ik\" } }}POST /analyze_index #è®¾ç½®settings{ \"settings\": { \"index\": { \"analysis\": { \"normalizer\": { \"case_insensitive_normalizer\": { \"type\": \"custom\", \"filter\": \"lowercase\" } }, \"filter\": { \"my_synonym\": { \"type\": \"synonym\", \"synonyms_path\": \"analysis-ik/extra/synonyms.dic\" } }, \"analyzer\": { \"ik\": { \"filter\": [ \"my_synonym\" ], \"char_filter\": [ \"my_char_mapper\" ], \"type\": \"custom\", \"tokenizer\": \"ik_max_word\" } }, \"char_filter\": { \"my_char_mapper\": { \"type\": \"mapping\", \"mappings_path\": \"analysis-ik/extra/pre_filter_mapping.dic\" } } } } }, \"mapping\": { \"data\": { \"properties\": { \"name\": { \"type\": \"text\", \"analyzer\": \"ik\" } } } }}GET /es_test_analyzer/_settingsGET /es_test_analyzer/_mappingGET /analyze_index/data/1POST /es_test_analyzer/_analyze{ \"text\": \"è¶…è¶Š\", \"analyzer\": \"ik_max_word\"}POST /es_test_analyzer/data/1{ \"name\": \"å¼ æœˆè¶…666å“ˆå“ˆå¼ æœˆè¶…\", \"nick_name\":\"å¼ æœˆè¶…666å“ˆå“ˆå¼ æœˆè¶…\"}POST /es_test_analyzer/data/2{ \"name\": \"ç‹æœˆ\", \"nick_name\":\"ç‹æœˆ\"}POST /es_test_analyzer/data/3{ \"name\": \"è¶…è¶Š\", \"nick_name\":\"è¶…è¶Š\"}GET /es_test_analyzer/data/1GET /es_test_analyzer/data/3/_termvectors?fields=nick_name # æŸ¥çœ‹ç´¢å¼•ä¸­åˆ†è¯æƒ…å†µGET /es_test_analyzer/data/_search{ \"query\": { \"multi_match\": { \"query\": \"è¶…è¶Š\", \"fields\": [ \"nick_name\" ], \"analyzer\": \"ik\", \"operator\": \"or\", \"type\": \"best_fields\" } }, \"highlight\": { \"fields\": { \"name\": { } } }}DELETE /es_test_analyzer/GET /analyze_index/data/_mappingGET /test/data/_search{ \"query\": { \"bool\": { \"should\": [ { \"multi_match\": { \"query\": \"é¤é¥®\", \"fields\": [\"title^2\",\"tags\"] } },{ \"wildcard\": { \"name\": { \"value\": \"*ä¸­å›½*\" } } } ] } }}GET /user/data/9969/_explain # æŸ¥çœ‹è¯¦ç»†idï¼š9969 å¾—åˆ†æƒ…å†µ{ \"query\": { \"bool\": { \"must\": [ { \"multi_match\": { \"query\": \"tacos n frankies\", \"fields\": [ \"name^1.0\", \"info^1.0\" ], \"type\": \"best_fields\", \"operator\": \"or\", \"analyzer\": \"ik_max_word\", \"slop\": 0, \"prefix_length\": 0, \"max_expansions\": 50, \"zero_terms_query\": \"NONE\", \"auto_generate_synonyms_phrase_query\": true, \"fuzzy_transpositions\": true, \"boost\": 1 } } \"adjust_pure_negative\": true, \"boost\": 1 } } , \"highlight\": { \"fields\": { \"name\": {}, \"info\": {} } }}GET /user/data/_search{ \"query\": { \"bool\": { \"must\": [ { \"multi_match\": { \"query\": \"tacos n frankies\", \"fields\": [ \"name^1.0\", \"info^1.0\" ], \"type\": \"best_fields\", \"operator\": \"or\", \"analyzer\": \"ik_max_word\", \"slop\": 0, \"prefix_length\": 0, \"max_expansions\": 50, \"zero_terms_query\": \"NONE\", \"auto_generate_synonyms_phrase_query\": true, \"fuzzy_transpositions\": true, \"boost\": 1 } } \"adjust_pure_negative\": true, \"boost\": 1 } } , \"highlight\": { \"fields\": { \"name\": {}, \"info\": {} } }} æŸ¥çœ‹å¥åº·ä¿¡æ¯ curl -XGET â€˜localhost:9200/_cat/health?v&amp;prettyâ€™ æˆ‘ä»¬å¯ä»¥è·å¾— greenï¼Œyellowï¼Œæˆ–è€… red çš„ statusã€‚Green è¡¨ç¤ºä¸€åˆ‡æ­£å¸¸ï¼ˆé›†ç¾¤åŠŸèƒ½é½å…¨ï¼‰ï¼Œ yellow è¡¨ç¤ºæ‰€æœ‰æ•°æ®å¯ç”¨ï¼Œä½†æ˜¯æœ‰äº›å‰¯æœ¬å°šæœªåˆ†é…ï¼ˆé›†ç¾¤åŠŸèƒ½é½å…¨ï¼‰ï¼Œred æ„å‘³ç€ç”±äºæŸäº›åŸå› æœ‰äº›æ•°æ®ä¸å¯ç”¨ã€‚æ³¨æ„ï¼Œé›†ç¾¤æ˜¯ redï¼Œå®ƒä»ç„¶å…·æœ‰éƒ¨åˆ†åŠŸèƒ½ï¼ˆä¾‹å¦‚ï¼Œå®ƒå°†ç»§ç»­ä»å¯ç”¨çš„åˆ†ç‰‡ä¸­æœåŠ¡æœç´¢è¯·æ±‚ï¼‰ï¼Œä½†æ˜¯æ‚¨å¯èƒ½éœ€è¦å°½å¿«å»ä¿®å¤å®ƒï¼Œå› ä¸ºæ‚¨å·²ç»ä¸¢å¤±æ•°æ®äº†ã€‚ æŸ¥çœ‹æ‰€æœ‰çš„ç´¢å¼• curl -XGET â€˜localhost:9200/_cat/indices?v&amp;prettyâ€™ Document APISindex api ç´¢å¼• API åœ¨ç‰¹å®šç´¢å¼•ä¸­ add ( æ·»åŠ  ) æˆ– update *( æ›´æ–° ) *a typed JSON document ( ç±»å‹åŒ–çš„ JSON æ–‡æ¡£ )ï¼Œä½¿å…¶å¯æœç´¢ã€‚ä»¥ä¸‹ç¤ºä¾‹å°† JSON æ–‡æ¡£æ’å…¥åˆ° â€œtwitterâ€ ç´¢å¼•ä¸­ï¼ŒID ä¸º1 ï¼š 123456789101112131415161718192021curl -XPUT 'localhost:9200/twitter/tweet/1?pretty' -H 'Content-Type: application/json' -d'{ \"user\" : \"kimchy\", \"post_date\" : \"2009-11-15T14:12:12\", \"message\" : \"trying out Elasticsearch\"}'ç»“æœï¼š{ \"_shards\" : { \"total\" : 2, \"failed\" : 0, \"successful\" : 2 }, \"_index\" : \"twitter\", \"_type\" : \"tweet\", \"_id\" : \"1\", \"_version\" : 1, \"created\" : true, \"result\" : created} total - æŒ‡ç¤ºåº”å¯¹å¤šå°‘ shard copies ( åˆ†ç‰‡å‰¯æœ¬ )ï¼ˆ \\primary ( ä¸» )åˆ†ç‰‡å’Œ replica ( å‰¯æœ¬ ) åˆ†ç‰‡ï¼‰æ‰§è¡Œç´¢å¼•æ“ä½œã€‚ successful - è¡¨ç¤ºç´¢å¼•æ“ä½œæˆåŠŸçš„åˆ†ç‰‡å‰¯æœ¬çš„æ•°é‡ã€‚ failed - åœ¨ç´¢å¼•æ“ä½œåœ¨å‰¯æœ¬ç¢ç‰‡ä¸Šå¤±è´¥çš„æƒ…å†µä¸‹åŒ…å«ä¸å¤åˆ¶ç›¸å…³çš„é”™è¯¯çš„æ•°ç»„ã€‚ å½“ç´¢å¼•æ“ä½œ successful è¿”å›æ—¶ï¼Œå¯èƒ½ä¸ä¼šå…¨éƒ¨å¯åŠ¨å‰¯æœ¬ç¢ç‰‡ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œåªéœ€è¦ä¸»ç´¢å¼•ï¼Œä½†å¯ä»¥æ›´æ”¹æ­¤è¡Œä¸ºï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ total å°†ç­‰äºåŸºäº number_of_replicas è®¾ç½®çš„æ€»åˆ†ç‰‡ï¼Œå¹¶ä¸” successful å°†ç­‰äºå·²å¯åŠ¨çš„åˆ†ç‰‡æ•°ï¼ˆä¸»å‰¯æœ¬å’Œå‰¯æœ¬ï¼‰ã€‚å¦‚æœæ²¡æœ‰å¤±è´¥ï¼Œ failed å°†æ˜¯ 0 ã€‚ get apiget api å…è®¸ä»ä¸€ä¸ªåŸºäºå…¶idçš„ index ä¸­è·å–ä¸€ä¸ª JSONæ ¼å¼çš„ documentï¼Œä¸‹é¢çš„ç¤ºä¾‹æ˜¯ä»ä¸€ä¸ªåœ¨åç§°ä¸ºtweetçš„ type \\ä¸‹çš„idä¸º1ï¼Œåç§°ä¸ºtwitterçš„ \\index \\ä¸­è·å–ä¸€ä¸ªJSONæ ¼å¼çš„ \\documentã€‚ 1curl -XGET 'http://localhost:9200/twitter/tweet/1' update api12345678910111213141516171819202122232425262728293031323334353637383940# æ›´æ–°api PUT test/type1/1{ \"counter\" : 1, \"tags\" : [\"red\"]}# è„šæœ¬æ›´æ–°POST test/type1/1/_update{ \"script\" : { \"inline\": \"ctx._source.counter += params.count\", \"lang\": \"painless\", \"params\" : { \"count\" : 4 } }}# å°†æ–°å­—æ®µæ·»åŠ åˆ°æ–‡æ¡£ï¼šPOST test/type1/1/_update{ \"script\" : \"ctx._source.new_field = \\\"value_of_new_field\\\"\"}# åˆ é™¤å­—æ®µPOST test/type1/1/_update{ \"script\" : \"ctx._source.remove(\\\"new_field\\\")\"}# ç”šè‡³å¯ä»¥æ”¹å˜å·²æ‰§è¡Œçš„æ“ä½œã€‚è¿™ä¸ªä¾‹å­å°±æ˜¯åˆ é™¤æ–‡æ¡£ï¼Œå¦‚æœ tagsåŒ…å« greenï¼Œå¦åˆ™å°±ä»€ä¹ˆä¹Ÿä¸åšï¼ˆnoopï¼‰ï¼šPOST test/type1/1/_update{ \"script\" : { \"inline\": \"if (ctx._source.tags.contains(params.tag)) { ctx.op = \\\"delete\\\" } else { ctx.op = \\\"none\\\" }\", \"lang\": \"painless\", \"params\" : { \"tag\" : \"green\" } }} é€šè¿‡æŸ¥è¯¢apiæ›´æ–°123456789101112POST twitter/_update_by_query{ \"script\": { \"inline\": \"ctx._source.likes++\", \"lang\": \"painless\" }, \"query\": { \"term\": { \"user\": \"kimchy\" } }} bulk apiBulk APIï¼Œèƒ½å¤Ÿåœ¨ä¸€ä¸ªå•ä¸€çš„APIè°ƒç”¨æ‰§è¡Œå¤šé¡¹ç´¢å¼•/åˆ é™¤æ“ä½œã€‚è¿™å¯ä»¥å¤§å¤§æé«˜ç´¢å¼•é€Ÿåº¦ã€‚ è¯¥ REST API ç«¯ç‚¹/_bulkï¼Œå®ƒéµå¾ªJSONç»“æ„ï¼š 1234567action_and_meta_data\\noptional_source\\naction_and_meta_data\\noptional_source\\n....action_and_meta_data\\noptional_source\\n æ³¨æ„ï¼šæ•°æ®çš„æœ€ç»ˆè¡Œå¿…é¡»ä»¥æ¢è¡Œç¬¦ç»“æŸ\\nã€‚ å¯èƒ½çš„æ“ä½œæœ‰ indexï¼Œcreateï¼Œdeleteå’Œ updateï¼Œ index å’Œ `createæœŸæœ›åœ¨ä¸‹ä¸€è¡Œçš„ä½œä¸ºæºï¼Œå¹¶ä¸ç´¢å¼• API æœ‰ç›¸åŒçš„è¯­ä¹‰ã€‚ï¼ˆå¦‚æœæ–‡ä»¶å…·æœ‰ç›¸åŒçš„ç´¢å¼•å’Œç±»å‹çš„æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œå°±ä¼šåˆ›å»ºå¤±è´¥ï¼Œå¿…è¦æ—¶å€™è€Œç´¢å¼•å›æ·»åŠ æˆ–æ›¿æ¢æ–‡ä»¶ï¼‰ã€‚deleteä¸ä¼šä½œä¸ºä¸‹ä¸€è¡Œçš„æºï¼Œå¹¶ä¸ delete API ä¸­å…·æœ‰ç›¸åŒçš„è¯­ä¹‰ã€‚update æ˜¯å¸Œæœ›`éƒ¨åˆ†æ–‡æ¡£ï¼Œupsert å’Œè„šæœ¬åŠå…¶é€‰é¡¹èƒ½å¤Ÿåœ¨ä¸‹ä¸€è¡ŒæŒ‡å®šã€‚ delete apidelete APIå…è®¸åŸºäºæŒ‡å®šçš„IDæ¥ä»ç´¢å¼•åº“ä¸­åˆ é™¤ä¸€ä¸ªJSONæ–‡ä»¶ã€‚ä¸‹é¢æ¼”ç¤ºäº†ä»ä¸€ä¸ªå«twitterçš„ç´¢å¼•åº“çš„tweettypeä¸‹åˆ é™¤æ–‡æ¡£ï¼Œidæ˜¯1: 1$ curl -XDELETE 'http://localhost:9200/twitter/tweet/1' ç´¢å¼•çš„æ¯ä¸ªæ–‡æ¡£éƒ½è¢«æ ‡è®°äº†ç‰ˆæœ¬ã€‚å½“åˆ é™¤æ–‡æ¡£æ—¶ï¼Œ å¯ä»¥é€šè¿‡æŒ‡å®šversionæ¥ç¡®ä¿æˆ‘ä»¬è¯•å›¾åˆ é™¤ä¸€ä¸ªå®é™…ä¸Šå·²è¢«åˆ é™¤çš„æ–‡æ¡£æ—¶ï¼Œå®ƒåœ¨æ­¤æœŸé—´å¹¶æ²¡æœ‰æ”¹å˜ã€‚åœ¨æ–‡æ¡£ä¸­æ‰§è¡Œçš„æ¯ä¸ªå†™å…¥æ“ä½œï¼ŒåŒ…æ‹¬åˆ é™¤ï¼Œéƒ½ä¼šä½¿å…¶ç‰ˆæœ¬é€’å¢ã€‚ delete by query apiæœ€ç®€å•çš„ç”¨æ³•æ˜¯ä½¿ç”¨_delete_by_queryå¯¹æ¯ä¸ªæŸ¥è¯¢åŒ¹é…çš„æ–‡æ¡£æ‰§è¡Œåˆ é™¤ã€‚è¿™æ˜¯API: 12345678POST twitter/_delete_by_query{ \"query\": { //â‘  \"match\": { \"message\": \"some message\" } }} term vectorsè¿”å›æœ‰å…³ç‰¹å®šæ–‡æ¡£å­—æ®µä¸­çš„è¯æ¡çš„ä¿¡æ¯å’Œç»Ÿè®¡ä¿¡æ¯ã€‚æ–‡æ¡£å¯ä»¥å­˜å‚¨åœ¨ç´¢å¼•ä¸­æˆ–ç”±ç”¨æˆ·äººå·¥æä¾›ã€‚è¯æ¡å‘é‡é»˜è®¤ä¸ºå®æ—¶ï¼Œä¸æ˜¯è¿‘å®æ—¶ã€‚è¿™å¯ä»¥é€šè¿‡å°†realtimeå‚æ•°è®¾ç½®ä¸ºfalseæ¥æ›´æ”¹ã€‚ 1GET /twitter/tweet/1/_termvectors å¯é€‰çš„ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨urlä¸­çš„å‚æ•°æŒ‡å®šæ£€ç´¢ä¿¡æ¯çš„å­—æ®µï¼š 1GET /twitter/tweet/1/_termvectors?fields=message searchquery apiç»“æœçš„åˆ†é¡µå¯ä»¥é€šè¿‡ä½¿ç”¨ from å’Œ size å‚æ•°æ¥å®Œæˆã€‚ from å‚æ•°å®šä¹‰äº†æ‚¨è¦æå–çš„ç¬¬ä¸€ä¸ªç»“æœçš„åç§»é‡ã€‚ size å‚æ•°å…è®¸æ‚¨é…ç½®è¦è¿”å›çš„æœ€å¤§åŒ¹é…æ•°ã€‚ è™½ç„¶ from å’Œ size å¯ä»¥è®¾ç½®ä¸ºè¯·æ±‚å‚æ•°ï¼Œä½†å®ƒä»¬ä¹Ÿå¯ä»¥åœ¨æœç´¢æ­£æ–‡ä¸­è®¾ç½®ã€‚from é»˜è®¤å€¼ä¸º 0ï¼Œsize é»˜è®¤ä¸º 10ã€‚ 1234567GET /_search{ &quot;from&quot; : 0, &quot;size&quot; : 10, &quot;query&quot; : { &quot;term&quot; : { &quot;user&quot; : &quot;kimchy&quot; } }} æ³¨æ„ from + size ä¸èƒ½è¶…è¿‡ index.max_result_window ç´¢å¼•è®¾ç½®ï¼Œé»˜è®¤ä¸º 10,000ã€‚ æœ‰å…³æ·±å…¥æ»šåŠ¨çš„æ›´æœ‰æ•ˆæ–¹æ³•ï¼Œè¯·å‚é˜… Scroll æˆ– Search After APIã€‚ sortæ’åºé€‰é¡¹å¯ä»¥æœ‰ä»¥ä¸‹å€¼ï¼š | asc | æŒ‰å‡åºæ’åº | | desc | æŒ‰å€’åºæ’åº | åœ¨å¯¹ _score è¿›è¡Œæ’åºæ—¶ï¼Œè¯¥é¡ºåºé»˜è®¤ä¸º descï¼Œåœ¨å¯¹å…¶ä»–äº‹ç‰©è¿›è¡Œæ’åºæ—¶é»˜è®¤ä¸º ascã€‚ Sort mode Option Elasticsearchæ”¯æŒæŒ‰æ•°ç»„æˆ–å¤šå€¼å­—æ®µæ’åºã€‚ mode é€‰é¡¹æ§åˆ¶é€‰æ‹©ç”¨äºå¯¹å…¶æ‰€å±æ–‡æ¡£è¿›è¡Œæ’åºçš„æ•°ç»„å€¼ã€‚ mode é€‰é¡¹å¯ä»¥å…·æœ‰ä»¥ä¸‹å€¼ï¼š | min | é€‰æ‹©æœ€ä½å€¼ã€‚ | | max | é€‰æ‹©æœ€é«˜å€¼ã€‚ | | sum | ä½¿ç”¨æ‰€æœ‰å€¼çš„å’Œä½œä¸ºæ’åºå€¼ã€‚ ä»…é€‚ç”¨äºåŸºäºæ•°å­—çš„æ•°ç»„å­—æ®µã€‚ | | avg | ä½¿ç”¨æ‰€æœ‰å€¼çš„å¹³å‡å€¼ä½œä¸ºæ’åºå€¼ã€‚ ä»…é€‚ç”¨äºåŸºäºæ•°å­—çš„æ•°ç»„å­—æ®µã€‚ | | median | ä½¿ç”¨æ‰€æœ‰å€¼çš„ä¸­å€¼ä½œä¸ºæ’åºå€¼ã€‚ ä»…é€‚ç”¨äºåŸºäºæ•°å­—çš„æ•°ç»„å­—æ®µã€‚ | Elasticsearch è¿˜æ”¯æŒæ ¹æ®ä¸€ä¸ªæˆ–å¤šä¸ªåµŒå¥—å¯¹è±¡å†…çš„å­—æ®µè¿›è¡Œæ’åºã€‚ é€šè¿‡åµŒå¥—å­—æ®µæ”¯æŒè¿›è¡Œçš„æ’åºåœ¨å·²ç»å­˜åœ¨çš„æ’åºé€‰é¡¹ä¹‹ä¸Šå…·æœ‰ä»¥ä¸‹å‚æ•°ï¼š nested_path å®šä¹‰è¦æ’åºçš„åµŒå¥—å¯¹è±¡ã€‚ å®é™…æ’åºå­—æ®µå¿…é¡»æ˜¯æ­¤åµŒå¥—å¯¹è±¡å†…çš„ç›´æ¥å­—æ®µã€‚ å½“é€šè¿‡åµŒå¥—å­—æ®µæ’åºæ—¶ï¼Œæ­¤å­—æ®µæ˜¯å¿…éœ€çš„ã€‚ nested_filter åµŒå¥—è·¯å¾„ä¸­çš„å†…éƒ¨å¯¹è±¡åº”ä¸å…¶åŒ¹é…çš„è¿‡æ»¤å™¨ï¼Œä»¥ä¾¿é€šè¿‡æ’åºè€ƒè™‘å…¶å­—æ®µå€¼ã€‚ å¸¸è§çš„æƒ…å†µæ˜¯åœ¨åµŒå¥—çš„è¿‡æ»¤å™¨æˆ–æŸ¥è¯¢ä¸­é‡å¤æŸ¥è¯¢/è¿‡æ»¤ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ²¡æœ‰ nested_filter æ˜¯æ¿€æ´»çš„ã€‚ Nested sorting example åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œofferæ˜¯ä¸€ä¸ªç±»å‹ä¸ºåµŒå¥—çš„å­—æ®µã€‚ éœ€è¦æŒ‡å®šnested_path; å¦åˆ™ï¼Œelasticsearchä¸çŸ¥é“éœ€è¦æ•è·å“ªä¸ªåµŒå¥—çº§æ’åºå€¼ã€‚ 123456789101112131415161718POST /_search{ \"query\" : { \"term\" : { \"product\" : \"chocolate\" } }, \"sort\" : [ { \"offer.price\" : { \"mode\" : \"avg\", \"order\" : \"asc\", \"nested_path\" : \"offer\", \"nested_filter\" : { \"term\" : { \"offer.color\" : \"blue\" } } } } ]} å½“é€šè¿‡è„šæœ¬æ’åºå’ŒæŒ‰åœ°ç†è·ç¦»æ’åºæ—¶ï¼Œä¹Ÿæ”¯æŒåµŒå¥—æ’åºã€‚ Missing Values ç¼ºå°‘çš„å‚æ•°æŒ‡å®šåº”å¦‚ä½•å¤„ç†ç¼ºå°‘å­—æ®µçš„æ–‡æ¡£ï¼šç¼ºå°‘çš„å€¼å¯ä»¥è®¾ç½®ä¸º lastï¼Œfirst æˆ–è‡ªå®šä¹‰å€¼ï¼ˆå°†ç”¨äºç¼ºå°‘æ–‡æ¡£ä½œä¸ºæ’åºå€¼ï¼‰ã€‚ 123456789GET /_search{ &quot;sort&quot; : [ { &quot;price&quot; : {&quot;missing&quot; : &quot;_last&quot;} } ], &quot;query&quot; : { &quot;term&quot; : { &quot;product&quot; : &quot;chocolate&quot; } }} Noteï¼šå¦‚æœåµŒå¥—çš„å†…éƒ¨å¯¹è±¡ä¸ nested_filter ä¸åŒ¹é…ï¼Œåˆ™ä½¿ç”¨ç¼ºå°‘çš„å€¼ã€‚ Geo Distance Sorting å…è®¸æŒ‰ geodistance æ’åºã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾ pin.location æ˜¯ä¸€ä¸ªç±»å‹ä¸º geo_point çš„å­—æ®µï¼š 1234567891011121314151617GET /_search{ &quot;sort&quot; : [ { &quot;_geo_distance&quot; : { &quot;pin.location&quot; : [-70, 40], &quot;order&quot; : &quot;asc&quot;, &quot;unit&quot; : &quot;km&quot;, &quot;mode&quot; : &quot;min&quot;, &quot;distance_type&quot; : &quot;sloppy_arc&quot; } } ], &quot;query&quot; : { &quot;term&quot; : { &quot;user&quot; : &quot;kimchy&quot; } }} distance_type å¦‚ä½•è®¡ç®—è·ç¦»ã€‚ å¯ä»¥æ˜¯ sloppy_arcï¼ˆé»˜è®¤ï¼‰ï¼Œå¼§ï¼ˆç¨å¾®æ›´ç²¾ç¡®ä½†æ˜¾ç€æ›´æ…¢ï¼‰æˆ–å¹³é¢ï¼ˆæ›´å¿«ï¼Œä½†ä¸å‡†ç¡®åœ¨é•¿è·ç¦»å’Œæ¥è¿‘æç‚¹ï¼‰ã€‚ mode å¦‚æœå­—æ®µæœ‰å¤šä¸ªåœ°ç†ç‚¹ï¼Œè¯¥æ€ä¹ˆåŠã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒæŒ‰å‡åºæ’åºæ—¶è€ƒè™‘æœ€çŸ­è·ç¦»ï¼ŒæŒ‰é™åºæ’åºæ—¶æœ€é•¿è·ç¦»ã€‚ æ”¯æŒçš„å€¼ä¸º minï¼Œmaxï¼Œmedian å’Œ avgã€‚ unit è®¡ç®—æ’åºå€¼æ—¶ä½¿ç”¨çš„å•ä½ã€‚ é»˜è®¤å€¼ä¸º mï¼ˆç±³ï¼‰ã€‚ geo distance sorting ä¸æ”¯æŒå¯é…ç½®çš„ç¼ºå¤±å€¼ï¼šå½“æ–‡æ¡£æ²¡æœ‰ç”¨äºè·ç¦»è®¡ç®—çš„å­—æ®µçš„å€¼æ—¶ï¼Œè·ç¦»å°†å§‹ç»ˆè¢«è§†ä¸ºç­‰äº Infinityã€‚ åœ¨æä¾›åæ ‡æ—¶æ”¯æŒä»¥ä¸‹æ ¼å¼ï¼š highlightingå…è®¸çªå‡ºæ˜¾ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µçš„æœç´¢ç»“æœã€‚ å®ç°ä½¿ç”¨ lucene æ™®é€šè§å…‰ç¬”ï¼Œå¿«é€Ÿå‘é‡è§å…‰ç¬”ï¼ˆfvhï¼‰æˆ– postings è§å…‰ç¬”ã€‚ ä»¥ä¸‹æ˜¯ä¸€ä¸ªæœç´¢è¯·æ±‚æ­£æ–‡çš„ç¤ºä¾‹ï¼š 1234567891011GET /_search{ &quot;query&quot; : { &quot;match&quot;: { &quot;user&quot;: &quot;kimchy&quot; } }, &quot;highlight&quot; : { &quot;fields&quot; : { &quot;content&quot; : {} } }} åœ¨ä¸Šè¿°æƒ…å†µä¸‹ï¼Œå†…å®¹å­—æ®µå°†ä¸ºæ¯ä¸ªæœç´¢å‘½ä¸­çªå‡ºæ˜¾ç¤ºï¼ˆæ¯ä¸ªæœç´¢å‘½ä¸­å†…å°†æœ‰å¦ä¸€ä¸ªå…ƒç´ ï¼Œç§°ä¸ºçªå‡ºæ˜¾ç¤ºï¼Œå…¶ä¸­åŒ…æ‹¬çªå‡ºæ˜¾ç¤ºçš„å­—æ®µå’Œçªå‡ºæ˜¾ç¤ºçš„ç‰‡æ®µï¼‰ã€‚ Noteï¼š ä¸ºäº†æ‰§è¡Œçªå‡ºæ˜¾ç¤ºï¼Œéœ€è¦å­—æ®µçš„å®é™…å†…å®¹ã€‚ å¦‚æœæœ‰é—®é¢˜çš„å­—æ®µè¢«å­˜å‚¨ï¼ˆåœ¨æ˜ å°„ä¸­å­˜å‚¨è®¾ç½®ä¸º trueï¼‰ï¼Œå®ƒå°†è¢«ä½¿ç”¨ï¼Œå¦åˆ™ï¼Œå®é™…çš„ _source å°†è¢«åŠ è½½ï¼Œå¹¶ä¸”ç›¸å…³å­—æ®µå°†ä»ä¸­æå–ã€‚ _all å­—æ®µä¸èƒ½ä» _source ä¸­æå–ï¼Œå› æ­¤å®ƒåªèƒ½ç”¨äºçªå‡ºæ˜¾ç¤ºï¼Œå¦‚æœå®ƒæ˜ å°„åˆ°å°† store è®¾ç½®ä¸º trueã€‚ å­—æ®µåç§°æ”¯æŒé€šé…ç¬¦ç¬¦å·ã€‚ ä¾‹å¦‚ï¼Œä½¿ç”¨ comment_ * å°†å¯¼è‡´æ‰€æœ‰ä¸è¡¨è¾¾å¼åŒ¹é…çš„æ–‡æœ¬å’Œå…³é”®å­—å­—æ®µï¼ˆä»¥åŠ 5.0 ä¹‹å‰çš„å­—ç¬¦ä¸²ï¼‰è¢«çªå‡ºæ˜¾ç¤ºã€‚ è¯·æ³¨æ„ï¼Œæ‰€æœ‰å…¶ä»–å­—æ®µå°†ä¸ä¼šçªå‡ºæ˜¾ç¤ºã€‚ å¦‚æœæ‚¨ä½¿ç”¨è‡ªå®šä¹‰æ˜ å°„å™¨å¹¶è¦åœ¨å­—æ®µä¸Šçªå‡ºæ˜¾ç¤ºï¼Œåˆ™å¿…é¡»æ˜¾å¼æä¾›å­—æ®µåç§°ã€‚ Plain highlighte(æœ‰å¤šç§ç±»å‹é€‰æ‹©ã€æ ¹æ®å®é™…æƒ…å†µä½¿ç”¨) è§å…‰ç¬”çš„é»˜è®¤é€‰æ‹©æ˜¯æ™®é€šç±»å‹ï¼Œå¹¶ä½¿ç”¨Luceneè§å…‰ç¬”ã€‚ å®ƒè¯•å›¾åœ¨ç†è§£è¯é‡è¦æ€§å’ŒçŸ­è¯­æŸ¥è¯¢ä¸­çš„ä»»ä½•è¯å®šä½æ ‡å‡†æ–¹é¢åæ˜ æŸ¥è¯¢åŒ¹é…é€»è¾‘ã€‚ warningï¼š å¦‚æœä½ æƒ³çªå‡ºå¾ˆå¤šæ–‡æ¡£ä¸­çš„å¤§é‡å­—æ®µä¸å¤æ‚çš„æŸ¥è¯¢ï¼Œè¿™ä¸ªè§å…‰ç¬”ä¸ä¼šå¿«ã€‚ åœ¨åŠªåŠ›å‡†ç¡®åœ°åæ˜ æŸ¥è¯¢é€»è¾‘ï¼Œå®ƒåˆ›å»ºä¸€ä¸ªå¾®å°çš„å†…å­˜ç´¢å¼•ï¼Œå¹¶é€šè¿‡ Lucene çš„æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ç¨‹åºé‡æ–°è¿è¡ŒåŸå§‹æŸ¥è¯¢æ¡ä»¶ï¼Œä»¥è·å–å½“å‰æ–‡æ¡£çš„ä½çº§åˆ«åŒ¹é…ä¿¡æ¯ã€‚ è¿™å¯¹äºæ¯ä¸ªå­—æ®µå’Œéœ€è¦çªå‡ºæ˜¾ç¤ºçš„æ¯ä¸ªæ–‡æ¡£é‡å¤ã€‚ å¦‚æœè¿™åœ¨æ‚¨çš„ç³»ç»Ÿä¸­å‡ºç°æ€§èƒ½é—®é¢˜ï¼Œè¯·è€ƒè™‘ä½¿ç”¨æ›¿ä»£è§å…‰ç¬”ã€‚ search typeQuery Then Fetch å‚æ•°å€¼ï¼š query_then_fetchã€‚ è¯·æ±‚åˆ†ä¸¤ä¸ªé˜¶æ®µå¤„ç†ã€‚ åœ¨ç¬¬ä¸€é˜¶æ®µï¼ŒæŸ¥è¯¢è¢«è½¬å‘åˆ°æ‰€æœ‰æ¶‰åŠçš„åˆ†ç‰‡ã€‚ æ¯ä¸ªåˆ†ç‰‡æ‰§è¡Œæœç´¢å¹¶ç”Ÿæˆå¯¹è¯¥åˆ†ç‰‡æœ¬åœ°çš„ç»“æœçš„æ’åºåˆ—è¡¨ã€‚ æ¯ä¸ªåˆ†ç‰‡åªå‘åè°ƒèŠ‚ç‚¹è¿”å›è¶³å¤Ÿçš„ä¿¡æ¯ï¼Œä»¥å…è®¸å…¶åˆå¹¶å¹¶å°†åˆ†ç‰‡çº§ç»“æœé‡æ–°æ’åºä¸ºå…¨å±€æ’åºçš„æœ€å¤§é•¿åº¦å¤§å°çš„ç»“æœé›†ã€‚ åœ¨ç¬¬äºŒé˜¶æ®µæœŸé—´ï¼Œåè°ƒèŠ‚ç‚¹ä»…ä»ç›¸å…³åˆ†ç‰‡è¯·æ±‚æ–‡æ¡£å†…å®¹ï¼ˆä»¥åŠé«˜äº®æ˜¾ç¤ºçš„ç‰‡æ®µï¼Œå¦‚æœæœ‰çš„è¯ï¼‰ã€‚ Noteï¼š å¦‚æœæ‚¨æœªåœ¨è¯·æ±‚ä¸­æŒ‡å®š search_typeï¼Œé‚£ä¹ˆè¿™æ˜¯é»˜è®¤è®¾ç½®ã€‚ Dfs, Query Then Fetch å‚æ•°å€¼ï¼šdfs_query_then_fetch ä¸ â€œQuery Then Fetchâ€ ç›¸åŒï¼Œé™¤äº†åˆå§‹åˆ†æ•£é˜¶æ®µï¼Œå…¶è®¡ç®—åˆ†å¸ƒé¡¹é¢‘ç‡ç”¨äºæ›´å‡†ç¡®çš„è®¡åˆ†ã€‚ scroll æ¸¸æ ‡(å¤šæ•°æ®æ·±åº¦åˆ†é¡µé—®é¢˜è§£å†³)ä»æ»šåŠ¨è¯·æ±‚è¿”å›çš„ç»“æœåæ˜ äº†è¿›è¡Œåˆå§‹æœç´¢è¯·æ±‚æ—¶ç´¢å¼•çš„çŠ¶æ€ï¼Œå¦‚æ—¶é—´å¿«ç…§ã€‚ å¯¹æ–‡æ¡£ï¼ˆç´¢å¼•ï¼Œæ›´æ–°æˆ–åˆ é™¤ï¼‰çš„åç»­æ›´æ”¹åªä¼šå½±å“ä»¥åçš„æœç´¢è¯·æ±‚ã€‚ ä¸ºäº†ä½¿ç”¨æ»šåŠ¨ï¼Œåˆå§‹æœç´¢è¯·æ±‚åº”è¯¥åœ¨æŸ¥è¯¢å­—ç¬¦ä¸²ä¸­æŒ‡å®šæ»šåŠ¨å‚æ•°ï¼Œå®ƒå‘Šè¯‰ Elasticsearch åº”ä¿æŒâ€œæœç´¢ä¸Šä¸‹æ–‡â€æ´»åŠ¨çš„æ—¶é—´ï¼ˆè§ä¿æŒæœç´¢ä¸Šä¸‹æ–‡ï¼‰ï¼Œä¾‹å¦‚ ?scroll=1mã€‚ 123456789POST /twitter/tweet/_search?scroll=1m{ \"size\": 100, \"query\": { \"match\" : { \"title\" : \"elasticsearch\" } }} ä¸Šè¿°è¯·æ±‚çš„ç»“æœåŒ…æ‹¬ä¸€ä¸ª scrollidï¼Œå®ƒåº”è¯¥è¢«ä¼ é€’ç»™æ»šåŠ¨ APIï¼Œä»¥ä¾¿æ£€ç´¢ä¸‹ä¸€æ‰¹ç»“æœã€‚ 12345POST â‘ /_search/scroll â‘¡{ \"scroll\" : \"1m\", â‘¢ \"scroll_id\" : \"DXF1ZXJ5QW5kRmV0Y2gBAAAAAAAAAD4WYm9laVYtZndUQlNsdDcwakFMNjU1QQ==\" â‘£} | â‘  | å¯ä»¥ä½¿ç”¨GETæˆ–POSTã€‚ | | â‘¡ | ç½‘å€ä¸åº”åŒ…å«ç´¢å¼•æˆ–ç±»å‹åç§° - è€Œæ˜¯åœ¨åŸå§‹æœç´¢è¯·æ±‚ä¸­æŒ‡å®šçš„ã€‚ | | â‘¢ | scroll å‚æ•°å‘Šè¯‰ Elasticsearch å°†æœç´¢ä¸Šä¸‹æ–‡æ‰“å¼€å¦ä¸€ä¸ª1mã€‚ | | â‘£ | scroll_idå‚æ•° | size å‚æ•°å…è®¸æ‚¨é…ç½®æ¯æ‰¹ç»“æœè¿”å›çš„æœ€å¤§å‘½ä¸­æ•°ã€‚ æ¯æ¬¡è°ƒç”¨ scroll API éƒ½ä¼šè¿”å›ä¸‹ä¸€æ‰¹ç»“æœï¼Œç›´åˆ°æ²¡æœ‰æ›´å¤šç»“æœè¦è¿”å›ï¼Œå³ hits æ•°ç»„ä¸ºç©ºã€‚ explanå¯ç”¨æ¯æ¬¡åŒ¹é…å¯¹å…¶è¯„åˆ†è®¡ç®—æ–¹å¼çš„è¯´æ˜ã€‚ 1234567GET /_search{ \"explain\": true, \"query\" : { \"term\" : { \"user\" : \"kimchy\" } }} suggesters (å…±æœ‰å››ç§æ–¹å¼) Completion Suggester Context Suggester Phrase Suggester Term suggester completion suggesterå®Œå…¨ï¼ˆcompletionï¼‰suggester æä¾›è‡ªåŠ¨å®Œæˆ/æŒ‰éœ€æœç´¢åŠŸèƒ½ã€‚ è¿™æ˜¯ä¸€ç§å¯¼èˆªåŠŸèƒ½ï¼Œå¯åœ¨ç”¨æˆ·è¾“å…¥æ—¶å¼•å¯¼ç”¨æˆ·æŸ¥çœ‹ç›¸å…³ç»“æœï¼Œä»è€Œæé«˜æœç´¢ç²¾åº¦ã€‚ å®ƒä¸æ˜¯ç”¨äºæ‹¼å†™æ ¡æ­£æˆ–å¹³å‡å€¼åŠŸèƒ½ï¼Œå¦‚æœ¯è¯­æˆ–çŸ­è¯­ suggesters ã€‚ ç†æƒ³åœ°ï¼Œè‡ªåŠ¨å®ŒæˆåŠŸèƒ½åº”å½“ä¸ç”¨æˆ·é”®å…¥çš„é€Ÿåº¦ä¸€æ ·å¿«ï¼Œä»¥æä¾›ä¸ç”¨æˆ·å·²ç»é”®å…¥çš„å†…å®¹ç›¸å…³çš„å³æ—¶åé¦ˆã€‚å› æ­¤ï¼Œå®Œæˆ suggester é’ˆå¯¹é€Ÿåº¦è¿›è¡Œä¼˜åŒ–ã€‚ suggester ä½¿ç”¨å…è®¸å¿«é€ŸæŸ¥æ‰¾çš„æ•°æ®ç»“æ„ï¼Œä½†æ˜¯æ„å»ºæˆæœ¬é«˜å¹¶ä¸”å­˜å‚¨åœ¨å­˜å‚¨å™¨ä¸­ã€‚ è¦ä½¿ç”¨æ­¤åŠŸèƒ½ï¼Œè¯·ä¸ºæ­¤å­—æ®µæŒ‡å®šä¸€ä¸ªç‰¹æ®Šæ˜ å°„ï¼Œä¸ºå¿«é€Ÿå®Œæˆçš„å­—æ®µå€¼ç¼–åˆ¶ç´¢å¼•ã€‚ 123456789101112131415PUT music{ \"mappings\": { \"song\" : { \"properties\" : { \"suggest\" : { \"type\" : \"completion\" }, \"title\" : { \"type\": \"keyword\" } } } }} æ˜ å°„æ”¯æŒä»¥ä¸‹å‚æ•°ï¼š analyzer ä½¿ç”¨ç´¢å¼•åˆ†æå™¨ï¼Œé»˜è®¤ä¸ºç®€å•ã€‚ å¦‚æœä½ æƒ³çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ä»¬æ²¡æœ‰é€‰æ‹©æ ‡å‡†åˆ†æå™¨ï¼šæˆ‘ä»¬å°è¯•åœ¨è¿™é‡Œå¾ˆå®¹æ˜“ç†è§£çš„è¡Œä¸ºï¼Œå¦‚æœä½ ç´¢å¼•å­—æ®µå†…å®¹åœ¨Drive-inï¼Œä½ ä¸ä¼šå¾—åˆ°ä»»ä½•å»ºè®®ï¼Œ ï¼ˆç¬¬ä¸€ä¸ªéåœç”¨è¯ï¼‰ search_analyzer è¦ä½¿ç”¨çš„æœç´¢åˆ†æå™¨ï¼Œé»˜è®¤ä¸ºåˆ†æå™¨çš„å€¼ã€‚ preserve_separators ä¿ç•™åˆ†éš”ç¬¦ï¼Œé»˜è®¤ä¸ºtrueã€‚ å¦‚æœç¦ç”¨ï¼Œä½ å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªä»¥Foo Fighterså¼€å¤´çš„å­—æ®µï¼Œå¦‚æœä½ æ¨èfoofã€‚ preserve_position_increments å¯ç”¨ä½ç½®å¢é‡ï¼Œé»˜è®¤ä¸ºtrueã€‚ å¦‚æœç¦ç”¨å’Œä½¿ç”¨åœç”¨åˆ†æå™¨ï¼Œæ‚¨å¯ä»¥å¾—åˆ°ä¸€ä¸ªå­—æ®µä»æŠ«å¤´å£«å¼€å§‹ï¼Œå¦‚æœä½  suggest bã€‚ æ³¨æ„ï¼šä½ ä¹Ÿå¯ä»¥é€šè¿‡ç´¢å¼•ä¸¤ä¸ªè¾“å…¥ï¼ŒBeatleså’ŒæŠ«å¤´å£«ï¼Œä¸éœ€è¦æ”¹å˜ä¸€ä¸ªç®€å•çš„åˆ†æå™¨ï¼Œå¦‚æœä½ èƒ½å¤Ÿä¸°å¯Œä½ çš„æ•°æ®ã€‚ max_input_length é™åˆ¶å•ä¸ªè¾“å…¥çš„é•¿åº¦ï¼Œé»˜è®¤ä¸º50ä¸ªUTF-16ä»£ç ç‚¹ã€‚ æ­¤é™åˆ¶ä»…åœ¨ç´¢å¼•æ—¶ä½¿ç”¨ï¼Œä»¥å‡å°‘æ¯ä¸ªè¾“å…¥å­—ç¬¦ä¸²çš„å­—ç¬¦æ€»æ•°ï¼Œä»¥é˜²æ­¢å¤§é‡è¾“å…¥è†¨èƒ€åº•å±‚æ•°æ®ç»“æ„ã€‚ å¤§å¤šæ•°ç”¨ä¾‹ä¸ä¼šå—é»˜è®¤å€¼çš„å½±å“ï¼Œå› ä¸ºå‰ç¼€å®Œæˆå¾ˆå°‘è¶…è¿‡å‰ç¼€é•¿åº¦è¶…è¿‡å°‘æ•°å‡ ä¸ªå­—ç¬¦ã€‚ ç´¢å¼• æ‚¨åƒä»»ä½•å…¶ä»–å­—æ®µä¸€æ ·ç´¢å¼• suggestion ã€‚ suggestion ç”±è¾“å…¥å’Œå¯é€‰çš„æƒé‡å±æ€§ç»„æˆã€‚ è¾“å…¥æ˜¯è¦ç”± suggestion æŸ¥è¯¢åŒ¹é…çš„æœŸæœ›æ–‡æœ¬ï¼Œå¹¶ä¸”æƒé‡ç¡®å®šå¦‚ä½•å¯¹ suggestion è¿›è¡Œè¯„åˆ†ã€‚ ç´¢å¼• suggestion å¦‚ä¸‹ï¼š 1234567PUT music/song/1?refresh{ &quot;suggest&quot; : { &quot;input&quot;: [ &quot;Nevermind&quot;, &quot;Nirvana&quot; ], &quot;weight&quot; : 34 }} ä»¥ä¸‹å‚æ•°è¢«æ”¯æŒï¼š input è¾“å…¥å­˜å‚¨ï¼Œè¿™å¯ä»¥æ˜¯å­—ç¬¦ä¸²æ•°ç»„æˆ–åªæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ æ­¤å­—æ®µæ˜¯å¿…å¡«å­—æ®µã€‚ weight æ­£æ•´æ•°æˆ–åŒ…å«æ­£æ•´æ•°çš„å­—ç¬¦ä¸²ï¼Œç”¨äºå®šä¹‰æƒé‡å¹¶å…è®¸å¯¹ suggestions è¿›è¡Œæ’åã€‚ æ­¤å­—æ®µæ˜¯å¯é€‰çš„ã€‚ æŸ¥è¯¢ suggest åƒå¾€å¸¸ä¸€æ ·å·¥ä½œï¼Œé™¤äº†æ‚¨å¿…é¡»æŒ‡å®š suggest ç±»å‹ä¸ºå®Œæˆã€‚ suggestions æ¥è¿‘å®æ—¶ï¼Œè¿™æ„å‘³ç€å¯ä»¥é€šè¿‡åˆ·æ–°æ˜¾ç¤ºæ–° suggestions ï¼Œå¹¶ä¸”ä¸€æ—¦åˆ é™¤å°±ä¸ä¼šæ˜¾ç¤ºæ–‡æ¡£ã€‚ æ­¤è¯·æ±‚ï¼š 123456789POST music/_suggest?pretty{ &quot;song-suggest&quot; : { &quot;prefix&quot; : &quot;nir&quot;, &quot;completion&quot; : { &quot;field&quot; : &quot;suggest&quot; } }} è¿”å›è¿™ä¸ªå“åº”ï¼š 12345678910111213141516171819202122{ &quot;_shards&quot; : { &quot;total&quot; : 5, &quot;successful&quot; : 5, &quot;failed&quot; : 0 }, &quot;song-suggest&quot; : [ { &quot;text&quot; : &quot;nir&quot;, &quot;offset&quot; : 0, &quot;length&quot; : 3, &quot;options&quot; : [ { &quot;text&quot; : &quot;Nirvana&quot;, &quot;_index&quot;: &quot;music&quot;, &quot;_type&quot;: &quot;song&quot;, &quot;_id&quot;: &quot;1&quot;, &quot;_score&quot;: 1.0, &quot;_source&quot;: { &quot;suggest&quot;: [&quot;Nevermind&quot;, &quot;Nirvana&quot;] } } ] } ]} æ¨¡ç³ŠæŸ¥è¯¢ å®Œæˆ suggester è¿˜æ”¯æŒæ¨¡ç³ŠæŸ¥è¯¢ - è¿™æ„å‘³ç€ï¼Œæ‚¨å¯ä»¥åœ¨æœç´¢ä¸­è¾“å…¥é”™è¯¯ï¼Œå¹¶ä»ç„¶è¿”å›ç»“æœã€‚ 123456789101112POST music/_suggest?pretty{ &quot;song-suggest&quot; : { &quot;prefix&quot; : &quot;nor&quot;, &quot;completion&quot; : { &quot;field&quot; : &quot;suggest&quot;, &quot;fuzzy&quot; : { &quot;fuzziness&quot; : 2 } } }} ä¸æŸ¥è¯¢å‰ç¼€å…±äº«æœ€é•¿å‰ç¼€çš„ suggestion å°†å¾—åˆ†æ›´é«˜ã€‚ æ¨¡ç³ŠæŸ¥è¯¢å¯ä»¥é‡‡ç”¨ç‰¹å®šçš„æ¨¡ç³Šå‚æ•°ã€‚ æ”¯æŒä»¥ä¸‹å‚æ•°ï¼š | fuzziness | æ¨¡ç³Šç³»æ•°ï¼Œé»˜è®¤ä¸ºAUTOã€‚ æœ‰å…³å…è®¸çš„è®¾ç½®ï¼Œè¯·å‚é˜… â€œFuzzinesseditâ€ä¸€èŠ‚ã€‚ | | transpositions | å¦‚æœè®¾ç½®ä¸ºtrueï¼Œåˆ™æ¢ä½è®¡æ•°ä¸ºä¸€ä¸ªæ›´æ”¹è€Œä¸æ˜¯ä¸¤ä¸ªï¼Œé»˜è®¤ä¸ºtrue | | min_length | è¿”å›æ¨¡ç³Š suggestions å‰çš„è¾“å…¥çš„æœ€å°é•¿åº¦ï¼Œé»˜è®¤å€¼3 | | prefix_length | è¾“å…¥çš„æœ€å°é•¿åº¦ï¼ˆæœªé’ˆå¯¹æ¨¡ç³Šæ›¿ä»£é¡¹è¿›è¡Œæ£€æŸ¥ï¼‰é»˜è®¤ä¸º1 | | unicode_aware | å¦‚æœä¸ºtrueï¼Œåˆ™æ‰€æœ‰åº¦é‡ï¼ˆå¦‚æ¨¡ç³Šç¼–è¾‘è·ç¦»ï¼Œç½®æ¢å’Œé•¿åº¦ï¼‰éƒ½ä»¥Unicodeä»£ç ç‚¹è€Œä¸æ˜¯å­—èŠ‚ä¸ºå•ä½ã€‚ è¿™æ¯”åŸå§‹å­—èŠ‚ç¨æ…¢ï¼Œå› æ­¤é»˜è®¤æƒ…å†µä¸‹è®¾ç½®ä¸ºfalseã€‚ | å¦‚æœä½ æƒ³åšæŒä½¿ç”¨é»˜è®¤å€¼ï¼Œä½†ä»ç„¶ä½¿ç”¨æ¨¡ç³Šï¼Œä½ å¯ä»¥ä½¿ç”¨ fuzzyï¼š{}æˆ–fuzzyï¼štrueã€‚ Explan apiExplain API è®¡ç®—æŸ¥è¯¢å’Œç‰¹å®šæ–‡æ¡£çš„åˆ†æ•°è¯´æ˜ã€‚ è¿™å¯ä»¥æä¾›æœ‰ç”¨çš„åé¦ˆï¼Œæ— è®ºæ–‡æ¡£æ˜¯å¦åŒ¹é…ç‰¹å®šæŸ¥è¯¢ã€‚ index å’Œ type å‚æ•°åˆ†åˆ«æœŸæœ›å•ä¸ªç´¢å¼•å’Œå•ä¸ªç±»å‹ã€‚ ç”¨æ³•å®Œæ•´æŸ¥è¯¢ç¤ºä¾‹ï¼š 123456GET /twitter/tweet/0/_explain{ &quot;query&quot; : { &quot;match&quot; : { &quot;message&quot; : &quot;elasticsearch&quot; } }} è¿™å°†äº§ç”Ÿä»¥ä¸‹ç»“æœï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748{ &quot;_index&quot; : &quot;twitter&quot;, &quot;_type&quot; : &quot;tweet&quot;, &quot;_id&quot; : &quot;0&quot;, &quot;matched&quot; : true, &quot;explanation&quot; : { &quot;value&quot; : 1.55077, &quot;description&quot; : &quot;sum of:&quot;, &quot;details&quot; : [ { &quot;value&quot; : 1.55077, &quot;description&quot; : &quot;weight(message:elasticsearch in 0) [PerFieldSimilarity], result of:&quot;, &quot;details&quot; : [ { &quot;value&quot; : 1.55077, &quot;description&quot; : &quot;score(doc=0,freq=1.0 = termFreq=1.0\\n), product of:&quot;, &quot;details&quot; : [ { &quot;value&quot; : 1.3862944, &quot;description&quot; : &quot;idf(docFreq=1, docCount=5)&quot;, &quot;details&quot; : [ ] }, { &quot;value&quot; : 1.1186441, &quot;description&quot; : &quot;tfNorm, computed from:&quot;, &quot;details&quot; : [ { &quot;value&quot; : 1.0, &quot;description&quot; : &quot;termFreq=1.0&quot;, &quot;details&quot; : [ ] }, { &quot;value&quot; : 1.2, &quot;description&quot; : &quot;parameter k1&quot;, &quot;details&quot; : [ ] }, { &quot;value&quot; : 0.75, &quot;description&quot; : &quot;parameter b&quot;, &quot;details&quot; : [ ] }, { &quot;value&quot; : 5.4, &quot;description&quot; : &quot;avgFieldLength&quot;, &quot;details&quot; : [ ] }, { &quot;value&quot; : 4.0, &quot;description&quot; : &quot;fieldLength&quot;, &quot;details&quot; : [ ] } ] } ] } ] }, { &quot;value&quot; : 0.0, &quot;description&quot; : &quot;match on required clause, product of:&quot;, &quot;details&quot; : [ { &quot;value&quot; : 0.0, &quot;description&quot; : &quot;# clause&quot;, &quot;details&quot; : [ ] }, { &quot;value&quot; : 1.0, &quot;description&quot; : &quot;_type:tweet, product of:&quot;, &quot;details&quot; : [ { &quot;value&quot; : 1.0, &quot;description&quot; : &quot;boost&quot;, &quot;details&quot; : [ ] }, { &quot;value&quot; : 1.0, &quot;description&quot; : &quot;queryNorm&quot;, &quot;details&quot; : [ ] } ] } ] } ] }} è¿˜æœ‰ä¸€ç§æ›´ç®€å•çš„é€šè¿‡ q å‚æ•°æŒ‡å®šæŸ¥è¯¢çš„æ–¹æ³•ã€‚ ç„¶åè§£ææŒ‡å®šçš„ q å‚æ•°å€¼ï¼Œå°±åƒä½¿ç”¨ query_string æŸ¥è¯¢ä¸€æ ·ã€‚ åœ¨apiä¸­çš„ q å‚æ•°çš„ç”¨æ³•ç¤ºä¾‹ï¼š 1GET /twitter/tweet/0/_explain?q=message:search è¿™å°†äº§ç”Ÿä¸å…ˆå‰è¯·æ±‚ç›¸åŒçš„ç»“æœã€‚ å‚è€ƒèµ„æ–™","link":"/2019/04/26/Elasticsearchå¸¸ç”¨å·¥å…·api.html"},{"title":"restful api è®¾è®¡ä»¥åŠå¹‚ç­‰æ€§ç›¸å…³è®¾è®¡","text":"æ‘˜è¦é’ˆå¯¹é¡¹ç›®ä¸­éƒ¨åˆ†ä½¿ç”¨restful-apiæ¥å£ï¼Œæ€»ç»“æ–‡æ¡£å¦‚ä¸‹ï¼Œæ²¡æœ‰è§„çŸ©ä¸æˆæ–¹åœ†ã€‚å†™ä»£ç äº¦æ˜¯ï¼Œè®¾è®¡restful-apiæ¥å£äº¦æ˜¯ã€‚ RESTful çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ï¼Œå®¢æˆ·ç«¯å‘å‡ºçš„æ•°æ®æ“ä½œæŒ‡ä»¤éƒ½æ˜¯â€åŠ¨è¯ + å®¾è¯­â€çš„ç»“æ„ã€‚æ¯”å¦‚ï¼ŒGET /articlesè¿™ä¸ªå‘½ä»¤ï¼ŒGETæ˜¯åŠ¨è¯ï¼Œ/articlesæ˜¯å®¾è¯­ã€‚ åŠ¨è¯é€šå¸¸å°±æ˜¯äº”ç§ HTTP æ–¹æ³•ï¼Œå¯¹åº” CRUD æ“ä½œã€‚ GETï¼šè¯»å–ï¼ˆReadï¼‰ POSTï¼šæ–°å»ºï¼ˆCreateï¼‰ PUTï¼šæ›´æ–°ï¼ˆUpdateï¼‰ PATCHï¼šæ›´æ–°ï¼ˆUpdateï¼‰ï¼Œé€šå¸¸æ˜¯éƒ¨åˆ†æ›´æ–° DELETEï¼šåˆ é™¤ï¼ˆDeleteï¼‰ æ ¹æ® HTTP è§„èŒƒï¼ŒåŠ¨è¯ä¸€å¾‹å¤§å†™ è¯ä¸å¤šè¯´ï¼Œå…ˆä¸Šä»£ç ï¼Œä¸€ä»½å®Œæ•´çš„restful-apiç¤ºä¾‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445@RestController@RequestMapping(\"admin/biz-name/v1/user\") //@RequestMapping(\"api/biz-name/v1/city\")public class AdminUserController { @Autowired private UserService service; @GetMapping(\"{id}/county/list\") public List&lt;UserView&gt; getUsersByCategoryId(@PathVariable(\"id\") Integer id) { return service.getUsersByCategoryId(id); } @GetMapping(\"{id}\") public UserView userInfoById(@PathVariable(\"id\") Integer id) { return service.getUserInfoById(id); } @PostMapping public Object create(@RequestBody UserEntityForm form) { // ç›¸å…³éªŒè¯valid è®¾ç½®é»˜è®¤å€¼ service.valid(form); if (StringUtil.isEmpty(form.getCsEmail())) { form.setCsEmail(\"980099577@qq.com\"); } Integer id = service.ceate(form); return Collections.singletonMap(\"id\", id); } @PutMapping public Result update(@RequestBody UserEntityForm form) { // ç›¸å…³éªŒè¯ valid service.valid(form); service.update(form); return Result.SUCCEED; } @DeleteMapping(\"{id}\") public Result delete(@PathVariable(\"id\") Integer id) { // ç›¸å…³éªŒè¯ valid service.valid(form); service.delete(id); return Result.SUCCEED; }} é’ˆå¯¹ä»¥ä¸Šrestful-api ä»£ç éœ€è¦æ³¨æ„ä¸€ä¸‹å‡ ç‚¹ï¼š@RestController æ³¨è§£æ­¤æ³¨è§£åŠ åœ¨ç±»çš„ä¸Šé¢ï¼Œè¿”å›çš„ç»“æœä»¥jsonæ ¼å¼ï¼Œæ ‡æ³¨æ­¤ä¸ºRestControllerã€‚ä¸åŒäºControlleræ³¨è§£ã€‚Controlleréjsonæ ¼å¼è¿”å›ã€‚ @RequestMappingæ­¤æ³¨è§£æ ‡è¯†apiè¯·æ±‚çš„è·¯åŠ²ï¼Œå¯æŒ‡å®šç›¸åº”çš„è¯·æ±‚æ–¹æ³•ï¼Œä¾‹å¦‚@RequestMapping(â€œadmin/biz-name/v1/userâ€)ï¼šhttp://localhost:8080/admin/biz-name/v1/user æœ‰å¦‚ä¸‹å®šä¹‰å‚æ•°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146@Target({ElementType.METHOD, ElementType.TYPE})@Retention(RetentionPolicy.RUNTIME)@Documented@Mappingpublic @interface RequestMapping { /** * Assign a name to this mapping. * &lt;p&gt;&lt;b&gt;Supported at the type level as well as at the method level!&lt;/b&gt; * When used on both levels, a combined name is derived by concatenation * with \"#\" as separator. * @see org.springframework.web.servlet.mvc.method.annotation.MvcUriComponentsBuilder * @see org.springframework.web.servlet.handler.HandlerMethodMappingNamingStrategy */ String name() default \"\"; /** * The primary mapping expressed by this annotation. * &lt;p&gt;In a Servlet environment this is an alias for {@link #path}. * For example {@code @RequestMapping(\"/foo\")} is equivalent to * {@code @RequestMapping(path=\"/foo\")}. * &lt;p&gt;In a Portlet environment this is the mapped portlet modes * (i.e. \"EDIT\", \"VIEW\", \"HELP\" or any custom modes). * &lt;p&gt;&lt;b&gt;Supported at the type level as well as at the method level!&lt;/b&gt; * When used at the type level, all method-level mappings inherit * this primary mapping, narrowing it for a specific handler method. */ @AliasFor(\"path\") String[] value() default {}; /** * In a Servlet environment only: the path mapping URIs (e.g. \"/myPath.do\"). * Ant-style path patterns are also supported (e.g. \"/myPath/*.do\"). * At the method level, relative paths (e.g. \"edit.do\") are supported within * the primary mapping expressed at the type level. Path mapping URIs may * contain placeholders (e.g. \"/${connect}\") * &lt;p&gt;&lt;b&gt;Supported at the type level as well as at the method level!&lt;/b&gt; * When used at the type level, all method-level mappings inherit * this primary mapping, narrowing it for a specific handler method. * @see org.springframework.web.bind.annotation.ValueConstants#DEFAULT_NONE * @since 4.2 */ @AliasFor(\"value\") String[] path() default {}; /** * The HTTP request methods to map to, narrowing the primary mapping: * GET, POST, HEAD, OPTIONS, PUT, PATCH, DELETE, TRACE. * &lt;p&gt;&lt;b&gt;Supported at the type level as well as at the method level!&lt;/b&gt; * When used at the type level, all method-level mappings inherit * this HTTP method restriction (i.e. the type-level restriction * gets checked before the handler method is even resolved). * &lt;p&gt;Supported for Servlet environments as well as Portlet 2.0 environments. */ RequestMethod[] method() default {}; /** * The parameters of the mapped request, narrowing the primary mapping. * &lt;p&gt;Same format for any environment: a sequence of \"myParam=myValue\" style * expressions, with a request only mapped if each such parameter is found * to have the given value. Expressions can be negated by using the \"!=\" operator, * as in \"myParam!=myValue\". \"myParam\" style expressions are also supported, * with such parameters having to be present in the request (allowed to have * any value). Finally, \"!myParam\" style expressions indicate that the * specified parameter is &lt;i&gt;not&lt;/i&gt; supposed to be present in the request. * &lt;p&gt;&lt;b&gt;Supported at the type level as well as at the method level!&lt;/b&gt; * When used at the type level, all method-level mappings inherit * this parameter restriction (i.e. the type-level restriction * gets checked before the handler method is even resolved). * &lt;p&gt;In a Servlet environment, parameter mappings are considered as restrictions * that are enforced at the type level. The primary path mapping (i.e. the * specified URI value) still has to uniquely identify the target handler, with * parameter mappings simply expressing preconditions for invoking the handler. * &lt;p&gt;In a Portlet environment, parameters are taken into account as mapping * differentiators, i.e. the primary portlet mode mapping plus the parameter * conditions uniquely identify the target handler. Different handlers may be * mapped onto the same portlet mode, as long as their parameter mappings differ. */ String[] params() default {}; /** * The headers of the mapped request, narrowing the primary mapping. * &lt;p&gt;Same format for any environment: a sequence of \"My-Header=myValue\" style * expressions, with a request only mapped if each such header is found * to have the given value. Expressions can be negated by using the \"!=\" operator, * as in \"My-Header!=myValue\". \"My-Header\" style expressions are also supported, * with such headers having to be present in the request (allowed to have * any value). Finally, \"!My-Header\" style expressions indicate that the * specified header is &lt;i&gt;not&lt;/i&gt; supposed to be present in the request. * &lt;p&gt;Also supports media type wildcards (*), for headers such as Accept * and Content-Type. For instance, * &lt;pre class=\"code\"&gt; * &amp;#064;RequestMapping(value = \"/something\", headers = \"content-type=text/*\") * &lt;/pre&gt; * will match requests with a Content-Type of \"text/html\", \"text/plain\", etc. * &lt;p&gt;&lt;b&gt;Supported at the type level as well as at the method level!&lt;/b&gt; * When used at the type level, all method-level mappings inherit * this header restriction (i.e. the type-level restriction * gets checked before the handler method is even resolved). * &lt;p&gt;Maps against HttpServletRequest headers in a Servlet environment, * and against PortletRequest properties in a Portlet 2.0 environment. * @see org.springframework.http.MediaType */ String[] headers() default {}; /** * The consumable media types of the mapped request, narrowing the primary mapping. * &lt;p&gt;The format is a single media type or a sequence of media types, * with a request only mapped if the {@code Content-Type} matches one of these media types. * Examples: * &lt;pre class=\"code\"&gt; * consumes = \"text/plain\" * consumes = {\"text/plain\", \"application/*\"} * &lt;/pre&gt; * Expressions can be negated by using the \"!\" operator, as in \"!text/plain\", which matches * all requests with a {@code Content-Type} other than \"text/plain\". * &lt;p&gt;&lt;b&gt;Supported at the type level as well as at the method level!&lt;/b&gt; * When used at the type level, all method-level mappings override * this consumes restriction. * @see org.springframework.http.MediaType * @see javax.servlet.http.HttpServletRequest#getContentType() */ String[] consumes() default {}; /** * The producible media types of the mapped request, narrowing the primary mapping. * &lt;p&gt;The format is a single media type or a sequence of media types, * with a request only mapped if the {@code Accept} matches one of these media types. * Examples: * &lt;pre class=\"code\"&gt; * produces = \"text/plain\" * produces = {\"text/plain\", \"application/*\"} * produces = \"application/json; charset=UTF-8\" * &lt;/pre&gt; * &lt;p&gt;It affects the actual content type written, for example to produce a JSON response * with UTF-8 encoding, {@code \"application/json; charset=UTF-8\"} should be used. * &lt;p&gt;Expressions can be negated by using the \"!\" operator, as in \"!text/plain\", which matches * all requests with a {@code Accept} other than \"text/plain\". * &lt;p&gt;&lt;b&gt;Supported at the type level as well as at the method level!&lt;/b&gt; * When used at the type level, all method-level mappings override * this produces restriction. * @see org.springframework.http.MediaType */ String[] produces() default {};} @GetMappingæ­¤æ³¨è§£ï¼Œæ¥æ”¶å‰ç«¯ä¸ºgetè¯·æ±‚çš„ç›¸å…³æ–¹æ³•,æ¥å£è¿”å›å¤©ç”Ÿå…·æœ‰å¹‚ç­‰æ€§ï¼Œæ¯æ¬¡è¯·æ±‚å‚æ•°ä¸€è‡´è¿”å›çš„ç»“æœä¹Ÿä¸€è‡´ æ­¤æ³¨è§£è¯·æ±‚ä¸€èˆ¬ä¸ºè·å–ç›¸å…³ä¿¡æ¯çš„æ–¹æ³• æœ‰å¦‚ä¸‹å‚æ•°ï¼Œ 12345678910111213141516171819202122232425262728293031323334353637383940414243@Target(ElementType.METHOD)@Retention(RetentionPolicy.RUNTIME)@Documented@RequestMapping(method = RequestMethod.GET)public @interface GetMapping { /** * Alias for {@link RequestMapping#name}. */ @AliasFor(annotation = RequestMapping.class) String name() default \"\"; /** * Alias for {@link RequestMapping#value}. */ @AliasFor(annotation = RequestMapping.class) String[] value() default {}; /** * Alias for {@link RequestMapping#path}. */ @AliasFor(annotation = RequestMapping.class) String[] path() default {}; /** * Alias for {@link RequestMapping#params}. */ @AliasFor(annotation = RequestMapping.class) String[] params() default {}; /** * Alias for {@link RequestMapping#headers}. */ @AliasFor(annotation = RequestMapping.class) String[] headers() default {}; /** * Alias for {@link RequestMapping#produces}. */ @AliasFor(annotation = RequestMapping.class) String[] produces() default {};} @PostMappingæ­¤æ³¨è§£ï¼Œæ¥æ”¶å‰ç«¯ä¸ºpostè¯·æ±‚çš„ç›¸å…³æ–¹æ³• ä¸€èˆ¬ä¸ºä¿å­˜ï¼Œåˆ›å»ºä¿¡æ¯çš„æ–¹æ³•ï¼Œsaveâ€¦,createâ€¦ @putMappingæ­¤æ³¨è§£ï¼Œæ¥æ”¶å‰ç«¯ä¸ºputè¯·æ±‚çš„ç›¸å…³æ–¹æ³• ä¸€èˆ¬ä¸ºæ›´æ–°æ•°æ®çš„æ¥å£æ–¹æ³•ï¼Œupdateâ€¦ @deleteMappingæ­¤æ³¨è§£ï¼Œæ¥æ”¶å‰ç«¯ä¸ºdeleteè¯·æ±‚çš„ç›¸å…³æ–¹æ³• ä¸€èˆ¬ä¸ºåˆ é™¤æ•°æ®çš„æ–¹æ³• @RequestBodyæ­¤æ³¨è§£æ”¾å…¥æ¥å£æ–¹æ³•çš„å‚æ•°å‰é¢ï¼Œå¯¹åº”è¯·æ±‚ä¸­çš„bodyé‡Œçš„å†…å®¹ï¼Œè¦æ±‚bodyå†…å®¹ä¸ºjsonæ ¼å¼ ä¾‹å¦‚ï¼š 1public Object create(@RequestBody UserEntityForm form) {}; @PathVariableæ­¤æ³¨è§£æ”¾å…¥æ¥å£æ–¹æ³•çš„å‚æ•°å‰é¢ï¼Œè¦æ±‚é‡Œé¢çš„å€¼å‡ºç°åœ¨Mappingä¸­ï¼Œä»¥{}åŒ…è£¹ï¼Œå¦‚ä¸‹ æ¥å—å‚æ•°requiredï¼Œè®¾ç½®åˆ¤æ–­æ­¤å­—æ®µæ˜¯å¦å¿…é¡» 12@GetMapping(\"{id}\")public UserView userInfoById(@PathVariable(\"id\",required = true) Integer id) {} @RequestParamæ­¤æ³¨è§£æ”¾å…¥æ¥å£æ–¹æ³•çš„å‚æ•°å‰é¢ï¼Œå‰ç«¯æ”¾å…¥è¯·æ±‚å‚æ•°ä¸­ï¼Œébodyé‡Œé¢ æ¥å—å‚æ•°requiredï¼Œè®¾ç½®åˆ¤æ–­æ­¤å­—æ®µæ˜¯å¦å¿…é¡» defaultValue è®¾ç½®æ­¤å­—æ®µçš„é»˜è®¤å€¼ 1public UserView userInfoById(@RequestParam(value = \"id\", required = false, defaultValue = \"1\") Integer idï¼‰{} æ‰€æœ‰çš„æ¥å£æ–¹æ³•éƒ½åº”è¯¥è®¾è®¡ä¸ºå¹‚ç­‰æ€§ï¼Œå³æ¥å£è¯·æ±‚å¤šæ¬¡æˆ–ä¸€æ¬¡éƒ½åº”è¯¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚æ­¤ç‰¹æ€§åœ¨é«˜å¹¶å‘ä¸‹é¢éå¸¸é€‚ç”¨ã€‚ é«˜å¹¶å‘çš„æ ¸å¿ƒæŠ€æœ¯ - å¹‚ç­‰çš„å®ç°æ–¹æ¡ˆä¸€ã€èƒŒæ™¯æˆ‘ä»¬å®é™…ç³»ç»Ÿä¸­æœ‰å¾ˆå¤šæ“ä½œï¼Œæ˜¯ä¸ç®¡åšå¤šå°‘æ¬¡ï¼Œéƒ½åº”è¯¥äº§ç”Ÿä¸€æ ·çš„æ•ˆæœæˆ–è¿”å›ä¸€æ ·çš„ç»“æœã€‚ ä¾‹å¦‚ï¼š å‰ç«¯é‡å¤æäº¤é€‰ä¸­çš„æ•°æ®ï¼Œåº”è¯¥åå°åªäº§ç”Ÿå¯¹åº”è¿™ä¸ªæ•°æ®çš„ä¸€ä¸ªååº”ç»“æœã€‚ 2. æˆ‘ä»¬å‘èµ·ä¸€ç¬”ä»˜æ¬¾è¯·æ±‚ï¼Œåº”è¯¥åªæ‰£ç”¨æˆ·è´¦æˆ·ä¸€æ¬¡é’±ï¼Œå½“é‡åˆ°ç½‘ç»œé‡å‘æˆ–ç³»ç»Ÿbugé‡å‘ï¼Œä¹Ÿåº”è¯¥åªæ‰£ä¸€æ¬¡é’±ï¼› 3. å‘é€æ¶ˆæ¯ï¼Œä¹Ÿåº”è¯¥åªå‘ä¸€æ¬¡ï¼ŒåŒæ ·çš„çŸ­ä¿¡å‘ç»™ç”¨æˆ·ï¼Œç”¨æˆ·ä¼šå“­çš„ï¼› 4. åˆ›å»ºä¸šåŠ¡è®¢å•ï¼Œä¸€æ¬¡ä¸šåŠ¡è¯·æ±‚åªèƒ½åˆ›å»ºä¸€ä¸ªï¼Œåˆ›å»ºå¤šä¸ªå°±ä¼šå‡ºå¤§é—®é¢˜ã€‚ ç­‰ç­‰å¾ˆå¤šé‡è¦çš„æƒ…å†µï¼Œè¿™äº›é€»è¾‘éƒ½éœ€è¦å¹‚ç­‰çš„ç‰¹æ€§æ¥æ”¯æŒã€‚ äºŒã€å¹‚ç­‰æ€§æ¦‚å¿µå¹‚ç­‰ï¼ˆidempotentã€idempotenceï¼‰æ˜¯ä¸€ä¸ªæ•°å­¦ä¸è®¡ç®—æœºå­¦æ¦‚å¿µï¼Œå¸¸è§äºæŠ½è±¡ä»£æ•°ä¸­ã€‚ åœ¨ç¼–ç¨‹ä¸­.ä¸€ä¸ªå¹‚ç­‰æ“ä½œçš„ç‰¹ç‚¹æ˜¯å…¶ä»»æ„å¤šæ¬¡æ‰§è¡Œæ‰€äº§ç”Ÿçš„å½±å“å‡ä¸ä¸€æ¬¡æ‰§è¡Œçš„å½±å“ç›¸åŒã€‚å¹‚ç­‰å‡½æ•°ï¼Œæˆ–å¹‚ç­‰æ–¹æ³•ï¼Œæ˜¯æŒ‡å¯ä»¥ä½¿ç”¨ç›¸åŒå‚æ•°é‡å¤æ‰§è¡Œï¼Œå¹¶èƒ½è·å¾—ç›¸åŒç»“æœçš„å‡½æ•°ã€‚è¿™äº›å‡½æ•°ä¸ä¼šå½±å“ç³»ç»ŸçŠ¶æ€ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒé‡å¤æ‰§è¡Œä¼šå¯¹ç³»ç»Ÿé€ æˆæ”¹å˜ã€‚ä¾‹å¦‚ï¼Œâ€œgetUsername()å’ŒsetTrue()â€å‡½æ•°å°±æ˜¯ä¸€ä¸ªå¹‚ç­‰å‡½æ•°. æ›´å¤æ‚çš„æ“ä½œå¹‚ç­‰ä¿è¯æ˜¯åˆ©ç”¨å”¯ä¸€äº¤æ˜“å·(æµæ°´å·)å®ç°. æˆ‘çš„ç†è§£ï¼šå¹‚ç­‰å°±æ˜¯ä¸€ä¸ªæ“ä½œï¼Œä¸è®ºæ‰§è¡Œå¤šå°‘æ¬¡ï¼Œäº§ç”Ÿçš„æ•ˆæœå’Œè¿”å›çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ ä¸‰ã€æŠ€æœ¯æ–¹æ¡ˆ æŸ¥è¯¢æ“ä½œ æŸ¥è¯¢ä¸€æ¬¡å’ŒæŸ¥è¯¢å¤šæ¬¡ï¼Œåœ¨æ•°æ®ä¸å˜çš„æƒ…å†µä¸‹ï¼ŒæŸ¥è¯¢ç»“æœæ˜¯ä¸€æ ·çš„ã€‚selectæ˜¯å¤©ç„¶çš„å¹‚ç­‰æ“ä½œ åˆ é™¤æ“ä½œ åˆ é™¤æ“ä½œä¹Ÿæ˜¯å¹‚ç­‰çš„ï¼Œåˆ é™¤ä¸€æ¬¡å’Œå¤šæ¬¡åˆ é™¤éƒ½æ˜¯æŠŠæ•°æ®åˆ é™¤ã€‚(æ³¨æ„å¯èƒ½è¿”å›ç»“æœä¸ä¸€æ ·ï¼Œåˆ é™¤çš„æ•°æ®ä¸å­˜åœ¨ï¼Œè¿”å›0ï¼Œåˆ é™¤çš„æ•°æ®å¤šæ¡ï¼Œè¿”å›ç»“æœå¤šä¸ª) 3.å”¯ä¸€ç´¢å¼•ï¼Œé˜²æ­¢æ–°å¢è„æ•°æ® æ¯”å¦‚ï¼šæ”¯ä»˜å®çš„èµ„é‡‘è´¦æˆ·ï¼Œæ”¯ä»˜å®ä¹Ÿæœ‰ç”¨æˆ·è´¦æˆ·ï¼Œæ¯ä¸ªç”¨æˆ·åªèƒ½æœ‰ä¸€ä¸ªèµ„é‡‘è´¦æˆ·ï¼Œæ€ä¹ˆé˜²æ­¢ç»™ç”¨æˆ·åˆ›å»ºèµ„é‡‘è´¦æˆ·å¤šä¸ªï¼Œé‚£ä¹ˆç»™èµ„é‡‘è´¦æˆ·è¡¨ä¸­çš„ç”¨æˆ·IDåŠ å”¯ä¸€ç´¢å¼•ï¼Œæ‰€ä»¥ä¸€ä¸ªç”¨æˆ·æ–°å¢æˆåŠŸä¸€ä¸ªèµ„é‡‘è´¦æˆ·è®°å½• è¦ç‚¹ï¼š å”¯ä¸€ç´¢å¼•æˆ–å”¯ä¸€ç»„åˆç´¢å¼•æ¥é˜²æ­¢æ–°å¢æ•°æ®å­˜åœ¨è„æ•°æ® ï¼ˆå½“è¡¨å­˜åœ¨å”¯ä¸€ç´¢å¼•ï¼Œå¹¶å‘æ—¶æ–°å¢æŠ¥é”™æ—¶ï¼Œå†æŸ¥è¯¢ä¸€æ¬¡å°±å¯ä»¥äº†ï¼Œæ•°æ®åº”è¯¥å·²ç»å­˜åœ¨äº†ï¼Œè¿”å›ç»“æœå³å¯ï¼‰ tokenæœºåˆ¶ï¼Œé˜²æ­¢é¡µé¢é‡å¤æäº¤ ä¸šåŠ¡è¦æ±‚ï¼š é¡µé¢çš„æ•°æ®åªèƒ½è¢«ç‚¹å‡»æäº¤ä¸€æ¬¡ å‘ç”ŸåŸå› ï¼š ç”±äºé‡å¤ç‚¹å‡»æˆ–è€…ç½‘ç»œé‡å‘ï¼Œæˆ–è€…nginxé‡å‘ç­‰æƒ…å†µä¼šå¯¼è‡´æ•°æ®è¢«é‡å¤æäº¤ è§£å†³åŠæ³•ï¼š é›†ç¾¤ç¯å¢ƒï¼šé‡‡ç”¨tokenåŠ redisï¼ˆrediså•çº¿ç¨‹çš„ï¼Œå¤„ç†éœ€è¦æ’é˜Ÿï¼‰ å•JVMç¯å¢ƒï¼šé‡‡ç”¨tokenåŠ redisæˆ–tokenåŠ jvmå†…å­˜ å¤„ç†æµç¨‹ï¼š 1. æ•°æ®æäº¤å‰è¦å‘æœåŠ¡çš„ç”³è¯·tokenï¼Œtokenæ”¾åˆ°redisæˆ–jvmå†…å­˜ï¼Œtokenæœ‰æ•ˆæ—¶é—´ 2. æäº¤ååå°æ ¡éªŒtokenï¼ŒåŒæ—¶åˆ é™¤tokenï¼Œç”Ÿæˆæ–°çš„tokenè¿”å› tokenç‰¹ç‚¹ï¼š è¦ç”³è¯·ï¼Œä¸€æ¬¡æœ‰æ•ˆæ€§ï¼Œå¯ä»¥é™æµ æ³¨æ„ï¼šredisè¦ç”¨åˆ é™¤æ“ä½œæ¥åˆ¤æ–­tokenï¼Œåˆ é™¤æˆåŠŸä»£è¡¨tokenæ ¡éªŒé€šè¿‡ï¼Œå¦‚æœç”¨select+deleteæ¥æ ¡éªŒtokenï¼Œå­˜åœ¨å¹¶å‘é—®é¢˜ï¼Œä¸å»ºè®®ä½¿ç”¨ æ‚²è§‚é” è·å–æ•°æ®çš„æ—¶å€™åŠ é”è·å– select * from table_xxx where id=â€™xxxâ€™ for update; æ³¨æ„ï¼šidå­—æ®µä¸€å®šæ˜¯ä¸»é”®æˆ–è€…å”¯ä¸€ç´¢å¼•ï¼Œä¸ç„¶æ˜¯é”è¡¨ï¼Œä¼šæ­»äººçš„ æ‚²è§‚é”ä½¿ç”¨æ—¶ä¸€èˆ¬ä¼´éšäº‹åŠ¡ä¸€èµ·ä½¿ç”¨ï¼Œæ•°æ®é”å®šæ—¶é—´å¯èƒ½ä¼šå¾ˆé•¿ï¼Œæ ¹æ®å®é™…æƒ…å†µé€‰ç”¨ ä¹è§‚é” ä¹è§‚é”åªæ˜¯åœ¨æ›´æ–°æ•°æ®é‚£ä¸€åˆ»é”è¡¨ï¼Œå…¶ä»–æ—¶é—´ä¸é”è¡¨ï¼Œæ‰€ä»¥ç›¸å¯¹äºæ‚²è§‚é”ï¼Œæ•ˆç‡æ›´é«˜ã€‚ ä¹è§‚é”çš„å®ç°æ–¹å¼å¤šç§å¤šæ ·å¯ä»¥é€šè¿‡versionæˆ–è€…å…¶ä»–çŠ¶æ€æ¡ä»¶ï¼š 1. é€šè¿‡ç‰ˆæœ¬å·å®ç° update table_xxx set name=#name#,version=version+1 where version=#version# å¦‚ä¸‹å›¾(æ¥è‡ªç½‘ä¸Š)ï¼š é€šè¿‡æ¡ä»¶é™åˆ¶ update tablexxx set avaiamount=avaiamount-#subAmount# where avaiamount-#subAmount# &gt;= 0 è¦æ±‚ï¼šquality-#subQuality# &gt;= ï¼Œè¿™ä¸ªæƒ…æ™¯é€‚åˆä¸ç”¨ç‰ˆæœ¬å·ï¼Œåªæ›´æ–°æ˜¯åšæ•°æ®å®‰å…¨æ ¡éªŒï¼Œé€‚åˆåº“å­˜æ¨¡å‹ï¼Œæ‰£ä»½é¢å’Œå›æ»šä»½é¢ï¼Œæ€§èƒ½æ›´é«˜ æ³¨æ„ï¼šä¹è§‚é”çš„æ›´æ–°æ“ä½œï¼Œæœ€å¥½ç”¨ä¸»é”®æˆ–è€…å”¯ä¸€ç´¢å¼•æ¥æ›´æ–°,è¿™æ ·æ˜¯è¡Œé”ï¼Œå¦åˆ™æ›´æ–°æ—¶ä¼šé”è¡¨ï¼Œä¸Šé¢ä¸¤ä¸ªsqlæ”¹æˆä¸‹é¢çš„ä¸¤ä¸ªæ›´å¥½ update tablexxx set name=#name#,version=version+1 where id=#id# and version=#version# update tablexxx set avaiamount=avaiamount-#subAmount# where id=#id# and avai_amount-#subAmount# &gt;= 0 åˆ†å¸ƒå¼é” è¿˜æ˜¯æ‹¿æ’å…¥æ•°æ®çš„ä¾‹å­ï¼Œå¦‚æœæ˜¯åˆ†å¸ƒæ˜¯ç³»ç»Ÿï¼Œæ„å»ºå…¨å±€å”¯ä¸€ç´¢å¼•æ¯”è¾ƒå›°éš¾ï¼Œä¾‹å¦‚å”¯ä¸€æ€§çš„å­—æ®µæ²¡æ³•ç¡®å®šï¼Œè¿™æ—¶å€™å¯ä»¥å¼•å…¥åˆ†å¸ƒå¼é”ï¼Œé€šè¿‡ç¬¬ä¸‰æ–¹çš„ç³»ç»Ÿ(redisæˆ–zookeeper)ï¼Œåœ¨ä¸šåŠ¡ç³»ç»Ÿæ’å…¥æ•°æ®æˆ–è€…æ›´æ–°æ•°æ®ï¼Œè·å–åˆ†å¸ƒå¼é”ï¼Œç„¶ååšæ“ä½œï¼Œä¹‹åé‡Šæ”¾é”ï¼Œè¿™æ ·å…¶å®æ˜¯æŠŠå¤šçº¿ç¨‹å¹¶å‘çš„é”çš„æ€è·¯ï¼Œå¼•å…¥å¤šå¤šä¸ªç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¾—è§£å†³æ€è·¯ã€‚ è¦ç‚¹ï¼šæŸä¸ªé•¿æµç¨‹å¤„ç†è¿‡ç¨‹è¦æ±‚ä¸èƒ½å¹¶å‘æ‰§è¡Œï¼Œå¯ä»¥åœ¨æµç¨‹æ‰§è¡Œä¹‹å‰æ ¹æ®æŸä¸ªæ ‡å¿—(ç”¨æˆ·ID+åç¼€ç­‰)è·å–åˆ†å¸ƒå¼é”ï¼Œå…¶ä»–æµç¨‹æ‰§è¡Œæ—¶è·å–é”å°±ä¼šå¤±è´¥ï¼Œä¹Ÿå°±æ˜¯åŒä¸€æ—¶é—´è¯¥æµç¨‹åªèƒ½æœ‰ä¸€ä¸ªèƒ½æ‰§è¡ŒæˆåŠŸï¼Œæ‰§è¡Œå®Œæˆåï¼Œé‡Šæ”¾åˆ†å¸ƒå¼é”(åˆ†å¸ƒå¼é”è¦ç¬¬ä¸‰æ–¹ç³»ç»Ÿæä¾›) select + insert å¹¶å‘ä¸é«˜çš„åå°ç³»ç»Ÿï¼Œæˆ–è€…ä¸€äº›ä»»åŠ¡JOBï¼Œä¸ºäº†æ”¯æŒå¹‚ç­‰ï¼Œæ”¯æŒé‡å¤æ‰§è¡Œï¼Œç®€å•çš„å¤„ç†æ–¹æ³•æ˜¯ï¼Œå…ˆæŸ¥è¯¢ä¸‹ä¸€äº›å…³é”®æ•°æ®ï¼Œåˆ¤æ–­æ˜¯å¦å·²ç»æ‰§è¡Œè¿‡ï¼Œåœ¨è¿›è¡Œä¸šåŠ¡å¤„ç†ï¼Œå°±å¯ä»¥äº† æ³¨æ„ï¼šæ ¸å¿ƒé«˜å¹¶å‘æµç¨‹ä¸è¦ç”¨è¿™ç§æ–¹æ³• çŠ¶æ€æœºå¹‚ç­‰ åœ¨è®¾è®¡å•æ®ç›¸å…³çš„ä¸šåŠ¡ï¼Œæˆ–è€…æ˜¯ä»»åŠ¡ç›¸å…³çš„ä¸šåŠ¡ï¼Œè‚¯å®šä¼šæ¶‰åŠåˆ°çŠ¶æ€æœº(çŠ¶æ€å˜æ›´å›¾)ï¼Œå°±æ˜¯ä¸šåŠ¡å•æ®ä¸Šé¢æœ‰ä¸ªçŠ¶æ€ï¼ŒçŠ¶æ€åœ¨ä¸åŒçš„æƒ…å†µä¸‹ä¼šå‘ç”Ÿå˜æ›´ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å­˜åœ¨æœ‰é™çŠ¶æ€æœºï¼Œè¿™æ—¶å€™ï¼Œå¦‚æœçŠ¶æ€æœºå·²ç»å¤„äºä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œè¿™æ—¶å€™æ¥äº†ä¸€ä¸ªä¸Šä¸€ä¸ªçŠ¶æ€çš„å˜æ›´ï¼Œç†è®ºä¸Šæ˜¯ä¸èƒ½å¤Ÿå˜æ›´çš„ï¼Œè¿™æ ·çš„è¯ï¼Œä¿è¯äº†æœ‰é™çŠ¶æ€æœºçš„å¹‚ç­‰ã€‚ æ³¨æ„ï¼šè®¢å•ç­‰å•æ®ç±»ä¸šåŠ¡ï¼Œå­˜åœ¨å¾ˆé•¿çš„çŠ¶æ€æµè½¬ï¼Œä¸€å®šè¦æ·±åˆ»ç†è§£çŠ¶æ€æœºï¼Œå¯¹ä¸šåŠ¡ç³»ç»Ÿè®¾è®¡èƒ½åŠ›æé«˜æœ‰å¾ˆå¤§å¸®åŠ© å¯¹å¤–æä¾›æ¥å£çš„apiå¦‚ä½•ä¿è¯å¹‚ç­‰ å¦‚é“¶è”æä¾›çš„ä»˜æ¬¾æ¥å£ï¼šéœ€è¦æ¥å…¥å•†æˆ·æäº¤ä»˜æ¬¾è¯·æ±‚æ—¶é™„å¸¦ï¼šsourceæ¥æºï¼Œseqåºåˆ—å· source+seqåœ¨æ•°æ®åº“é‡Œé¢åšå”¯ä¸€ç´¢å¼•ï¼Œé˜²æ­¢å¤šæ¬¡ä»˜æ¬¾ï¼Œ(å¹¶å‘æ—¶ï¼Œåªèƒ½å¤„ç†ä¸€ä¸ªè¯·æ±‚) é‡ç‚¹å¯¹å¤–æä¾›æ¥å£ä¸ºäº†æ”¯æŒå¹‚ç­‰è°ƒç”¨ï¼Œæ¥å£æœ‰ä¸¤ä¸ªå­—æ®µå¿…é¡»ä¼ ï¼Œä¸€ä¸ªæ˜¯æ¥æºsourceï¼Œä¸€ä¸ªæ˜¯æ¥æºæ–¹åºåˆ—å·seqï¼Œè¿™ä¸ªä¸¤ä¸ªå­—æ®µåœ¨æä¾›æ–¹ç³»ç»Ÿé‡Œé¢åšè”åˆå”¯ä¸€ç´¢å¼•ï¼Œè¿™æ ·å½“ç¬¬ä¸‰æ–¹è°ƒç”¨æ—¶ï¼Œå…ˆåœ¨æœ¬æ–¹ç³»ç»Ÿé‡Œé¢æŸ¥è¯¢ä¸€ä¸‹ï¼Œæ˜¯å¦å·²ç»å¤„ç†è¿‡ï¼Œè¿”å›ç›¸åº”å¤„ç†ç»“æœï¼›æ²¡æœ‰å¤„ç†è¿‡ï¼Œè¿›è¡Œç›¸åº”å¤„ç†ï¼Œè¿”å›ç»“æœã€‚æ³¨æ„ï¼Œä¸ºäº†å¹‚ç­‰å‹å¥½ï¼Œä¸€å®šè¦å…ˆæŸ¥è¯¢ä¸€ä¸‹ï¼Œæ˜¯å¦å¤„ç†è¿‡è¯¥ç¬”ä¸šåŠ¡ï¼Œä¸æŸ¥è¯¢ç›´æ¥æ’å…¥ä¸šåŠ¡ç³»ç»Ÿï¼Œä¼šæŠ¥é”™ï¼Œä½†å®é™…å·²ç»å¤„ç†äº†ã€‚ æ€»ç»“å¹‚ç­‰æ€§åº”è¯¥æ˜¯åˆæ ¼ç¨‹åºå‘˜çš„ä¸€ä¸ªåŸºå› ï¼Œåœ¨è®¾è®¡ç³»ç»Ÿæ—¶ï¼Œæ˜¯é¦–è¦è€ƒè™‘çš„é—®é¢˜ï¼Œå°¤å…¶æ˜¯åœ¨åƒæ”¯ä»˜å®ï¼Œé“¶è¡Œï¼Œäº’è”ç½‘é‡‘èå…¬å¸ç­‰æ¶‰åŠçš„éƒ½æ˜¯é’±çš„ç³»ç»Ÿï¼Œæ—¢è¦é«˜æ•ˆï¼Œæ•°æ®ä¹Ÿè¦å‡†ç¡®ï¼Œæ‰€ä»¥ä¸èƒ½å‡ºç°å¤šæ‰£æ¬¾ï¼Œå¤šæ‰“æ¬¾ç­‰é—®é¢˜ï¼Œè¿™æ ·ä¼šå¾ˆéš¾å¤„ç†ï¼Œç”¨æˆ·ä½“éªŒä¹Ÿä¸å¥½ å‚è€ƒè‡ª","link":"/2019/04/18/restful-api-è®¾è®¡ä»¥åŠå¹‚ç­‰æ€§ç›¸å…³è®¾è®¡.html"},{"title":"ä¸€åƒè¡Œ MySQL å­¦ä¹ ç¬”è®°(è½¬è½½)","text":"æ‘˜è¦ä»¥ä¸‹ä¸ºæœ¬äººåˆå­¦ MySQL æ—¶åšçš„ç¬”è®°ï¼Œä¹Ÿä»é‚£æ—¶èµ·æ²¡å†æ›´æ–°è¿‡ï¼Œä½†è¿˜æ˜¯å›Šæ‹¬äº†åŸºæœ¬çš„çŸ¥è¯†ç‚¹ï¼Œæœ‰æ—¶è¿˜ç¿»å‡ºæ¥æŸ¥æŸ¥ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678679680681682683684685686687688689690691692693694695696697698699700701702703704705706707708709710711712713714715716717718719720721722723724725726727728729730731732733734735736737738739740741742743744745746747748749750751752753754755756757758759760761762763764765766767768769770771772773774775776777778779780781782783784785786787788789790791792793794795796797798799800801802803804805806807808809810811812813814815816817818819820821822823824825826827828829830831832833834835836837838839840841842843844845846847848849850851852853854855856857858859860861862863864865866867868869870871872873874875876877878879880881882883884885886887888889890891892893894895896897898899900901902903904905906907908909910911912913914915916917918919920921922923924925926927928929930931932933934935936937938939940941942943944945946947948949950951952953954955956957958959960961962963964965966967968969970971972973974975976977978979980981982983984985986987988989990991992993994995996997998999100010011002100310041005100610071008100910101011101210131014101510161017101810191020102110221023102410251026102710281029103010311032103310341035103610371038103910401041104210431044/* WindowsæœåŠ¡ */-- å¯åŠ¨MySQL net start mysql-- åˆ›å»ºWindowsæœåŠ¡ sc create mysql binPath= mysqld_bin_path(æ³¨æ„ï¼šç­‰å·ä¸å€¼ä¹‹é—´æœ‰ç©ºæ ¼)/* è¿æ¥ä¸æ–­å¼€æœåŠ¡å™¨ */mysql -h åœ°å€ -P ç«¯å£ -u ç”¨æˆ·å -p å¯†ç SHOW PROCESSLIST -- æ˜¾ç¤ºå“ªäº›çº¿ç¨‹æ­£åœ¨è¿è¡ŒSHOW VARIABLES -- æ˜¾ç¤ºç³»ç»Ÿå˜é‡ä¿¡æ¯/* æ•°æ®åº“æ“ä½œ */ -------------------- æŸ¥çœ‹å½“å‰æ•°æ®åº“ SELECT DATABASE();-- æ˜¾ç¤ºå½“å‰æ—¶é—´ã€ç”¨æˆ·åã€æ•°æ®åº“ç‰ˆæœ¬ SELECT now(), user(), version();-- åˆ›å»ºåº“ CREATE DATABASE[ IF NOT EXISTS] æ•°æ®åº“å æ•°æ®åº“é€‰é¡¹ æ•°æ®åº“é€‰é¡¹ï¼š CHARACTER SET charset_name COLLATE collation_name-- æŸ¥çœ‹å·²æœ‰åº“ SHOW DATABASES[ LIKE 'PATTERN']-- æŸ¥çœ‹å½“å‰åº“ä¿¡æ¯ SHOW CREATE DATABASE æ•°æ®åº“å-- ä¿®æ”¹åº“çš„é€‰é¡¹ä¿¡æ¯ ALTER DATABASE åº“å é€‰é¡¹ä¿¡æ¯-- åˆ é™¤åº“ DROP DATABASE[ IF EXISTS] æ•°æ®åº“å åŒæ—¶åˆ é™¤è¯¥æ•°æ®åº“ç›¸å…³çš„ç›®å½•åŠå…¶ç›®å½•å†…å®¹/* è¡¨çš„æ“ä½œ */ -------------------- åˆ›å»ºè¡¨ CREATE [TEMPORARY] TABLE[ IF NOT EXISTS] [åº“å.]è¡¨å ( è¡¨çš„ç»“æ„å®šä¹‰ )[ è¡¨é€‰é¡¹] æ¯ä¸ªå­—æ®µå¿…é¡»æœ‰æ•°æ®ç±»å‹ æœ€åä¸€ä¸ªå­—æ®µåä¸èƒ½æœ‰é€—å· TEMPORARY ä¸´æ—¶è¡¨ï¼Œä¼šè¯ç»“æŸæ—¶è¡¨è‡ªåŠ¨æ¶ˆå¤± å¯¹äºå­—æ®µçš„å®šä¹‰ï¼š å­—æ®µå æ•°æ®ç±»å‹ [NOT NULL | NULL] [DEFAULT default_value] [AUTO_INCREMENT] [UNIQUE [KEY] | [PRIMARY] KEY] [COMMENT 'string']-- è¡¨é€‰é¡¹ -- å­—ç¬¦é›† CHARSET = charset_name å¦‚æœè¡¨æ²¡æœ‰è®¾å®šï¼Œåˆ™ä½¿ç”¨æ•°æ®åº“å­—ç¬¦é›† -- å­˜å‚¨å¼•æ“ ENGINE = engine_name è¡¨åœ¨ç®¡ç†æ•°æ®æ—¶é‡‡ç”¨çš„ä¸åŒçš„æ•°æ®ç»“æ„ï¼Œç»“æ„ä¸åŒä¼šå¯¼è‡´å¤„ç†æ–¹å¼ã€æä¾›çš„ç‰¹æ€§æ“ä½œç­‰ä¸åŒ å¸¸è§çš„å¼•æ“ï¼šInnoDB MyISAM Memory/Heap BDB Merge Example CSV MaxDB Archive ä¸åŒçš„å¼•æ“åœ¨ä¿å­˜è¡¨çš„ç»“æ„å’Œæ•°æ®æ—¶é‡‡ç”¨ä¸åŒçš„æ–¹å¼ MyISAMè¡¨æ–‡ä»¶å«ä¹‰ï¼š.frmè¡¨å®šä¹‰ï¼Œ.MYDè¡¨æ•°æ®ï¼Œ.MYIè¡¨ç´¢å¼• InnoDBè¡¨æ–‡ä»¶å«ä¹‰ï¼š.frmè¡¨å®šä¹‰ï¼Œè¡¨ç©ºé—´æ•°æ®å’Œæ—¥å¿—æ–‡ä»¶ SHOW ENGINES -- æ˜¾ç¤ºå­˜å‚¨å¼•æ“çš„çŠ¶æ€ä¿¡æ¯ SHOW ENGINE å¼•æ“å {LOGS|STATUS} -- æ˜¾ç¤ºå­˜å‚¨å¼•æ“çš„æ—¥å¿—æˆ–çŠ¶æ€ä¿¡æ¯ -- è‡ªå¢èµ·å§‹æ•° AUTO_INCREMENT = è¡Œæ•° -- æ•°æ®æ–‡ä»¶ç›®å½• DATA DIRECTORY = 'ç›®å½•' -- ç´¢å¼•æ–‡ä»¶ç›®å½• INDEX DIRECTORY = 'ç›®å½•' -- è¡¨æ³¨é‡Š COMMENT = 'string' -- åˆ†åŒºé€‰é¡¹ PARTITION BY ... (è¯¦ç»†è§æ‰‹å†Œ)-- æŸ¥çœ‹æ‰€æœ‰è¡¨ SHOW TABLES[ LIKE 'pattern'] SHOW TABLES FROM è¡¨å-- æŸ¥çœ‹è¡¨æœºæ„ SHOW CREATE TABLE è¡¨å ï¼ˆä¿¡æ¯æ›´è¯¦ç»†ï¼‰ DESC è¡¨å / DESCRIBE è¡¨å / EXPLAIN è¡¨å / SHOW COLUMNS FROM è¡¨å [LIKE 'PATTERN'] SHOW TABLE STATUS [FROM db_name] [LIKE 'pattern']-- ä¿®æ”¹è¡¨ -- ä¿®æ”¹è¡¨æœ¬èº«çš„é€‰é¡¹ ALTER TABLE è¡¨å è¡¨çš„é€‰é¡¹ eg: ALTER TABLE è¡¨å ENGINE=MYISAM; -- å¯¹è¡¨è¿›è¡Œé‡å‘½å RENAME TABLE åŸè¡¨å TO æ–°è¡¨å RENAME TABLE åŸè¡¨å TO åº“å.è¡¨å ï¼ˆå¯å°†è¡¨ç§»åŠ¨åˆ°å¦ä¸€ä¸ªæ•°æ®åº“ï¼‰ -- RENAMEå¯ä»¥äº¤æ¢ä¸¤ä¸ªè¡¨å -- ä¿®æ”¹è¡¨çš„å­—æ®µæœºæ„ï¼ˆ13.1.2. ALTER TABLEè¯­æ³•ï¼‰ ALTER TABLE è¡¨å æ“ä½œå -- æ“ä½œå ADD[ COLUMN] å­—æ®µå®šä¹‰ -- å¢åŠ å­—æ®µ AFTER å­—æ®µå -- è¡¨ç¤ºå¢åŠ åœ¨è¯¥å­—æ®µååé¢ FIRST -- è¡¨ç¤ºå¢åŠ åœ¨ç¬¬ä¸€ä¸ª ADD PRIMARY KEY(å­—æ®µå) -- åˆ›å»ºä¸»é”® ADD UNIQUE [ç´¢å¼•å] (å­—æ®µå)-- åˆ›å»ºå”¯ä¸€ç´¢å¼• ADD INDEX [ç´¢å¼•å] (å­—æ®µå) -- åˆ›å»ºæ™®é€šç´¢å¼• DROP[ COLUMN] å­—æ®µå -- åˆ é™¤å­—æ®µ MODIFY[ COLUMN] å­—æ®µå å­—æ®µå±æ€§ -- æ”¯æŒå¯¹å­—æ®µå±æ€§è¿›è¡Œä¿®æ”¹ï¼Œä¸èƒ½ä¿®æ”¹å­—æ®µå(æ‰€æœ‰åŸæœ‰å±æ€§ä¹Ÿéœ€å†™ä¸Š) CHANGE[ COLUMN] åŸå­—æ®µå æ–°å­—æ®µå å­—æ®µå±æ€§ -- æ”¯æŒå¯¹å­—æ®µåä¿®æ”¹ DROP PRIMARY KEY -- åˆ é™¤ä¸»é”®(åˆ é™¤ä¸»é”®å‰éœ€åˆ é™¤å…¶AUTO_INCREMENTå±æ€§) DROP INDEX ç´¢å¼•å -- åˆ é™¤ç´¢å¼• DROP FOREIGN KEY å¤–é”® -- åˆ é™¤å¤–é”®-- åˆ é™¤è¡¨ DROP TABLE[ IF EXISTS] è¡¨å ...-- æ¸…ç©ºè¡¨æ•°æ® TRUNCATE [TABLE] è¡¨å-- å¤åˆ¶è¡¨ç»“æ„ CREATE TABLE è¡¨å LIKE è¦å¤åˆ¶çš„è¡¨å-- å¤åˆ¶è¡¨ç»“æ„å’Œæ•°æ® CREATE TABLE è¡¨å [AS] SELECT * FROM è¦å¤åˆ¶çš„è¡¨å-- æ£€æŸ¥è¡¨æ˜¯å¦æœ‰é”™è¯¯ CHECK TABLE tbl_name [, tbl_name] ... [option] ...-- ä¼˜åŒ–è¡¨ OPTIMIZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ...-- ä¿®å¤è¡¨ REPAIR [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ... [QUICK] [EXTENDED] [USE_FRM]-- åˆ†æè¡¨ ANALYZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] .../* æ•°æ®æ“ä½œ */ -------------------- å¢ INSERT [INTO] è¡¨å [(å­—æ®µåˆ—è¡¨)] VALUES (å€¼åˆ—è¡¨)[, (å€¼åˆ—è¡¨), ...] -- å¦‚æœè¦æ’å…¥çš„å€¼åˆ—è¡¨åŒ…å«æ‰€æœ‰å­—æ®µå¹¶ä¸”é¡ºåºä¸€è‡´ï¼Œåˆ™å¯ä»¥çœç•¥å­—æ®µåˆ—è¡¨ã€‚ -- å¯åŒæ—¶æ’å…¥å¤šæ¡æ•°æ®è®°å½•ï¼ REPLACE ä¸ INSERT å®Œå…¨ä¸€æ ·ï¼Œå¯äº’æ¢ã€‚ INSERT [INTO] è¡¨å SET å­—æ®µå=å€¼[, å­—æ®µå=å€¼, ...]-- æŸ¥ SELECT å­—æ®µåˆ—è¡¨ FROM è¡¨å[ å…¶ä»–å­å¥] -- å¯æ¥è‡ªå¤šä¸ªè¡¨çš„å¤šä¸ªå­—æ®µ -- å…¶ä»–å­å¥å¯ä»¥ä¸ä½¿ç”¨ -- å­—æ®µåˆ—è¡¨å¯ä»¥ç”¨*ä»£æ›¿ï¼Œè¡¨ç¤ºæ‰€æœ‰å­—æ®µ-- åˆ  DELETE FROM è¡¨å[ åˆ é™¤æ¡ä»¶å­å¥] æ²¡æœ‰æ¡ä»¶å­å¥ï¼Œåˆ™ä¼šåˆ é™¤å…¨éƒ¨-- æ”¹ UPDATE è¡¨å SET å­—æ®µå=æ–°å€¼[, å­—æ®µå=æ–°å€¼] [æ›´æ–°æ¡ä»¶]/* å­—ç¬¦é›†ç¼–ç  */ -------------------- MySQLã€æ•°æ®åº“ã€è¡¨ã€å­—æ®µå‡å¯è®¾ç½®ç¼–ç -- æ•°æ®ç¼–ç ä¸å®¢æˆ·ç«¯ç¼–ç ä¸éœ€ä¸€è‡´SHOW VARIABLES LIKE 'character_set_%' -- æŸ¥çœ‹æ‰€æœ‰å­—ç¬¦é›†ç¼–ç é¡¹ character_set_client å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€æ•°æ®æ—¶ä½¿ç”¨çš„ç¼–ç  character_set_results æœåŠ¡å™¨ç«¯å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯æ‰€ä½¿ç”¨çš„ç¼–ç  character_set_connection è¿æ¥å±‚ç¼–ç SET å˜é‡å = å˜é‡å€¼ SET character_set_client = gbk; SET character_set_results = gbk; SET character_set_connection = gbk;SET NAMES GBK; -- ç›¸å½“äºå®Œæˆä»¥ä¸Šä¸‰ä¸ªè®¾ç½®-- æ ¡å¯¹é›† æ ¡å¯¹é›†ç”¨ä»¥æ’åº SHOW CHARACTER SET [LIKE 'pattern']/SHOW CHARSET [LIKE 'pattern'] æŸ¥çœ‹æ‰€æœ‰å­—ç¬¦é›† SHOW COLLATION [LIKE 'pattern'] æŸ¥çœ‹æ‰€æœ‰æ ¡å¯¹é›† CHARSET å­—ç¬¦é›†ç¼–ç  è®¾ç½®å­—ç¬¦é›†ç¼–ç  COLLATE æ ¡å¯¹é›†ç¼–ç  è®¾ç½®æ ¡å¯¹é›†ç¼–ç /* æ•°æ®ç±»å‹ï¼ˆåˆ—ç±»å‹ï¼‰ */ ------------------1. æ•°å€¼ç±»å‹-- a. æ•´å‹ ---------- ç±»å‹ å­—èŠ‚ èŒƒå›´ï¼ˆæœ‰ç¬¦å·ä½ï¼‰ tinyint 1å­—èŠ‚ -128 ~ 127 æ— ç¬¦å·ä½ï¼š0 ~ 255 smallint 2å­—èŠ‚ -32768 ~ 32767 mediumint 3å­—èŠ‚ -8388608 ~ 8388607 int 4å­—èŠ‚ bigint 8å­—èŠ‚ int(M) Mè¡¨ç¤ºæ€»ä½æ•° - é»˜è®¤å­˜åœ¨ç¬¦å·ä½ï¼Œunsigned å±æ€§ä¿®æ”¹ - æ˜¾ç¤ºå®½åº¦ï¼Œå¦‚æœæŸä¸ªæ•°ä¸å¤Ÿå®šä¹‰å­—æ®µæ—¶è®¾ç½®çš„ä½æ•°ï¼Œåˆ™å‰é¢ä»¥0è¡¥å¡«ï¼Œzerofill å±æ€§ä¿®æ”¹ ä¾‹ï¼šint(5) æ’å…¥ä¸€ä¸ªæ•°'123'ï¼Œè¡¥å¡«åä¸º'00123' - åœ¨æ»¡è¶³è¦æ±‚çš„æƒ…å†µä¸‹ï¼Œè¶Šå°è¶Šå¥½ã€‚ - 1è¡¨ç¤ºboolå€¼çœŸï¼Œ0è¡¨ç¤ºboolå€¼å‡ã€‚MySQLæ²¡æœ‰å¸ƒå°”ç±»å‹ï¼Œé€šè¿‡æ•´å‹0å’Œ1è¡¨ç¤ºã€‚å¸¸ç”¨tinyint(1)è¡¨ç¤ºå¸ƒå°”å‹ã€‚-- b. æµ®ç‚¹å‹ ---------- ç±»å‹ å­—èŠ‚ èŒƒå›´ float(å•ç²¾åº¦) 4å­—èŠ‚ double(åŒç²¾åº¦) 8å­—èŠ‚ æµ®ç‚¹å‹æ—¢æ”¯æŒç¬¦å·ä½ unsigned å±æ€§ï¼Œä¹Ÿæ”¯æŒæ˜¾ç¤ºå®½åº¦ zerofill å±æ€§ã€‚ ä¸åŒäºæ•´å‹ï¼Œå‰åå‡ä¼šè¡¥å¡«0. å®šä¹‰æµ®ç‚¹å‹æ—¶ï¼Œéœ€æŒ‡å®šæ€»ä½æ•°å’Œå°æ•°ä½æ•°ã€‚ float(M, D) double(M, D) Mè¡¨ç¤ºæ€»ä½æ•°ï¼ŒDè¡¨ç¤ºå°æ•°ä½æ•°ã€‚ Må’ŒDçš„å¤§å°ä¼šå†³å®šæµ®ç‚¹æ•°çš„èŒƒå›´ã€‚ä¸åŒäºæ•´å‹çš„å›ºå®šèŒƒå›´ã€‚ Mæ—¢è¡¨ç¤ºæ€»ä½æ•°ï¼ˆä¸åŒ…æ‹¬å°æ•°ç‚¹å’Œæ­£è´Ÿå·ï¼‰ï¼Œä¹Ÿè¡¨ç¤ºæ˜¾ç¤ºå®½åº¦ï¼ˆæ‰€æœ‰æ˜¾ç¤ºç¬¦å·å‡åŒ…æ‹¬ï¼‰ã€‚ æ”¯æŒç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºã€‚ æµ®ç‚¹æ•°è¡¨ç¤ºè¿‘ä¼¼å€¼ã€‚-- c. å®šç‚¹æ•° ---------- decimal -- å¯å˜é•¿åº¦ decimal(M, D) Mä¹Ÿè¡¨ç¤ºæ€»ä½æ•°ï¼ŒDè¡¨ç¤ºå°æ•°ä½æ•°ã€‚ ä¿å­˜ä¸€ä¸ªç²¾ç¡®çš„æ•°å€¼ï¼Œä¸ä¼šå‘ç”Ÿæ•°æ®çš„æ”¹å˜ï¼Œä¸åŒäºæµ®ç‚¹æ•°çš„å››èˆäº”å…¥ã€‚ å°†æµ®ç‚¹æ•°è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ¥ä¿å­˜ï¼Œæ¯9ä½æ•°å­—ä¿å­˜ä¸º4ä¸ªå­—èŠ‚ã€‚2. å­—ç¬¦ä¸²ç±»å‹-- a. char, varchar ---------- char å®šé•¿å­—ç¬¦ä¸²ï¼Œé€Ÿåº¦å¿«ï¼Œä½†æµªè´¹ç©ºé—´ varchar å˜é•¿å­—ç¬¦ä¸²ï¼Œé€Ÿåº¦æ…¢ï¼Œä½†èŠ‚çœç©ºé—´ Mè¡¨ç¤ºèƒ½å­˜å‚¨çš„æœ€å¤§é•¿åº¦ï¼Œæ­¤é•¿åº¦æ˜¯å­—ç¬¦æ•°ï¼Œéå­—èŠ‚æ•°ã€‚ ä¸åŒçš„ç¼–ç ï¼Œæ‰€å ç”¨çš„ç©ºé—´ä¸åŒã€‚ char,æœ€å¤š255ä¸ªå­—ç¬¦ï¼Œä¸ç¼–ç æ— å…³ã€‚ varchar,æœ€å¤š65535å­—ç¬¦ï¼Œä¸ç¼–ç æœ‰å…³ã€‚ ä¸€æ¡æœ‰æ•ˆè®°å½•æœ€å¤§ä¸èƒ½è¶…è¿‡65535ä¸ªå­—èŠ‚ã€‚ utf8 æœ€å¤§ä¸º21844ä¸ªå­—ç¬¦ï¼Œgbk æœ€å¤§ä¸º32766ä¸ªå­—ç¬¦ï¼Œlatin1 æœ€å¤§ä¸º65532ä¸ªå­—ç¬¦ varchar æ˜¯å˜é•¿çš„ï¼Œéœ€è¦åˆ©ç”¨å­˜å‚¨ç©ºé—´ä¿å­˜ varchar çš„é•¿åº¦ï¼Œå¦‚æœæ•°æ®å°äº255ä¸ªå­—èŠ‚ï¼Œåˆ™é‡‡ç”¨ä¸€ä¸ªå­—èŠ‚æ¥ä¿å­˜é•¿åº¦ï¼Œåä¹‹éœ€è¦ä¸¤ä¸ªå­—èŠ‚æ¥ä¿å­˜ã€‚ varchar çš„æœ€å¤§æœ‰æ•ˆé•¿åº¦ç”±æœ€å¤§è¡Œå¤§å°å’Œä½¿ç”¨çš„å­—ç¬¦é›†ç¡®å®šã€‚ æœ€å¤§æœ‰æ•ˆé•¿åº¦æ˜¯65532å­—èŠ‚ï¼Œå› ä¸ºåœ¨varcharå­˜å­—ç¬¦ä¸²æ—¶ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ç©ºçš„ï¼Œä¸å­˜åœ¨ä»»ä½•æ•°æ®ï¼Œç„¶åè¿˜éœ€ä¸¤ä¸ªå­—èŠ‚æ¥å­˜æ”¾å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œæ‰€ä»¥æœ‰æ•ˆé•¿åº¦æ˜¯64432-1-2=65532å­—èŠ‚ã€‚ ä¾‹ï¼šè‹¥ä¸€ä¸ªè¡¨å®šä¹‰ä¸º CREATE TABLE tb(c1 int, c2 char(30), c3 varchar(N)) charset=utf8; é—®Nçš„æœ€å¤§å€¼æ˜¯å¤šå°‘ï¼Ÿ ç­”ï¼š(65535-1-2-4-30*3)/3-- b. blob, text ---------- blob äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼ˆå­—èŠ‚å­—ç¬¦ä¸²ï¼‰ tinyblob, blob, mediumblob, longblob text éäºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼ˆå­—ç¬¦å­—ç¬¦ä¸²ï¼‰ tinytext, text, mediumtext, longtext text åœ¨å®šä¹‰æ—¶ï¼Œä¸éœ€è¦å®šä¹‰é•¿åº¦ï¼Œä¹Ÿä¸ä¼šè®¡ç®—æ€»é•¿åº¦ã€‚ text ç±»å‹åœ¨å®šä¹‰æ—¶ï¼Œä¸å¯ç»™defaultå€¼-- c. binary, varbinary ---------- ç±»ä¼¼äºcharå’Œvarcharï¼Œç”¨äºä¿å­˜äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯ä¿å­˜å­—èŠ‚å­—ç¬¦ä¸²è€Œéå­—ç¬¦å­—ç¬¦ä¸²ã€‚ char, varchar, text å¯¹åº” binary, varbinary, blob.3. æ—¥æœŸæ—¶é—´ç±»å‹ ä¸€èˆ¬ç”¨æ•´å‹ä¿å­˜æ—¶é—´æˆ³ï¼Œå› ä¸ºPHPå¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†æ—¶é—´æˆ³è¿›è¡Œæ ¼å¼åŒ–ã€‚ datetime 8å­—èŠ‚ æ—¥æœŸåŠæ—¶é—´ 1000-01-01 00:00:00 åˆ° 9999-12-31 23:59:59 date 3å­—èŠ‚ æ—¥æœŸ 1000-01-01 åˆ° 9999-12-31 timestamp 4å­—èŠ‚ æ—¶é—´æˆ³ 19700101000000 åˆ° 2038-01-19 03:14:07 time 3å­—èŠ‚ æ—¶é—´ -838:59:59 åˆ° 838:59:59 year 1å­—èŠ‚ å¹´ä»½ 1901 - 2155datetime YYYY-MM-DD hh:mm:sstimestamp YY-MM-DD hh:mm:ss YYYYMMDDhhmmss YYMMDDhhmmss YYYYMMDDhhmmss YYMMDDhhmmssdate YYYY-MM-DD YY-MM-DD YYYYMMDD YYMMDD YYYYMMDD YYMMDDtime hh:mm:ss hhmmss hhmmssyear YYYY YY YYYY YY4. æšä¸¾å’Œé›†åˆ-- æšä¸¾(enum) ----------enum(val1, val2, val3...) åœ¨å·²çŸ¥çš„å€¼ä¸­è¿›è¡Œå•é€‰ã€‚æœ€å¤§æ•°é‡ä¸º65535. æšä¸¾å€¼åœ¨ä¿å­˜æ—¶ï¼Œä»¥2ä¸ªå­—èŠ‚çš„æ•´å‹(smallint)ä¿å­˜ã€‚æ¯ä¸ªæšä¸¾å€¼ï¼ŒæŒ‰ä¿å­˜çš„ä½ç½®é¡ºåºï¼Œä»1å¼€å§‹é€ä¸€é€’å¢ã€‚ è¡¨ç°ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œå­˜å‚¨å´æ˜¯æ•´å‹ã€‚ NULLå€¼çš„ç´¢å¼•æ˜¯NULLã€‚ ç©ºå­—ç¬¦ä¸²é”™è¯¯å€¼çš„ç´¢å¼•å€¼æ˜¯0ã€‚-- é›†åˆï¼ˆsetï¼‰ ----------set(val1, val2, val3...) create table tab ( gender set('ç”·', 'å¥³', 'æ— ') ); insert into tab values ('ç”·, å¥³'); æœ€å¤šå¯ä»¥æœ‰64ä¸ªä¸åŒçš„æˆå‘˜ã€‚ä»¥bigintå­˜å‚¨ï¼Œå…±8ä¸ªå­—èŠ‚ã€‚é‡‡å–ä½è¿ç®—çš„å½¢å¼ã€‚ å½“åˆ›å»ºè¡¨æ—¶ï¼ŒSETæˆå‘˜å€¼çš„å°¾éƒ¨ç©ºæ ¼å°†è‡ªåŠ¨è¢«åˆ é™¤ã€‚/* é€‰æ‹©ç±»å‹ */-- PHPè§’åº¦1. åŠŸèƒ½æ»¡è¶³2. å­˜å‚¨ç©ºé—´å°½é‡å°ï¼Œå¤„ç†æ•ˆç‡æ›´é«˜3. è€ƒè™‘å…¼å®¹é—®é¢˜-- IPå­˜å‚¨ ----------1. åªéœ€å­˜å‚¨ï¼Œå¯ç”¨å­—ç¬¦ä¸²2. å¦‚æœéœ€è®¡ç®—ï¼ŒæŸ¥æ‰¾ç­‰ï¼Œå¯å­˜å‚¨ä¸º4ä¸ªå­—èŠ‚çš„æ— ç¬¦å·intï¼Œå³unsigned 1) PHPå‡½æ•°è½¬æ¢ ip2longå¯è½¬æ¢ä¸ºæ•´å‹ï¼Œä½†ä¼šå‡ºç°æºå¸¦ç¬¦å·é—®é¢˜ã€‚éœ€æ ¼å¼åŒ–ä¸ºæ— ç¬¦å·çš„æ•´å‹ã€‚ åˆ©ç”¨sprintfå‡½æ•°æ ¼å¼åŒ–å­—ç¬¦ä¸² sprintf(\"%u\", ip2long('192.168.3.134')); ç„¶åç”¨long2ipå°†æ•´å‹è½¬å›IPå­—ç¬¦ä¸² 2) MySQLå‡½æ•°è½¬æ¢(æ— ç¬¦å·æ•´å‹ï¼ŒUNSIGNED) INET_ATON('127.0.0.1') å°†IPè½¬ä¸ºæ•´å‹ INET_NTOA(2130706433) å°†æ•´å‹è½¬ä¸ºIP/* åˆ—å±æ€§ï¼ˆåˆ—çº¦æŸï¼‰ */ ------------------1. PRIMARY ä¸»é”® - èƒ½å”¯ä¸€æ ‡è¯†è®°å½•çš„å­—æ®µï¼Œå¯ä»¥ä½œä¸ºä¸»é”®ã€‚ - ä¸€ä¸ªè¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ã€‚ - ä¸»é”®å…·æœ‰å”¯ä¸€æ€§ã€‚ - å£°æ˜å­—æ®µæ—¶ï¼Œç”¨ primary key æ ‡è¯†ã€‚ ä¹Ÿå¯ä»¥åœ¨å­—æ®µåˆ—è¡¨ä¹‹åå£°æ˜ ä¾‹ï¼šcreate table tab ( id int, stu varchar(10), primary key (id)); - ä¸»é”®å­—æ®µçš„å€¼ä¸èƒ½ä¸ºnullã€‚ - ä¸»é”®å¯ä»¥ç”±å¤šä¸ªå­—æ®µå…±åŒç»„æˆã€‚æ­¤æ—¶éœ€è¦åœ¨å­—æ®µåˆ—è¡¨åå£°æ˜çš„æ–¹æ³•ã€‚ ä¾‹ï¼šcreate table tab ( id int, stu varchar(10), age int, primary key (stu, age));2. UNIQUE å”¯ä¸€ç´¢å¼•ï¼ˆå”¯ä¸€çº¦æŸï¼‰ ä½¿å¾—æŸå­—æ®µçš„å€¼ä¹Ÿä¸èƒ½é‡å¤ã€‚3. NULL çº¦æŸ nullä¸æ˜¯æ•°æ®ç±»å‹ï¼Œæ˜¯åˆ—çš„ä¸€ä¸ªå±æ€§ã€‚ è¡¨ç¤ºå½“å‰åˆ—æ˜¯å¦å¯ä»¥ä¸ºnullï¼Œè¡¨ç¤ºä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚ null, å…è®¸ä¸ºç©ºã€‚é»˜è®¤ã€‚ not null, ä¸å…è®¸ä¸ºç©ºã€‚ insert into tab values (null, 'val'); -- æ­¤æ—¶è¡¨ç¤ºå°†ç¬¬ä¸€ä¸ªå­—æ®µçš„å€¼è®¾ä¸ºnull, å–å†³äºè¯¥å­—æ®µæ˜¯å¦å…è®¸ä¸ºnull4. DEFAULT é»˜è®¤å€¼å±æ€§ å½“å‰å­—æ®µçš„é»˜è®¤å€¼ã€‚ insert into tab values (default, 'val'); -- æ­¤æ—¶è¡¨ç¤ºå¼ºåˆ¶ä½¿ç”¨é»˜è®¤å€¼ã€‚ create table tab ( add_time timestamp default current_timestamp ); -- è¡¨ç¤ºå°†å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³è®¾ä¸ºé»˜è®¤å€¼ã€‚ current_date, current_time5. AUTO_INCREMENT è‡ªåŠ¨å¢é•¿çº¦æŸ è‡ªåŠ¨å¢é•¿å¿…é¡»ä¸ºç´¢å¼•ï¼ˆä¸»é”®æˆ–uniqueï¼‰ åªèƒ½å­˜åœ¨ä¸€ä¸ªå­—æ®µä¸ºè‡ªåŠ¨å¢é•¿ã€‚ é»˜è®¤ä¸º1å¼€å§‹è‡ªåŠ¨å¢é•¿ã€‚å¯ä»¥é€šè¿‡è¡¨å±æ€§ auto_increment = xè¿›è¡Œè®¾ç½®ï¼Œæˆ– alter table tbl auto_increment = x;6. COMMENT æ³¨é‡Š ä¾‹ï¼šcreate table tab ( id int ) comment 'æ³¨é‡Šå†…å®¹';7. FOREIGN KEY å¤–é”®çº¦æŸ ç”¨äºé™åˆ¶ä¸»è¡¨ä¸ä»è¡¨æ•°æ®å®Œæ•´æ€§ã€‚ alter table t1 add constraint `t1_t2_fk` foreign key (t1_id) references t2(id); -- å°†è¡¨t1çš„t1_idå¤–é”®å…³è”åˆ°è¡¨t2çš„idå­—æ®µã€‚ -- æ¯ä¸ªå¤–é”®éƒ½æœ‰ä¸€ä¸ªåå­—ï¼Œå¯ä»¥é€šè¿‡ constraint æŒ‡å®š å­˜åœ¨å¤–é”®çš„è¡¨ï¼Œç§°ä¹‹ä¸ºä»è¡¨ï¼ˆå­è¡¨ï¼‰ï¼Œå¤–é”®æŒ‡å‘çš„è¡¨ï¼Œç§°ä¹‹ä¸ºä¸»è¡¨ï¼ˆçˆ¶è¡¨ï¼‰ã€‚ ä½œç”¨ï¼šä¿æŒæ•°æ®ä¸€è‡´æ€§ï¼Œå®Œæ•´æ€§ï¼Œä¸»è¦ç›®çš„æ˜¯æ§åˆ¶å­˜å‚¨åœ¨å¤–é”®è¡¨ï¼ˆä»è¡¨ï¼‰ä¸­çš„æ•°æ®ã€‚ MySQLä¸­ï¼Œå¯ä»¥å¯¹InnoDBå¼•æ“ä½¿ç”¨å¤–é”®çº¦æŸï¼š è¯­æ³•ï¼š foreign key (å¤–é”®å­—æ®µï¼‰ references ä¸»è¡¨å (å…³è”å­—æ®µ) [ä¸»è¡¨è®°å½•åˆ é™¤æ—¶çš„åŠ¨ä½œ] [ä¸»è¡¨è®°å½•æ›´æ–°æ—¶çš„åŠ¨ä½œ] æ­¤æ—¶éœ€è¦æ£€æµ‹ä¸€ä¸ªä»è¡¨çš„å¤–é”®éœ€è¦çº¦æŸä¸ºä¸»è¡¨çš„å·²å­˜åœ¨çš„å€¼ã€‚å¤–é”®åœ¨æ²¡æœ‰å…³è”çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥è®¾ç½®ä¸ºnull.å‰ææ˜¯è¯¥å¤–é”®åˆ—ï¼Œæ²¡æœ‰not nullã€‚ å¯ä»¥ä¸æŒ‡å®šä¸»è¡¨è®°å½•æ›´æ”¹æˆ–æ›´æ–°æ—¶çš„åŠ¨ä½œï¼Œé‚£ä¹ˆæ­¤æ—¶ä¸»è¡¨çš„æ“ä½œè¢«æ‹’ç»ã€‚ å¦‚æœæŒ‡å®šäº† on update æˆ– on deleteï¼šåœ¨åˆ é™¤æˆ–æ›´æ–°æ—¶ï¼Œæœ‰å¦‚ä¸‹å‡ ä¸ªæ“ä½œå¯ä»¥é€‰æ‹©ï¼š 1. cascadeï¼Œçº§è”æ“ä½œã€‚ä¸»è¡¨æ•°æ®è¢«æ›´æ–°ï¼ˆä¸»é”®å€¼æ›´æ–°ï¼‰ï¼Œä»è¡¨ä¹Ÿè¢«æ›´æ–°ï¼ˆå¤–é”®å€¼æ›´æ–°ï¼‰ã€‚ä¸»è¡¨è®°å½•è¢«åˆ é™¤ï¼Œä»è¡¨ç›¸å…³è®°å½•ä¹Ÿè¢«åˆ é™¤ã€‚ 2. set nullï¼Œè®¾ç½®ä¸ºnullã€‚ä¸»è¡¨æ•°æ®è¢«æ›´æ–°ï¼ˆä¸»é”®å€¼æ›´æ–°ï¼‰ï¼Œä»è¡¨çš„å¤–é”®è¢«è®¾ç½®ä¸ºnullã€‚ä¸»è¡¨è®°å½•è¢«åˆ é™¤ï¼Œä»è¡¨ç›¸å…³è®°å½•å¤–é”®è¢«è®¾ç½®æˆnullã€‚ä½†æ³¨æ„ï¼Œè¦æ±‚è¯¥å¤–é”®åˆ—ï¼Œæ²¡æœ‰not nullå±æ€§çº¦æŸã€‚ 3. restrictï¼Œæ‹’ç»çˆ¶è¡¨åˆ é™¤å’Œæ›´æ–°ã€‚ æ³¨æ„ï¼Œå¤–é”®åªè¢«InnoDBå­˜å‚¨å¼•æ“æ‰€æ”¯æŒã€‚å…¶ä»–å¼•æ“æ˜¯ä¸æ”¯æŒçš„ã€‚/* å»ºè¡¨è§„èŒƒ */ ------------------ -- Normal Format, NF - æ¯ä¸ªè¡¨ä¿å­˜ä¸€ä¸ªå®ä½“ä¿¡æ¯ - æ¯ä¸ªå…·æœ‰ä¸€ä¸ªIDå­—æ®µä½œä¸ºä¸»é”® - IDä¸»é”® + åŸå­è¡¨ -- 1NF, ç¬¬ä¸€èŒƒå¼ å­—æ®µä¸èƒ½å†åˆ†ï¼Œå°±æ»¡è¶³ç¬¬ä¸€èŒƒå¼ã€‚ -- 2NF, ç¬¬äºŒèŒƒå¼ æ»¡è¶³ç¬¬ä¸€èŒƒå¼çš„å‰æä¸‹ï¼Œä¸èƒ½å‡ºç°éƒ¨åˆ†ä¾èµ–ã€‚ æ¶ˆé™¤ç¬¦åˆä¸»é”®å°±å¯ä»¥é¿å…éƒ¨åˆ†ä¾èµ–ã€‚å¢åŠ å•åˆ—å…³é”®å­—ã€‚ -- 3NF, ç¬¬ä¸‰èŒƒå¼ æ»¡è¶³ç¬¬äºŒèŒƒå¼çš„å‰æä¸‹ï¼Œä¸èƒ½å‡ºç°ä¼ é€’ä¾èµ–ã€‚ æŸä¸ªå­—æ®µä¾èµ–äºä¸»é”®ï¼Œè€Œæœ‰å…¶ä»–å­—æ®µä¾èµ–äºè¯¥å­—æ®µã€‚è¿™å°±æ˜¯ä¼ é€’ä¾èµ–ã€‚ å°†ä¸€ä¸ªå®ä½“ä¿¡æ¯çš„æ•°æ®æ”¾åœ¨ä¸€ä¸ªè¡¨å†…å®ç°ã€‚/* SELECT */ ------------------SELECT [ALL|DISTINCT] select_expr FROM -&gt; WHERE -&gt; GROUP BY [åˆè®¡å‡½æ•°] -&gt; HAVING -&gt; ORDER BY -&gt; LIMITa. select_expr -- å¯ä»¥ç”¨ * è¡¨ç¤ºæ‰€æœ‰å­—æ®µã€‚ select * from tb; -- å¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼ï¼ˆè®¡ç®—å…¬å¼ã€å‡½æ•°è°ƒç”¨ã€å­—æ®µä¹Ÿæ˜¯ä¸ªè¡¨è¾¾å¼ï¼‰ select stu, 29+25, now() from tb; -- å¯ä»¥ä¸ºæ¯ä¸ªåˆ—ä½¿ç”¨åˆ«åã€‚é€‚ç”¨äºç®€åŒ–åˆ—æ ‡è¯†ï¼Œé¿å…å¤šä¸ªåˆ—æ ‡è¯†ç¬¦é‡å¤ã€‚ - ä½¿ç”¨ as å…³é”®å­—ï¼Œä¹Ÿå¯çœç•¥ as. select stu+10 as add10 from tb;b. FROM å­å¥ ç”¨äºæ ‡è¯†æŸ¥è¯¢æ¥æºã€‚ -- å¯ä»¥ä¸ºè¡¨èµ·åˆ«åã€‚ä½¿ç”¨aså…³é”®å­—ã€‚ SELECT * FROM tb1 AS tt, tb2 AS bb; -- fromå­å¥åï¼Œå¯ä»¥åŒæ—¶å‡ºç°å¤šä¸ªè¡¨ã€‚ -- å¤šä¸ªè¡¨ä¼šæ¨ªå‘å åŠ åˆ°ä¸€èµ·ï¼Œè€Œæ•°æ®ä¼šå½¢æˆä¸€ä¸ªç¬›å¡å°”ç§¯ã€‚ SELECT * FROM tb1, tb2; -- å‘ä¼˜åŒ–ç¬¦æç¤ºå¦‚ä½•é€‰æ‹©ç´¢å¼• USE INDEXã€IGNORE INDEXã€FORCE INDEX SELECT * FROM table1 USE INDEX (key1,key2) WHERE key1=1 AND key2=2 AND key3=3; SELECT * FROM table1 IGNORE INDEX (key3) WHERE key1=1 AND key2=2 AND key3=3;c. WHERE å­å¥ -- ä»fromè·å¾—çš„æ•°æ®æºä¸­è¿›è¡Œç­›é€‰ã€‚ -- æ•´å‹1è¡¨ç¤ºçœŸï¼Œ0è¡¨ç¤ºå‡ã€‚ -- è¡¨è¾¾å¼ç”±è¿ç®—ç¬¦å’Œè¿ç®—æ•°ç»„æˆã€‚ -- è¿ç®—æ•°ï¼šå˜é‡ï¼ˆå­—æ®µï¼‰ã€å€¼ã€å‡½æ•°è¿”å›å€¼ -- è¿ç®—ç¬¦ï¼š =, &lt;=&gt;, &lt;&gt;, !=, &lt;=, &lt;, &gt;=, &gt;, !, &amp;&amp;, ||, in (not) null, (not) like, (not) in, (not) between and, is (not), and, or, not, xor is/is not åŠ ä¸Šture/false/unknownï¼Œæ£€éªŒæŸä¸ªå€¼çš„çœŸå‡ &lt;=&gt;ä¸&lt;&gt;åŠŸèƒ½ç›¸åŒï¼Œ&lt;=&gt;å¯ç”¨äºnullæ¯”è¾ƒd. GROUP BY å­å¥, åˆ†ç»„å­å¥ GROUP BY å­—æ®µ/åˆ«å [æ’åºæ–¹å¼] åˆ†ç»„åä¼šè¿›è¡Œæ’åºã€‚å‡åºï¼šASCï¼Œé™åºï¼šDESC ä»¥ä¸‹[åˆè®¡å‡½æ•°]éœ€é…åˆ GROUP BY ä½¿ç”¨ï¼š count è¿”å›ä¸åŒçš„éNULLå€¼æ•°ç›® count(*)ã€count(å­—æ®µ) sum æ±‚å’Œ max æ±‚æœ€å¤§å€¼ min æ±‚æœ€å°å€¼ avg æ±‚å¹³å‡å€¼ group_concat è¿”å›å¸¦æœ‰æ¥è‡ªä¸€ä¸ªç»„çš„è¿æ¥çš„éNULLå€¼çš„å­—ç¬¦ä¸²ç»“æœã€‚ç»„å†…å­—ç¬¦ä¸²è¿æ¥ã€‚e. HAVING å­å¥ï¼Œæ¡ä»¶å­å¥ ä¸ where åŠŸèƒ½ã€ç”¨æ³•ç›¸åŒï¼Œæ‰§è¡Œæ—¶æœºä¸åŒã€‚ where åœ¨å¼€å§‹æ—¶æ‰§è¡Œæ£€æµ‹æ•°æ®ï¼Œå¯¹åŸæ•°æ®è¿›è¡Œè¿‡æ»¤ã€‚ having å¯¹ç­›é€‰å‡ºçš„ç»“æœå†æ¬¡è¿›è¡Œè¿‡æ»¤ã€‚ having å­—æ®µå¿…é¡»æ˜¯æŸ¥è¯¢å‡ºæ¥çš„ï¼Œwhere å­—æ®µå¿…é¡»æ˜¯æ•°æ®è¡¨å­˜åœ¨çš„ã€‚ where ä¸å¯ä»¥ä½¿ç”¨å­—æ®µçš„åˆ«åï¼Œhaving å¯ä»¥ã€‚å› ä¸ºæ‰§è¡ŒWHEREä»£ç æ—¶ï¼Œå¯èƒ½å°šæœªç¡®å®šåˆ—å€¼ã€‚ where ä¸å¯ä»¥ä½¿ç”¨åˆè®¡å‡½æ•°ã€‚ä¸€èˆ¬éœ€ç”¨åˆè®¡å‡½æ•°æ‰ä¼šç”¨ having SQLæ ‡å‡†è¦æ±‚HAVINGå¿…é¡»å¼•ç”¨GROUP BYå­å¥ä¸­çš„åˆ—æˆ–ç”¨äºåˆè®¡å‡½æ•°ä¸­çš„åˆ—ã€‚f. ORDER BY å­å¥ï¼Œæ’åºå­å¥ order by æ’åºå­—æ®µ/åˆ«å æ’åºæ–¹å¼ [,æ’åºå­—æ®µ/åˆ«å æ’åºæ–¹å¼]... å‡åºï¼šASCï¼Œé™åºï¼šDESC æ”¯æŒå¤šä¸ªå­—æ®µçš„æ’åºã€‚g. LIMIT å­å¥ï¼Œé™åˆ¶ç»“æœæ•°é‡å­å¥ ä»…å¯¹å¤„ç†å¥½çš„ç»“æœè¿›è¡Œæ•°é‡é™åˆ¶ã€‚å°†å¤„ç†å¥½çš„ç»“æœçš„çœ‹ä½œæ˜¯ä¸€ä¸ªé›†åˆï¼ŒæŒ‰ç…§è®°å½•å‡ºç°çš„é¡ºåºï¼Œç´¢å¼•ä»0å¼€å§‹ã€‚ limit èµ·å§‹ä½ç½®, è·å–æ¡æ•° çœç•¥ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºä»ç´¢å¼•0å¼€å§‹ã€‚limit è·å–æ¡æ•°h. DISTINCT, ALL é€‰é¡¹ distinct å»é™¤é‡å¤è®°å½• é»˜è®¤ä¸º all, å…¨éƒ¨è®°å½•/* UNION */ ------------------ å°†å¤šä¸ªselectæŸ¥è¯¢çš„ç»“æœç»„åˆæˆä¸€ä¸ªç»“æœé›†åˆã€‚ SELECT ... UNION [ALL|DISTINCT] SELECT ... é»˜è®¤ DISTINCT æ–¹å¼ï¼Œå³æ‰€æœ‰è¿”å›çš„è¡Œéƒ½æ˜¯å”¯ä¸€çš„ å»ºè®®ï¼Œå¯¹æ¯ä¸ªSELECTæŸ¥è¯¢åŠ ä¸Šå°æ‹¬å·åŒ…è£¹ã€‚ ORDER BY æ’åºæ—¶ï¼Œéœ€åŠ ä¸Š LIMIT è¿›è¡Œç»“åˆã€‚ éœ€è¦å„selectæŸ¥è¯¢çš„å­—æ®µæ•°é‡ä¸€æ ·ã€‚ æ¯ä¸ªselectæŸ¥è¯¢çš„å­—æ®µåˆ—è¡¨(æ•°é‡ã€ç±»å‹)åº”ä¸€è‡´ï¼Œå› ä¸ºç»“æœä¸­çš„å­—æ®µåä»¥ç¬¬ä¸€æ¡selectè¯­å¥ä¸ºå‡†ã€‚/* å­æŸ¥è¯¢ */ ------------------ - å­æŸ¥è¯¢éœ€ç”¨æ‹¬å·åŒ…è£¹ã€‚-- fromå‹ fromåè¦æ±‚æ˜¯ä¸€ä¸ªè¡¨ï¼Œå¿…é¡»ç»™å­æŸ¥è¯¢ç»“æœå–ä¸ªåˆ«åã€‚ - ç®€åŒ–æ¯ä¸ªæŸ¥è¯¢å†…çš„æ¡ä»¶ã€‚ - fromå‹éœ€å°†ç»“æœç”Ÿæˆä¸€ä¸ªä¸´æ—¶è¡¨æ ¼ï¼Œå¯ç”¨ä»¥åŸè¡¨çš„é”å®šçš„é‡Šæ”¾ã€‚ - å­æŸ¥è¯¢è¿”å›ä¸€ä¸ªè¡¨ï¼Œè¡¨å‹å­æŸ¥è¯¢ã€‚ select * from (select * from tb where id&gt;0) as subfrom where id&gt;1;-- whereå‹ - å­æŸ¥è¯¢è¿”å›ä¸€ä¸ªå€¼ï¼Œæ ‡é‡å­æŸ¥è¯¢ã€‚ - ä¸éœ€è¦ç»™å­æŸ¥è¯¢å–åˆ«åã€‚ - whereå­æŸ¥è¯¢å†…çš„è¡¨ï¼Œä¸èƒ½ç›´æ¥ç”¨ä»¥æ›´æ–°ã€‚ select * from tb where money = (select max(money) from tb); -- åˆ—å­æŸ¥è¯¢ å¦‚æœå­æŸ¥è¯¢ç»“æœè¿”å›çš„æ˜¯ä¸€åˆ—ã€‚ ä½¿ç”¨ in æˆ– not in å®ŒæˆæŸ¥è¯¢ exists å’Œ not exists æ¡ä»¶ å¦‚æœå­æŸ¥è¯¢è¿”å›æ•°æ®ï¼Œåˆ™è¿”å›1æˆ–0ã€‚å¸¸ç”¨äºåˆ¤æ–­æ¡ä»¶ã€‚ select column1 from t1 where exists (select * from t2); -- è¡Œå­æŸ¥è¯¢ æŸ¥è¯¢æ¡ä»¶æ˜¯ä¸€ä¸ªè¡Œã€‚ select * from t1 where (id, gender) in (select id, gender from t2); è¡Œæ„é€ ç¬¦ï¼š(col1, col2, ...) æˆ– ROW(col1, col2, ...) è¡Œæ„é€ ç¬¦é€šå¸¸ç”¨äºä¸å¯¹èƒ½è¿”å›ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šåˆ—çš„å­æŸ¥è¯¢è¿›è¡Œæ¯”è¾ƒã€‚ -- ç‰¹æ®Šè¿ç®—ç¬¦ != all() ç›¸å½“äº not in = some() ç›¸å½“äº inã€‚any æ˜¯ some çš„åˆ«å != some() ä¸ç­‰åŒäº not inï¼Œä¸ç­‰äºå…¶ä¸­æŸä¸€ä¸ªã€‚ all, some å¯ä»¥é…åˆå…¶ä»–è¿ç®—ç¬¦ä¸€èµ·ä½¿ç”¨ã€‚/* è¿æ¥æŸ¥è¯¢(join) */ ------------------ å°†å¤šä¸ªè¡¨çš„å­—æ®µè¿›è¡Œè¿æ¥ï¼Œå¯ä»¥æŒ‡å®šè¿æ¥æ¡ä»¶ã€‚-- å†…è¿æ¥(inner join) - é»˜è®¤å°±æ˜¯å†…è¿æ¥ï¼Œå¯çœç•¥innerã€‚ - åªæœ‰æ•°æ®å­˜åœ¨æ—¶æ‰èƒ½å‘é€è¿æ¥ã€‚å³è¿æ¥ç»“æœä¸èƒ½å‡ºç°ç©ºè¡Œã€‚ on è¡¨ç¤ºè¿æ¥æ¡ä»¶ã€‚å…¶æ¡ä»¶è¡¨è¾¾å¼ä¸whereç±»ä¼¼ã€‚ä¹Ÿå¯ä»¥çœç•¥æ¡ä»¶ï¼ˆè¡¨ç¤ºæ¡ä»¶æ°¸è¿œä¸ºçœŸï¼‰ ä¹Ÿå¯ç”¨whereè¡¨ç¤ºè¿æ¥æ¡ä»¶ã€‚ è¿˜æœ‰ using, ä½†éœ€å­—æ®µåç›¸åŒã€‚ using(å­—æ®µå) -- äº¤å‰è¿æ¥ cross join å³ï¼Œæ²¡æœ‰æ¡ä»¶çš„å†…è¿æ¥ã€‚ select * from tb1 cross join tb2;-- å¤–è¿æ¥(outer join) - å¦‚æœæ•°æ®ä¸å­˜åœ¨ï¼Œä¹Ÿä¼šå‡ºç°åœ¨è¿æ¥ç»“æœä¸­ã€‚ -- å·¦å¤–è¿æ¥ left join å¦‚æœæ•°æ®ä¸å­˜åœ¨ï¼Œå·¦è¡¨è®°å½•ä¼šå‡ºç°ï¼Œè€Œå³è¡¨ä¸ºnullå¡«å…… -- å³å¤–è¿æ¥ right join å¦‚æœæ•°æ®ä¸å­˜åœ¨ï¼Œå³è¡¨è®°å½•ä¼šå‡ºç°ï¼Œè€Œå·¦è¡¨ä¸ºnullå¡«å……-- è‡ªç„¶è¿æ¥(natural join) è‡ªåŠ¨åˆ¤æ–­è¿æ¥æ¡ä»¶å®Œæˆè¿æ¥ã€‚ ç›¸å½“äºçœç•¥äº†usingï¼Œä¼šè‡ªåŠ¨æŸ¥æ‰¾ç›¸åŒå­—æ®µåã€‚ natural join natural left join natural right joinselect info.id, info.name, info.stu_num, extra_info.hobby, extra_info.sex from info, extra_info where info.stu_num = extra_info.stu_id;/* å¯¼å…¥å¯¼å‡º */ ------------------select * into outfile æ–‡ä»¶åœ°å€ [æ§åˆ¶æ ¼å¼] from è¡¨å; -- å¯¼å‡ºè¡¨æ•°æ®load data [local] infile æ–‡ä»¶åœ°å€ [replace|ignore] into table è¡¨å [æ§åˆ¶æ ¼å¼]; -- å¯¼å…¥æ•°æ® ç”Ÿæˆçš„æ•°æ®é»˜è®¤çš„åˆ†éš”ç¬¦æ˜¯åˆ¶è¡¨ç¬¦ localæœªæŒ‡å®šï¼Œåˆ™æ•°æ®æ–‡ä»¶å¿…é¡»åœ¨æœåŠ¡å™¨ä¸Š replace å’Œ ignore å…³é”®è¯æ§åˆ¶å¯¹ç°æœ‰çš„å”¯ä¸€é”®è®°å½•çš„é‡å¤çš„å¤„ç†-- æ§åˆ¶æ ¼å¼fields æ§åˆ¶å­—æ®µæ ¼å¼é»˜è®¤ï¼šfields terminated by '\\t' enclosed by '' escaped by '\\\\' terminated by 'string' -- ç»ˆæ­¢ enclosed by 'char' -- åŒ…è£¹ escaped by 'char' -- è½¬ä¹‰ -- ç¤ºä¾‹ï¼š SELECT a,b,a+b INTO OUTFILE '/tmp/result.text' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '\"' LINES TERMINATED BY '\\n' FROM test_table;lines æ§åˆ¶è¡Œæ ¼å¼é»˜è®¤ï¼šlines terminated by '\\n' terminated by 'string' -- ç»ˆæ­¢/* INSERT */ ------------------selectè¯­å¥è·å¾—çš„æ•°æ®å¯ä»¥ç”¨insertæ’å…¥ã€‚å¯ä»¥çœç•¥å¯¹åˆ—çš„æŒ‡å®šï¼Œè¦æ±‚ values () æ‹¬å·å†…ï¼Œæä¾›ç»™äº†æŒ‰ç…§åˆ—é¡ºåºå‡ºç°çš„æ‰€æœ‰å­—æ®µçš„å€¼ã€‚ æˆ–è€…ä½¿ç”¨setè¯­æ³•ã€‚ INSERT INTO tbl_name SET field=value,...ï¼›å¯ä»¥ä¸€æ¬¡æ€§ä½¿ç”¨å¤šä¸ªå€¼ï¼Œé‡‡ç”¨(), (), ();çš„å½¢å¼ã€‚ INSERT INTO tbl_name VALUES (), (), ();å¯ä»¥åœ¨åˆ—å€¼æŒ‡å®šæ—¶ï¼Œä½¿ç”¨è¡¨è¾¾å¼ã€‚ INSERT INTO tbl_name VALUES (field_value, 10+10, now());å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç‰¹æ®Šå€¼ DEFAULTï¼Œè¡¨ç¤ºè¯¥åˆ—ä½¿ç”¨é»˜è®¤å€¼ã€‚ INSERT INTO tbl_name VALUES (field_value, DEFAULT);å¯ä»¥é€šè¿‡ä¸€ä¸ªæŸ¥è¯¢çš„ç»“æœï¼Œä½œä¸ºéœ€è¦æ’å…¥çš„å€¼ã€‚ INSERT INTO tbl_name SELECT ...;å¯ä»¥æŒ‡å®šåœ¨æ’å…¥çš„å€¼å‡ºç°ä¸»é”®ï¼ˆæˆ–å”¯ä¸€ç´¢å¼•ï¼‰å†²çªæ—¶ï¼Œæ›´æ–°å…¶ä»–éä¸»é”®åˆ—çš„ä¿¡æ¯ã€‚ INSERT INTO tbl_name VALUES/SET/SELECT ON DUPLICATE KEY UPDATE å­—æ®µ=å€¼, â€¦;/* DELETE */ ------------------DELETE FROM tbl_name [WHERE where_definition] [ORDER BY ...] [LIMIT row_count]æŒ‰ç…§æ¡ä»¶åˆ é™¤ã€‚whereæŒ‡å®šåˆ é™¤çš„æœ€å¤šè®°å½•æ•°ã€‚limitå¯ä»¥é€šè¿‡æ’åºæ¡ä»¶åˆ é™¤ã€‚order by + limitæ”¯æŒå¤šè¡¨åˆ é™¤ï¼Œä½¿ç”¨ç±»ä¼¼è¿æ¥è¯­æ³•ã€‚delete from éœ€è¦åˆ é™¤æ•°æ®å¤šè¡¨1ï¼Œè¡¨2 using è¡¨è¿æ¥æ“ä½œ æ¡ä»¶ã€‚/* TRUNCATE */ ------------------TRUNCATE [TABLE] tbl_nameæ¸…ç©ºæ•°æ®åˆ é™¤é‡å»ºè¡¨åŒºåˆ«ï¼š1ï¼Œtruncate æ˜¯åˆ é™¤è¡¨å†åˆ›å»ºï¼Œdelete æ˜¯é€æ¡åˆ é™¤2ï¼Œtruncate é‡ç½®auto_incrementçš„å€¼ã€‚è€Œdeleteä¸ä¼š3ï¼Œtruncate ä¸çŸ¥é“åˆ é™¤äº†å‡ æ¡ï¼Œè€ŒdeleteçŸ¥é“ã€‚4ï¼Œå½“è¢«ç”¨äºå¸¦åˆ†åŒºçš„è¡¨æ—¶ï¼Œtruncate ä¼šä¿ç•™åˆ†åŒº/* å¤‡ä»½ä¸è¿˜åŸ */ ------------------å¤‡ä»½ï¼Œå°†æ•°æ®çš„ç»“æ„ä¸è¡¨å†…æ•°æ®ä¿å­˜èµ·æ¥ã€‚åˆ©ç”¨ mysqldump æŒ‡ä»¤å®Œæˆã€‚-- å¯¼å‡ºmysqldump [options] db_name [tables]mysqldump [options] ---database DB1 [DB2 DB3...]mysqldump [options] --all--database1. å¯¼å‡ºä¸€å¼ è¡¨ mysqldump -uç”¨æˆ·å -på¯†ç  åº“å è¡¨å &gt; æ–‡ä»¶å(D:/a.sql)2. å¯¼å‡ºå¤šå¼ è¡¨ mysqldump -uç”¨æˆ·å -på¯†ç  åº“å è¡¨1 è¡¨2 è¡¨3 &gt; æ–‡ä»¶å(D:/a.sql)3. å¯¼å‡ºæ‰€æœ‰è¡¨ mysqldump -uç”¨æˆ·å -på¯†ç  åº“å &gt; æ–‡ä»¶å(D:/a.sql)4. å¯¼å‡ºä¸€ä¸ªåº“ mysqldump -uç”¨æˆ·å -på¯†ç  --lock-all-tables --database åº“å &gt; æ–‡ä»¶å(D:/a.sql)å¯ä»¥-wæºå¸¦WHEREæ¡ä»¶-- å¯¼å…¥1. åœ¨ç™»å½•mysqlçš„æƒ…å†µä¸‹ï¼š source å¤‡ä»½æ–‡ä»¶2. åœ¨ä¸ç™»å½•çš„æƒ…å†µä¸‹ mysql -uç”¨æˆ·å -på¯†ç  åº“å &lt; å¤‡ä»½æ–‡ä»¶/* è§†å›¾ */ ------------------ä»€ä¹ˆæ˜¯è§†å›¾ï¼š è§†å›¾æ˜¯ä¸€ä¸ªè™šæ‹Ÿè¡¨ï¼Œå…¶å†…å®¹ç”±æŸ¥è¯¢å®šä¹‰ã€‚åŒçœŸå®çš„è¡¨ä¸€æ ·ï¼Œè§†å›¾åŒ…å«ä¸€ç³»åˆ—å¸¦æœ‰åç§°çš„åˆ—å’Œè¡Œæ•°æ®ã€‚ä½†æ˜¯ï¼Œè§†å›¾å¹¶ä¸åœ¨æ•°æ®åº“ä¸­ä»¥å­˜å‚¨çš„æ•°æ®å€¼é›†å½¢å¼å­˜åœ¨ã€‚è¡Œå’Œåˆ—æ•°æ®æ¥è‡ªç”±å®šä¹‰è§†å›¾çš„æŸ¥è¯¢æ‰€å¼•ç”¨çš„è¡¨ï¼Œå¹¶ä¸”åœ¨å¼•ç”¨è§†å›¾æ—¶åŠ¨æ€ç”Ÿæˆã€‚ è§†å›¾å…·æœ‰è¡¨ç»“æ„æ–‡ä»¶ï¼Œä½†ä¸å­˜åœ¨æ•°æ®æ–‡ä»¶ã€‚ å¯¹å…¶ä¸­æ‰€å¼•ç”¨çš„åŸºç¡€è¡¨æ¥è¯´ï¼Œè§†å›¾çš„ä½œç”¨ç±»ä¼¼äºç­›é€‰ã€‚å®šä¹‰è§†å›¾çš„ç­›é€‰å¯ä»¥æ¥è‡ªå½“å‰æˆ–å…¶å®ƒæ•°æ®åº“çš„ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨ï¼Œæˆ–è€…å…¶å®ƒè§†å›¾ã€‚é€šè¿‡è§†å›¾è¿›è¡ŒæŸ¥è¯¢æ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œé€šè¿‡å®ƒä»¬è¿›è¡Œæ•°æ®ä¿®æ”¹æ—¶çš„é™åˆ¶ä¹Ÿå¾ˆå°‘ã€‚ è§†å›¾æ˜¯å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æŸ¥è¯¢çš„sqlè¯­å¥ï¼Œå®ƒä¸»è¦å‡ºäºä¸¤ç§åŸå› ï¼šå®‰å…¨åŸå› ï¼Œè§†å›¾å¯ä»¥éšè—ä¸€äº›æ•°æ®ï¼Œå¦‚ï¼šç¤¾ä¼šä¿é™©åŸºé‡‘è¡¨ï¼Œå¯ä»¥ç”¨è§†å›¾åªæ˜¾ç¤ºå§“åï¼Œåœ°å€ï¼Œè€Œä¸æ˜¾ç¤ºç¤¾ä¼šä¿é™©å·å’Œå·¥èµ„æ•°ç­‰ï¼Œå¦ä¸€åŸå› æ˜¯å¯ä½¿å¤æ‚çš„æŸ¥è¯¢æ˜“äºç†è§£å’Œä½¿ç”¨ã€‚-- åˆ›å»ºè§†å›¾CREATE [OR REPLACE] [ALGORITHM = {UNDEFINED | MERGE | TEMPTABLE}] VIEW view_name [(column_list)] AS select_statement - è§†å›¾åå¿…é¡»å”¯ä¸€ï¼ŒåŒæ—¶ä¸èƒ½ä¸è¡¨é‡åã€‚ - è§†å›¾å¯ä»¥ä½¿ç”¨selectè¯­å¥æŸ¥è¯¢åˆ°çš„åˆ—åï¼Œä¹Ÿå¯ä»¥è‡ªå·±æŒ‡å®šç›¸åº”çš„åˆ—åã€‚ - å¯ä»¥æŒ‡å®šè§†å›¾æ‰§è¡Œçš„ç®—æ³•ï¼Œé€šè¿‡ALGORITHMæŒ‡å®šã€‚ - column_listå¦‚æœå­˜åœ¨ï¼Œåˆ™æ•°ç›®å¿…é¡»ç­‰äºSELECTè¯­å¥æ£€ç´¢çš„åˆ—æ•°-- æŸ¥çœ‹ç»“æ„ SHOW CREATE VIEW view_name-- åˆ é™¤è§†å›¾ - åˆ é™¤è§†å›¾åï¼Œæ•°æ®ä¾ç„¶å­˜åœ¨ã€‚ - å¯åŒæ—¶åˆ é™¤å¤šä¸ªè§†å›¾ã€‚ DROP VIEW [IF EXISTS] view_name ...-- ä¿®æ”¹è§†å›¾ç»“æ„ - ä¸€èˆ¬ä¸ä¿®æ”¹è§†å›¾ï¼Œå› ä¸ºä¸æ˜¯æ‰€æœ‰çš„æ›´æ–°è§†å›¾éƒ½ä¼šæ˜ å°„åˆ°è¡¨ä¸Šã€‚ ALTER VIEW view_name [(column_list)] AS select_statement-- è§†å›¾ä½œç”¨ 1. ç®€åŒ–ä¸šåŠ¡é€»è¾‘ 2. å¯¹å®¢æˆ·ç«¯éšè—çœŸå®çš„è¡¨ç»“æ„-- è§†å›¾ç®—æ³•(ALGORITHM) MERGE åˆå¹¶ å°†è§†å›¾çš„æŸ¥è¯¢è¯­å¥ï¼Œä¸å¤–éƒ¨æŸ¥è¯¢éœ€è¦å…ˆåˆå¹¶å†æ‰§è¡Œï¼ TEMPTABLE ä¸´æ—¶è¡¨ å°†è§†å›¾æ‰§è¡Œå®Œæ¯•åï¼Œå½¢æˆä¸´æ—¶è¡¨ï¼Œå†åšå¤–å±‚æŸ¥è¯¢ï¼ UNDEFINED æœªå®šä¹‰(é»˜è®¤)ï¼ŒæŒ‡çš„æ˜¯MySQLè‡ªä¸»å»é€‰æ‹©ç›¸åº”çš„ç®—æ³•ã€‚/* äº‹åŠ¡(transaction) */ ------------------äº‹åŠ¡æ˜¯æŒ‡é€»è¾‘ä¸Šçš„ä¸€ç»„æ“ä½œï¼Œç»„æˆè¿™ç»„æ“ä½œçš„å„ä¸ªå•å…ƒï¼Œè¦ä¸å…¨æˆåŠŸè¦ä¸å…¨å¤±è´¥ã€‚ - æ”¯æŒè¿ç»­SQLçš„é›†ä½“æˆåŠŸæˆ–é›†ä½“æ’¤é”€ã€‚ - äº‹åŠ¡æ˜¯æ•°æ®åº“åœ¨æ•°æ®æ™šè‡ªä¹ æ–¹é¢çš„ä¸€ä¸ªåŠŸèƒ½ã€‚ - éœ€è¦åˆ©ç”¨ InnoDB æˆ– BDB å­˜å‚¨å¼•æ“ï¼Œå¯¹è‡ªåŠ¨æäº¤çš„ç‰¹æ€§æ”¯æŒå®Œæˆã€‚ - InnoDBè¢«ç§°ä¸ºäº‹åŠ¡å®‰å…¨å‹å¼•æ“ã€‚-- äº‹åŠ¡å¼€å¯ START TRANSACTION; æˆ–è€… BEGIN; å¼€å¯äº‹åŠ¡åï¼Œæ‰€æœ‰è¢«æ‰§è¡Œçš„SQLè¯­å¥å‡è¢«è®¤ä½œå½“å‰äº‹åŠ¡å†…çš„SQLè¯­å¥ã€‚-- äº‹åŠ¡æäº¤ COMMIT;-- äº‹åŠ¡å›æ»š ROLLBACK; å¦‚æœéƒ¨åˆ†æ“ä½œå‘ç”Ÿé—®é¢˜ï¼Œæ˜ å°„åˆ°äº‹åŠ¡å¼€å¯å‰ã€‚-- äº‹åŠ¡çš„ç‰¹æ€§ 1. åŸå­æ€§ï¼ˆAtomicityï¼‰ äº‹åŠ¡æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¸­çš„æ“ä½œè¦ä¹ˆéƒ½å‘ç”Ÿï¼Œè¦ä¹ˆéƒ½ä¸å‘ç”Ÿã€‚ 2. ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ äº‹åŠ¡å‰åæ•°æ®çš„å®Œæ•´æ€§å¿…é¡»ä¿æŒä¸€è‡´ã€‚ - äº‹åŠ¡å¼€å§‹å’Œç»“æŸæ—¶ï¼Œå¤–éƒ¨æ•°æ®ä¸€è‡´ - åœ¨æ•´ä¸ªäº‹åŠ¡è¿‡ç¨‹ä¸­ï¼Œæ“ä½œæ˜¯è¿ç»­çš„ 3. éš”ç¦»æ€§ï¼ˆIsolationï¼‰ å¤šä¸ªç”¨æˆ·å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œä¸€ä¸ªç”¨æˆ·çš„äº‹åŠ¡ä¸èƒ½è¢«å…¶å®ƒç”¨æˆ·çš„äº‹ç‰©æ‰€å¹²æ‰°ï¼Œå¤šä¸ªå¹¶å‘äº‹åŠ¡ä¹‹é—´çš„æ•°æ®è¦ç›¸äº’éš”ç¦»ã€‚ 4. æŒä¹…æ€§ï¼ˆDurabilityï¼‰ ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦è¢«æäº¤ï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­çš„æ•°æ®æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§çš„ã€‚-- äº‹åŠ¡çš„å®ç° 1. è¦æ±‚æ˜¯äº‹åŠ¡æ”¯æŒçš„è¡¨ç±»å‹ 2. æ‰§è¡Œä¸€ç»„ç›¸å…³çš„æ“ä½œå‰å¼€å¯äº‹åŠ¡ 3. æ•´ç»„æ“ä½œå®Œæˆåï¼Œéƒ½æˆåŠŸï¼Œåˆ™æäº¤ï¼›å¦‚æœå­˜åœ¨å¤±è´¥ï¼Œé€‰æ‹©å›æ»šï¼Œåˆ™ä¼šå›åˆ°äº‹åŠ¡å¼€å§‹çš„å¤‡ä»½ç‚¹ã€‚-- äº‹åŠ¡çš„åŸç† åˆ©ç”¨InnoDBçš„è‡ªåŠ¨æäº¤(autocommit)ç‰¹æ€§å®Œæˆã€‚ æ™®é€šçš„MySQLæ‰§è¡Œè¯­å¥åï¼Œå½“å‰çš„æ•°æ®æäº¤æ“ä½œå‡å¯è¢«å…¶ä»–å®¢æˆ·ç«¯å¯è§ã€‚ è€Œäº‹åŠ¡æ˜¯æš‚æ—¶å…³é—­â€œè‡ªåŠ¨æäº¤â€æœºåˆ¶ï¼Œéœ€è¦commitæäº¤æŒä¹…åŒ–æ•°æ®æ“ä½œã€‚-- æ³¨æ„ 1. æ•°æ®å®šä¹‰è¯­è¨€ï¼ˆDDLï¼‰è¯­å¥ä¸èƒ½è¢«å›æ»šï¼Œæ¯”å¦‚åˆ›å»ºæˆ–å–æ¶ˆæ•°æ®åº“çš„è¯­å¥ï¼Œå’Œåˆ›å»ºã€å–æ¶ˆæˆ–æ›´æ”¹è¡¨æˆ–å­˜å‚¨çš„å­ç¨‹åºçš„è¯­å¥ã€‚ 2. äº‹åŠ¡ä¸èƒ½è¢«åµŒå¥—-- ä¿å­˜ç‚¹ SAVEPOINT ä¿å­˜ç‚¹åç§° -- è®¾ç½®ä¸€ä¸ªäº‹åŠ¡ä¿å­˜ç‚¹ ROLLBACK TO SAVEPOINT ä¿å­˜ç‚¹åç§° -- å›æ»šåˆ°ä¿å­˜ç‚¹ RELEASE SAVEPOINT ä¿å­˜ç‚¹åç§° -- åˆ é™¤ä¿å­˜ç‚¹-- InnoDBè‡ªåŠ¨æäº¤ç‰¹æ€§è®¾ç½® SET autocommit = 0|1; 0è¡¨ç¤ºå…³é—­è‡ªåŠ¨æäº¤ï¼Œ1è¡¨ç¤ºå¼€å¯è‡ªåŠ¨æäº¤ã€‚ - å¦‚æœå…³é—­äº†ï¼Œé‚£æ™®é€šæ“ä½œçš„ç»“æœå¯¹å…¶ä»–å®¢æˆ·ç«¯ä¹Ÿä¸å¯è§ï¼Œéœ€è¦commitæäº¤åæ‰èƒ½æŒä¹…åŒ–æ•°æ®æ“ä½œã€‚ - ä¹Ÿå¯ä»¥å…³é—­è‡ªåŠ¨æäº¤æ¥å¼€å¯äº‹åŠ¡ã€‚ä½†ä¸START TRANSACTIONä¸åŒçš„æ˜¯ï¼Œ SET autocommitæ˜¯æ°¸ä¹…æ”¹å˜æœåŠ¡å™¨çš„è®¾ç½®ï¼Œç›´åˆ°ä¸‹æ¬¡å†æ¬¡ä¿®æ”¹è¯¥è®¾ç½®ã€‚(é’ˆå¯¹å½“å‰è¿æ¥) è€ŒSTART TRANSACTIONè®°å½•å¼€å¯å‰çš„çŠ¶æ€ï¼Œè€Œä¸€æ—¦äº‹åŠ¡æäº¤æˆ–å›æ»šåå°±éœ€è¦å†æ¬¡å¼€å¯äº‹åŠ¡ã€‚(é’ˆå¯¹å½“å‰äº‹åŠ¡)/* é”è¡¨ */è¡¨é”å®šåªç”¨äºé˜²æ­¢å…¶å®ƒå®¢æˆ·ç«¯è¿›è¡Œä¸æ­£å½“åœ°è¯»å–å’Œå†™å…¥MyISAM æ”¯æŒè¡¨é”ï¼ŒInnoDB æ”¯æŒè¡Œé”-- é”å®š LOCK TABLES tbl_name [AS alias]-- è§£é” UNLOCK TABLES/* è§¦å‘å™¨ */ ------------------ è§¦å‘ç¨‹åºæ˜¯ä¸è¡¨æœ‰å…³çš„å‘½åæ•°æ®åº“å¯¹è±¡ï¼Œå½“è¯¥è¡¨å‡ºç°ç‰¹å®šäº‹ä»¶æ—¶ï¼Œå°†æ¿€æ´»è¯¥å¯¹è±¡ ç›‘å¬ï¼šè®°å½•çš„å¢åŠ ã€ä¿®æ”¹ã€åˆ é™¤ã€‚-- åˆ›å»ºè§¦å‘å™¨CREATE TRIGGER trigger_name trigger_time trigger_event ON tbl_name FOR EACH ROW trigger_stmt å‚æ•°ï¼š trigger_timeæ˜¯è§¦å‘ç¨‹åºçš„åŠ¨ä½œæ—¶é—´ã€‚å®ƒå¯ä»¥æ˜¯ before æˆ– afterï¼Œä»¥æŒ‡æ˜è§¦å‘ç¨‹åºæ˜¯åœ¨æ¿€æ´»å®ƒçš„è¯­å¥ä¹‹å‰æˆ–ä¹‹åè§¦å‘ã€‚ trigger_eventæŒ‡æ˜äº†æ¿€æ´»è§¦å‘ç¨‹åºçš„è¯­å¥çš„ç±»å‹ INSERTï¼šå°†æ–°è¡Œæ’å…¥è¡¨æ—¶æ¿€æ´»è§¦å‘ç¨‹åº UPDATEï¼šæ›´æ”¹æŸä¸€è¡Œæ—¶æ¿€æ´»è§¦å‘ç¨‹åº DELETEï¼šä»è¡¨ä¸­åˆ é™¤æŸä¸€è¡Œæ—¶æ¿€æ´»è§¦å‘ç¨‹åº tbl_nameï¼šç›‘å¬çš„è¡¨ï¼Œå¿…é¡»æ˜¯æ°¸ä¹…æ€§çš„è¡¨ï¼Œä¸èƒ½å°†è§¦å‘ç¨‹åºä¸TEMPORARYè¡¨æˆ–è§†å›¾å…³è”èµ·æ¥ã€‚ trigger_stmtï¼šå½“è§¦å‘ç¨‹åºæ¿€æ´»æ—¶æ‰§è¡Œçš„è¯­å¥ã€‚æ‰§è¡Œå¤šä¸ªè¯­å¥ï¼Œå¯ä½¿ç”¨BEGIN...ENDå¤åˆè¯­å¥ç»“æ„-- åˆ é™¤DROP TRIGGER [schema_name.]trigger_nameå¯ä»¥ä½¿ç”¨oldå’Œnewä»£æ›¿æ—§çš„å’Œæ–°çš„æ•°æ® æ›´æ–°æ“ä½œï¼Œæ›´æ–°å‰æ˜¯oldï¼Œæ›´æ–°åæ˜¯new. åˆ é™¤æ“ä½œï¼Œåªæœ‰old. å¢åŠ æ“ä½œï¼Œåªæœ‰new.-- æ³¨æ„ 1. å¯¹äºå…·æœ‰ç›¸åŒè§¦å‘ç¨‹åºåŠ¨ä½œæ—¶é—´å’Œäº‹ä»¶çš„ç»™å®šè¡¨ï¼Œä¸èƒ½æœ‰ä¸¤ä¸ªè§¦å‘ç¨‹åºã€‚-- å­—ç¬¦è¿æ¥å‡½æ•°concat(str1,str2,...])concat_ws(separator,str1,str2,...)-- åˆ†æ”¯è¯­å¥if æ¡ä»¶ then æ‰§è¡Œè¯­å¥elseif æ¡ä»¶ then æ‰§è¡Œè¯­å¥else æ‰§è¡Œè¯­å¥end if;-- ä¿®æ”¹æœ€å¤–å±‚è¯­å¥ç»“æŸç¬¦delimiter è‡ªå®šä¹‰ç»“æŸç¬¦å· SQLè¯­å¥è‡ªå®šä¹‰ç»“æŸç¬¦å·delimiter ; -- ä¿®æ”¹å›åŸæ¥çš„åˆ†å·-- è¯­å¥å—åŒ…è£¹begin è¯­å¥å—end-- ç‰¹æ®Šçš„æ‰§è¡Œ1. åªè¦æ·»åŠ è®°å½•ï¼Œå°±ä¼šè§¦å‘ç¨‹åºã€‚2. Insert into on duplicate key update è¯­æ³•ä¼šè§¦å‘ï¼š å¦‚æœæ²¡æœ‰é‡å¤è®°å½•ï¼Œä¼šè§¦å‘ before insert, after insert; å¦‚æœæœ‰é‡å¤è®°å½•å¹¶æ›´æ–°ï¼Œä¼šè§¦å‘ before insert, before update, after update; å¦‚æœæœ‰é‡å¤è®°å½•ä½†æ˜¯æ²¡æœ‰å‘ç”Ÿæ›´æ–°ï¼Œåˆ™è§¦å‘ before insert, before update3. Replace è¯­æ³• å¦‚æœæœ‰è®°å½•ï¼Œåˆ™æ‰§è¡Œ before insert, before delete, after delete, after insert/* SQLç¼–ç¨‹ */ --------------------// å±€éƒ¨å˜é‡ ------------ å˜é‡å£°æ˜ declare var_name[,...] type [default value] è¿™ä¸ªè¯­å¥è¢«ç”¨æ¥å£°æ˜å±€éƒ¨å˜é‡ã€‚è¦ç»™å˜é‡æä¾›ä¸€ä¸ªé»˜è®¤å€¼ï¼Œè¯·åŒ…å«ä¸€ä¸ªdefaultå­å¥ã€‚å€¼å¯ä»¥è¢«æŒ‡å®šä¸ºä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¸éœ€è¦ä¸ºä¸€ä¸ªå¸¸æ•°ã€‚å¦‚æœæ²¡æœ‰defaultå­å¥ï¼Œåˆå§‹å€¼ä¸ºnullã€‚-- èµ‹å€¼ ä½¿ç”¨ set å’Œ select into è¯­å¥ä¸ºå˜é‡èµ‹å€¼ã€‚ - æ³¨æ„ï¼šåœ¨å‡½æ•°å†…æ˜¯å¯ä»¥ä½¿ç”¨å…¨å±€å˜é‡ï¼ˆç”¨æˆ·è‡ªå®šä¹‰çš„å˜é‡ï¼‰--// å…¨å±€å˜é‡ ------------ å®šä¹‰ã€èµ‹å€¼set è¯­å¥å¯ä»¥å®šä¹‰å¹¶ä¸ºå˜é‡èµ‹å€¼ã€‚set @var = value;ä¹Ÿå¯ä»¥ä½¿ç”¨select intoè¯­å¥ä¸ºå˜é‡åˆå§‹åŒ–å¹¶èµ‹å€¼ã€‚è¿™æ ·è¦æ±‚selectè¯­å¥åªèƒ½è¿”å›ä¸€è¡Œï¼Œä½†æ˜¯å¯ä»¥æ˜¯å¤šä¸ªå­—æ®µï¼Œå°±æ„å‘³ç€åŒæ—¶ä¸ºå¤šä¸ªå˜é‡è¿›è¡Œèµ‹å€¼ï¼Œå˜é‡çš„æ•°é‡éœ€è¦ä¸æŸ¥è¯¢çš„åˆ—æ•°ä¸€è‡´ã€‚è¿˜å¯ä»¥æŠŠèµ‹å€¼è¯­å¥çœ‹ä½œä¸€ä¸ªè¡¨è¾¾å¼ï¼Œé€šè¿‡selectæ‰§è¡Œå®Œæˆã€‚æ­¤æ—¶ä¸ºäº†é¿å…=è¢«å½“ä½œå…³ç³»è¿ç®—ç¬¦çœ‹å¾…ï¼Œä½¿ç”¨:=ä»£æ›¿ã€‚ï¼ˆsetè¯­å¥å¯ä»¥ä½¿ç”¨= å’Œ :=ï¼‰ã€‚select @var:=20;select @v1:=id, @v2=name from t1 limit 1;select * from tbl_name where @var:=30;select into å¯ä»¥å°†è¡¨ä¸­æŸ¥è¯¢è·å¾—çš„æ•°æ®èµ‹ç»™å˜é‡ã€‚ -| select max(height) into @max_height from tb;-- è‡ªå®šä¹‰å˜é‡åä¸ºäº†é¿å…selectè¯­å¥ä¸­ï¼Œç”¨æˆ·è‡ªå®šä¹‰çš„å˜é‡ä¸ç³»ç»Ÿæ ‡è¯†ç¬¦ï¼ˆé€šå¸¸æ˜¯å­—æ®µåï¼‰å†²çªï¼Œç”¨æˆ·è‡ªå®šä¹‰å˜é‡åœ¨å˜é‡åå‰ä½¿ç”¨@ä½œä¸ºå¼€å§‹ç¬¦å·ã€‚@var=10; - å˜é‡è¢«å®šä¹‰åï¼Œåœ¨æ•´ä¸ªä¼šè¯å‘¨æœŸéƒ½æœ‰æ•ˆï¼ˆç™»å½•åˆ°é€€å‡ºï¼‰--// æ§åˆ¶ç»“æ„ ------------ ifè¯­å¥if search_condition then statement_list [elseif search_condition then statement_list]...[else statement_list]end if;-- caseè¯­å¥CASE value WHEN [compare-value] THEN result[WHEN [compare-value] THEN result ...][ELSE result]END-- whileå¾ªç¯[begin_label:] while search_condition do statement_listend while [end_label];- å¦‚æœéœ€è¦åœ¨å¾ªç¯å†…æå‰ç»ˆæ­¢ whileå¾ªç¯ï¼Œåˆ™éœ€è¦ä½¿ç”¨æ ‡ç­¾ï¼›æ ‡ç­¾éœ€è¦æˆå¯¹å‡ºç°ã€‚ -- é€€å‡ºå¾ªç¯ é€€å‡ºæ•´ä¸ªå¾ªç¯ leave é€€å‡ºå½“å‰å¾ªç¯ iterate é€šè¿‡é€€å‡ºçš„æ ‡ç­¾å†³å®šé€€å‡ºå“ªä¸ªå¾ªç¯--// å†…ç½®å‡½æ•° ------------ æ•°å€¼å‡½æ•°abs(x) -- ç»å¯¹å€¼ abs(-10.9) = 10format(x, d) -- æ ¼å¼åŒ–åƒåˆ†ä½æ•°å€¼ format(1234567.456, 2) = 1,234,567.46ceil(x) -- å‘ä¸Šå–æ•´ ceil(10.1) = 11floor(x) -- å‘ä¸‹å–æ•´ floor (10.1) = 10round(x) -- å››èˆäº”å…¥å»æ•´mod(m, n) -- m%n m mod n æ±‚ä½™ 10%3=1pi() -- è·å¾—åœ†å‘¨ç‡pow(m, n) -- m^nsqrt(x) -- ç®—æœ¯å¹³æ–¹æ ¹rand() -- éšæœºæ•°truncate(x, d) -- æˆªå–dä½å°æ•°-- æ—¶é—´æ—¥æœŸå‡½æ•°now(), current_timestamp(); -- å½“å‰æ—¥æœŸæ—¶é—´current_date(); -- å½“å‰æ—¥æœŸcurrent_time(); -- å½“å‰æ—¶é—´date('yyyy-mm-dd hh:ii:ss'); -- è·å–æ—¥æœŸéƒ¨åˆ†time('yyyy-mm-dd hh:ii:ss'); -- è·å–æ—¶é—´éƒ¨åˆ†date_format('yyyy-mm-dd hh:ii:ss', '%d %y %a %d %m %b %j'); -- æ ¼å¼åŒ–æ—¶é—´unix_timestamp(); -- è·å¾—unixæ—¶é—´æˆ³from_unixtime(); -- ä»æ—¶é—´æˆ³è·å¾—æ—¶é—´-- å­—ç¬¦ä¸²å‡½æ•°length(string) -- stringé•¿åº¦ï¼Œå­—èŠ‚char_length(string) -- stringçš„å­—ç¬¦ä¸ªæ•°substring(str, position [,length]) -- ä»strçš„positionå¼€å§‹,å–lengthä¸ªå­—ç¬¦replace(str ,search_str ,replace_str) -- åœ¨strä¸­ç”¨replace_stræ›¿æ¢search_strinstr(string ,substring) -- è¿”å›substringé¦–æ¬¡åœ¨stringä¸­å‡ºç°çš„ä½ç½®concat(string [,...]) -- è¿æ¥å­—ä¸²charset(str) -- è¿”å›å­—ä¸²å­—ç¬¦é›†lcase(string) -- è½¬æ¢æˆå°å†™left(string, length) -- ä»string2ä¸­çš„å·¦è¾¹èµ·å–lengthä¸ªå­—ç¬¦load_file(file_name) -- ä»æ–‡ä»¶è¯»å–å†…å®¹locate(substring, string [,start_position]) -- åŒinstr,ä½†å¯æŒ‡å®šå¼€å§‹ä½ç½®lpad(string, length, pad) -- é‡å¤ç”¨padåŠ åœ¨stringå¼€å¤´,ç›´åˆ°å­—ä¸²é•¿åº¦ä¸ºlengthltrim(string) -- å»é™¤å‰ç«¯ç©ºæ ¼repeat(string, count) -- é‡å¤countæ¬¡rpad(string, length, pad) --åœ¨stråç”¨padè¡¥å……,ç›´åˆ°é•¿åº¦ä¸ºlengthrtrim(string) -- å»é™¤åç«¯ç©ºæ ¼strcmp(string1 ,string2) -- é€å­—ç¬¦æ¯”è¾ƒä¸¤å­—ä¸²å¤§å°-- æµç¨‹å‡½æ•°case when [condition] then result [when [condition] then result ...] [else result] end å¤šåˆ†æ”¯if(expr1,expr2,expr3) åŒåˆ†æ”¯ã€‚-- èšåˆå‡½æ•°count()sum();max();min();avg();group_concat()-- å…¶ä»–å¸¸ç”¨å‡½æ•°md5();default();--// å­˜å‚¨å‡½æ•°ï¼Œè‡ªå®šä¹‰å‡½æ•° ------------ æ–°å»º CREATE FUNCTION function_name (å‚æ•°åˆ—è¡¨) RETURNS è¿”å›å€¼ç±»å‹ å‡½æ•°ä½“ - å‡½æ•°åï¼Œåº”è¯¥åˆæ³•çš„æ ‡è¯†ç¬¦ï¼Œå¹¶ä¸”ä¸åº”è¯¥ä¸å·²æœ‰çš„å…³é”®å­—å†²çªã€‚ - ä¸€ä¸ªå‡½æ•°åº”è¯¥å±äºæŸä¸ªæ•°æ®åº“ï¼Œå¯ä»¥ä½¿ç”¨db_name.funciton_nameçš„å½¢å¼æ‰§è¡Œå½“å‰å‡½æ•°æ‰€å±æ•°æ®åº“ï¼Œå¦åˆ™ä¸ºå½“å‰æ•°æ®åº“ã€‚ - å‚æ•°éƒ¨åˆ†ï¼Œç”±\"å‚æ•°å\"å’Œ\"å‚æ•°ç±»å‹\"ç»„æˆã€‚å¤šä¸ªå‚æ•°ç”¨é€—å·éš”å¼€ã€‚ - å‡½æ•°ä½“ç”±å¤šæ¡å¯ç”¨çš„mysqlè¯­å¥ï¼Œæµç¨‹æ§åˆ¶ï¼Œå˜é‡å£°æ˜ç­‰è¯­å¥æ„æˆã€‚ - å¤šæ¡è¯­å¥åº”è¯¥ä½¿ç”¨ begin...end è¯­å¥å—åŒ…å«ã€‚ - ä¸€å®šè¦æœ‰ return è¿”å›å€¼è¯­å¥ã€‚-- åˆ é™¤ DROP FUNCTION [IF EXISTS] function_name;-- æŸ¥çœ‹ SHOW FUNCTION STATUS LIKE 'partten' SHOW CREATE FUNCTION function_name;-- ä¿®æ”¹ ALTER FUNCTION function_name å‡½æ•°é€‰é¡¹--// å­˜å‚¨è¿‡ç¨‹ï¼Œè‡ªå®šä¹‰åŠŸèƒ½ ------------ å®šä¹‰å­˜å‚¨å­˜å‚¨è¿‡ç¨‹ æ˜¯ä¸€æ®µä»£ç ï¼ˆè¿‡ç¨‹ï¼‰ï¼Œå­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„sqlç»„æˆã€‚ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹é€šå¸¸ç”¨äºå®Œæˆä¸€æ®µä¸šåŠ¡é€»è¾‘ï¼Œä¾‹å¦‚æŠ¥åï¼Œäº¤ç­è´¹ï¼Œè®¢å•å…¥åº“ç­‰ã€‚è€Œä¸€ä¸ªå‡½æ•°é€šå¸¸ä¸“æ³¨ä¸æŸä¸ªåŠŸèƒ½ï¼Œè§†ä¸ºå…¶ä»–ç¨‹åºæœåŠ¡çš„ï¼Œéœ€è¦åœ¨å…¶ä»–è¯­å¥ä¸­è°ƒç”¨å‡½æ•°æ‰å¯ä»¥ï¼Œè€Œå­˜å‚¨è¿‡ç¨‹ä¸èƒ½è¢«å…¶ä»–è°ƒç”¨ï¼Œæ˜¯è‡ªå·±æ‰§è¡Œ é€šè¿‡callæ‰§è¡Œã€‚-- åˆ›å»ºCREATE PROCEDURE sp_name (å‚æ•°åˆ—è¡¨) è¿‡ç¨‹ä½“å‚æ•°åˆ—è¡¨ï¼šä¸åŒäºå‡½æ•°çš„å‚æ•°åˆ—è¡¨ï¼Œéœ€è¦æŒ‡æ˜å‚æ•°ç±»å‹INï¼Œè¡¨ç¤ºè¾“å…¥å‹OUTï¼Œè¡¨ç¤ºè¾“å‡ºå‹INOUTï¼Œè¡¨ç¤ºæ··åˆå‹æ³¨æ„ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚/* å­˜å‚¨è¿‡ç¨‹ */ ------------------å­˜å‚¨è¿‡ç¨‹æ˜¯ä¸€æ®µå¯æ‰§è¡Œæ€§ä»£ç çš„é›†åˆã€‚ç›¸æ¯”å‡½æ•°ï¼Œæ›´åå‘äºä¸šåŠ¡é€»è¾‘ã€‚è°ƒç”¨ï¼šCALL è¿‡ç¨‹å-- æ³¨æ„- æ²¡æœ‰è¿”å›å€¼ã€‚- åªèƒ½å•ç‹¬è°ƒç”¨ï¼Œä¸å¯å¤¹æ‚åœ¨å…¶ä»–è¯­å¥ä¸­-- å‚æ•°IN|OUT|INOUT å‚æ•°å æ•°æ®ç±»å‹IN è¾“å…¥ï¼šåœ¨è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œå°†æ•°æ®è¾“å…¥åˆ°è¿‡ç¨‹ä½“å†…éƒ¨çš„å‚æ•°OUT è¾“å‡ºï¼šåœ¨è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œå°†è¿‡ç¨‹ä½“å¤„ç†å®Œçš„ç»“æœè¿”å›åˆ°å®¢æˆ·ç«¯INOUT è¾“å…¥è¾“å‡ºï¼šæ—¢å¯è¾“å…¥ï¼Œä¹Ÿå¯è¾“å‡º-- è¯­æ³•CREATE PROCEDURE è¿‡ç¨‹å (å‚æ•°åˆ—è¡¨)BEGIN è¿‡ç¨‹ä½“END/* ç”¨æˆ·å’Œæƒé™ç®¡ç† */ -------------------- rootå¯†ç é‡ç½®1. åœæ­¢MySQLæœåŠ¡2. [Linux] /usr/local/mysql/bin/safe_mysqld --skip-grant-tables &amp; [Windows] mysqld --skip-grant-tables3. use mysql;4. UPDATE `user` SET PASSWORD=PASSWORD(\"å¯†ç \") WHERE `user` = \"root\";5. FLUSH PRIVILEGES;ç”¨æˆ·ä¿¡æ¯è¡¨ï¼šmysql.user-- åˆ·æ–°æƒé™FLUSH PRIVILEGES;-- å¢åŠ ç”¨æˆ·CREATE USER ç”¨æˆ·å IDENTIFIED BY [PASSWORD] å¯†ç (å­—ç¬¦ä¸²) - å¿…é¡»æ‹¥æœ‰mysqlæ•°æ®åº“çš„å…¨å±€CREATE USERæƒé™ï¼Œæˆ–æ‹¥æœ‰INSERTæƒé™ã€‚ - åªèƒ½åˆ›å»ºç”¨æˆ·ï¼Œä¸èƒ½èµ‹äºˆæƒé™ã€‚ - ç”¨æˆ·åï¼Œæ³¨æ„å¼•å·ï¼šå¦‚ 'user_name'@'192.168.1.1' - å¯†ç ä¹Ÿéœ€å¼•å·ï¼Œçº¯æ•°å­—å¯†ç ä¹Ÿè¦åŠ å¼•å· - è¦åœ¨çº¯æ–‡æœ¬ä¸­æŒ‡å®šå¯†ç ï¼Œéœ€å¿½ç•¥PASSWORDå…³é”®è¯ã€‚è¦æŠŠå¯†ç æŒ‡å®šä¸ºç”±PASSWORD()å‡½æ•°è¿”å›çš„æ··ç¼–å€¼ï¼Œéœ€åŒ…å«å…³é”®å­—PASSWORD-- é‡å‘½åç”¨æˆ·RENAME USER old_user TO new_user-- è®¾ç½®å¯†ç SET PASSWORD = PASSWORD('å¯†ç ') -- ä¸ºå½“å‰ç”¨æˆ·è®¾ç½®å¯†ç SET PASSWORD FOR ç”¨æˆ·å = PASSWORD('å¯†ç ') -- ä¸ºæŒ‡å®šç”¨æˆ·è®¾ç½®å¯†ç -- åˆ é™¤ç”¨æˆ·DROP USER ç”¨æˆ·å-- åˆ†é…æƒé™/æ·»åŠ ç”¨æˆ·GRANT æƒé™åˆ—è¡¨ ON è¡¨å TO ç”¨æˆ·å [IDENTIFIED BY [PASSWORD] 'password'] - all privileges è¡¨ç¤ºæ‰€æœ‰æƒé™ - *.* è¡¨ç¤ºæ‰€æœ‰åº“çš„æ‰€æœ‰è¡¨ - åº“å.è¡¨å è¡¨ç¤ºæŸåº“ä¸‹é¢çš„æŸè¡¨ GRANT ALL PRIVILEGES ON `pms`.* TO 'pms'@'%' IDENTIFIED BY 'pms0817';-- æŸ¥çœ‹æƒé™SHOW GRANTS FOR ç”¨æˆ·å -- æŸ¥çœ‹å½“å‰ç”¨æˆ·æƒé™ SHOW GRANTS; æˆ– SHOW GRANTS FOR CURRENT_USER; æˆ– SHOW GRANTS FOR CURRENT_USER();-- æ’¤æ¶ˆæƒé™REVOKE æƒé™åˆ—è¡¨ ON è¡¨å FROM ç”¨æˆ·åREVOKE ALL PRIVILEGES, GRANT OPTION FROM ç”¨æˆ·å -- æ’¤é”€æ‰€æœ‰æƒé™-- æƒé™å±‚çº§-- è¦ä½¿ç”¨GRANTæˆ–REVOKEï¼Œæ‚¨å¿…é¡»æ‹¥æœ‰GRANT OPTIONæƒé™ï¼Œå¹¶ä¸”æ‚¨å¿…é¡»ç”¨äºæ‚¨æ­£åœ¨æˆäºˆæˆ–æ’¤é”€çš„æƒé™ã€‚å…¨å±€å±‚çº§ï¼šå…¨å±€æƒé™é€‚ç”¨äºä¸€ä¸ªç»™å®šæœåŠ¡å™¨ä¸­çš„æ‰€æœ‰æ•°æ®åº“ï¼Œmysql.user GRANT ALL ON *.*å’Œ REVOKE ALL ON *.*åªæˆäºˆå’Œæ’¤é”€å…¨å±€æƒé™ã€‚æ•°æ®åº“å±‚çº§ï¼šæ•°æ®åº“æƒé™é€‚ç”¨äºä¸€ä¸ªç»™å®šæ•°æ®åº“ä¸­çš„æ‰€æœ‰ç›®æ ‡ï¼Œmysql.db, mysql.host GRANT ALL ON db_name.*å’ŒREVOKE ALL ON db_name.*åªæˆäºˆå’Œæ’¤é”€æ•°æ®åº“æƒé™ã€‚è¡¨å±‚çº§ï¼šè¡¨æƒé™é€‚ç”¨äºä¸€ä¸ªç»™å®šè¡¨ä¸­çš„æ‰€æœ‰åˆ—ï¼Œmysql.talbes_priv GRANT ALL ON db_name.tbl_nameå’ŒREVOKE ALL ON db_name.tbl_nameåªæˆäºˆå’Œæ’¤é”€è¡¨æƒé™ã€‚åˆ—å±‚çº§ï¼šåˆ—æƒé™é€‚ç”¨äºä¸€ä¸ªç»™å®šè¡¨ä¸­çš„å•ä¸€åˆ—ï¼Œmysql.columns_priv å½“ä½¿ç”¨REVOKEæ—¶ï¼Œæ‚¨å¿…é¡»æŒ‡å®šä¸è¢«æˆæƒåˆ—ç›¸åŒçš„åˆ—ã€‚-- æƒé™åˆ—è¡¨ALL [PRIVILEGES] -- è®¾ç½®é™¤GRANT OPTIONä¹‹å¤–çš„æ‰€æœ‰ç®€å•æƒé™ALTER -- å…è®¸ä½¿ç”¨ALTER TABLEALTER ROUTINE -- æ›´æ”¹æˆ–å–æ¶ˆå·²å­˜å‚¨çš„å­ç¨‹åºCREATE -- å…è®¸ä½¿ç”¨CREATE TABLECREATE ROUTINE -- åˆ›å»ºå·²å­˜å‚¨çš„å­ç¨‹åºCREATE TEMPORARY TABLES -- å…è®¸ä½¿ç”¨CREATE TEMPORARY TABLECREATE USER -- å…è®¸ä½¿ç”¨CREATE USER, DROP USER, RENAME USERå’ŒREVOKE ALL PRIVILEGESã€‚CREATE VIEW -- å…è®¸ä½¿ç”¨CREATE VIEWDELETE -- å…è®¸ä½¿ç”¨DELETEDROP -- å…è®¸ä½¿ç”¨DROP TABLEEXECUTE -- å…è®¸ç”¨æˆ·è¿è¡Œå·²å­˜å‚¨çš„å­ç¨‹åºFILE -- å…è®¸ä½¿ç”¨SELECT...INTO OUTFILEå’ŒLOAD DATA INFILEINDEX -- å…è®¸ä½¿ç”¨CREATE INDEXå’ŒDROP INDEXINSERT -- å…è®¸ä½¿ç”¨INSERTLOCK TABLES -- å…è®¸å¯¹æ‚¨æ‹¥æœ‰SELECTæƒé™çš„è¡¨ä½¿ç”¨LOCK TABLESPROCESS -- å…è®¸ä½¿ç”¨SHOW FULL PROCESSLISTREFERENCES -- æœªè¢«å®æ–½RELOAD -- å…è®¸ä½¿ç”¨FLUSHREPLICATION CLIENT -- å…è®¸ç”¨æˆ·è¯¢é—®ä»å±æœåŠ¡å™¨æˆ–ä¸»æœåŠ¡å™¨çš„åœ°å€REPLICATION SLAVE -- ç”¨äºå¤åˆ¶å‹ä»å±æœåŠ¡å™¨ï¼ˆä»ä¸»æœåŠ¡å™¨ä¸­è¯»å–äºŒè¿›åˆ¶æ—¥å¿—äº‹ä»¶ï¼‰SELECT -- å…è®¸ä½¿ç”¨SELECTSHOW DATABASES -- æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“SHOW VIEW -- å…è®¸ä½¿ç”¨SHOW CREATE VIEWSHUTDOWN -- å…è®¸ä½¿ç”¨mysqladmin shutdownSUPER -- å…è®¸ä½¿ç”¨CHANGE MASTER, KILL, PURGE MASTER LOGSå’ŒSET GLOBALè¯­å¥ï¼Œmysqladmin debugå‘½ä»¤ï¼›å…è®¸æ‚¨è¿æ¥ï¼ˆä¸€æ¬¡ï¼‰ï¼Œå³ä½¿å·²è¾¾åˆ°max_connectionsã€‚UPDATE -- å…è®¸ä½¿ç”¨UPDATEUSAGE -- â€œæ— æƒé™â€çš„åŒä¹‰è¯GRANT OPTION -- å…è®¸æˆäºˆæƒé™/* è¡¨ç»´æŠ¤ */-- åˆ†æå’Œå­˜å‚¨è¡¨çš„å…³é”®å­—åˆ†å¸ƒANALYZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE è¡¨å ...-- æ£€æŸ¥ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨æ˜¯å¦æœ‰é”™è¯¯CHECK TABLE tbl_name [, tbl_name] ... [option] ...option = {QUICK | FAST | MEDIUM | EXTENDED | CHANGED}-- æ•´ç†æ•°æ®æ–‡ä»¶çš„ç¢ç‰‡OPTIMIZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] .../* æ‚é¡¹ */ ------------------1. å¯ç”¨åå¼•å·ï¼ˆ`ï¼‰ä¸ºæ ‡è¯†ç¬¦ï¼ˆåº“åã€è¡¨åã€å­—æ®µåã€ç´¢å¼•ã€åˆ«åï¼‰åŒ…è£¹ï¼Œä»¥é¿å…ä¸å…³é”®å­—é‡åï¼ä¸­æ–‡ä¹Ÿå¯ä»¥ä½œä¸ºæ ‡è¯†ç¬¦ï¼2. æ¯ä¸ªåº“ç›®å½•å­˜åœ¨ä¸€ä¸ªä¿å­˜å½“å‰æ•°æ®åº“çš„é€‰é¡¹æ–‡ä»¶db.optã€‚3. æ³¨é‡Šï¼š å•è¡Œæ³¨é‡Š # æ³¨é‡Šå†…å®¹ å¤šè¡Œæ³¨é‡Š /* æ³¨é‡Šå†…å®¹ */ å•è¡Œæ³¨é‡Š -- æ³¨é‡Šå†…å®¹ (æ ‡å‡†SQLæ³¨é‡Šé£æ ¼ï¼Œè¦æ±‚åŒç ´æŠ˜å·ååŠ ä¸€ç©ºæ ¼ç¬¦ï¼ˆç©ºæ ¼ã€TABã€æ¢è¡Œç­‰ï¼‰)4. æ¨¡å¼é€šé…ç¬¦ï¼š _ ä»»æ„å•ä¸ªå­—ç¬¦ % ä»»æ„å¤šä¸ªå­—ç¬¦ï¼Œç”šè‡³åŒ…æ‹¬é›¶å­—ç¬¦ å•å¼•å·éœ€è¦è¿›è¡Œè½¬ä¹‰ \\'5. CMDå‘½ä»¤è¡Œå†…çš„è¯­å¥ç»“æŸç¬¦å¯ä»¥ä¸º \";\", \"\\G\", \"\\g\"ï¼Œä»…å½±å“æ˜¾ç¤ºç»“æœã€‚å…¶ä»–åœ°æ–¹è¿˜æ˜¯ç”¨åˆ†å·ç»“æŸã€‚delimiter å¯ä¿®æ”¹å½“å‰å¯¹è¯çš„è¯­å¥ç»“æŸç¬¦ã€‚6. SQLå¯¹å¤§å°å†™ä¸æ•æ„Ÿ7. æ¸…é™¤å·²æœ‰è¯­å¥ï¼š\\c","link":"/2019/04/18/ä¸€åƒè¡Œ-MySQL-å­¦ä¹ ç¬”è®°-è½¬è½½.html"},{"title":"å®‰è£…ã€éƒ¨åˆ†é…ç½®icarusä¸»é¢˜ä¸­æ–‡ç‰ˆ","text":"æ‘˜è¦å‘ç°icarusä¸»é¢˜è¿˜ä¸é”™ï¼ŒèŠ±äº†ä¸€ä¸¤ä¸ªå°æ—¶ç ”ç©¶äº†ä¸‹å®‰è£…ã€éƒ¨åˆ†é…ç½®icarusä¸»é¢˜ä¸­æ–‡ç‰ˆ å®‰è£…icarus ç›´æ¥ä¸‹è½½ä¸»é¢˜æ¨¡å—æ”¾åˆ°blogé¡¹ç›® ,blogé¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ 1git clone https://github.com/ppoffice/hexo-theme-icarus.git themes/icarus æ­¤æ—¶å·²ç»ä¸‹è½½åˆ°é¡¹ç›®ä¸­ã€‚ é¡¶çº§_config.ymlä¸­é€‰æ‹©icarusä¸»é¢˜ 1234# Extensions## Plugins: https://hexo.io/plugins/## Themes: https://hexo.io/themes/theme: icarus æ­¤æ—¶ä¸»é¢˜å·²ç»å®‰è£…å¥½ï¼Œæ¸…é™¤ã€ç¼–è¯‘ã€éƒ¨ç½²å¯ä»¥çœ‹åˆ°æ•ˆæœäº† é…ç½®icarus å®Œå…¨å‚ç…§å®˜ç½‘é…ç½®ï¼Œè¿›è¡Œç¿»è¯‘è§£è¯´ é…ç½®æ–‡ç« éƒ¨åˆ†é¡¶éƒ¨å›¾ç‰‡æ·»åŠ icarus ä¸»é¢˜ä¸­çš„é…ç½®_config.ymlä¸­å¼€å¯å›¾ç‰‡å¼€å…³ 12article: thumbnail: true æ–‡ç« .mdæ–‡ä»¶å¤´ä¸­æ·»åŠ å›¾ç‰‡ç»å¯¹/ç›¸å¯¹åœ°å€ 12345title: Getting Started with Icarusthumbnail: /gallery/thumbnails/desert.jpg// thumbnail:https://raw.githubusercontent.com/removeif/blog_image/master/20190620152744.png---Post content... é…ç½®å®Œæˆåéƒ¨ç½²æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹(æœ€æ–°æ–‡ç« åˆ—è¡¨æ˜¾ç¤ºç¼©ç•¥å›¾ã€æ–‡ç« å¼€å¤´æ˜¾ç¤ºä¸€å¼ è®¾ç½®å›¾ç‰‡) å·¦è¾¹æ–‡ç« å¯¼èˆªæ å¼€å¯icarus ä¸»é¢˜ä¸­çš„é…ç½®_config.ymlä¸­å¼€å…³ 1234widgets: - type: toc position: left åŒäº‹æ–‡ç« é¡¶éƒ¨åŠ å…¥æ ‡ç­¾ 1234title: Table of Contents Exampletoc: true---Post content... é…ç½®æ•ˆæœ è¯„è®ºç³»ç»Ÿå¼€å¯icarus ä¸»é¢˜ä¸­çš„é…ç½®_config.ymlä¸­å¼€å¯ï¼ˆéƒ¨åˆ†è¯„è®ºç³»ç»Ÿéœ€è¦ç¿»å¢™æ‰èƒ½ä½¿ç”¨ï¼Œvalineä¸ç”¨ç¿»å¢™ä¸ªäººæ¨èï¼Œvalineå®‰è£…å‚è€ƒï¼‰ 1234567comment: type: valine app_id: xxxxxxxx # (required) LeanCloud application id app_key: xxxxxxxx # (required) LeanCloud application key notify: false # (optional) receive email notification verify: false # (optional) show verification code placeholder: xxxxxxxx # (optional) comment box placeholder text å¼€å¯æ•ˆæœ æèµ æ”¶æ¬¾å¼€å¯icarus ä¸»é¢˜ä¸­çš„é…ç½®_config.ymlä¸­å¼€å¯ æ³¨æ„å¦‚æœé»˜è®¤ä¸é…ç½®ï¼Œç¼–è¯‘æ—¶æœ‰æŠ¥é”™ï¼Œå¯ä»¥# æŠŠå®ƒæ³¨é‡Šæ‰ï¼Œä¸å¯ç”¨åŠŸèƒ½ 1234567891011donate: - # Donation entry name type: alipay # Qrcode image URL qrcode: 'https://wx2.sinaimg.cn/large/b5d1b710gy1g0lvxdcwm0j20p011i4bg.jpg' - # Donation entry name type: wechat # Qrcode image URL qrcode: 'https://wx2.sinaimg.cn/large/b5d1b710gy1g0lvwdcpb5j20u014qgy2.jpg' å¼€å¯é…ç½®æ•ˆæœå¦‚ä¸‹ å…¨å±€æœç´¢å¼€å¯icarus ä¸»é¢˜ä¸­çš„é…ç½®_config.ymlä¸­å¼€å¯,ä¸åŒçš„æœç´¢ç±»å‹éœ€è¦å®‰è£…æ’ä»¶å‚è€ƒå®˜ç½‘,type: insightæ­¤ç±»å‹ä¸éœ€è¦å®‰è£…ï¼Œå·²ç»å†…ç½® 12search: type: insight æ•ˆæœå¦‚ä¸‹ æ›´å¤šé…ç½®è¯·å‚è€ƒå®˜ç½‘é…ç½®ç›®å‰é…ç½®åŸºæœ¬å·²ç»å¤Ÿä½¿ç”¨ï¼Œè¿˜éœ€è¦æ›´å¤šé…ç½®è¯·å‚è€ƒè¿æ¥ å‚è€ƒè‡ª","link":"/2019/02/28/å®‰è£…ã€éƒ¨åˆ†é…ç½®icarusä¸»é¢˜ä¸­æ–‡ç‰ˆ.html"},{"title":"javaåŸºç¡€-staticå…³é”®å­—","text":"staticç”¨æ³• staticå’Œfinalæ˜¯ä¸¤ä¸ªæˆ‘ä»¬å¿…é¡»æŒæ¡çš„å…³é”®å­—ã€‚ä¸åŒäºå…¶ä»–å…³é”®å­—ï¼Œä»–ä»¬éƒ½æœ‰å¤šç§ç”¨æ³•ï¼Œè€Œä¸”åœ¨ä¸€å®šç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œå¯ä»¥æé«˜ç¨‹åºçš„è¿è¡Œæ€§èƒ½ï¼Œä¼˜åŒ–ç¨‹åºçš„ç»“æ„ã€‚ä¸‹é¢æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹staticå…³é”®å­—åŠå…¶ç”¨æ³•ã€‚ ä¿®é¥°æˆå‘˜å˜é‡åœ¨æˆ‘ä»¬å¹³æ—¶çš„ä½¿ç”¨å½“ä¸­ï¼Œstaticæœ€å¸¸ç”¨çš„åŠŸèƒ½å°±æ˜¯ä¿®é¥°ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œè®©ä»–ä»¬æˆä¸ºç±»çš„æˆå‘˜å±æ€§å’Œæ–¹æ³•ï¼Œæˆ‘ä»¬é€šå¸¸å°†ç”¨staticä¿®é¥°çš„æˆå‘˜ç§°ä¸ºç±»æˆå‘˜æˆ–è€…é™æ€æˆå‘˜ã€‚ 1234567891011121314151617181920212223public class Person { String name; int age; public String toString() { return \"Name:\" + name + \", Age:\" + age; } public static void main(String[] args) { Person p1 = new Person(); p1.name = \"zhangsan\"; p1.age = 10; Person p2 = new Person(); p2.name = \"lisi\"; p2.age = 12; System.out.println(p1); System.out.println(p2); } /**Output * Name:zhangsan, Age:10 * Name:lisi, Age:12 *///~} æ ¹æ®Personæ„é€ å‡ºçš„æ¯ä¸€ä¸ªå¯¹è±¡éƒ½æ˜¯ç‹¬ç«‹å­˜åœ¨çš„ï¼Œä¿å­˜æœ‰è‡ªå·±ç‹¬ç«‹çš„æˆå‘˜å˜é‡ï¼Œç›¸äº’ä¸ä¼šå½±å“ï¼Œä»–ä»¬åœ¨å†…å­˜ä¸­çš„ç¤ºæ„å¦‚ä¸‹: ä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œp1å’Œp2ä¸¤ä¸ªå˜é‡å¼•ç”¨çš„å¯¹è±¡åˆ†åˆ«å­˜å‚¨åœ¨å†…å­˜ä¸­å †åŒºåŸŸçš„ä¸åŒåœ°å€ä¸­ï¼Œæ‰€ä»¥ä»–ä»¬ä¹‹é—´ç›¸äº’ä¸ä¼šå¹²æ‰°ã€‚ä½†å…¶å®ï¼Œåœ¨è¿™å½“ä¸­ï¼Œæˆ‘ä»¬çœç•¥äº†ä¸€äº›é‡è¦ä¿¡æ¯ï¼Œç›¸ä¿¡å¤§å®¶ä¹Ÿéƒ½ä¼šæƒ³åˆ°ï¼Œå¯¹è±¡çš„æˆå‘˜å±æ€§éƒ½åœ¨è¿™äº†ï¼Œç”±æ¯ä¸ªå¯¹è±¡è‡ªå·±ä¿å­˜ï¼Œé‚£ä¹ˆä»–ä»¬çš„æ–¹æ³•å‘¢ï¼Ÿå®é™…ä¸Šï¼Œä¸è®ºä¸€ä¸ªç±»åˆ›å»ºäº†å‡ ä¸ªå¯¹è±¡ï¼Œä»–ä»¬çš„æ–¹æ³•éƒ½æ˜¯ä¸€æ ·çš„ï¼š ä»ä¸Šé¢çš„å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸¤ä¸ªPersonå¯¹è±¡çš„æ–¹æ³•å®é™…ä¸Šåªæ˜¯æŒ‡å‘äº†åŒä¸€ä¸ªæ–¹æ³•å®šä¹‰ã€‚è¿™ä¸ªæ–¹æ³•å®šä¹‰æ˜¯ä½äºå†…å­˜ä¸­çš„ä¸€å—ä¸å˜åŒºåŸŸï¼ˆç”±jvmåˆ’åˆ†ï¼‰ï¼Œæˆ‘ä»¬æš‚ç§°å®ƒä¸ºé™æ€å­˜å‚¨åŒºã€‚è¿™ä¸€å—å­˜å‚¨åŒºä¸ä»…å­˜æ”¾äº†æ–¹æ³•çš„å®šä¹‰ï¼Œå®é™…ä¸Šä»æ›´å¤§çš„è§’åº¦è€Œè¨€ï¼Œå®ƒå­˜æ”¾çš„æ˜¯å„ç§ç±»çš„å®šä¹‰ï¼Œå½“æˆ‘ä»¬é€šè¿‡newæ¥ç”Ÿæˆå¯¹è±¡æ—¶ï¼Œä¼šæ ¹æ®è¿™é‡Œå®šä¹‰çš„ç±»çš„å®šä¹‰å»åˆ›å»ºå¯¹è±¡ã€‚å¤šä¸ªå¯¹è±¡ä»…ä¼šå¯¹åº”åŒä¸€ä¸ªæ–¹æ³•ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªè®©æˆ‘ä»¬å……åˆ†ä¿¡æœçš„ç†ç”±ï¼Œé‚£å°±æ˜¯ä¸ç®¡å¤šå°‘çš„å¯¹è±¡ï¼Œä»–ä»¬çš„æ–¹æ³•æ€»æ˜¯ç›¸åŒçš„ï¼Œå°½ç®¡æœ€åçš„è¾“å‡ºä¼šæœ‰æ‰€ä¸åŒï¼Œä½†æ˜¯æ–¹æ³•æ€»æ˜¯ä¼šæŒ‰ç…§æˆ‘ä»¬é¢„æƒ³çš„ç»“æœå»æ“ä½œï¼Œå³ä¸åŒçš„å¯¹è±¡å»è°ƒç”¨åŒä¸€ä¸ªæ–¹æ³•ï¼Œç»“æœä¼šä¸å°½ç›¸åŒã€‚ staticå…³é”®å­—å¯ä»¥ä¿®é¥°æˆå‘˜å˜é‡å’Œæ–¹æ³•ï¼Œæ¥è®©å®ƒä»¬å˜æˆç±»çš„æ‰€å±ï¼Œè€Œä¸æ˜¯å¯¹è±¡çš„æ‰€å±ï¼Œæ¯”å¦‚æˆ‘ä»¬å°†Personçš„ageå±æ€§ç”¨staticè¿›è¡Œä¿®é¥°ï¼Œç»“æœä¼šæ˜¯ä»€ä¹ˆæ ·å‘¢? 1234567891011public class Person { String name; static int age; /* å…¶ä½™ä»£ç ä¸å˜... */ /**Output * Name:zhangsan, Age:12 * Name:lisi, Age:12 *///~} æˆ‘ä»¬å‘ç°ï¼Œç»“æœå‘ç”Ÿäº†ä¸€ç‚¹å˜åŒ–ï¼Œåœ¨ç»™p2çš„ageå±æ€§èµ‹å€¼æ—¶ï¼Œå¹²æ‰°äº†p1çš„ageå±æ€§ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬è¿˜æ˜¯æ¥çœ‹ä»–ä»¬åœ¨å†…å­˜ä¸­çš„ç¤ºæ„ï¼š æˆ‘ä»¬å‘ç°ï¼Œç»™ageå±æ€§åŠ äº†staticå…³é”®å­—ä¹‹åï¼ŒPersonå¯¹è±¡å°±ä¸å†æ‹¥æœ‰ageå±æ€§äº†ï¼Œageå±æ€§ä¼šç»Ÿä¸€äº¤ç»™Personç±»å»ç®¡ç†ï¼Œå³å¤šä¸ªPersonå¯¹è±¡åªä¼šå¯¹åº”ä¸€ä¸ªageå±æ€§ï¼Œä¸€ä¸ªå¯¹è±¡å¦‚æœå¯¹ageå±æ€§åšäº†æ”¹å˜ï¼Œå…¶ä»–çš„å¯¹è±¡éƒ½ä¼šå—åˆ°å½±å“ã€‚æˆ‘ä»¬çœ‹åˆ°æ­¤æ—¶çš„ageå’ŒtoString()æ–¹æ³•ä¸€æ ·ï¼Œéƒ½æ˜¯äº¤ç”±ç±»å»ç®¡ç†ã€‚ è™½ç„¶æˆ‘ä»¬çœ‹åˆ°staticå¯ä»¥è®©å¯¹è±¡å…±äº«å±æ€§ï¼Œä½†æ˜¯å®é™…ä¸­æˆ‘ä»¬å¾ˆå°‘è¿™ä¹ˆç”¨ï¼Œä¹Ÿä¸æ¨èè¿™ä¹ˆä½¿ç”¨ã€‚å› ä¸ºè¿™æ ·ä¼šè®©è¯¥å±æ€§å˜å¾—éš¾ä»¥æ§åˆ¶ï¼Œå› ä¸ºå®ƒåœ¨ä»»ä½•åœ°æ–¹éƒ½æœ‰å¯èƒ½è¢«æ”¹å˜ã€‚å¦‚æœæˆ‘ä»¬æƒ³å…±äº«å±æ€§ï¼Œä¸€èˆ¬æˆ‘ä»¬ä¼šé‡‡ç”¨å…¶ä»–çš„åŠæ³•ï¼š 1234567891011121314151617181920212223242526272829public class Person { private static int count = 0; int id; String name; int age; public Person() { id = ++count; } public String toString() { return \"Id:\" + id + \", Name:\" + name + \", Age:\" + age; } public static void main(String[] args) { Person p1 = new Person(); p1.name = \"zhangsan\"; p1.age = 10; Person p2 = new Person(); p2.name = \"lisi\"; p2.age = 12; System.out.println(p1); System.out.println(p2); } /**Output * Id:1, Name:zhangsan, Age:10 * Id:2, Name:lisi, Age:12 *///~} ä¸Šé¢çš„ä»£ç èµ·åˆ°äº†ç»™Personçš„å¯¹è±¡åˆ›å»ºä¸€ä¸ªå”¯ä¸€idä»¥åŠè®°å½•æ€»æ•°çš„ä½œç”¨ï¼Œå…¶ä¸­countç”±staticä¿®é¥°ï¼Œæ˜¯Personç±»çš„æˆå‘˜å±æ€§ï¼Œæ¯æ¬¡åˆ›å»ºä¸€ä¸ªPersonå¯¹è±¡ï¼Œå°±ä¼šä½¿è¯¥å±æ€§è‡ªåŠ 1ç„¶åèµ‹ç»™å¯¹è±¡çš„idå±æ€§ï¼Œè¿™æ ·ï¼Œcountå±æ€§è®°å½•äº†åˆ›å»ºPersonå¯¹è±¡çš„æ€»æ•°ï¼Œç”±äºcountä½¿ç”¨äº†privateä¿®é¥°ï¼Œæ‰€ä»¥ä»ç±»å¤–é¢æ— æ³•éšæ„æ”¹å˜ã€‚ ä¿®é¥°æˆå‘˜æ–¹æ³•staticçš„å¦ä¸€ä¸ªä½œç”¨ï¼Œå°±æ˜¯ä¿®é¥°æˆå‘˜æ–¹æ³•ã€‚ç›¸æ¯”äºä¿®é¥°æˆå‘˜å±æ€§ï¼Œä¿®é¥°æˆå‘˜æ–¹æ³•å¯¹äºæ•°æ®çš„å­˜å‚¨ä¸Šé¢å¹¶æ²¡æœ‰å¤šå¤§çš„å˜åŒ–ï¼Œå› ä¸ºæˆ‘ä»¬ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œæ–¹æ³•æœ¬æ¥å°±æ˜¯å­˜æ”¾åœ¨ç±»çš„å®šä¹‰å½“ä¸­çš„ã€‚staticä¿®é¥°æˆå‘˜æ–¹æ³•æœ€å¤§çš„ä½œç”¨ï¼Œå°±æ˜¯å¯ä»¥ä½¿ç”¨â€ç±»å.æ–¹æ³•åâ€œçš„æ–¹å¼æ“ä½œæ–¹æ³•ï¼Œé¿å…äº†å…ˆè¦newå‡ºå¯¹è±¡çš„ç¹çå’Œèµ„æºæ¶ˆè€—ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šç»å¸¸åœ¨å¸®åŠ©ç±»ä¸­çœ‹åˆ°å®ƒçš„ä½¿ç”¨ï¼š 12345678910public class PrintHelper { public static void print(Object o){ System.out.println(o); } public static void main(String[] args) { PrintHelper.print(\"Hello world\"); }} ä¸Šé¢ä¾¿æ˜¯ä¸€ä¸ªä¾‹å­ï¼ˆç°åœ¨è¿˜ä¸å¤ªå®ç”¨ï¼‰ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒçš„ä½œç”¨ï¼Œä½¿å¾—staticä¿®é¥°çš„æ–¹æ³•æˆä¸ºç±»çš„æ–¹æ³•ï¼Œä½¿ç”¨æ—¶é€šè¿‡â€œç±»å.æ–¹æ³•åâ€çš„æ–¹å¼å°±å¯ä»¥æ–¹ä¾¿çš„ä½¿ç”¨äº†ï¼Œç›¸å½“äºå®šä¹‰äº†ä¸€ä¸ªå…¨å±€çš„å‡½æ•°ï¼ˆåªè¦å¯¼å…¥è¯¥ç±»æ‰€åœ¨çš„åŒ…å³å¯ï¼‰ã€‚ä¸è¿‡å®ƒä¹Ÿæœ‰ä½¿ç”¨çš„å±€é™ï¼Œä¸€ä¸ªstaticä¿®é¥°çš„ç±»ä¸­ï¼Œä¸èƒ½ä½¿ç”¨éstaticä¿®é¥°çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•ï¼Œè¿™å¾ˆå¥½ç†è§£ï¼Œå› ä¸ºstaticä¿®é¥°çš„æ–¹æ³•æ˜¯å±äºç±»çš„ï¼Œå¦‚æœå»ç›´æ¥ä½¿ç”¨å¯¹è±¡çš„æˆå‘˜å˜é‡ï¼Œå®ƒä¼šä¸çŸ¥æ‰€æªï¼ˆä¸çŸ¥è¯¥ä½¿ç”¨å“ªä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼‰ã€‚ é™æ€å—åœ¨è¯´æ˜staticå…³é”®å­—çš„ç¬¬ä¸‰ä¸ªç”¨æ³•æ—¶ï¼Œæˆ‘ä»¬æœ‰å¿…è¦é‡æ–°æ¢³ç†ä¸€ä¸‹ä¸€ä¸ªå¯¹è±¡çš„åˆå§‹åŒ–è¿‡ç¨‹ã€‚ä»¥ä¸‹é¢çš„ä»£ç ä¸ºä¾‹ï¼š 1234567891011121314151617181920212223242526272829class Book{ public Book(String msg) { System.out.println(msg); }}public class Person { Book book1 = new Book(\"book1æˆå‘˜å˜é‡åˆå§‹åŒ–\"); static Book book2 = new Book(\"staticæˆå‘˜book2æˆå‘˜å˜é‡åˆå§‹åŒ–\"); public Person(String msg) { System.out.println(msg); } Book book3 = new Book(\"book3æˆå‘˜å˜é‡åˆå§‹åŒ–\"); static Book book4 = new Book(\"staticæˆå‘˜book4æˆå‘˜å˜é‡åˆå§‹åŒ–\"); public static void main(String[] args) { Person p1 = new Person(\"p1åˆå§‹åŒ–\"); } /**Output * staticæˆå‘˜book2æˆå‘˜å˜é‡åˆå§‹åŒ– * staticæˆå‘˜book4æˆå‘˜å˜é‡åˆå§‹åŒ– * book1æˆå‘˜å˜é‡åˆå§‹åŒ– * book3æˆå‘˜å˜é‡åˆå§‹åŒ– * p1åˆå§‹åŒ– *///~} ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒPersonç±»ä¸­ç»„åˆäº†å››ä¸ªBookæˆå‘˜å˜é‡ï¼Œä¸¤ä¸ªæ˜¯æ™®é€šæˆå‘˜ï¼Œä¸¤ä¸ªæ˜¯staticä¿®é¥°çš„ç±»æˆå‘˜ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬newä¸€ä¸ªPersonå¯¹è±¡æ—¶ï¼Œstaticä¿®é¥°çš„æˆå‘˜å˜é‡é¦–å…ˆè¢«åˆå§‹åŒ–ï¼Œéšåæ˜¯æ™®é€šæˆå‘˜ï¼Œæœ€åè°ƒç”¨Personç±»çš„æ„é€ æ–¹æ³•å®Œæˆåˆå§‹åŒ–ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨åˆ›å»ºå¯¹è±¡æ—¶ï¼Œstaticä¿®é¥°çš„æˆå‘˜ä¼šé¦–å…ˆè¢«åˆå§‹åŒ–ï¼Œè€Œä¸”æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæœ‰å¤šä¸ªstaticä¿®é¥°çš„æˆå‘˜ï¼Œé‚£ä¹ˆä¼šæŒ‰ç…§ä»–ä»¬çš„å…ˆåä½ç½®è¿›è¡Œåˆå§‹åŒ–ã€‚ å®é™…ä¸Šï¼Œstaticä¿®é¥°çš„æˆå‘˜çš„åˆå§‹åŒ–å¯ä»¥æ›´æ—©çš„è¿›è¡Œï¼Œè¯·çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š 12345678910111213141516171819202122232425262728293031323334353637class Book{ public Book(String msg) { System.out.println(msg); }}public class Person { Book book1 = new Book(\"book1æˆå‘˜å˜é‡åˆå§‹åŒ–\"); static Book book2 = new Book(\"staticæˆå‘˜book2æˆå‘˜å˜é‡åˆå§‹åŒ–\"); public Person(String msg) { System.out.println(msg); } Book book3 = new Book(\"book3æˆå‘˜å˜é‡åˆå§‹åŒ–\"); static Book book4 = new Book(\"staticæˆå‘˜book4æˆå‘˜å˜é‡åˆå§‹åŒ–\"); public static void funStatic() { System.out.println(\"staticä¿®é¥°çš„funStaticæ–¹æ³•\"); } public static void main(String[] args) { Person.funStatic(); System.out.println(\"****************\"); Person p1 = new Person(\"p1åˆå§‹åŒ–\"); } /**Output * staticæˆå‘˜book2æˆå‘˜å˜é‡åˆå§‹åŒ– * staticæˆå‘˜book4æˆå‘˜å˜é‡åˆå§‹åŒ– * staticä¿®é¥°çš„funStaticæ–¹æ³• * *************** * book1æˆå‘˜å˜é‡åˆå§‹åŒ– * book3æˆå‘˜å˜é‡åˆå§‹åŒ– * p1åˆå§‹åŒ– *///~} åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°ä¸¤ä¸ªæœ‰æ„æ€çš„åœ°æ–¹ï¼Œç¬¬ä¸€ä¸ªæ˜¯å½“æˆ‘ä»¬æ²¡æœ‰åˆ›å»ºå¯¹è±¡ï¼Œè€Œæ˜¯é€šè¿‡ç±»å»è°ƒç”¨ç±»æ–¹æ³•æ—¶ï¼Œå°½ç®¡è¯¥æ–¹æ³•æ²¡æœ‰ä½¿ç”¨åˆ°ä»»ä½•çš„ç±»æˆå‘˜ï¼Œç±»æˆå‘˜è¿˜æ˜¯åœ¨æ–¹æ³•è°ƒç”¨ä¹‹å‰å°±åˆå§‹åŒ–äº†ï¼Œè¿™è¯´æ˜ï¼Œå½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡å»ä½¿ç”¨ä¸€ä¸ªç±»æ—¶ï¼Œå°±ä¼šè§¦å‘è¯¥ç±»çš„æˆå‘˜åˆå§‹åŒ–ã€‚ç¬¬äºŒä¸ªæ˜¯å½“æˆ‘ä»¬ä½¿ç”¨äº†ç±»æ–¹æ³•ï¼Œå®Œæˆç±»çš„æˆå‘˜çš„åˆå§‹åŒ–åï¼Œå†newè¯¥ç±»çš„å¯¹è±¡æ—¶ï¼Œstaticä¿®é¥°çš„ç±»æˆå‘˜æ²¡æœ‰å†æ¬¡åˆå§‹åŒ–ï¼Œè¿™è¯´æ˜ï¼Œstaticä¿®é¥°çš„ç±»æˆå‘˜ï¼Œåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œåªéœ€è¦åˆå§‹åŒ–ä¸€æ¬¡å³å¯ï¼Œä¸ä¼šè¿›è¡Œå¤šæ¬¡çš„åˆå§‹åŒ–ã€‚ å›é¡¾äº†å¯¹è±¡çš„åˆå§‹åŒ–ä»¥åï¼Œæˆ‘ä»¬å†æ¥çœ‹staticçš„ç¬¬ä¸‰ä¸ªä½œç”¨å°±éå¸¸ç®€å•äº†ï¼Œé‚£å°±æ˜¯å½“æˆ‘ä»¬åˆå§‹åŒ–staticä¿®é¥°çš„æˆå‘˜æ—¶ï¼Œå¯ä»¥å°†ä»–ä»¬ç»Ÿä¸€æ”¾åœ¨ä¸€ä¸ªä»¥staticå¼€å§‹ï¼Œç”¨èŠ±æ‹¬å·åŒ…è£¹èµ·æ¥çš„å—çŠ¶è¯­å¥ä¸­ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142class Book{ public Book(String msg) { System.out.println(msg); }}public class Person { Book book1 = new Book(\"book1æˆå‘˜å˜é‡åˆå§‹åŒ–\"); static Book book2; static { book2 = new Book(\"staticæˆå‘˜book2æˆå‘˜å˜é‡åˆå§‹åŒ–\"); book4 = new Book(\"staticæˆå‘˜book4æˆå‘˜å˜é‡åˆå§‹åŒ–\"); } public Person(String msg) { System.out.println(msg); } Book book3 = new Book(\"book3æˆå‘˜å˜é‡åˆå§‹åŒ–\"); static Book book4; public static void funStatic() { System.out.println(\"staticä¿®é¥°çš„funStaticæ–¹æ³•\"); } public static void main(String[] args) { Person.funStatic(); System.out.println(\"****************\"); Person p1 = new Person(\"p1åˆå§‹åŒ–\"); } /**Output * staticæˆå‘˜book2æˆå‘˜å˜é‡åˆå§‹åŒ– * staticæˆå‘˜book4æˆå‘˜å˜é‡åˆå§‹åŒ– * staticä¿®é¥°çš„funStaticæ–¹æ³• * *************** * book1æˆå‘˜å˜é‡åˆå§‹åŒ– * book3æˆå‘˜å˜é‡åˆå§‹åŒ– * p1åˆå§‹åŒ– *///~} æˆ‘ä»¬å°†ä¸Šä¸€ä¸ªä¾‹å­ç¨å¾®åšäº†ä¸€ä¸‹ä¿®æ”¹ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œç»“æœæ²¡æœ‰äºŒè‡´ã€‚ é™æ€å¯¼åŒ…ç›¸æ¯”äºä¸Šé¢çš„ä¸‰ç§ç”¨é€”ï¼Œç¬¬å››ç§ç”¨é€”å¯èƒ½äº†è§£çš„äººå°±æ¯”è¾ƒå°‘äº†ï¼Œä½†æ˜¯å®é™…ä¸Šå®ƒå¾ˆç®€å•ï¼Œè€Œä¸”åœ¨è°ƒç”¨ç±»æ–¹æ³•æ—¶ä¼šæ›´æ–¹ä¾¿ã€‚ä»¥ä¸Šé¢çš„â€œPrintHelperâ€çš„ä¾‹å­ä¸ºä¾‹ï¼Œåšä¸€ä¸‹ç¨å¾®çš„å˜åŒ–ï¼Œå³å¯ä½¿ç”¨é™æ€å¯¼åŒ…å¸¦ç»™æˆ‘ä»¬çš„æ–¹ä¾¿ï¼š 123456789/* PrintHelper.javaæ–‡ä»¶ */package com.dotgua.study;public class PrintHelper { public static void print(Object o){ System.out.println(o); }} 123456789101112import static com.dotgua.study.PrintHelper.*; // å¯¼å…¥ä¸Šé¢çš„åŒ…public class App { public static void main( String[] args ) { print(\"Hello World!\"); } /**Output * Hello World! *///~} ä¸Šé¢çš„ä»£ç æ¥è‡ªäºä¸¤ä¸ªjavaæ–‡ä»¶ï¼Œå…¶ä¸­çš„PrintHelperå¾ˆç®€å•ï¼ŒåŒ…å«äº†ä¸€ä¸ªç”¨äºæ‰“å°çš„staticæ–¹æ³•ã€‚è€Œåœ¨App.javaæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå°†PrintHelperç±»å¯¼å…¥ï¼Œè¿™é‡Œåœ¨å¯¼å…¥æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†staticå…³é”®å­—ï¼Œè€Œä¸”åœ¨å¼•å…¥ç±»çš„æœ€åè¿˜åŠ ä¸Šäº†â€œ.*â€ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯å°†PrintHelperç±»ä¸­çš„æ‰€æœ‰ç±»æ–¹æ³•ç›´æ¥å¯¼å…¥ã€‚ä¸åŒäºéstaticå¯¼å…¥ï¼Œé‡‡ç”¨staticå¯¼å…¥åŒ…åï¼Œåœ¨ä¸ä¸å½“å‰ç±»çš„æ–¹æ³•åå†²çªçš„æƒ…å†µä¸‹ï¼Œæ— éœ€ä½¿ç”¨â€œç±»å.æ–¹æ³•åâ€çš„æ–¹æ³•å»è°ƒç”¨ç±»æ–¹æ³•äº†ï¼Œç›´æ¥å¯ä»¥é‡‡ç”¨â€æ–¹æ³•åâ€œå»è°ƒç”¨ç±»æ–¹æ³•ï¼Œå°±å¥½åƒæ˜¯è¯¥ç±»è‡ªå·±çš„æ–¹æ³•ä¸€æ ·ä½¿ç”¨å³å¯ã€‚ æ€»ç»“staticæ˜¯javaä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªå…³é”®å­—ï¼Œè€Œä¸”å®ƒçš„ç”¨æ³•ä¹Ÿå¾ˆä¸°å¯Œï¼Œä¸»è¦æœ‰å››ç§ç”¨æ³•ï¼š ç”¨æ¥ä¿®é¥°æˆå‘˜å˜é‡ï¼Œå°†å…¶å˜ä¸ºç±»çš„æˆå‘˜ï¼Œä»è€Œå®ç°æ‰€æœ‰å¯¹è±¡å¯¹äºè¯¥æˆå‘˜çš„å…±äº«ï¼› ç”¨æ¥ä¿®é¥°æˆå‘˜æ–¹æ³•ï¼Œå°†å…¶å˜ä¸ºç±»æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨â€œç±»å.æ–¹æ³•åâ€çš„æ–¹å¼è°ƒç”¨ï¼Œå¸¸ç”¨äºå·¥å…·ç±»ï¼› é™æ€å—ç”¨æ³•ï¼Œå°†å¤šä¸ªç±»æˆå‘˜æ”¾åœ¨ä¸€èµ·åˆå§‹åŒ–ï¼Œä½¿å¾—ç¨‹åºæ›´åŠ è§„æ•´ï¼Œå…¶ä¸­ç†è§£å¯¹è±¡çš„åˆå§‹åŒ–è¿‡ç¨‹éå¸¸å…³é”®ï¼› é™æ€å¯¼åŒ…ç”¨æ³•ï¼Œå°†ç±»çš„æ–¹æ³•ç›´æ¥å¯¼å…¥åˆ°å½“å‰ç±»ä¸­ï¼Œä»è€Œç›´æ¥ä½¿ç”¨â€œæ–¹æ³•åâ€å³å¯è°ƒç”¨ç±»æ–¹æ³•ï¼Œæ›´åŠ æ–¹ä¾¿ã€‚ å‚è€ƒè‡ª","link":"/2019/01/07/javaåŸºç¡€-staticå…³é”®å­—.html"},{"title":"javaåŸºç¡€-finalå…³é”®å­—","text":"final å…³é”®å­— åœ¨javaçš„å…³é”®å­—ä¸­ï¼Œstaticå’Œfinalæ˜¯ä¸¤ä¸ªæˆ‘ä»¬å¿…é¡»æŒæ¡çš„å…³é”®å­—ã€‚ä¸åŒäºå…¶ä»–å…³é”®å­—ï¼Œä»–ä»¬éƒ½æœ‰å¤šç§ç”¨æ³•ï¼Œè€Œä¸”åœ¨ä¸€å®šç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œå¯ä»¥æé«˜ç¨‹åºçš„è¿è¡Œæ€§èƒ½ï¼Œä¼˜åŒ–ç¨‹åºçš„ç»“æ„ã€‚ä¸‹é¢æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹finalå…³é”®å­—åŠå…¶ç”¨æ³•ã€‚ ä¿®é¥°æ•°æ®åœ¨ç¼–å†™ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦è¯´æ˜ä¸€ä¸ªæ•°æ®æ˜¯ä¸å¯å˜çš„ï¼Œæˆ‘ä»¬æˆä¸ºå¸¸é‡ã€‚åœ¨javaä¸­ï¼Œç”¨finalå…³é”®å­—ä¿®é¥°çš„å˜é‡ï¼Œåªèƒ½è¿›è¡Œä¸€æ¬¡èµ‹å€¼æ“ä½œï¼Œå¹¶ä¸”åœ¨ç”Ÿå­˜æœŸå†…ä¸å¯ä»¥æ”¹å˜å®ƒçš„å€¼ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œfinalä¼šå‘Šè¯‰ç¼–è¯‘å™¨ï¼Œè¿™ä¸ªæ•°æ®æ˜¯ä¸ä¼šä¿®æ”¹çš„ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°±å¯èƒ½ä¼šåœ¨ç¼–è¯‘æ—¶æœŸå°±å¯¹è¯¥æ•°æ®è¿›è¡Œæ›¿æ¢ç”šè‡³æ‰§è¡Œè®¡ç®—ï¼Œè¿™æ ·å¯ä»¥å¯¹æˆ‘ä»¬çš„ç¨‹åºèµ·åˆ°ä¸€ç‚¹ä¼˜åŒ–ã€‚ä¸è¿‡åœ¨é’ˆå¯¹åŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹æ—¶ï¼Œfinalå…³é”®å­—çš„æ•ˆæœå­˜åœ¨ç»†å¾®å·®åˆ«ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š 123456789101112131415161718192021222324 class Value { int v; public Value(int v) { this.v = v; }}public class FinalTest { final int f1 = 1; final int f2; public FinalTest() { f2 = 2; } public static void main(String[] args) { final int value1 = 1; // value1 = 4; final double value2; value2 = 2.0; final Value value3 = new Value(1); value3.v = 4; }} ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹mainæ–¹æ³•ä¸­çš„å‡ ä¸ªfinalä¿®é¥°çš„æ•°æ®ï¼Œåœ¨ç»™value1èµ‹åˆå§‹å€¼ä¹‹åï¼Œæˆ‘ä»¬æ— æ³•å†å¯¹value1çš„å€¼è¿›è¡Œä¿®æ”¹ï¼Œfinalå…³é”®å­—èµ·åˆ°äº†å¸¸é‡çš„ä½œç”¨ã€‚ä»value2æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œfinalä¿®é¥°çš„å˜é‡å¯ä»¥ä¸åœ¨å£°æ˜æ—¶èµ‹å€¼ï¼Œå³å¯ä»¥å…ˆå£°æ˜ï¼Œåèµ‹å€¼ã€‚value3æ—¶ä¸€ä¸ªå¼•ç”¨å˜é‡ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°finalä¿®é¥°å¼•ç”¨å˜é‡æ—¶ï¼Œåªæ˜¯é™å®šäº†å¼•ç”¨å˜é‡çš„å¼•ç”¨ä¸å¯æ”¹å˜ï¼Œå³ä¸èƒ½å°†value3å†æ¬¡å¼•ç”¨å¦ä¸€ä¸ªValueå¯¹è±¡ï¼Œä½†æ˜¯å¼•ç”¨çš„å¯¹è±¡çš„å€¼æ˜¯å¯ä»¥æ”¹å˜çš„ï¼Œä»å†…å­˜æ¨¡å‹ä¸­æˆ‘ä»¬çœ‹çš„æ›´åŠ æ¸…æ™°ï¼š ä¸Šå›¾ä¸­ï¼Œfinalä¿®é¥°çš„å€¼ç”¨ç²—çº¿æ¡çš„è¾¹æ¡†è¡¨ç¤ºå®ƒçš„å€¼æ˜¯ä¸å¯æ”¹å˜çš„ï¼Œæˆ‘ä»¬çŸ¥é“å¼•ç”¨å˜é‡çš„å€¼å®é™…ä¸Šæ˜¯å®ƒæ‰€å¼•ç”¨çš„å¯¹è±¡çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥åœ°å€çš„å€¼æ˜¯ä¸å¯æ”¹å˜çš„ï¼Œä»è€Œè¯´æ˜äº†ä¸ºä»€ä¹ˆå¼•ç”¨å˜é‡ä¸å¯ä»¥æ”¹å˜å¼•ç”¨å¯¹è±¡ã€‚è€Œå®é™…å¼•ç”¨çš„å¯¹è±¡å®é™…ä¸Šæ˜¯ä¸å—finalå…³é”®å­—çš„å½±å“çš„ï¼Œæ‰€ä»¥å®ƒçš„å€¼æ˜¯å¯ä»¥æ”¹å˜çš„ã€‚ å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†ç”¨finalä¿®é¥°æˆå‘˜å˜é‡æ—¶çš„ç»†å¾®å·®åˆ«ï¼Œå› ä¸ºfinalä¿®é¥°çš„æ•°æ®çš„å€¼æ˜¯ä¸å¯æ”¹å˜çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»ç¡®ä¿åœ¨ä½¿ç”¨å‰å°±å·²ç»å¯¹æˆå‘˜å˜é‡èµ‹å€¼äº†ã€‚å› æ­¤å¯¹äºfinalä¿®é¥°çš„æˆå‘˜å˜é‡ï¼Œæˆ‘ä»¬æœ‰ä¸”åªæœ‰ä¸¤ä¸ªåœ°æ–¹å¯ä»¥ç»™å®ƒèµ‹å€¼ï¼Œä¸€ä¸ªæ˜¯å£°æ˜è¯¥æˆå‘˜æ—¶èµ‹å€¼ï¼Œå¦ä¸€ä¸ªæ˜¯åœ¨æ„é€ æ–¹æ³•ä¸­èµ‹å€¼ï¼Œåœ¨è¿™ä¸¤ä¸ªåœ°æ–¹æˆ‘ä»¬å¿…é¡»ç»™å®ƒä»¬èµ‹åˆå§‹å€¼ã€‚ æœ€åæˆ‘ä»¬éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼ŒåŒæ—¶ä½¿ç”¨staticå’Œfinalä¿®é¥°çš„æˆå‘˜åœ¨å†…å­˜ä¸­åªå æ®ä¸€æ®µä¸èƒ½æ”¹å˜çš„å­˜å‚¨ç©ºé—´ã€‚ ä¿®é¥°æ–¹æ³•å‚æ•°å‰é¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœå˜é‡æ˜¯æˆ‘ä»¬è‡ªå·±åˆ›å»ºçš„ï¼Œé‚£ä¹ˆä½¿ç”¨finalä¿®é¥°è¡¨ç¤ºæˆ‘ä»¬åªä¼šç»™å®ƒèµ‹å€¼ä¸€æ¬¡ä¸”ä¸ä¼šæ”¹å˜å˜é‡çš„å€¼ã€‚é‚£ä¹ˆå¦‚æœå˜é‡æ˜¯ä½œä¸ºå‚æ•°ä¼ å…¥çš„ï¼Œæˆ‘ä»¬æ€ä¹ˆä¿è¯å®ƒçš„å€¼ä¸ä¼šæ”¹å˜å‘¢ï¼Ÿè¿™å°±ç”¨åˆ°äº†finalçš„ç¬¬äºŒç§ç”¨æ³•ï¼Œå³åœ¨æˆ‘ä»¬ç¼–å†™æ–¹æ³•æ—¶ï¼Œå¯ä»¥åœ¨å‚æ•°å‰é¢æ·»åŠ finalå…³é”®å­—ï¼Œå®ƒè¡¨ç¤ºåœ¨æ•´ä¸ªæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ä¸ä¼šï¼ˆå®é™…ä¸Šæ˜¯ä¸èƒ½ï¼‰æ”¹å˜å‚æ•°çš„å€¼ï¼š 12345678910public class FinalTest { /* ... */ public void finalFunc(final int i, final Value value) { // i = 5; ä¸èƒ½æ”¹å˜içš„å€¼ // v = new Value(); ä¸èƒ½æ”¹å˜vçš„å€¼ value.v = 5; // å¯ä»¥æ”¹å˜å¼•ç”¨å¯¹è±¡çš„å€¼ }} ä¿®é¥°æ–¹æ³•ç¬¬ä¸‰ç§æ–¹å¼ï¼Œå³ç”¨finalå…³é”®å­—ä¿®é¥°æ–¹æ³•ï¼Œå®ƒè¡¨ç¤ºè¯¥æ–¹æ³•ä¸èƒ½è¢«è¦†ç›–ã€‚è¿™ç§ä½¿ç”¨æ–¹å¼ä¸»è¦æ˜¯ä»è®¾è®¡çš„è§’åº¦è€ƒè™‘ï¼Œå³æ˜ç¡®å‘Šè¯‰å…¶ä»–å¯èƒ½ä¼šç»§æ‰¿è¯¥ç±»çš„ç¨‹åºå‘˜ï¼Œä¸å¸Œæœ›ä»–ä»¬å»è¦†ç›–è¿™ä¸ªæ–¹æ³•ã€‚è¿™ç§æ–¹å¼æˆ‘ä»¬å¾ˆå®¹æ˜“ç†è§£ï¼Œç„¶è€Œï¼Œå…³äºprivateå’Œfinalå…³é”®å­—è¿˜æœ‰ä¸€ç‚¹è”ç³»ï¼Œè¿™å°±æ˜¯ç±»ä¸­æ‰€æœ‰çš„privateæ–¹æ³•éƒ½éšå¼åœ°æŒ‡å®šä¸ºæ˜¯finalçš„ï¼Œç”±äºæ— æ³•åœ¨ç±»å¤–ä½¿ç”¨privateæ–¹æ³•ï¼Œæ‰€ä»¥ä¹Ÿå°±æ— æ³•è¦†ç›–å®ƒã€‚ ä¿®é¥°ç±»äº†è§£äº†finalå…³é”®å­—çš„å…¶ä»–ç”¨æ³•ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å¯ä»¥æƒ³åˆ°ä½¿ç”¨finalå…³é”®å­—ä¿®é¥°ç±»çš„ä½œç”¨ï¼Œé‚£å°±æ˜¯ç”¨finalä¿®é¥°çš„ç±»æ˜¯æ— æ³•è¢«ç»§æ‰¿çš„ã€‚ ä¸Šé¢æˆ‘ä»¬è®²è§£äº†finalçš„å››ç§ç”¨æ³•ï¼Œç„¶è€Œï¼Œå¯¹äºç¬¬ä¸‰ç§å’Œç¬¬å››ç§ç”¨æ³•ï¼Œæˆ‘ä»¬å´ç”šå°‘ä½¿ç”¨ã€‚è¿™ä¸æ˜¯æ²¡æœ‰é“ç†çš„ï¼Œä»finalçš„è®¾è®¡æ¥è®²ï¼Œè¿™ä¸¤ç§ç”¨æ³•ç”šè‡³å¯ä»¥è¯´æ˜¯é¸¡è‚‹ï¼Œå› ä¸ºå¯¹äºå¼€å‘äººå‘˜æ¥è®²ï¼Œå¦‚æœæˆ‘ä»¬å†™çš„ç±»è¢«ç»§æ‰¿çš„è¶Šå¤šï¼Œå°±è¯´æ˜æˆ‘ä»¬å†™çš„ç±»è¶Šæœ‰ä»·å€¼ï¼Œè¶ŠæˆåŠŸã€‚å³ä½¿æ˜¯ä»è®¾è®¡çš„è§’åº¦æ¥è®²ï¼Œä¹Ÿæ²¡æœ‰å¿…è¦å°†ä¸€ä¸ªç±»è®¾è®¡ä¸ºä¸å¯ç»§æ‰¿çš„ã€‚Javaæ ‡å‡†åº“å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åä¾‹ï¼Œç‰¹åˆ«æ˜¯Java 1.0/1.1ä¸­Vectorç±»è¢«å¦‚æ­¤å¹¿æ³›çš„è¿ç”¨ï¼Œå¦‚æœæ‰€æœ‰çš„æ–¹æ³•å‡æœªè¢«æŒ‡å®šä¸ºfinalçš„è¯ï¼Œå®ƒå¯èƒ½ä¼šæ›´åŠ æœ‰ç”¨ã€‚å¦‚æ­¤æœ‰ç”¨çš„ç±»ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“æƒ³åˆ°å»ç»§æ‰¿å’Œé‡å†™ä»–ä»¬ï¼Œç„¶è€Œï¼Œç”±äºfinalçš„ä½œç”¨ï¼Œå¯¼è‡´æˆ‘ä»¬å¯¹Vectorç±»çš„æ‰©å±•å—åˆ°äº†ä¸€äº›é˜»ç¢ï¼Œå¯¼è‡´äº†Vectorå¹¶æ²¡æœ‰å®Œå…¨å‘æŒ¥å®ƒåº”æœ‰çš„å…¨éƒ¨ä»·å€¼ã€‚ æ€»ç»“finalå…³é”®å­—æ˜¯æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„å…³é”®å­—ä¹‹ä¸€ï¼Œå®ƒçš„ç”¨æ³•æœ‰å¾ˆå¤šï¼Œä½†æ˜¯å¹¶ä¸æ˜¯æ¯ä¸€ç§ç”¨æ³•éƒ½å€¼å¾—æˆ‘ä»¬å»å¹¿æ³›ä½¿ç”¨ã€‚å®ƒçš„ä¸»è¦ç”¨æ³•æœ‰ä»¥ä¸‹å››ç§ï¼š ç”¨æ¥ä¿®é¥°æ•°æ®ï¼ŒåŒ…æ‹¬æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡ï¼Œè¯¥å˜é‡åªèƒ½è¢«èµ‹å€¼ä¸€æ¬¡ä¸”å®ƒçš„å€¼æ— æ³•è¢«æ”¹å˜ã€‚å¯¹äºæˆå‘˜å˜é‡æ¥è®²ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨å£°æ˜æ—¶æˆ–è€…æ„é€ æ–¹æ³•ä¸­å¯¹å®ƒèµ‹å€¼ï¼› ç”¨æ¥ä¿®é¥°æ–¹æ³•å‚æ•°ï¼Œè¡¨ç¤ºåœ¨å˜é‡çš„ç”Ÿå­˜æœŸä¸­å®ƒçš„å€¼ä¸èƒ½è¢«æ”¹å˜ï¼› ä¿®é¥°æ–¹æ³•ï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•æ— æ³•è¢«é‡å†™ï¼› ä¿®é¥°ç±»ï¼Œè¡¨ç¤ºè¯¥ç±»æ— æ³•è¢«ç»§æ‰¿ã€‚ ä¸Šé¢çš„å››ç§æ–¹æ³•ä¸­ï¼Œç¬¬ä¸‰ç§å’Œç¬¬å››ç§æ–¹æ³•éœ€è¦è°¨æ…ä½¿ç”¨ï¼Œå› ä¸ºåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¦‚æœæ˜¯ä»…ä»…ä¸ºäº†ä¸€ç‚¹è®¾è®¡ä¸Šçš„è€ƒè™‘ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦ä½¿ç”¨finalæ¥ä¿®é¥°æ–¹æ³•å’Œç±»ã€‚ å‚è€ƒè‡ª","link":"/2019/01/07/javaåŸºç¡€-finalå…³é”®å­—.html"},{"title":"Javaè®¾è®¡æ¨¡å¼ä¹‹ä»£ç†æ¨¡å¼","text":"ä»£ç†æ¨¡å¼ä»£ç†(Proxy)æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼,æä¾›äº†å¯¹ç›®æ ‡å¯¹è±¡å¦å¤–çš„è®¿é—®æ–¹å¼;å³é€šè¿‡ä»£ç†å¯¹è±¡è®¿é—®ç›®æ ‡å¯¹è±¡.è¿™æ ·åšçš„å¥½å¤„æ˜¯:å¯ä»¥åœ¨ç›®æ ‡å¯¹è±¡å®ç°çš„åŸºç¡€ä¸Š,å¢å¼ºé¢å¤–çš„åŠŸèƒ½æ“ä½œ,å³æ‰©å±•ç›®æ ‡å¯¹è±¡çš„åŠŸèƒ½.è¿™é‡Œä½¿ç”¨åˆ°ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªæ€æƒ³:ä¸è¦éšæ„å»ä¿®æ”¹åˆ«äººå·²ç»å†™å¥½çš„ä»£ç æˆ–è€…æ–¹æ³•,å¦‚æœéœ€æ”¹ä¿®æ”¹,å¯ä»¥é€šè¿‡ä»£ç†çš„æ–¹å¼æ¥æ‰©å±•è¯¥æ–¹æ³• ä¸¾ä¸ªä¾‹å­æ¥è¯´æ˜ä»£ç†çš„ä½œç”¨:å‡è®¾æˆ‘ä»¬æƒ³é‚€è¯·ä¸€ä½æ˜æ˜Ÿ,é‚£ä¹ˆå¹¶ä¸æ˜¯ç›´æ¥è¿æ¥æ˜æ˜Ÿ,è€Œæ˜¯è”ç³»æ˜æ˜Ÿçš„ç»çºªäºº,æ¥è¾¾åˆ°åŒæ ·çš„ç›®çš„.æ˜æ˜Ÿå°±æ˜¯ä¸€ä¸ªç›®æ ‡å¯¹è±¡,ä»–åªè¦è´Ÿè´£æ´»åŠ¨ä¸­çš„èŠ‚ç›®,è€Œå…¶ä»–çç¢çš„äº‹æƒ…å°±äº¤ç»™ä»–çš„ä»£ç†äºº(ç»çºªäºº)æ¥è§£å†³.è¿™å°±æ˜¯ä»£ç†æ€æƒ³åœ¨ç°å®ä¸­çš„ä¸€ä¸ªä¾‹å­.å›¾ç‰‡è¡¨ç¤ºå¦‚ä¸‹ï¼š ä»£ç†æ¨¡å¼çš„å…³é”®ç‚¹æ˜¯:ä»£ç†å¯¹è±¡ä¸ç›®æ ‡å¯¹è±¡.ä»£ç†å¯¹è±¡æ˜¯å¯¹ç›®æ ‡å¯¹è±¡çš„æ‰©å±•,å¹¶ä¼šè°ƒç”¨ç›®æ ‡å¯¹è±¡ é™æ€ä»£ç†é™æ€ä»£ç†åœ¨ä½¿ç”¨æ—¶,éœ€è¦å®šä¹‰æ¥å£æˆ–è€…çˆ¶ç±»,è¢«ä»£ç†å¯¹è±¡ä¸ä»£ç†å¯¹è±¡ä¸€èµ·å®ç°ç›¸åŒçš„æ¥å£æˆ–è€…æ˜¯ç»§æ‰¿ç›¸åŒçˆ¶ç±». eg:æ¨¡æ‹Ÿä¿å­˜åŠ¨ä½œ,å®šä¹‰ä¸€ä¸ªä¿å­˜åŠ¨ä½œçš„æ¥å£:IUserDao.java,ç„¶åç›®æ ‡å¯¹è±¡å®ç°è¿™ä¸ªæ¥å£çš„æ–¹æ³•UserDao.java,æ­¤æ—¶å¦‚æœä½¿ç”¨é™æ€ä»£ç†æ–¹å¼,å°±éœ€è¦åœ¨ä»£ç†å¯¹è±¡(UserDaoProxy.java)ä¸­ä¹Ÿå®ç°IUserDaoæ¥å£.è°ƒç”¨çš„æ—¶å€™é€šè¿‡è°ƒç”¨ä»£ç†å¯¹è±¡çš„æ–¹æ³•æ¥è°ƒç”¨ç›®æ ‡å¯¹è±¡.éœ€è¦æ³¨æ„çš„æ˜¯,ä»£ç†å¯¹è±¡ä¸ç›®æ ‡å¯¹è±¡è¦å®ç°ç›¸åŒçš„æ¥å£,ç„¶åé€šè¿‡è°ƒç”¨ç›¸åŒçš„æ–¹æ³•æ¥è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³• ç¤ºä¾‹ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354/** * @desc ç”¨æˆ·ä¿å­˜æ¥å£ */public interface IUserDao { // ä¿å­˜æ–¹æ³• void save();}/** * @desc ç”¨æˆ·ä¿å­˜ */public class UserDao implements IUserDao { @Override public void save() { System.out.println(\"OKï¼Œå·²ä¿å­˜æ•°æ®!\"); }}/** * @desc ä»£ç†å¯¹è±¡ï¼Œé™æ€ä»£ç† */public class UserDaoProxy implements IUserDao { // ç›®æ ‡å¯¹è±¡ private IUserDao target; public UserDaoProxy(IUserDao user) { this.target = user; } @Override public void save() { System.out.println(\"å¼€å§‹äº‹ç‰©.\"); target.save(); System.out.println(\"æäº¤äº‹ç‰©.\"); }}/** * @desc é™æ€ä»£ç†æµ‹è¯•æ–¹æ³• */public class MainTest { public static void main(String[] args) { // ç›®æ ‡å¯¹è±¡ IUserDao userDao = new UserDao(); // ä»£ç†å¯¹è±¡ï¼ŒæŠŠç›®æ ‡å¯¹è±¡ä¼ ç»™ä»£ç†ï¼Œå»ºç«‹ä»£ç†å…³ç³» UserDaoProxy proxy = new UserDaoProxy(userDao); proxy.save(); }} ç»“æœï¼š é™æ€ä»£ç†æ€»ç»“:1.å¯ä»¥åšåˆ°åœ¨ä¸ä¿®æ”¹ç›®æ ‡å¯¹è±¡çš„åŠŸèƒ½å‰æä¸‹,å¯¹ç›®æ ‡åŠŸèƒ½æ‰©å±•.2.ç¼ºç‚¹: å› ä¸ºä»£ç†å¯¹è±¡éœ€è¦ä¸ç›®æ ‡å¯¹è±¡å®ç°ä¸€æ ·çš„æ¥å£,æ‰€ä»¥ä¼šæœ‰å¾ˆå¤šä»£ç†ç±»,ç±»å¤ªå¤š.åŒæ—¶,ä¸€æ—¦æ¥å£å¢åŠ æ–¹æ³•,ç›®æ ‡å¯¹è±¡ä¸ä»£ç†å¯¹è±¡éƒ½è¦ç»´æŠ¤. å¦‚ä½•è§£å†³é™æ€ä»£ç†ä¸­çš„ç¼ºç‚¹å‘¢?ç­”æ¡ˆæ˜¯å¯ä»¥ä½¿ç”¨åŠ¨æ€ä»£ç†æ–¹å¼ åŠ¨æ€ä»£ç†åŠ¨æ€ä»£ç†æœ‰ä»¥ä¸‹ç‰¹ç‚¹: ä»£ç†å¯¹è±¡,ä¸éœ€è¦å®ç°æ¥å£ .ä»£ç†å¯¹è±¡çš„ç”Ÿæˆ,æ˜¯åˆ©ç”¨JDKçš„API,åŠ¨æ€çš„åœ¨å†…å­˜ä¸­æ„å»ºä»£ç†å¯¹è±¡(éœ€è¦æˆ‘ä»¬æŒ‡å®šåˆ›å»ºä»£ç†å¯¹è±¡/ç›®æ ‡å¯¹è±¡å®ç°çš„æ¥å£çš„ç±»å‹) åŠ¨æ€ä»£ç†ä¹Ÿå«åš:JDKä»£ç†,æ¥å£ä»£ç† JDKä¸­ç”Ÿæˆä»£ç†å¯¹è±¡çš„APIä»£ç†ç±»æ‰€åœ¨åŒ…:java.lang.reflect.ProxyJDKå®ç°ä»£ç†åªéœ€è¦ä½¿ç”¨newProxyInstanceæ–¹æ³•,ä½†æ˜¯è¯¥æ–¹æ³•éœ€è¦æ¥æ”¶ä¸‰ä¸ªå‚æ•°,å®Œæ•´çš„å†™æ³•æ˜¯: 1static Object newProxyInstance(ClassLoader loader, Class&lt;?&gt;[] interfaces,InvocationHandler h ) æ³¨æ„è¯¥æ–¹æ³•æ˜¯åœ¨Proxyç±»ä¸­æ˜¯é™æ€æ–¹æ³•,ä¸”æ¥æ”¶çš„ä¸‰ä¸ªå‚æ•°ä¾æ¬¡ä¸º: ClassLoader loader,:æŒ‡å®šå½“å‰ç›®æ ‡å¯¹è±¡ä½¿ç”¨ç±»åŠ è½½å™¨,è·å–åŠ è½½å™¨çš„æ–¹æ³•æ˜¯å›ºå®šçš„ Class&lt;?&gt;[] interfaces,:ç›®æ ‡å¯¹è±¡å®ç°çš„æ¥å£çš„ç±»å‹,ä½¿ç”¨æ³›å‹æ–¹å¼ç¡®è®¤ç±»å‹ InvocationHandler h:äº‹ä»¶å¤„ç†,æ‰§è¡Œç›®æ ‡å¯¹è±¡çš„æ–¹æ³•æ—¶,ä¼šè§¦å‘äº‹ä»¶å¤„ç†å™¨çš„æ–¹æ³•,ä¼šæŠŠå½“å‰æ‰§è¡Œç›®æ ‡å¯¹è±¡çš„æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ å…¥ ä»£ç ç¤ºä¾‹:æ¥å£ç±»IUserDao.javaä»¥åŠæ¥å£å®ç°ç±»,ç›®æ ‡å¯¹è±¡UserDaoæ˜¯ä¸€æ ·çš„,æ²¡æœ‰åšä¿®æ”¹.åœ¨è¿™ä¸ªåŸºç¡€ä¸Š,å¢åŠ ä¸€ä¸ªä»£ç†å·¥å‚ç±»(ProxyFactory.java),å°†ä»£ç†ç±»å†™åœ¨è¿™ä¸ªåœ°æ–¹,ç„¶ååœ¨æµ‹è¯•ç±»(éœ€è¦ä½¿ç”¨åˆ°ä»£ç†çš„ä»£ç )ä¸­å…ˆå»ºç«‹ç›®æ ‡å¯¹è±¡å’Œä»£ç†å¯¹è±¡çš„è”ç³»,ç„¶åä»£ç”¨ä»£ç†å¯¹è±¡çš„ä¸­åŒåæ–¹æ³• ç¤ºä¾‹ä»£ç ä»£ç†å·¥å‚ç±»:ProxyFactory.java 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152import java.lang.reflect.InvocationHandler;import java.lang.reflect.Method;import java.lang.reflect.Proxy;/** * @desc åŠ¨æ€ä»£ç†å·¥å‚ */public class ProxyFactory { private Object target; /** * ç»´æŠ¤ä¸€ä¸ªç›®æ ‡å¯¹è±¡ * * @param target */ public ProxyFactory(Object target) { this.target = target; } public Object getProxyInstance() { return Proxy.newProxyInstance(target.getClass().getClassLoader(), target.getClass().getInterfaces(), new InvocationHandler() { @Override public Object invoke(Object proxy, Method method, Object[] args) throws Throwable { System.out.println(\"å¼€å§‹äº‹ç‰©2.\"); // æ‰§è¡Œç›®æ ‡æ–¹æ³• Object returnValue = method.invoke(target, args); System.out.println(\"æäº¤äº‹ç‰©2.\"); return returnValue; } }); }}/** * @desc åŠ¨æ€ä»£ç†æµ‹è¯•æ–¹æ³• */public class MainTest { public static void main(String[] args) { // ç›®æ ‡å¯¹è±¡ IUserDao userDao = new UserDao(); // åŸå§‹ç±»å‹ System.out.println(userDao.getClass()); // ç»™ç›®æ ‡å¯¹è±¡ï¼Œåˆ›å»ºä»£ç†å¯¹è±¡ IUserDao proxy = (IUserDao) new ProxyFactory(userDao).getProxyInstance(); // å†…å­˜ä¸­åŠ¨æ€ç”Ÿæˆçš„ä»£ç†å¯¹è±¡ System.out.println(proxy.getClass()); // æ‰§è¡Œæ–¹æ³• proxy.save(); }} ç»“æœï¼š æ€»ç»“ä»£ç†å¯¹è±¡ä¸éœ€è¦å®ç°æ¥å£,ä½†æ˜¯ç›®æ ‡å¯¹è±¡ä¸€å®šè¦å®ç°æ¥å£,å¦åˆ™ä¸èƒ½ç”¨åŠ¨æ€ä»£ç† Cglibä»£ç†ä¸Šé¢çš„é™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†æ¨¡å¼éƒ½æ˜¯è¦æ±‚ç›®æ ‡å¯¹è±¡æ˜¯å®ç°ä¸€ä¸ªæ¥å£çš„ç›®æ ‡å¯¹è±¡,ä½†æ˜¯æœ‰æ—¶å€™ç›®æ ‡å¯¹è±¡åªæ˜¯ä¸€ä¸ªå•ç‹¬çš„å¯¹è±¡,å¹¶æ²¡æœ‰å®ç°ä»»ä½•çš„æ¥å£,è¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨ä»¥ç›®æ ‡å¯¹è±¡å­ç±»çš„æ–¹å¼ç±»å®ç°ä»£ç†,è¿™ç§æ–¹æ³•å°±å«åš:Cglibä»£ç† ä¸€. Cglibä»£ç†,ä¹Ÿå«ä½œå­ç±»ä»£ç†,å®ƒæ˜¯åœ¨å†…å­˜ä¸­æ„å»ºä¸€ä¸ªå­ç±»å¯¹è±¡ä»è€Œå®ç°å¯¹ç›®æ ‡å¯¹è±¡åŠŸèƒ½çš„æ‰©å±•. JDKçš„åŠ¨æ€ä»£ç†æœ‰ä¸€ä¸ªé™åˆ¶,å°±æ˜¯ä½¿ç”¨åŠ¨æ€ä»£ç†çš„å¯¹è±¡å¿…é¡»å®ç°ä¸€ä¸ªæˆ–å¤šä¸ªæ¥å£,å¦‚æœæƒ³ä»£ç†æ²¡æœ‰å®ç°æ¥å£çš„ç±»,å°±å¯ä»¥ä½¿ç”¨Cglibå®ç°. Cglibæ˜¯ä¸€ä¸ªå¼ºå¤§çš„é«˜æ€§èƒ½çš„ä»£ç ç”ŸæˆåŒ…,å®ƒå¯ä»¥åœ¨è¿è¡ŒæœŸæ‰©å±•javaç±»ä¸å®ç°javaæ¥å£.å®ƒå¹¿æ³›çš„è¢«è®¸å¤šAOPçš„æ¡†æ¶ä½¿ç”¨,ä¾‹å¦‚Spring AOPå’Œsynaopä¸ºä»–ä»¬æä¾›æ–¹æ³•çš„interception(æ‹¦æˆª) CglibåŒ…çš„åº•å±‚æ˜¯é€šè¿‡ä½¿ç”¨ä¸€ä¸ªå°è€Œå—çš„å­—èŠ‚ç å¤„ç†æ¡†æ¶ASMæ¥è½¬æ¢å­—èŠ‚ç å¹¶ç”Ÿæˆæ–°çš„ç±».ä¸é¼“åŠ±ç›´æ¥ä½¿ç”¨ASM,å› ä¸ºå®ƒè¦æ±‚ä½ å¿…é¡»å¯¹JVMå†…éƒ¨ç»“æ„åŒ…æ‹¬classæ–‡ä»¶çš„æ ¼å¼å’ŒæŒ‡ä»¤é›†éƒ½å¾ˆç†Ÿæ‚‰. äºŒ. Cglibå­ç±»ä»£ç†å®ç°æ–¹æ³•: éœ€è¦å¼•å…¥cglibçš„jaræ–‡ä»¶,ä½†æ˜¯Springçš„æ ¸å¿ƒåŒ…ä¸­å·²ç»åŒ…æ‹¬äº†CglibåŠŸèƒ½,æ‰€ä»¥ç›´æ¥å¼•å…¥spring-core-3.2.5.jarå³å¯. å¼•å…¥åŠŸèƒ½åŒ…å,å°±å¯ä»¥åœ¨å†…å­˜ä¸­åŠ¨æ€æ„å»ºå­ç±» ä»£ç†çš„ç±»ä¸èƒ½ä¸ºfinal,å¦åˆ™æŠ¥é”™ ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•å¦‚æœä¸ºfinal/static,é‚£ä¹ˆå°±ä¸ä¼šè¢«æ‹¦æˆª,å³ä¸ä¼šæ‰§è¡Œç›®æ ‡å¯¹è±¡é¢å¤–çš„ä¸šåŠ¡æ–¹æ³•. ç¤ºä¾‹ä»£ç 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465/** * ç›®æ ‡å¯¹è±¡,æ²¡æœ‰å®ç°ä»»ä½•æ¥å£ */public class UserDao { public void save() { System.out.println(\"----å·²ç»ä¿å­˜æ•°æ®!----\"); }}/** * Cglibå­ç±»ä»£ç†å·¥å‚ * å¯¹UserDaoåœ¨å†…å­˜ä¸­åŠ¨æ€æ„å»ºä¸€ä¸ªå­ç±»å¯¹è±¡ */public class ProxyFactory implements MethodInterceptor{ //ç»´æŠ¤ç›®æ ‡å¯¹è±¡ private Object target; public ProxyFactory(Object target) { this.target = target; } //ç»™ç›®æ ‡å¯¹è±¡åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ public Object getProxyInstance(){ //1.å·¥å…·ç±» Enhancer en = new Enhancer(); //2.è®¾ç½®çˆ¶ç±» en.setSuperclass(target.getClass()); //3.è®¾ç½®å›è°ƒå‡½æ•° en.setCallback(this); //4.åˆ›å»ºå­ç±»(ä»£ç†å¯¹è±¡) return en.create(); } @Override public Object intercept(Object obj, Method method, Object[] args, MethodProxy proxy) throws Throwable { System.out.println(\"å¼€å§‹äº‹åŠ¡...\"); //æ‰§è¡Œç›®æ ‡å¯¹è±¡çš„æ–¹æ³• Object returnValue = method.invoke(target, args); System.out.println(\"æäº¤äº‹åŠ¡...\"); return returnValue; }}/** * æµ‹è¯•ç±» */public class App { @Test public void test(){ //ç›®æ ‡å¯¹è±¡ UserDao target = new UserDao(); //ä»£ç†å¯¹è±¡ UserDao proxy = (UserDao)new ProxyFactory(target).getProxyInstance(); //æ‰§è¡Œä»£ç†å¯¹è±¡çš„æ–¹æ³• proxy.save(); }} æ€»ç»“åŠ¨æ€ä»£ç†ä¸é™æ€ä»£ç†ç›¸æ¯”è¾ƒï¼Œæœ€å¤§çš„å¥½å¤„æ˜¯æ¥å£ä¸­å£°æ˜çš„æ‰€æœ‰æ–¹æ³•éƒ½è¢«è½¬ç§»åˆ°è°ƒç”¨å¤„ç†å™¨ä¸€ä¸ªé›†ä¸­çš„æ–¹æ³•ä¸­å¤„ç†ã€‚åœ¨æ¥å£æ–¹æ³•æ•°é‡æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œçµæ´»å¤„ç†ï¼Œè€Œä¸éœ€è¦åƒé™æ€ä»£ç†é‚£æ ·å¯¹æ¯ä¸€ä¸ªæ–¹æ³•æˆ–æ–¹æ³•ç»„åˆè¿›è¡Œå¤„ç†ã€‚Proxy å¾ˆç¾å¾ˆå¼ºå¤§ï¼Œä½†æ˜¯ä»…æ”¯æŒ interface ä»£ç†ã€‚Java çš„å•ç»§æ‰¿æœºåˆ¶æ³¨å®šäº†è¿™äº›åŠ¨æ€ä»£ç†ç±»ä»¬æ— æ³•å®ç°å¯¹ class çš„åŠ¨æ€ä»£ç†ã€‚å¥½åœ¨æœ‰cglibä¸ºProxyæä¾›äº†å¼¥è¡¥ã€‚classä¸interfaceçš„åŒºåˆ«æœ¬æ¥å°±æ¨¡ç³Šï¼Œåœ¨java8ä¸­æ›´æ˜¯å¢åŠ äº†ä¸€äº›æ–°ç‰¹æ€§ï¼Œä½¿å¾—interfaceè¶Šæ¥è¶Šæ¥è¿‘classï¼Œå½“æœ‰ä¸€æ—¥ï¼Œjavaçªç ´äº†å•ç»§æ‰¿çš„é™åˆ¶ï¼ŒåŠ¨æ€ä»£ç†å°†ä¼šæ›´åŠ å¼ºå¤§ã€‚ å‚è€ƒï¼šhttp://www.cnblogs.com/cenyu/p/6289209.html http://blog.csdn.net/goskalrie/article/details/52458773","link":"/2019/01/06/Javaè®¾è®¡æ¨¡å¼ä¹‹ä»£ç†æ¨¡å¼.html"},{"title":"Javaè®¾è®¡æ¨¡å¼ä¹‹å‘½ä»¤æ¨¡å¼","text":"ç›®çš„ å°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œå¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼›å¯¹è¯·æ±‚æ’é˜Ÿæˆ–è®°å½•æ—¥å¿—ï¼Œä»¥åŠæ”¯æŒå¯æ’¤é”€çš„æ“ä½œã€‚ å°†â€å‘å‡ºè¯·æ±‚çš„å¯¹è±¡â€å’Œâ€æ¥æ”¶ä¸æ‰§è¡Œè¿™äº›è¯·æ±‚çš„å¯¹è±¡â€åˆ†éš”å¼€æ¥ã€‚ æ•ˆæœ commandæ¨¡å¼å°†è°ƒç”¨æ“ä½œçš„å¯¹è±¡å’Œå®ç°è¯¥æ“ä½œçš„å¯¹è±¡è§£è€¦ å¯ä»¥å°†å¤šä¸ªå‘½ä»¤è£…é…æˆä¸€ä¸ªå¤åˆå‘½ä»¤ï¼Œå¤åˆå‘½ä»¤æ˜¯Compositeæ¨¡å¼çš„ä¸€ä¸ªå®ä¾‹ å¢åŠ æ–°çš„commandå¾ˆå®¹æ˜“ï¼Œæ— éœ€æ”¹å˜å·²æœ‰çš„ç±» é€‚ç”¨æ€§ æŠ½è±¡å‡ºå¾…æ‰§è¡Œçš„åŠ¨ä½œä»¥å‚æ•°åŒ–æŸå¯¹è±¡ åœ¨ä¸åŒçš„æ—¶åˆ»æŒ‡å®šã€æ’åˆ—å’Œæ‰§è¡Œè¯·æ±‚ã€‚å¦‚è¯·æ±‚é˜Ÿåˆ— æ”¯æŒå–æ¶ˆæ“ä½œ æ”¯æŒä¿®æ”¹æ—¥å¿— ç”¨æ„å»ºåœ¨åŸè¯­æ“ä½œä¸Šçš„é«˜å±‚æ“ä½œæ„é€ ä¸€ä¸ªç³»ç»Ÿã€‚æ”¯æŒäº‹ç‰© å‚ä¸è€… Commandå£°æ˜æ‰§è¡Œæ“ä½œçš„æ¥å£ ConcreteCommandå°†ä¸€ä¸ªæ¥æ”¶è€…å¯¹è±¡ç»‘å®šäºä¸€ä¸ªåŠ¨ä½œ è°ƒç”¨æ¥æ”¶è€…ç›¸åº”çš„æ“ä½œï¼Œä»¥å®ç°execute Clientåˆ›å»ºä¸€ä¸ªå…·ä½“å‘½ä»¤å¯¹è±¡å¹¶è®¾å®šå®ƒçš„æ¥æ”¶è€… Invokerè¦æ±‚è¯¥å‘½ä»¤æ‰§è¡Œè¿™ä¸ªè¯·æ±‚ ReceiverçŸ¥é“å¦‚ä½•å®æ–½ä¸æ‰§è¡Œä¸€ä¸ªè¯·æ±‚ç›¸å…³çš„æ“ä½œã€‚ä»»ä½•ç±»éƒ½å¯èƒ½ä½œä¸ºä¸€ä¸ªæ¥æ”¶è€… ç»“æ„å›¾ åä½œï¼š 1)ã€clientåˆ›å»ºä¸€ä¸ªConcreteCommandå¯¹è±¡å¹¶æŒ‡å®šå®ƒçš„Receiverå¯¹è±¡ 2)ã€æŸInvokerå¯¹è±¡å­˜å‚¨è¯¥ConcreteCommandå¯¹è±¡ 3)ã€è¯¥Invokeré€šè¿‡è°ƒç”¨Commandå¯¹è±¡çš„executeæ“ä½œæ¥æäº¤ä¸€ä¸ªè¯·æ±‚ã€‚è‹¥è¯¥å‘½ä»¤æ˜¯å¯æ’¤é”€çš„ï¼ŒConcreteCommandåœ¨æ‰§è¡Œexecuteæ“ä½œå‰å­˜å‚¨å½“å‰çŠ¶æ€ä»¥ç”¨äºå–æ¶ˆè¯¥å‘½ä»¤ 4)ã€ConcreteCommandå¯¹è±¡è°ƒç”¨å®ƒçš„Receiverçš„æ“ä½œä»¥æ‰§è¡Œè¯¥è¯·æ±‚ å‘½ä»¤å¯¹è±¡å°†åŠ¨ä½œå’Œæ¥å—è€…åŒ…è¿›å¯¹è±¡ä¸­ï¼Œè¿™ä¸ªå¯¹è±¡åªæš´éœ²å‡ºä¸€ä¸ªexecute()æ–¹æ³•ï¼Œå½“æ­¤æ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œæ¥æ”¶è€…å°±ä¼šè¿›è¡Œè¿™äº›åŠ¨ä½œã€‚ä»å¤–é¢æ¥çœ‹ï¼Œå…¶ä»–å¯¹è±¡ä¸çŸ¥é“ç©¶ç«Ÿå“ªä¸ªæ¥æ”¶è€…è¿›è¡Œäº†å“ªäº›åŠ¨ä½œï¼ŒåªçŸ¥é“å¦‚æœè°ƒç”¨execute()æ–¹æ³•ï¼Œè¯·æ±‚çš„ç›®çš„å°±èƒ½è¾¾åˆ°ã€‚ java å®ç°æºç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102/** * @desc å‘½ä»¤æ¥å£ */public interface Command { /** * æ‰§è¡Œå‘½ä»¤ */ void excute(); /** * æ’¤é”€å‘½ä»¤ */ void undo();}/** * @desc çœŸæ­£å‘½ä»¤æ‰§è¡Œè€…ï¼Œæ¥æ”¶è€… */public class Receiver { public void action() { System.out.println(\"æ­£åœ¨æ‰§è¡Œå‘½ä»¤...\"); } public void unAction() { System.out.println(\"æ­£åœ¨æ’¤é”€å‘½ä»¤...\"); }}/** * @desc åˆ›å»ºå‘½ä»¤ï¼ˆå¯å®ç°å¤šæ¡å‘½ä»¤ä»¥åŠå¤šä¸ªå‘½ä»¤æ‰§è¡Œäººï¼‰ */public class CreateCommand implements Command { private Receiver receiver; /** * åˆå§‹åŒ–å‘½ä»¤æ¥æ”¶äºº * * @param receiver */ public CreateCommand(Receiver receiver) { this.receiver = receiver; } @Override public void excute() { receiver.action(); } @Override public void undo() { receiver.unAction(); }}/** * @desc å‘½ä»¤è°ƒç”¨è€… */public class Invoker { private Command command; /** * å‘½ä»¤è°ƒç”¨è€…æŒæœ‰è¯¥å‘½ä»¤ * * @param command */ public Invoker(Command command) { this.command = command; } /** * æ‰§è¡Œå‘½ä»¤ */ public void runCommand() { command.excute(); } /** * æ’¤é”€å‘½ä»¤ */ public void unRunCommand() { command.undo(); }}/** * @desc å‘½ä»¤æ¨¡å¼æµ‹è¯• */public class TestMain { public static void main(String[] args) { // new ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œäºº Receiver receiver = new Receiver(); // new ä¸€æ¡å‘½ä»¤ Command command = new CreateCommand(receiver); // å¼€å§‹è°ƒç”¨å‘½ä»¤ Invoker invoker = new Invoker(command); invoker.runCommand(); invoker.unRunCommand(); }} æ‰§è¡Œç»“æœ å¸¸è§åº”ç”¨ï¼š 1ã€å·¥ä½œé˜Ÿåˆ—ï¼Œçº¿ç¨‹æ± ï¼Œæ—¥ç¨‹å®‰æ’ 2ã€æ—¥å¿—è¯·æ±‚(ç³»ç»Ÿæ¢å¤)è¦ç‚¹ï¼š 1ã€å‘½ä»¤æ¨¡å¼å°†å‘å‡ºè¯·æ±‚çš„å¯¹è±¡å’Œæ‰§è¡Œè¯·æ±‚çš„å¯¹è±¡è§£è€¦ 2ã€åœ¨è¢«è§£è€¦çš„ä¸¤è€…ä¹‹é—´æ˜¯é€šè¿‡å‘½ä»¤å¯¹è±¡è¿›è¡Œæ²Ÿé€šçš„ã€‚å‘½ä»¤å¯¹è±¡å°è£…äº†æ¥æ”¶è€…å’Œä¸€ä¸ªæˆ–ä¸€ç»„åŠ¨ä½œ 3ã€è°ƒç”¨è€…é€šè¿‡è°ƒç”¨å‘½ä»¤å¯¹è±¡çš„execute()å‘å‡ºè¯·æ±‚ï¼Œè¿™ä¼šä½¿å¾—æ¥æ”¶è€…çš„åŠ¨ä½œè¢«è°ƒç”¨ 4ã€è°ƒç”¨è€…å¯ä»¥æ¥å—å‘½ä»¤å½“ä½œå‚æ•°ï¼Œç”šè‡³åœ¨è¿è¡Œæ—¶åŠ¨æ€çš„è¿›è¡Œ 5ã€å‘½ä»¤å¯ä»¥æ”¯æŒæ’¤é”€ï¼Œåšæ³•æ˜¯å®ç°ä¸€ä¸ªundo()æ–¹æ³•æ¥å›åˆ°execute()è¢«æ‰§è¡Œå‰çš„çŠ¶æ€ 6ã€å®å‘½ä»¤æ˜¯å‘½ä»¤çš„ä¸€ç§ç®€å•çš„å»¶ä¼¸ï¼Œå…è®¸è°ƒç”¨å¤šä¸ªå‘½ä»¤ã€‚å®æ–¹æ³•ä¹Ÿå¯ä»¥æ”¯æŒæ’¤é”€ 7ã€å®é™…æ“ä½œæ—¶ï¼Œå¾ˆå¸¸è§ä½¿ç”¨â€èªæ˜â€å‘½ä»¤å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥å®ç°äº†è¯·æ±‚ï¼Œè€Œä¸æ˜¯å°†å·¥ä½œå§”æ‰˜ç»™æ¥å—è€…(å¼Šç«¯ï¼Ÿ) 8ã€å‘½ä»¤ä¹Ÿå¯ä»¥ç”¨æ¥å®ç°æ—¥å¿—å’Œäº‹ç‰©ç³»ç»Ÿ å‚è€ƒï¼šhttp://www.cnblogs.com/ikuman/archive/2013/08/06/3233092.html","link":"/2019/01/04/Javaè®¾è®¡æ¨¡å¼ä¹‹å‘½ä»¤æ¨¡å¼.html"},{"title":"java 8éƒ¨åˆ†è¯»ä¹¦ç¬”è®°","text":"Lambda è¡¨è¾¾å¼ Lambda è¡¨è¾¾å¼å¼•ç”¨çš„æ˜¯å€¼ï¼Œä¸æ˜¯å˜é‡ã€‚ Lambda è¡¨è¾¾å¼ä¸­çš„å˜é‡åªèƒ½æ˜¯finalç±»å‹ï¼Œåªèƒ½ç»™å˜é‡èµ‹å€¼ä¸€æ¬¡ã€‚ 123String name = getUserName();name = formatUesrName();button.addActionListener(event -&gt; System.out.println(\"Hi\" + name)) å¦‚ä¸Šä»£ç å°†ä¸ä¼šç¼–è¯‘é€šè¿‡ï¼Œnameè¢«èµ‹å€¼å¤šæ¬¡ã€‚ å‡½æ•°æ¥å£ï¼šåªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ï¼Œç”¨ä½œLambdaè¡¨è¾¾å¼çš„ç±»å‹ã€‚ Javaä¸­é‡è¦çš„å‡ ä¸ªå‡½æ•°æ¥å£ åç§° è§£é‡Š è¿”å›å€¼ eg å‚æ•° Predicate æ–­è¨€ boolean è¿™å¼ å”±ç‰‡å·²ç»å‘è¡Œäº†å— T Consumer æ¶ˆè´¹ void è¾“å‡ºä¸€ä¸ªå€¼ T Function&lt;T,R&gt; è¿è¡Œ R è·å¾—Artistå¯¹è±¡çš„åå­— T Supplier ä¾›åº” T å·¥å‚æ–¹æ³• None UnaryOperator ä¸€å…ƒè¿ç®— T é€»è¾‘é(!) T BinaryOperator äºŒå…ƒè¿ç®— T æ±‚ä¸¤ä¸ªæ•°çš„ä¹˜ç§¯ (T,T) æ‰€æœ‰çš„éƒ½æœ‰æ³›å‹æ²¡æœ‰çš„è¯å€¼ä»£ç ç¼–è¯‘ä¸è¿‡ 123Predicate&lt;Integer&gt; atLeast5 = x -&gt; x &gt; 5;// ç¼–è¯‘é€šè¿‡Predicate atLeast5 = x -&gt; x &gt; 5;// ç¼–è¯‘ä¸é€šè¿‡BinaryOperator&lt;Long&gt; addLongs = (x , y) -&gt; x + y;// ç¼–è¯‘é€šè¿‡ æµ Stream(é’ˆå¯¹äºé›†åˆ) æƒ°æ€§æ±‚å€¼ å’ŒåŠæ—©æ±‚å€¼ 1allArtists.stream().filter(artist -&gt; artist.isFrom(\"London\")); è¿™è¡Œä»£ç å¹¶æ²¡æœ‰åšä»€ä¹ˆå®è´¨æ€§å·¥ä½œ,filteråªæ˜¯åˆ»ç”»å‡ºäº†Streamï¼Œæ²¡æœ‰äº§ç”Ÿæ–°çš„é›†åˆã€‚åƒfilterè¿™ç§åªæè¿°Streamï¼Œä¸äº§ç”Ÿæ–°é›†åˆçš„æ–¹æ³•å«åšæƒ°æ€§æ±‚å€¼æ–¹æ³•,è€Œåƒcountè¿™æ ·æœ€ç»ˆä¼šä»Streamäº§ç”Ÿå€¼çš„æ–¹æ³•å«åšåŠæ—©æ±‚å€¼æ–¹æ³•ã€‚ 123456789allArtists.stream().filter(artist - &gt;{ System.out.println(artist.getName()); return artist.isFrom(\"London\");});// æ­¤æ®µä»£ç å¹¶ä¸ä¼šè¾“å‡º è‰ºæœ¯å®¶åå­—allArtists.stream().filter(artist - &gt;{ System.out.println(artist.getName()); return artist.isFrom(\"London\");}).count();// æ­¤æ®µä»£ç å¹¶ä¼šè¾“å‡º è‰ºæœ¯å®¶åå­— åˆ¤æ–­ä¸€ä¸ªæ“ä½œæ˜¯æƒ°æ€§æ±‚å€¼è¿˜æ˜¯åŠæ—©æ±‚å€¼ï¼Œåªéœ€çœ‹å®ƒçš„è¿”å›å€¼ï¼Œè¿”å›å€¼æ˜¯Stream,é‚£ä¹ˆå°±æ˜¯æƒ°æ€§æ±‚å€¼ï¼Œè¿”å›å€¼æ˜¯å¦ä¸€ä¸ªå€¼æˆ–è€…æ˜¯ç©ºï¼Œåˆ™æ˜¯åŠæ—©æ±‚å€¼ã€‚æœ€ç»ˆè¾¾åˆ°çš„æ•ˆæœï¼šé€šè¿‡è¿™äº›æ–¹æ³•å½¢æˆä¸€ä¸ªæƒ°æ€§æ±‚å€¼çš„é“¾ï¼Œæœ€ç»ˆè°ƒç”¨ä¸€ä¸ªåŠæ—©æ±‚å€¼æ–¹æ³•å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„æœ€ç»ˆç»“æœã€‚ å¸¸ç”¨çš„æµæ“ä½œ collect(toList()) :ç”±Streamé‡Œçš„å€¼ç”Ÿæˆä¸€ä¸ªåˆ—è¡¨ Streamçš„of æ–¹æ³•ä½¿ç”¨ä¸€ç»„åˆå§‹å€¼ç”Ÿæˆæ–°çš„Stream 12List&lt;String&gt; collected = Stream.of(\"a\",\"b\",\"c\").collect(Collectors.toList());assertEquals(Arrays.asList(\"a\",\"b\",\"c\"),collected);//åˆ¤æ–­ç»“æœå’Œé¢„æœŸå€¼æ˜¯å¦ä¸€æ · map å°†ä¸€ç§ç±»å‹è½¬æ¢ä¸ºå¦ä¸€ç§ç±»å‹ï¼Œå°†ä¸€ä¸ªæµä¸­çš„å€¼è½¬æ¢ä¸ºä¸€ä¸ªæ–°çš„æµã€‚mapToInt/mapToDouble/mapToLong 123List&lt;String&gt; collected = Stream.of(\"a\",\"b\",\"hello\") .map(string -&gt; string.toUpperCase()) .collect(Collectors.toList());//å°†å°å†™è½¬æ¢ä¸ºå¤§å†™ filter filteræ¨¡å¼ï¼Œä¿ç•™Streamä¸­çš„ä¸€äº›å…ƒç´ ï¼Œè¿‡æ»¤æ‰å…¶ä»–çš„ã€‚è¿”å›trueä¿ç•™ï¼Œè¿”å›falseè¿‡æ»¤ã€‚ 123List&lt;String&gt; beginWithNumbers = Stream.of(\"a\",\"1adf\",\"abc1\") .filter(value -&gt; isDigit(value.chartAt(0))) .collect(toList());//è¿”å›æ•°æ®å¼€å¤´çš„å­—ç¬¦ä¸² flatMap :å¯ç”¨Streamæ›¿æ¢å€¼ï¼Œå°†å¤šä¸ªStreamè¿æ¥æˆä¸€ä¸ªStream 123List&lt;Integer&gt; together = Stream.of(asList(1,2), asList(3,4)) .flatMap(numbers -&gt; numbers.stream()) .collect(toList()); å®ƒä¼šæŠŠåŸæµä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ç»è¿‡æŒ‡å®šå‡½æ•°å¤„ç†ä¹‹åï¼Œè¿”å›ä¸€ä¸ªStreamå¯¹è±¡ï¼Œå¹¶å°†ä¹‹å±•å¼€åˆ°åŸçˆ¶æµä¸­ã€‚ maxå’Œmin 1234List&lt;Track&gt; tracks = asList(new Track(\"Bakai\",524), new Track(\"Violets\",378), new Track(\"Time\",451));Track shortestTrack = tracks.stream().min(Commparator.comparing(track -&gt; track.getLength())).get();// æŸ¥æ‰¾è·ç¦»æœ€çŸ­çš„ reduce èšåˆå½’çº³ï¼šæ“ä½œä¸­å¯ä»¥å®ç°ä»ä¸€ç»„å€¼ç”Ÿæˆä¸€ä¸ªå€¼ ä½¿ç”¨reduceæ±‚å’Œ 12int count = Stream.of(1,2,3) .reduce(0, (acc, element) -&gt; acc + element); å±•å¼€reduceæ“ä½œ 123456BinaryOperator&lt;Integer&gt; accumulator = (acc, element) -&gt; acc + element;int count = accumulator.apply( accumulator.apply( accumulator.apply(0, 1), 2), 3); 1collections.stream().map(Entity::getNum).reduce(0, Integer::sum); // collectionsæ±‚å’Œnum 1234//æ ¹æ®typeIdåˆ†ç»„ entities[{typeId:1,name:\"ç«é”…\"},{typeId:1,name:\"çƒ§çƒ¤\"}ï¼Œ{typeId:2,name:\"å¾‹å¸ˆ\"}]Map&lt;Integer, List&lt;Entity&gt;&gt; groups = entities.stream() .collect(Collectors.groupingBy(Entity::getTypeId));List&lt;Entity&gt; list = groups.get(typeId); //æ‹¿åˆ°å¯¹åº”çš„åˆ†ç»„æ•°æ® æ‰¾å‡ºé•¿åº¦å¤§äºä¸€åˆ†é’Ÿçš„æ›²ç›® 1234567public Set&lt;String&gt; findLongTracks(List&lt;Album&gt; albums){ return albums.stream() .flatMap(album -&gt; album.getTracks()) .filter(track -&gt; track.getLength() &gt; 60) .map(track -&gt; track.getName) .collect(toSet());}","link":"/2018/12/19/java-8éƒ¨åˆ†è¯»ä¹¦ç¬”è®°.html"},{"title":"Javaè®¾è®¡æ¨¡å¼ä¹‹é€‚é…å™¨æ¨¡å¼","text":"å®šä¹‰ é€‚é…å™¨æ¨¡å¼æŠŠä¸€ä¸ªç±»çš„æ¥å£å˜æ¢æˆå®¢æˆ·ç«¯æ‰€æœŸå¾…çš„å¦ä¸€ç§æ¥å£ï¼Œä»è€Œä½¿åŸæœ¬å› æ¥å£ä¸åŒ¹é…è€Œæ— æ³•åœ¨ä¸€èµ·å·¥ä½œçš„ä¸¤ä¸ªç±»èƒ½å¤Ÿåœ¨ä¸€èµ·å·¥ä½œã€‚ é€‚é…å™¨æ¨¡å¼çš„ç”¨é€”ç”¨ç”µå™¨åšä¾‹å­ï¼Œç¬”è®°æœ¬ç”µè„‘çš„æ’å¤´ä¸€èˆ¬éƒ½æ˜¯ä¸‰ç›¸çš„ï¼Œå³é™¤äº†é˜³æã€é˜´æå¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªåœ°æã€‚è€Œæœ‰äº›åœ°æ–¹çš„ç”µæºæ’åº§å´åªæœ‰ä¸¤æï¼Œæ²¡æœ‰åœ°æã€‚ç”µæºæ’åº§ä¸ç¬”è®°æœ¬ç”µè„‘çš„ç”µæºæ’å¤´ä¸åŒ¹é…ä½¿å¾—ç¬”è®°æœ¬ç”µè„‘æ— æ³•ä½¿ç”¨ã€‚è¿™æ—¶å€™ä¸€ä¸ªä¸‰ç›¸åˆ°ä¸¤ç›¸çš„è½¬æ¢å™¨ï¼ˆé€‚é…å™¨ï¼‰å°±èƒ½è§£å†³æ­¤é—®é¢˜ï¼Œè€Œè¿™æ­£åƒæ˜¯æœ¬æ¨¡å¼æ‰€åšçš„äº‹æƒ…ã€‚ é€‚é…å™¨æ¨¡å¼çš„ç»“æ„é€‚é…å™¨æ¨¡å¼æœ‰ç±»çš„é€‚é…å™¨æ¨¡å¼å’Œå¯¹è±¡çš„é€‚é…å™¨æ¨¡å¼ä¸¤ç§ä¸åŒçš„å½¢å¼ã€‚ ç±»é€‚é…å™¨æ¨¡å¼ç±»çš„é€‚é…å™¨æ¨¡å¼æŠŠé€‚é…çš„ç±»çš„APIè½¬æ¢æˆä¸ºç›®æ ‡ç±»çš„APIã€‚ åœ¨ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒAdapteeç±»å¹¶æ²¡æœ‰sampleOperation2()æ–¹æ³•ï¼Œè€Œå®¢æˆ·ç«¯åˆ™æœŸå¾…è¿™ä¸ªæ–¹æ³•ã€‚ä¸ºä½¿å®¢æˆ·ç«¯èƒ½å¤Ÿä½¿ç”¨Adapteeç±»ï¼Œæä¾›ä¸€ä¸ªä¸­é—´ç¯èŠ‚ï¼Œå³ç±»Adapterï¼ŒæŠŠAdapteeçš„APIä¸Targetç±»çš„APIè¡”æ¥èµ·æ¥ã€‚Adapterä¸Adapteeæ˜¯ç»§æ‰¿å…³ç³»ï¼Œè¿™å†³å®šäº†è¿™ä¸ªé€‚é…å™¨æ¨¡å¼æ˜¯ç±»çš„ï¼š æ¨¡å¼æ‰€æ¶‰åŠçš„è§’è‰²æœ‰ï¼š â— ç›®æ ‡(Target)è§’è‰²ï¼šè¿™å°±æ˜¯æ‰€æœŸå¾…å¾—åˆ°çš„æ¥å£ã€‚æ³¨æ„ï¼šç”±äºè¿™é‡Œè®¨è®ºçš„æ˜¯ç±»é€‚é…å™¨æ¨¡å¼ï¼Œå› æ­¤ç›®æ ‡ä¸å¯ä»¥æ˜¯ç±»ã€‚ â— æº(Adapee)è§’è‰²ï¼šç°åœ¨éœ€è¦é€‚é…çš„æ¥å£ã€‚ â— é€‚é…å™¨(Adapter)è§’è‰²ï¼šé€‚é…å™¨ç±»æ˜¯æœ¬æ¨¡å¼çš„æ ¸å¿ƒã€‚é€‚é…å™¨æŠŠæºæ¥å£è½¬æ¢æˆç›®æ ‡æ¥å£ã€‚æ˜¾ç„¶ï¼Œè¿™ä¸€è§’è‰²ä¸å¯ä»¥æ˜¯æ¥å£ï¼Œè€Œå¿…é¡»æ˜¯å…·ä½“ç±»ã€‚ javaæºç 123456789101112131415161718192021222324252627282930313233343536public interface Target { /** * è¿™æ˜¯æºç±»Adapteeä¹Ÿæœ‰çš„æ–¹æ³• */ public void sampleOperation1(); /** * è¿™æ˜¯æºç±»Adapteeeæ²¡æœ‰çš„æ–¹æ³• */ public void sampleOperation2(); }/**ä¸Šé¢ç»™å‡ºçš„æ˜¯ç›®æ ‡è§’è‰²çš„æºä»£ç ï¼Œè¿™ä¸ªè§’è‰²æ˜¯ä»¥ä¸€ä¸ªJAVAæ¥å£çš„å½¢å¼å®ç°çš„ã€‚å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªæ¥å£å£°æ˜äº†ä¸¤ä¸ªæ–¹æ³•ï¼š*sampleOperation1()å’ŒsampleOperation2()ã€‚è€Œæºè§’è‰²Adapteeæ˜¯ä¸€ä¸ªå…·ä½“ç±»ï¼Œå®ƒæœ‰ä¸€ä¸ªsampleOperation1()æ–¹æ³•ï¼Œä½†æ˜¯æ²¡æœ‰sampleOperation2()æ–¹æ³•ã€‚*/public class Adaptee { public void sampleOperation1(){}}/**é€‚é…å™¨è§’è‰²Adapteræ‰©å±•äº†Adaptee,åŒæ—¶åˆå®ç°äº†ç›®æ ‡(Target)æ¥å£ã€‚ç”±äºAdapteeæ²¡æœ‰æä¾›sampleOperation2()æ–¹æ³•ï¼Œè€Œç›®æ ‡æ¥å£åˆè¦æ±‚è¿™ä¸ªæ–¹æ³•ï¼Œå› æ­¤é€‚é…å™¨è§’è‰²Adapterå®ç°äº†è¿™ä¸ªæ–¹æ³•ã€‚*/public class Adapter extends Adaptee implements Target { /** * ç”±äºæºç±»Adapteeæ²¡æœ‰æ–¹æ³•sampleOperation2() * å› æ­¤é€‚é…å™¨è¡¥å……ä¸Šè¿™ä¸ªæ–¹æ³• */ @Override public void sampleOperation2() { //å†™ç›¸å…³çš„ä»£ç  }} å¯¹è±¡é€‚é…å™¨æ¨¡å¼ä¸ç±»çš„é€‚é…å™¨æ¨¡å¼ä¸€æ ·ï¼Œå¯¹è±¡çš„é€‚é…å™¨æ¨¡å¼æŠŠè¢«é€‚é…çš„ç±»çš„APIè½¬æ¢æˆä¸ºç›®æ ‡ç±»çš„APIï¼Œä¸ç±»çš„é€‚é…å™¨æ¨¡å¼ä¸åŒçš„æ˜¯ï¼Œå¯¹è±¡çš„é€‚é…å™¨æ¨¡å¼ä¸æ˜¯ä½¿ç”¨ç»§æ‰¿å…³ç³»è¿æ¥åˆ°Adapteeç±»ï¼Œè€Œæ˜¯ä½¿ç”¨å§”æ´¾å…³ç³»è¿æ¥åˆ°Adapteeç±»ã€‚ ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼ŒAdapteeç±»å¹¶æ²¡æœ‰sampleOperation2()æ–¹æ³•ï¼Œè€Œå®¢æˆ·ç«¯åˆ™æœŸå¾…è¿™ä¸ªæ–¹æ³•ã€‚ä¸ºä½¿å®¢æˆ·ç«¯èƒ½å¤Ÿä½¿ç”¨Adapteeç±»ï¼Œéœ€è¦æä¾›ä¸€ä¸ªåŒ…è£…(Wrapper)ç±»Adapterã€‚è¿™ä¸ªåŒ…è£…ç±»åŒ…è£…äº†ä¸€ä¸ªAdapteeçš„å®ä¾‹ï¼Œä»è€Œæ­¤åŒ…è£…ç±»èƒ½å¤ŸæŠŠAdapteeçš„APIä¸Targetç±»çš„APIè¡”æ¥èµ·æ¥ã€‚Adapterä¸Adapteeæ˜¯å§”æ´¾å…³ç³»ï¼Œè¿™å†³å®šäº†é€‚é…å™¨æ¨¡å¼æ˜¯å¯¹è±¡çš„ã€‚ java æºç å®ç°1234567891011121314151617181920212223242526272829303132333435363738public interface Target { /** * è¿™æ˜¯æºç±»Adapteeä¹Ÿæœ‰çš„æ–¹æ³• */ public void sampleOperation1(); /** * è¿™æ˜¯æºç±»Adapteeeæ²¡æœ‰çš„æ–¹æ³• */ public void sampleOperation2(); }public class Adaptee { public void sampleOperation1(){} }public class Adapter { private Adaptee adaptee; public Adapter(Adaptee adaptee){ this.adaptee = adaptee; } /** * æºç±»Adapteeæœ‰æ–¹æ³•sampleOperation1 * å› æ­¤é€‚é…å™¨ç±»ç›´æ¥å§”æ´¾å³å¯ */ public void sampleOperation1(){ this.adaptee.sampleOperation1(); } /** * æºç±»Adapteeæ²¡æœ‰æ–¹æ³•sampleOperation2 * å› æ­¤ç”±é€‚é…å™¨ç±»éœ€è¦è¡¥å……æ­¤æ–¹æ³• */ public void sampleOperation2(){ //å†™ç›¸å…³çš„ä»£ç  }} ç±»é€‚é…å™¨æ¨¡å¼å’Œå¯¹è±¡é€‚é…å™¨æ¨¡å¼çš„æƒè¡¡ ç±»é€‚é…å™¨ï¼Œä½¿ç”¨å¯¹è±¡ç»§æ‰¿çš„æ–¹å¼ï¼Œæ˜¯é™æ€çš„å®šä¹‰æ–¹å¼ï¼›å¯¹è±¡é€‚é…å™¨ï¼Œä½¿ç”¨å¯¹è±¡ç»„åˆçš„æ–¹å¼ï¼Œæ˜¯åŠ¨æ€ç»„åˆçš„æ–¹å¼ã€‚ å¯¹äºç±»é€‚é…å™¨ï¼Œç”±äºé€‚é…å™¨ç›´æ¥ç»§æ‰¿äº†Adapteeï¼Œä½¿å¾—é€‚é…å™¨ä¸èƒ½å’ŒAdapteeçš„å­ç±»ä¸€èµ·å·¥ä½œï¼Œå› ä¸ºç»§æ‰¿æ˜¯é™æ€çš„å…³ç³» å¯¹äºå¯¹è±¡é€‚é…å™¨ï¼Œä¸€ä¸ªé€‚é…å™¨å¯ä»¥æŠŠå¤šç§ä¸åŒçš„æºé€‚é…åˆ°åŒä¸€ä¸ªç›®æ ‡ã€‚æ¢è¨€ä¹‹ï¼ŒåŒä¸€ä¸ªé€‚é…å™¨å¯ä»¥æŠŠæºç±»å’Œå®ƒçš„å­ç±»éƒ½é€‚é…åˆ°ç›®æ ‡æ¥å£ã€‚å› ä¸ºå¯¹è±¡é€‚é…å™¨é‡‡ç”¨çš„æ˜¯å¯¹è±¡ç»„åˆçš„å…³ç³»ï¼Œåªè¦å¯¹è±¡ç±»å‹æ­£ç¡®ï¼Œæ˜¯ä¸æ˜¯å­ç±»éƒ½æ— æ‰€è°“ã€‚ å¯¹äºç±»é€‚é…å™¨ï¼Œé€‚é…å™¨å¯ä»¥é‡å®šä¹‰Adapteeçš„éƒ¨åˆ†è¡Œä¸ºï¼Œç›¸å½“äºå­ç±»è¦†ç›–çˆ¶ç±»çš„éƒ¨åˆ†å®ç°æ–¹æ³•ã€‚ å¯¹äºå¯¹è±¡é€‚é…å™¨ï¼Œè¦é‡å®šä¹‰Adapteeçš„è¡Œä¸ºæ¯”è¾ƒå›°éš¾ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦å®šä¹‰Adapteeçš„å­ç±»æ¥å®ç°é‡å®šä¹‰ï¼Œç„¶åè®©é€‚é…å™¨ç»„åˆå­ç±»ã€‚è™½ç„¶é‡å®šä¹‰Adapteeçš„è¡Œä¸ºæ¯”è¾ƒå›°éš¾ï¼Œä½†æ˜¯æƒ³è¦å¢åŠ ä¸€äº›æ–°çš„è¡Œä¸ºåˆ™æ–¹ä¾¿çš„å¾ˆï¼Œè€Œä¸”æ–°å¢åŠ çš„è¡Œä¸ºå¯åŒæ—¶é€‚ç”¨äºæ‰€æœ‰çš„æºã€‚ å¯¹äºç±»é€‚é…å™¨ï¼Œä»…ä»…å¼•å…¥äº†ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸éœ€è¦é¢å¤–çš„å¼•ç”¨æ¥é—´æ¥å¾—åˆ°Adapteeã€‚ å¯¹äºå¯¹è±¡é€‚é…å™¨ï¼Œéœ€è¦é¢å¤–çš„å¼•ç”¨æ¥é—´æ¥å¾—åˆ°Adapteeã€‚ å»ºè®®å°½é‡ä½¿ç”¨å¯¹è±¡é€‚é…å™¨çš„å®ç°æ–¹å¼ï¼Œå¤šç”¨åˆæˆ/èšåˆã€å°‘ç”¨ç»§æ‰¿ã€‚å½“ç„¶ï¼Œå…·ä½“é—®é¢˜å…·ä½“åˆ†æï¼Œæ ¹æ®éœ€è¦æ¥é€‰ç”¨å®ç°æ–¹å¼ï¼Œæœ€é€‚åˆçš„æ‰æ˜¯æœ€å¥½çš„ã€‚ é€‚é…å™¨æ¨¡å¼çš„ä¼˜ç‚¹ æ›´å¥½çš„å¤ç”¨æ€§ ç³»ç»Ÿéœ€è¦ä½¿ç”¨ç°æœ‰çš„ç±»ï¼Œè€Œæ­¤ç±»çš„æ¥å£ä¸ç¬¦åˆç³»ç»Ÿçš„éœ€è¦ã€‚é‚£ä¹ˆé€šè¿‡é€‚é…å™¨æ¨¡å¼å°±å¯ä»¥è®©è¿™äº›åŠŸèƒ½å¾—åˆ°æ›´å¥½çš„å¤ç”¨ã€‚ æ›´å¥½çš„æ‰©å±•æ€§ åœ¨å®ç°é€‚é…å™¨åŠŸèƒ½çš„æ—¶å€™ï¼Œå¯ä»¥è°ƒç”¨è‡ªå·±å¼€å‘çš„åŠŸèƒ½ï¼Œä»è€Œè‡ªç„¶åœ°æ‰©å±•ç³»ç»Ÿçš„åŠŸèƒ½ã€‚ é€‚é…å™¨æ¨¡å¼çš„ç¼ºç‚¹è¿‡å¤šçš„ä½¿ç”¨é€‚é…å™¨ï¼Œä¼šè®©ç³»ç»Ÿéå¸¸é›¶ä¹±ï¼Œä¸æ˜“æ•´ä½“è¿›è¡ŒæŠŠæ¡ã€‚æ¯”å¦‚ï¼Œæ˜æ˜çœ‹åˆ°è°ƒç”¨çš„æ˜¯Aæ¥å£ï¼Œå…¶å®å†…éƒ¨è¢«é€‚é…æˆäº†Bæ¥å£çš„å®ç°ï¼Œä¸€ä¸ªç³»ç»Ÿå¦‚æœå¤ªå¤šå‡ºç°è¿™ç§æƒ…å†µï¼Œæ— å¼‚äºä¸€åœºç¾éš¾ã€‚å› æ­¤å¦‚æœä¸æ˜¯å¾ˆæœ‰å¿…è¦ï¼Œå¯ä»¥ä¸ä½¿ç”¨é€‚é…å™¨ï¼Œè€Œæ˜¯ç›´æ¥å¯¹ç³»ç»Ÿè¿›è¡Œé‡æ„ã€‚ ç¼ºçœé€‚é…å™¨æ¨¡å¼ç¼ºçœé€‚é…(Default Adapter)æ¨¡å¼ä¸ºä¸€ä¸ªæ¥å£æä¾›ç¼ºçœå®ç°ï¼Œè¿™æ ·å­ç±»å‹å¯ä»¥ä»è¿™ä¸ªç¼ºçœå®ç°è¿›è¡Œæ‰©å±•ï¼Œè€Œä¸å¿…ä»åŸæœ‰æ¥å£è¿›è¡Œæ‰©å±•ã€‚ä½œä¸ºé€‚é…å™¨æ¨¡å¼çš„ä¸€ä¸ªç‰¹ä¾‹ï¼Œç¼ºçœæ˜¯é€‚é…æ¨¡å¼åœ¨JAVAè¯­è¨€ä¸­æœ‰ç€ç‰¹æ®Šçš„åº”ç”¨ã€‚ å®ä¾‹1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768/***é²æ™ºæ·±çš„æ•…äº‹* å’Œå°šè¦åšä»€ä¹ˆå‘¢ï¼Ÿåƒæ–‹ã€å¿µç»ã€æ‰“åã€æ’é’Ÿã€ä¹ æ­¦ç­‰ã€‚å¦‚æœè®¾è®¡ä¸€ä¸ªå’Œå°š*æ¥å£ï¼Œ*ç»™å‡ºæ‰€æœ‰çš„å’Œå°šéƒ½éœ€è¦å®ç°çš„æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¥å£åº”å½“å¦‚ä¸‹ï¼š*/public interface å’Œå°š { public void åƒæ–‹ï¼ˆï¼‰ï¼› public void å¿µç»ï¼ˆï¼‰ï¼› public void æ‰“åï¼ˆï¼‰ï¼› public void æ’é’Ÿï¼ˆï¼‰ï¼› public void ä¹ æ­¦ï¼ˆï¼‰ï¼› public String getName();}/**æ˜¾ç„¶ï¼Œæ‰€æœ‰çš„å’Œå°šç±»éƒ½åº”å½“å®ç°æ¥å£æ‰€å®šä¹‰çš„å…¨éƒ¨æ–¹æ³•ï¼Œä¸ç„¶å°±æ ¹æœ¬é€šä¸è¿‡JAVAè¯­è¨€ç¼–è¾‘å™¨ã€‚åƒä¸‹é¢çš„é²æ™ºæ·±ç±»å°±ä¸è¡Œã€‚*/public class é²æ™ºæ·± implements å’Œå°š{ public void ä¹ æ­¦(){ æ‹³æ‰“é•‡å…³è¥¿ï¼› å¤§é—¹äº”å°å±±ï¼› å¤§é—¹æ¡ƒèŠ±æ‘ï¼› ç«çƒ§ç“¦å®˜å¯ºï¼› å€’æ‹”å‚æ¨æŸ³ï¼› } public String getName(){ return \"é²æ™ºæ·±\"; }}/*** ç”±äºé²æ™ºæ·±åªå®ç°äº†getName()å’Œä¹ æ­¦()æ–¹æ³•ï¼Œè€Œæ²¡æœ‰å®ç°ä»»ä½•å…¶ä»–çš„æ–¹æ³•ã€‚å› æ­¤ï¼Œå®ƒæ ¹æœ¬å°±é€šä¸è¿‡Javaè¯­è¨€ç¼–è¯‘å™¨ã€‚*é²æ™ºæ·±ç±»åªæœ‰å®ç°å’Œå°šæ¥å£çš„æ‰€æœ‰çš„æ–¹æ³•æ‰å¯ä»¥é€šè¿‡Javaè¯­è¨€ç¼–è¯‘å™¨ï¼Œä½†æ˜¯è¿™æ ·ä¸€æ¥é²æ™ºæ·±å°±ä¸å†æ˜¯é²æ™ºæ·±äº†ã€‚*ä»¥å²ä¸ºé‰´ï¼Œå¯ä»¥çŸ¥å¤©ä¸‹ã€‚ç ”ç©¶ä¸€ä¸‹å‡ ç™¾å¹´å‰é²æ™ºæ·±æ˜¯æ€ä¹ˆå‰ƒåº¦æˆå’Œå°šçš„ï¼Œä¼šå¯¹Javaç¼–ç¨‹æœ‰å¾ˆå¤§çš„å¯å‘ã€‚*ä¸é”™ï¼Œå½“åˆé²è¾¾å‰ƒåº¦ï¼Œä¼—åƒ§è¯´ï¼šâ€œæ­¤äººå½¢å®¹ä¸‘æ¶ã€ç›¸è²Œå‡¶é¡½ï¼Œä¸å¯å‰ƒåº¦ä»–\",ä½†æ˜¯é•¿è€å´è¯´ï¼š*â€æ­¤äººä¸Šåº”å¤©æ˜Ÿã€å¿ƒåœ°åˆšç›´ã€‚è™½ç„¶æ—¶ä¸‹å‡¶é¡½ï¼Œå‘½ä¸­é©³æ‚ï¼Œä¹…åå´å¾—æ¸…å‡€ã€‚è¯æœéå‡¡ï¼Œæ±ç­‰çš†ä¸åŠä»–ã€‚â€*åŸæ¥å¦‚æ­¤ï¼çœ‹æ¥åªè¦è¿™é‡Œä¹Ÿåº”ä¸Šä¸€ä¸ªå¤©æ˜Ÿçš„è¯ï¼Œé—®é¢˜å°±è§£å†³äº†ï¼ä½¿ç”¨é¢å‘å¯¹è±¡çš„è¯­è¨€æ¥è¯´ï¼Œâ€œåº”â€è€…ï¼Œå®ç°ä¹Ÿï¼›â€œå¤©æ˜Ÿâ€è€…ï¼ŒæŠ½è±¡ç±»ä¹Ÿã€‚*/public abstract class å¤©æ˜Ÿ implements å’Œå°š { public void åƒæ–‹(){} public void å¿µç»(){} public void æ‰“å(){} public void æ’é’Ÿ(){} public void ä¹ æ­¦(){} public String getName(){ return null; }}/**é²æ™ºæ·±ç±»ç»§æ‰¿æŠ½è±¡ç±»â€œå¤©æ˜Ÿâ€*/public class é²æ™ºæ·± extends å’Œå°š{ public void ä¹ æ­¦(){ æ‹³æ‰“é•‡å…³è¥¿ï¼› å¤§é—¹äº”å°å±±ï¼› å¤§é—¹æ¡ƒèŠ±æ‘ï¼› ç«çƒ§ç“¦å®˜å¯ºï¼› å€’æ‹”å‚æ¨æŸ³ï¼› } public String getName(){ return \"é²æ™ºæ·±\"; }} â€‹ è¿™ä¸ªæŠ½è±¡çš„å¤©æ˜Ÿç±»ä¾¿æ˜¯ä¸€ä¸ªé€‚é…å™¨ç±»ï¼Œé²æ™ºæ·±å®é™…ä¸Šå€ŸåŠ©äºé€‚é…å™¨æ¨¡å¼è¾¾åˆ°äº†å‰ƒåº¦çš„ç›®çš„ã€‚æ­¤é€‚é…å™¨ç±»å®ç°äº†å’Œå°šæ¥å£æ‰€è¦æ±‚çš„æ‰€æœ‰æ–¹æ³•ã€‚ä½†æ˜¯ä¸é€šå¸¸çš„é€‚é…å™¨æ¨¡å¼ä¸åŒçš„æ˜¯ï¼Œæ­¤é€‚é…å™¨ç±»ç»™å‡ºçš„æ‰€æœ‰çš„æ–¹æ³•çš„å®ç°éƒ½æ˜¯â€œå¹³åº¸â€çš„ã€‚è¿™ç§â€œå¹³åº¸åŒ–â€çš„é€‚é…å™¨æ¨¡å¼ç§°ä½œç¼ºçœé€‚é…æ¨¡å¼ã€‚ â€‹ åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œå¿…é¡»è®©ä¸€ä¸ªå…·ä½“ç±»å®ç°æŸä¸€ä¸ªæ¥å£ï¼Œä½†æ˜¯è¿™ä¸ªç±»åˆç”¨ä¸åˆ°æ¥å£æ‰€è§„å®šçš„æ‰€æœ‰çš„æ–¹æ³•ã€‚é€šå¸¸çš„å¤„ç†æ–¹æ³•æ˜¯ï¼Œè¿™ä¸ªå…·ä½“ç±»è¦å®ç°æ‰€æœ‰çš„æ–¹æ³•ï¼Œé‚£äº›æœ‰ç”¨çš„æ–¹æ³•è¦æœ‰å®ç°ï¼Œé‚£äº›æ²¡æœ‰ç”¨çš„æ–¹æ³•ä¹Ÿè¦æœ‰ç©ºçš„ã€å¹³åº¸çš„å®ç°ã€‚ è¿™äº›ç©ºçš„æ–¹æ³•æ˜¯ä¸€ç§æµªè´¹ï¼Œæœ‰æ—¶ä¹Ÿæ˜¯ä¸€ç§æ··ä¹±ã€‚é™¤éçœ‹è¿‡è¿™äº›ç©ºæ–¹æ³•çš„ä»£ç ï¼Œç¨‹åºå‘˜å¯èƒ½ä¼šä»¥ä¸ºè¿™äº›æ–¹æ³•ä¸æ˜¯ç©ºçš„ã€‚å³ä¾¿ä»–çŸ¥é“å…¶ä¸­æœ‰ä¸€äº›æ–¹æ³•æ˜¯ç©ºçš„ï¼Œä¹Ÿä¸ä¸€å®šçŸ¥é“å“ªäº›æ–¹æ³•æ˜¯ç©ºçš„ï¼Œå“ªäº›æ–¹æ³•ä¸æ˜¯ç©ºçš„ï¼Œé™¤éçœ‹è¿‡è¿™äº›æ–¹æ³•çš„æºä»£ç æˆ–æ˜¯æ–‡æ¡£ã€‚ ç¼ºçœé€‚é…æ¨¡å¼å¯ä»¥å¾ˆå¥½çš„å¤„ç†è¿™ä¸€æƒ…å†µã€‚å¯ä»¥è®¾è®¡ä¸€ä¸ªæŠ½è±¡çš„é€‚é…å™¨ç±»å®ç°æ¥å£ï¼Œæ­¤æŠ½è±¡ç±»è¦ç»™æ¥å£æ‰€è¦æ±‚çš„æ¯ä¸€ç§æ–¹æ³•éƒ½æä¾›ä¸€ä¸ªç©ºçš„æ–¹æ³•ã€‚å°±åƒå¸®åŠ©äº†é²æ™ºæ·±çš„â€œä¸Šåº”å¤©æ˜Ÿâ€ä¸€æ ·ï¼Œæ­¤æŠ½è±¡ç±»å¯ä»¥ä½¿å®ƒçš„å…·ä½“å­ç±»å…äºè¢«è¿«å®ç°ç©ºçš„æ–¹æ³•ã€‚ ç¼ºçœé€‚é…å™¨æ¨¡å¼çš„ç»“æ„ç¼ºçœé€‚é…æ¨¡å¼æ˜¯ä¸€ç§â€œå¹³åº¸â€åŒ–çš„é€‚é…å™¨æ¨¡å¼ã€‚ å®ç°ä»£ç 12345678910111213141516171819202122public interface AbstractService { public void serviceOperation1(); public int serviceOperation2(); public String serviceOperation3();}public abstract class ServiceAdapter implements AbstractService{ @Override public void serviceOperation1() { } @Override public int serviceOperation2() { return 0; } @Override public String serviceOperation3() { return null; }} å¯ä»¥çœ‹åˆ°ï¼Œæ¥å£AbstractServiceè¦æ±‚å®šä¹‰ä¸‰ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯serviceOperation1()ã€serviceOperation2()ã€serviceOperation3()ï¼›è€ŒæŠ½è±¡é€‚é…å™¨ç±»ServiceAdapteråˆ™ä¸ºè¿™ä¸‰ç§æ–¹æ³•éƒ½æä¾›äº†å¹³åº¸çš„å®ç°ã€‚å› æ­¤ï¼Œä»»ä½•ç»§æ‰¿è‡ªæŠ½è±¡ç±»ServiceAdapterçš„å…·ä½“ç±»éƒ½å¯ä»¥é€‰æ‹©å®ƒæ‰€éœ€è¦çš„æ–¹æ³•å®ç°ï¼Œè€Œä¸å¿…ç†ä¼šå…¶ä»–çš„ä¸éœ€è¦çš„æ–¹æ³•ã€‚ é€‚é…å™¨æ¨¡å¼çš„ç”¨æ„æ˜¯è¦æ”¹å˜æºçš„æ¥å£ï¼Œä»¥ä¾¿äºç›®æ ‡æ¥å£ç›¸å®¹ã€‚ç¼ºçœé€‚é…çš„ç”¨æ„ç¨æœ‰ä¸åŒï¼Œå®ƒæ˜¯ä¸ºäº†æ–¹ä¾¿å»ºç«‹ä¸€ä¸ªä¸å¹³åº¸çš„é€‚é…å™¨ç±»è€Œæä¾›çš„ä¸€ç§å¹³åº¸å®ç°ã€‚ åœ¨ä»»ä½•æ—¶å€™ï¼Œå¦‚æœä¸å‡†å¤‡å®ç°ä¸€ä¸ªæ¥å£çš„æ‰€æœ‰æ–¹æ³•æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨â€œç¼ºçœé€‚é…æ¨¡å¼â€åˆ¶é€ ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œç»™å‡ºæ‰€æœ‰æ–¹æ³•çš„å¹³åº¸çš„å…·ä½“å®ç°ã€‚è¿™æ ·ï¼Œä»è¿™ä¸ªæŠ½è±¡ç±»å†ç»§æ‰¿ä¸‹å»çš„å­ç±»å°±ä¸å¿…å®ç°æ‰€æœ‰çš„æ–¹æ³•äº†ã€‚ å‚è€ƒï¼šhttp://www.cnblogs.com/java-my-life/archive/2012/04/13/2442795.html","link":"/2018/12/04/Javaè®¾è®¡æ¨¡å¼ä¹‹é€‚é…å™¨æ¨¡å¼.html"},{"title":"æ”¯ä»˜ç³»ç»Ÿè®¾è®¡(è½¬è½½)","text":"æ”¯ä»˜ç³»ç»Ÿæ¦‚è¿°æ”¯ä»˜ç³»ç»Ÿæ˜¯è¿æ¥æ¶ˆè´¹è€…ã€å•†å®¶ï¼ˆæˆ–å¹³å°ï¼‰å’Œé‡‘èæœºæ„çš„æ¡¥æ¢ï¼Œç®¡ç†æ”¯ä»˜æ•°æ®ï¼Œè°ƒç”¨ç¬¬ä¸‰æ–¹æ”¯ä»˜å¹³å°æ¥å£ï¼Œè®°å½•æ”¯ä»˜ä¿¡æ¯ï¼ˆå¯¹åº”è®¢å•å·ï¼Œæ”¯ä»˜é‡‘é¢ç­‰ï¼‰ï¼Œé‡‘é¢å¯¹è´¦ç­‰åŠŸèƒ½ï¼Œæ ¹æ®ä¸åŒå…¬å¸å¯¹äºæ”¯ä»˜ä¸šåŠ¡çš„å®šä½ä¸åŒå¤§æ¦‚æœ‰å‡ ä¸ªé˜¶æ®µï¼šç¬¬ä¸€é˜¶æ®µï¼šæ”¯ä»˜ä½œä¸ºä¸€ä¸ªï¼ˆå°é—­ï¼‰çš„ã€ç‹¬ç«‹çš„åº”ç”¨ç³»ç»Ÿï¼Œä¸ºå„ç³»ç»Ÿæä¾›æ”¯ä»˜åŠŸèƒ½æ”¯æŒã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªç³»ç»Ÿä»…é™äºä¸ºå…¬å¸å†…éƒ¨çš„ä¸šåŠ¡æä¾›æ”¯ä»˜æ”¯æŒï¼Œå¹¶ä¸”å’Œä¸šåŠ¡ç´§å¯†è€¦åˆã€‚ç¬¬äºŒé˜¶æ®µï¼šæ”¯ä»˜ä½œä¸ºä¸€ä¸ªå¼€å‘çš„ç³»ç»Ÿï¼Œä¸ºå…¬å¸å†…å¤–éƒ¨ç³»ç»Ÿã€å„ç§ä¸šåŠ¡æä¾›æ”¯ä»˜æœåŠ¡ï¼Œæ”¯ä»˜æœåŠ¡æœ¬èº«åº”è¯¥æ˜¯å’Œå…·ä½“çš„ä¸šåŠ¡è§£è€¦åˆã€‚ æ”¯ä»˜ç³»ç»Ÿæ¶æ„æ¨¡å—ç»„æˆå›¾ æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹ç”¨æˆ·å®Œæˆä¸€æ¬¡è´­ç‰©éœ€è¦è¿›è¡Œé‚£äº›æ“ä½œï¼š é€šå¸¸æ¶ˆè´¹è€…åœ¨æ‰‹æœºAPPæˆ–è€…ç½‘ç«™éƒ½ä¼šæ¶‰åŠåˆ°æ”¯ä»˜ç›¸å…³çš„ä¸šåŠ¡åœºæ™¯ï¼Œç”¨æˆ·åªéœ€è¦ç®€å•ç‚¹å‡»æ”¯ä»˜æŒ‰é’®è¾“å…¥æ”¯ä»˜å¯†ç ï¼Œå°±å¯ä»¥å®Œæˆæ•´ä¸ªæ”¯ä»˜è¿‡ç¨‹ï¼Œé‚£ä¹ˆæˆ‘å°±å’Œå¤§å®¶ä¸€èµ·æ¥çœ‹çœ‹ä¸€ä¸ªå®Œæ•´çš„æ”¯ä»˜ç³»ç»Ÿæœ‰ä»€ä¹ˆåŠŸèƒ½ç»„æˆå’Œè®¾è®¡æ—¶éœ€è¦è€ƒè™‘é‚£äº›é—®é¢˜ã€‚ æ”¯ä»˜ç³»ç»Ÿçš„ä½œç”¨ ä»ä¸Šå›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºçœŸå®çš„èµ„é‡‘æµå‘ã€‚é¦–å…ˆå½“ç”¨æˆ·äº§ç”Ÿæ”¯ä»˜è¡Œä¸ºæ—¶ï¼Œèµ„é‡‘ä»ç”¨æˆ·ç«¯æµå‘æ”¯ä»˜ç³»ç»Ÿï¼Œé€€æ¬¾æ—¶åˆ™ç›¸åï¼Œä»æ”¯ä»˜ç³»ç»Ÿå›æµè‡³ç”¨æˆ·ç«¯ã€‚å› æ­¤åœ¨æ•´ä¸ªäº¤æ˜“è¿‡ç¨‹ä¸­ç”¨æˆ·ç«¯ä¸æ”¯ä»˜ç³»ç»Ÿæ˜¯åŒå‘èµ„é‡‘çš„æµåŠ¨æ–¹å¼ã€‚å¯¹äºæ”¯ä»˜ç³»ç»Ÿè€Œè¨€ï¼Œèµ„é‡‘æœ‰è¿›æœ‰å‡ºã€‚ä»æ”¯ä»˜ç³»ç»Ÿåˆ°å•†æˆ·ç«¯å°±æ¯”è¾ƒç®€å•äº†ï¼Œåœ¨æ¸…ç®—å®Œæˆåæ”¯ä»˜ç³»ç»Ÿè´Ÿè´£å°†ä»£æ”¶çš„èµ„é‡‘ç»“ç®—ç»™å•†æˆ·ï¼Œé€šå¸¸ç»“ç®—çš„æ“ä½œå¯ä»¥åœ¨çº¿ä¸Šæ¥å®Œæˆï¼ˆé‡‡ç”¨æ”¯ä»˜å…¬å¸ä»£ä»˜æ¥å£æˆ–è€…é“¶ä¼ç›´è¿æ¥å£æ¥å®Œæˆï¼‰ï¼Œä¹Ÿå¯ä»¥ç”±å…¬å¸è´¢åŠ¡é€šè¿‡çº¿ä¸‹æ‰‹å·¥è½¬è´¦çš„æ–¹å¼æ¥å®Œæˆï¼Œå› æ­¤è¿™ç§èµ„é‡‘æµåŠ¨çš„æ–¹å¼æ˜¯å•å‘çš„ã€‚å‡ºäºèµ„é‡‘å®‰å…¨è€ƒè™‘ï¼Œå¤§å¤šæ•°å…¬å¸é€šå¸¸è¿™éƒ¨åˆ†é‡‡ç”¨çº¿ä¸‹æ–¹å¼å®ç°ã€‚ çœŸå®çš„èµ„é‡‘æµç”±æ”¯ä»˜å…¬å¸æŒ‰ç…§çº¦å®šæœŸé™ï¼ˆé€šå¸¸ T+1 ï¼‰ç»“ç®—åˆ°å¹³å°å…¬å¸å¯¹å…¬è´¦æˆ·ä¸­ï¼Œç„¶åå†ç”±å¹³å°å…¬å¸å†æŒ‰ç…§äº¤æ˜“æ˜ç»†è¿›è¡ŒäºŒæ¬¡æ¸…ç®—åç»“ç®—ç»™å¯¹åº”çš„å•†æˆ·ã€‚ æ”¯ä»˜ç³»ç»Ÿæ”¯ä»˜ç³»ç»Ÿæ¨¡å—ç»„æˆ å®Œæ•´çš„æ”¯ä»˜ç³»ç»ŸåŒ…æ‹¬å¦‚ä¸‹çš„åŠŸèƒ½ åº”ç”¨ç®¡ç†: åŒæ—¶æ”¯æŒå…¬å¸å¤šä¸ªä¸šåŠ¡ç³»ç»Ÿå¯¹æ¥ã€‚ å•†æˆ·ç®¡ç†: æ”¯æŒå•†æˆ·å…¥é©»ï¼Œå•†æˆ·éœ€è¦å‘å¹³å°æ–¹æä¾›ç›¸å…³çš„èµ„æ–™å¤‡æ¡ˆã€‚ æ¸ é“ç®¡ç†: æ”¯æŒå¾®ä¿¡ã€æ”¯ä»˜å®ã€é“¶è”ã€äº¬ä¸œæ”¯ä»˜ç­‰å¤šç§æ¸ é“ã€‚ è´¦æˆ·ç®¡ç†: æ¸ é“è´¦æˆ·ç®¡ç†ï¼Œæ”¯æŒå…±äº«è´¦æˆ·ï¼ˆä¸ªäººå•†æˆ·ï¼‰åŠè‡ªæœ‰è´¦æˆ·ã€‚ æ”¯ä»˜äº¤æ˜“: ç”Ÿæˆé¢„æ”¯ä»˜è®¢å•ã€æä¾›é€€æ¬¾æœåŠ¡ã€‚ å¯¹è´¦ç®¡ç†: å®ç°æ”¯ä»˜ç³»ç»Ÿçš„äº¤æ˜“æ•°æ®ä¸ç¬¬ä¸‰æ–¹æ”¯ä»˜æ¸ é“äº¤æ˜“æ˜ç»†çš„è‡ªåŠ¨æ ¸å¯¹ï¼ˆé€šå¸¸T+1ï¼‰ï¼Œç¡®ä¿äº¤æ˜“æ•°æ®çš„å‡†ç¡®æ€§å’Œä¸€è‡´æ€§ã€‚ æ¸…ç®—ç®¡ç†: è®¡ç®—æ”¶æ¬¾äº¤æ˜“ä¸­å•†æˆ·çš„åº”æ”¶ä¸æ”¯ä»˜ç³»ç»Ÿæ”¶ç›Šã€‚ ç»“ç®—ç®¡ç†: æ ¹æ®æ¸…ç®—ç»“æœï¼Œå°†èµ„é‡‘åˆ’æ‹¨è‡³å•†æˆ·å¯¹åº”çš„èµ„é‡‘å¸æˆ·ä¸­ã€‚ æ ¸å¿ƒæµç¨‹æ”¯ä»˜ç³»ç»Ÿæœ‰å‡ ä¸ªå…³é”®çš„æ ¸å¿ƒæµç¨‹ï¼šæ”¯ä»˜æµç¨‹ã€å¯¹è´¦æµç¨‹ã€ç»“ç®—æµç¨‹ æ”¯ä»˜æµç¨‹è¯´æ˜ ç”¨æˆ·åœ¨å•†åŸé€‰è´­å•†å“å¹¶å‘èµ·æ”¯ä»˜è¯·æ±‚ï¼› å•†åŸå°†æ”¯ä»˜è®¢å•é€šè¿‡B2Cç½‘å…³æ”¶æ¬¾æ¥å£ä¼ é€è‡³æ”¯ä»˜ç½‘å…³ï¼› ç”¨æˆ·é€‰æ‹©ç½‘é“¶æ”¯ä»˜åŠé“¶è¡Œï¼Œæ”¯ä»˜å¹³å°å°†è®¢å•è½¬é€è‡³æŒ‡å®šé“¶è¡Œç½‘å…³ç•Œé¢ï¼› ç”¨æˆ·æ”¯ä»˜å®Œæˆï¼Œé“¶è¡Œå¤„ç†ç»“æœå¹¶å‘å¹³å°è¿”å›å¤„ç†ç»“æœï¼› æ”¯ä»˜å¹³å°æ¥æ”¶å¤„ç†ç»“æœï¼Œè½åœ°å¤„ç†å¹¶å‘å•†æˆ·è¿”å›ç»“æœï¼› å•†åŸæ¥æ”¶åˆ°æ”¯ä»˜å…¬å¸è¿”å›ç»“æœï¼Œè½åœ°å¤„ç†ï¼ˆæ›´æ”¹è®¢å•çŠ¶æ€ï¼‰å¹¶é€šçŸ¥ç”¨æˆ·ã€‚ ä¸€èˆ¬è€Œè¨€æ”¯ä»˜ç³»ç»Ÿä¼šç»™å•†æˆ·è®¾ç½®æœ‰â€œå¯ç”¨ä½™é¢â€è´¦æˆ·ã€â€œå¾…ç»“ç®—â€è´¦æˆ·ï¼›ç³»ç»Ÿåœ¨æ¥æ”¶åˆ°é“¶è¡Œè¿”å›æ”¯ä»˜æˆåŠŸä¿¡æ¯ä¼šè¿›è¡Œè½åœ°å¤„ç†ï¼Œä¸€æ–¹é¢æ›´æ”¹å¯¹åº”è®¢å•çŠ¶æ€ï¼Œå¦ä¸€æ–¹é¢åœ¨å•†æˆ·å¾…ç»“ç®—è´¦æˆ·è®°å…¥ä¸€ç¬”é‡‘é¢ï¼›è¯¥ç¬”é‡‘é¢ï¼Œç³»ç»Ÿä¼šæ ¹æ®ç»“ç®—å‘¨æœŸä»å¾…ç»“ç®—è´¦æˆ·â€”&gt;â€œå¯ç”¨ä½™é¢â€è´¦æˆ·ã€‚ é€€æ¬¾æµç¨‹è¯´æ˜ ç”¨æˆ·åœ¨å•†æˆ·å¹³å°å‘èµ·é€€æ¬¾ç”³è¯·ï¼Œå•†æˆ·æ ¸å®é€€æ¬¾ä¿¡æ¯åŠç”³è¯·ï¼› å•†æˆ·ç™»å½•æ”¯ä»˜å¹³å°è´¦æˆ·/æˆ–è€…é€šè¿‡æ”¯ä»˜å…¬å¸æä¾›çš„é€€æ¬¾æ¥å£å‘æ”¯ä»˜å¹³å°å‘èµ·é€€æ¬¾ï¼› æ”¯ä»˜ç³»ç»Ÿä¼šå¯¹é€€æ¬¾ä¿¡æ¯æ ¡éªŒï¼ˆé€€æ¬¾è®¢å•å¯¹åº”çš„åŸè®¢å•æ˜¯å¦æ”¯ä»˜æˆåŠŸï¼Ÿé€€æ¬¾é‡‘é¢æ˜¯å¦å°‘äºç­‰äºåŸè®¢å•é‡‘é¢ï¼Ÿï¼‰ï¼Œæ ¡éªŒå•†æˆ·è´¦æˆ·ä½™é¢æ˜¯å¦å……è¶³ç­‰ï¼›æ ¡éªŒä¸é€šè¿‡ï¼Œåˆ™æ— æ³•é€€æ¬¾ï¼› æ”¯ä»˜ç³»ç»Ÿåœ¨å•†æˆ·å¯ç”¨ä½™é¢è´¦æˆ·æ‰£é™¤é‡‘é¢ï¼Œå¹¶å°†é€€æ¬¾è®¢å•å‘é€è‡³é“¶è¡Œï¼Œé“¶è¡Œå®Œæˆé€€æ¬¾æ“ä½œã€‚æ³¨æ„ï¼šå¯¹äºç½‘å…³æ”¶æ¬¾çš„è®¢å•é€€æ¬¾ï¼Œå„é“¶è¡Œè¦æ±‚ä¸ä¸€ï¼Œæœ‰äº›é“¶è¡Œæä¾›çš„é€€æ¬¾æ¥å£è¦æ±‚åŸè®¢å•æœ‰æ•ˆæœŸåœ¨90æˆ–180å¤©ï¼Œæœ‰äº›é“¶è¡Œä¸æä¾›é€€æ¬¾æ¥å£ï¼›é’ˆå¯¹è¶…æœŸæˆ–è€…ä¸æ”¯æŒæ¥å£é€€æ¬¾çš„è®¢å•ï¼Œæ”¯ä»˜å…¬å¸é€šè¿‡ä»£ä»˜é€šé“å®Œæˆé€€æ¬¾æ“ä½œã€‚ å¯¹äºæ”¶å•é‡‘é¢æœªç»“ç®—ï¼Œè¿˜åœ¨â€œå¾…ç»“ç®—â€è´¦æˆ·çš„è®¢å•ï¼Œå¦‚æœå‡ºç°é€€æ¬¾æƒ…å†µï¼Œä¸šåŠ¡æµç¨‹å’Œä¸Šè¿°æµç¨‹å·®ä¸å¤šï¼Œåªæ˜¯ä»å¾…ç»“ç®—è´¦æˆ·è¿›è¡Œæ‰£æ¬¾ã€‚ å¯¹è´¦è¯´æ˜â€‹ å¯¹è´¦ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç§°ä¸ºå‹¾å…‘ï¼Œæ”¯ä»˜ç³»ç»Ÿçš„å¯¹è´¦ï¼ŒåŒ…å«ç€ä¸¤ä¸ªå±‚é¢ï¼š æ”¯ä»˜ç³»ç»Ÿå†…éƒ¨é—´çš„å¯¹è´¦ï¼Œæ”¯ä»˜ç³»ç»Ÿä¸€èˆ¬æ˜¯åˆ†å¸ƒå¼çš„ï¼Œæ•´ä¸ªæ”¯ä»˜ç³»ç»Ÿè¢«æ‹†åˆ†æˆäº†å¤šä¸ªå­ç³»ç»Ÿï¼Œå¦‚äº¤æ˜“ç³»ç»Ÿã€è´¦æˆ·ç³»ç»Ÿã€ä¼šè®¡ç³»ç»Ÿã€è´¦æˆ·ç³»ç»Ÿï¼Œæ¯ä¸ªå­ç³»ç»Ÿåœ¨å¤„ç†å„è‡ªçš„ä¸šåŠ¡ï¼Œç³»ç»Ÿé—´çš„å¯¹è´¦ï¼Œå°±æ˜¯ä»¥ä¸Šç³»ç»Ÿçš„æ ¸å¯¹ï¼Œç”¨äºä¿®æ­£å†…éƒ¨ç³»ç»Ÿçš„æ•°æ®ä¸ä¸€è‡´ã€‚ æ”¯ä»˜ç³»ç»Ÿä¸æ¸ é“çš„å¯¹è´¦ï¼Œè¿™é‡Œçš„æ¸ é“æ³›æŒ‡æ‰€æœ‰ä¸ºæ”¯ä»˜ç³»ç»Ÿæä¾›ä»£æ”¶ä»˜ä¸šåŠ¡çš„æ¸ é“ï¼Œå¦‚ï¼šç¬¬ä¸‰æ–¹æ”¯ä»˜å…¬å¸ã€é“¶è¡Œã€æ¸…ç®—ä¸­å¿ƒã€ç½‘è”ã€é“¶è”ç­‰ã€‚ å¯¹è´¦ç®€æ˜“æµç¨‹ æ”¯ä»˜ç³»ç»Ÿä¸æ¸ é“é—´çš„å¯¹è´¦ç³»ç»Ÿé—´çš„å¯¹è´¦æ¯”è¾ƒå¥½ç†è§£ï¼Œè¿™é‡Œä¸»è¦è®²æ”¯ä»˜ç³»ç»Ÿä¸æ¸ é“é—´çš„å¯¹è´¦ã€‚æ”¯ä»˜ç³»ç»Ÿä¸æ¸ é“é—´çš„å¯¹è´¦ï¼ŒåˆåŒ…å«2ä¸ªç»´åº¦ï¼š ä¿¡æ¯æµå‹¾å¯¹ï¼šå³ä¸šåŠ¡å¯¹è´¦ï¼äº¤æ˜“å¯¹è´¦ï¼Œä¸»è¦æ˜¯å°±æ”¶å•äº¤æ˜“çš„æ”¯ä»˜ä¿¡æ¯ä¸é“¶è¡Œæä¾›çš„ä¿¡æ¯æµæ–‡ä»¶è¿›è¡Œå‹¾å…‘ã€‚ä¿¡æ¯æµçš„å‹¾åœ°èƒ½å‘ç°æ”¯ä»˜ç³»ç»Ÿä¸é“¶è¡Œç³»ç»Ÿé—´çš„æ‰å•ã€ä¸¤è¾¹ç”±äºç³»ç»Ÿé—´çš„åŸå› å¯¼è‡´çš„åŒä¸€ç¬”äº¤æ˜“æ”¯ä»˜é‡‘é¢ä¸ä¸€è‡´ï¼ˆå¯èƒ½æ€§å¾ˆå°ï¼‰æˆ–è€…æ”¯ä»˜çŠ¶æ€ä¸ä¸€è‡´ã€‚ä¿¡æ¯æµå‹¾å…‘ä¸€èˆ¬ç”¨æ¥æ¢å¤æ‰å•æ•°æ®ï¼Œå¯é€šè¿‡è¡¥å•æˆ–è€…å…·ä½“ç³»ç»Ÿé—®é¢˜æ’æŸ¥è§£å†³ã€‚ èµ„é‡‘æµå‹¾å¯¹ï¼šå³èµ„é‡‘å¯¹è´¦ï¼Œä¸»è¦å°±æ”¶å•äº¤æ˜“çš„æ”¯ä»˜ä¿¡æ¯ä¸é“¶è¡Œæä¾›çš„èµ„é‡‘æµä¿¡æ¯è¿›è¡Œå‹¾å…‘ã€‚èµ„é‡‘æµçš„å‹¾å…‘èƒ½å‘ç°æ”¯ä»˜ç³»ç»Ÿåœ¨é“¶è¡Œçš„å¸æˆ·èµ„é‡‘å®é™…å‘ç”Ÿçš„å˜åŠ¨ä¸åº”è¯¥å‘ç”Ÿçš„å˜åŠ¨çš„å·®å¼‚ï¼Œæ¯”å¦‚é•¿æ¬¾ï¼ˆé“¶è¡Œå¤šç»“ç®—ç»™æ”¯ä»˜ç³»ç»Ÿï¼‰å’ŒçŸ­æ¬¾ï¼ˆé“¶è¡Œå°‘ç»“ç®—ç»™æ”¯ä»˜ç³»ç»Ÿï¼‰ã€‚ è¯´äº†è¿™ä¹ˆå¤šï¼Œå°±å‡ºç°æ¥4ä¸ªå¯¹è´¦æ–‡ä»¶ï¼Œæ”¯ä»˜ç³»ç»Ÿä¿¡æ¯æµæ–‡ä»¶ã€æ”¯ä»˜ç³»ç»Ÿèµ„é‡‘æµæ–‡ä»¶ã€é“¶è¡Œä¿¡æ¯æµæ–‡ä»¶ã€é“¶è¡Œèµ„é‡‘æµæ–‡ä»¶ã€‚ä¸šåŠ¡å¯¹è´¦ï¼ˆå‹¾å…‘ï¼‰å°±æ˜¯æ”¯ä»˜ç³»ç»Ÿçš„ä¿¡æ¯æµæ–‡ä»¶ä¸é“¶è¡Œçš„ä¿¡æ¯æµæ–‡ä»¶å‹¾å…‘ï¼Œèµ„é‡‘å¯¹è´¦å³æ”¯ä»˜ç³»ç»Ÿçš„èµ„é‡‘æµæ–‡ä»¶ä¸é“¶è¡Œçš„èµ„é‡‘æµæ–‡ä»¶å‹¾å…‘ã€‚ æ ¸å¯¹çš„å·®å¼‚å¤„ç†1ã€ä¿¡æ¯æµå‹¾å¯¹çš„å·®å¼‚å¤„ç† æ”¯ä»˜ç³»ç»Ÿä¿¡æ¯æµæ²¡æœ‰ï¼Œè€Œé“¶è¡Œæœ‰çš„å·®å¼‚ï¼Œå¯èƒ½æ˜¯å› ä¸ºæ”¯ä»˜ç³»ç»Ÿäº¤æ˜“æ•°æ®çš„ä¸¢å¤±ã€é“¶è¡Œçš„æ‰å•ï¼Œå¦‚æœæ˜¯é“¶è¡Œçš„æ‰å•ï¼Œç”±æ”¯ä»˜å…¬å¸çš„è¿è¥ç™»å½•é“¶è¡Œç½‘é“¶ç¡®è®¤åï¼Œåšè¡¥å•å¤„ç†ï¼Œå¹¶å°†å·®å¼‚è¡¨ä¸­è¯¥è®°å½•æ ¸é”€ã€‚ æ”¯ä»˜ç³»ç»Ÿä¿¡æ¯æµæœ‰ï¼Œè€Œé“¶è¡Œæ²¡æœ‰çš„å·®å¼‚ï¼Œæ­¤ç§æƒ…å†µä¸€èˆ¬ä¸ä¼šå‘ç”Ÿï¼Œå› ä¸ºæ”¯ä»˜ç³»ç»Ÿæ‰€æœ‰çš„äº¤æ˜“æ•°æ®éƒ½æ˜¯å–é“¶è¡Œè¿”å›çŠ¶æ€çš„æ•°æ®ã€‚ 2ã€èµ„é‡‘æµå‹¾å¯¹å¯¹å·®å¼‚å¤„ç† æ”¯ä»˜ç³»ç»Ÿèµ„é‡‘æµæ²¡æœ‰ï¼Œè€Œé“¶è¡Œæœ‰çš„å·®å¼‚ã€‚å¯èƒ½åŸå› å¦‚ä¸‹ï¼š1ã€é“¶è¡Œæ—¥åˆ‡æ™šä¸æ”¯ä»˜ç³»ç»Ÿæ ¸å¿ƒè´¦åŠ¡ç³»ç»Ÿï¼›2ã€æ”¯ä»˜ç³»ç»Ÿè´¦åŠ¡æ ¸å¿ƒç³»ç»Ÿä¸å…¶ä»–ç³»ç»Ÿé—´çš„æ‰å•ã€‚ä¸€æ—¦å‡ºç°ï¼Œåˆ™ä¼šå‡ºç°é•¿æ¬¾ï¼ˆå³é“¶è¡Œä¸åº”è¯¥ç»“ç®—è€Œå®é™…ç»“ç®—ï¼‰çš„ç°è±¡ï¼Œå¯¹äºå› æ—¥åˆ‡å¯¼è‡´çš„å·®å¼‚ï¼Œåœ¨ç¬¬äºŒå¤©çš„å¯¹è´¦ä¸­ç³»ç»Ÿä¼šå¯¹å¹³ï¼Œå…¶ä»–åŸå› çš„ï¼Œéœ€è¦æŠ€æœ¯æ’æŸ¥ã€‚ æ”¯ä»˜ç³»ç»Ÿèµ„é‡‘æµæœ‰ï¼Œè€Œé“¶è¡Œæ²¡æœ‰çš„å·®å¼‚ï¼Œå¯èƒ½æ˜¯å› ä¸ºé“¶è¡Œæ—¥åˆ‡æ—©äºæ”¯ä»˜ç³»ç»Ÿçš„æ ¸å¿ƒè´¦åŠ¡ç³»ç»Ÿï¼Œä¸€æ—¦å‡ºç°ï¼Œä¼šå‡ºç°çŸ­æ¬¾ï¼ˆé“¶è¡Œåº”ç»“ç®—è€Œå®é™…æœªç»“ç®—ï¼‰çš„ç°è±¡ï¼Œé“¶è¡Œæ—¥åˆ‡å¯¼è‡´æ®µå·®å¼‚ï¼Œä¼šåœ¨ä¸‹ä¸€å¤©ä¸é“¶è¡Œçš„å‹¾å¯¹ä¸­ï¼Œå°†æ­¤ç¬”å·®å¼‚å‹¾å¯¹ä¸Šï¼Œå¦‚æœæ˜¯éæ—¥åˆ‡å¯¼è‡´çš„åŸå› ï¼Œå°±éœ€è¦æ‰¾é“¶è¡Œè¿½æ¬¾äº†ã€‚ æ€»ç»“å°±æ˜¯ï¼Œä¸šåŠ¡å¯¹è´¦ï¼Œå³ä¿¡æ¯æµå¯¹è´¦ï¼Œæ”¯ä»˜ç³»ç»Ÿçš„äº¤æ˜“æµæ°´ä¸é“¶è¡Œçš„äº¤æ˜“æµæ°´é—´æ ¸å¯¹ï¼Œä¿éšœæ”¯ä»˜äº¤æ˜“å®Œæ•´å…¥è´¦ã€‚èµ„é‡‘å¯¹è´¦ï¼Œå³èµ„é‡‘æµå¯¹è´¦ï¼Œæ”¯ä»˜ç³»ç»Ÿçš„å…¥è´¦æµæ°´ä¸é“¶è¡Œçš„ç»“ç®—æµæ°´é—´æ ¸å¯¹ï¼Œä¿éšœé“¶è¡Œå…¥è´¦æµæ°´ä¸å®é™…å…¥è´¦èµ„é‡‘çš„åŒ¹é…ã€‚ ç»“ç®—ç»“ç®—æµç¨‹ åœ¨æ¸…ç»“ç®—éƒ¨åˆ†ï¼Œç³»ç»ŸæŒ‰ç…§è®¾å®šå¥½çš„æ¸…ç»“ç®—è§„åˆ™è‡ªåŠ¨å°†é’±æ¬¾ç»“ç®—ç»™å•†æˆ·ã€‚å®Œå–„çš„è¿è¥ä¼šè®¡ä½“ç³»å¸®åŠ©è´¢åŠ¡è¿›è¡Œç²¾ç»†åŒ–æ ¸ç®—ï¼Œæé«˜è´¢åŠ¡æ•ˆç‡ã€‚ä¸æ”¯ä»˜æ¸ é“è‡ªåŠ¨è¿›è¡Œå¯¹è´¦ï¼Œç¡®ä¿è´¦åŠ¡æ­£ç¡®ï¼Œåœ¨å¼‚å¸¸æƒ…å†µä¸‹èƒ½åŠæ—¶å®šä½é—®é¢˜å¹¶å¤„ç†ã€‚ç³»ç»Ÿæ›´æ˜¯èƒ½å¯¹å•†æˆ·è¿›è¡Œä¸ªæ€§åŒ–çš„è´¹ç‡é…ç½®æˆ–è´¦æœŸé…ç½®ï¼Œæ–¹ä¾¿çµæ´»ã€‚ç³»ç»Ÿçš„ä»·å€¼ä¸ä»…ä½“ç°åœ¨æ”¯ä»˜æ¸…ç»“ç®—æ–¹é¢ï¼ŒåŒæ—¶æ›´æ˜¯æå‡äº†è¿è¥ç®¡ç†æ•ˆç‡ã€‚æ”¯ä»˜æ¸…ç»“ç®—ç³»ç»Ÿå¯ä»¥æœ‰æ•ˆå¸®åŠ©è¿è¥ã€è´¢åŠ¡ã€å¼€å‘ä»¥åŠç®¡ç†äººå‘˜ã€‚å¯¹äºè¿è¥äººå‘˜ï¼Œç³»ç»Ÿå¯å¸®åŠ©å¤„ç†å¹³å°çš„è¿è¥å·¥ä½œï¼ŒåŒ…æ‹¬å„ç±»æ”¯ä»˜ç®¡ç†ï¼Œå•†æˆ·ã€ä¼šå‘˜ç®¡ç†ï¼Œè¥é”€æ´»åŠ¨çš„æ•°æ®ç»Ÿè®¡ç­‰ï¼Œå…¨é¢æé«˜è¿è¥æ•ˆç‡ã€‚é’ˆå¯¹è´¢åŠ¡äººå‘˜ï¼Œå¯ä»¥ååŠ©å®Œæˆèµ„é‡‘å¯¹è´¦ã€ä¼šè®¡å¤„ç†ï¼Œå‡ºå…¥æ¬¾ç®¡ç†ï¼Œè´¦åŠ¡å·®é”™å¤„ç†ç­‰ï¼Œå¤§éƒ¨åˆ†å·¥ä½œç”±ç³»ç»Ÿè‡ªåŠ¨å¤„ç†ï¼Œå‡å°‘äººå·¥å¤„ç†ï¼Œæé«˜èµ„é‡‘å¤„ç†æ•ˆç‡ã€‚ä¸€å¥—çµæ´»ä¾¿æ·çš„é…ç½®åå°ä¾›å¼€å‘äººå‘˜å¿«é€Ÿè°ƒæ•´ç³»ç»Ÿä»¥é€‚åº”æ–°çš„ä¸šåŠ¡ï¼Œå¹¶èƒ½æ–¹ä¾¿å¯¹ç³»ç»Ÿè¿›è¡Œç»´æŠ¤ï¼Œå¦‚æ¸ é“æ¥å…¥ã€è´¹ç‡é…ç½®ã€è´¦æœŸè°ƒæ•´ç­‰ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚ç³»ç»Ÿæä¾›èµ„é‡‘æµè½¬è¿‡ç¨‹ä¸­å„ä¸ªç¯èŠ‚çš„æ•°æ®ï¼Œèƒ½å¤Ÿä»å„ä¸ªç»´åº¦è¿›è¡Œæ ¸ç®—å’Œåˆ†æï¼Œå½¢æˆå¯¹ç®¡ç†äººå‘˜çš„å†³ç­–æ”¯æŒï¼Œä»è€Œæé«˜å†³ç­–æ•ˆç‡ã€‚ å…³é”®è¡¨è®¾è®¡ æ”¯ä»˜ç³»ç»Ÿè¦ç‚¹åœ¨æ”¯ä»˜ç³»ç»Ÿä¸­ï¼Œæ”¯ä»˜ç½‘å…³å’Œæ”¯ä»˜æ¸ é“çš„å¯¹æ¥æ˜¯æœ€ç¹çé‡è¦çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œå…¶ä¸­æ”¯ä»˜ç½‘å…³æ˜¯å¯¹å¤–æä¾›æœåŠ¡çš„æ¥å£ï¼Œæ‰€æœ‰éœ€è¦æ¸ é“æ”¯æŒçš„èµ„é‡‘æ“ä½œéƒ½éœ€è¦é€šè¿‡ç½‘å…³åˆ†å‘åˆ°å¯¹åº”çš„æ¸ é“æ¨¡å—ä¸Šã€‚ä¸€æ—¦å®šå‹ï¼Œåç»­å°±å¾ˆå°‘ï¼Œä¹Ÿå¾ˆéš¾è°ƒæ•´ã€‚è€Œæ”¯ä»˜æ¸ é“æ¨¡å—æ˜¯æ¥æ”¶ç½‘å…³çš„è¯·æ±‚ï¼Œè°ƒç”¨æ¸ é“æ¥å£æ‰§è¡ŒçœŸæ­£çš„èµ„é‡‘æ“ä½œã€‚æ¯ä¸ªæ¸ é“çš„æ¥å£ï¼Œä¼ è¾“æ–¹å¼éƒ½ä¸å°½ç›¸åŒï¼Œæ‰€ä»¥åœ¨è¿™é‡Œï¼Œæ”¯ä»˜ç½‘å…³ç›¸å¯¹äºæ”¯ä»˜æ¸ é“æ¨¡å—çš„ä½œç”¨ï¼Œç±»ä¼¼è®¾è®¡æ¨¡å¼ä¸­çš„wrapperï¼Œå°è£…å„ä¸ªæ¸ é“çš„å·®å¼‚ï¼Œå¯¹ç½‘å…³å‘ˆç°ç»Ÿä¸€çš„æ¥å£ã€‚è€Œç½‘å…³çš„åŠŸèƒ½æ˜¯ä¸ºä¸šåŠ¡æä¾›é€šç”¨æ¥å£ï¼Œä¸€äº›å’Œæ¸ é“äº¤äº’çš„å…¬å…±æ“ä½œï¼Œä¹Ÿä¼šæ”¾ç½®åˆ°ç½‘å…³ä¸­ã€‚ æ”¯ä»˜ç³»ç»Ÿå¯¹å…¶ä»–ç³»ç»Ÿï¼Œç‰¹åˆ«æ˜¯äº¤æ˜“ç³»ç»Ÿï¼Œæä¾›çš„æ”¯ä»˜æœåŠ¡åŒ…æ‹¬ç­¾çº¦ï¼Œæ”¯ä»˜ï¼Œé€€æ¬¾ï¼Œå……å€¼ï¼Œè½¬å¸ï¼Œè§£çº¦ç­‰ã€‚æœ‰äº›åœ°æ–¹è¿˜ä¼šé¢å¤–æä¾›ç­¾çº¦å¹¶æ”¯ä»˜çš„æ¥å£ï¼Œç”¨äºæ”¯æŒåœ¨æ”¯ä»˜è¿‡ç¨‹ä¸­ç»‘å¡ã€‚ æ¯ä¸ªæœåŠ¡å®ç°çš„æµç¨‹ä¹Ÿæ˜¯åŸºæœ¬ç±»ä¼¼ï¼ŒåŒ…æ‹¬ä¸‹å•ï¼Œå–æ¶ˆè®¢å•ï¼Œé€€å•ï¼ŒæŸ¥å•ç­‰æ“ä½œã€‚æ¯ä¸ªæ“ä½œå®ç°ï¼Œéƒ½åŒ…æ‹¬å‚æ•°æ ¡éªŒï¼Œæ”¯ä»˜è·¯ç”±ï¼Œç”Ÿæˆè®¢å•ï¼Œé£é™©è¯„ä¼°ï¼Œè°ƒç”¨æ¸ é“æœåŠ¡ï¼Œæ›´æ–°è®¢å•å’Œå‘é€æ¶ˆæ¯è¿™7æ­¥ï¼Œå¯¹äºä¸€äº›æ¯”è¾ƒå¤æ‚çš„æ¸ é“æœåŠ¡ï¼Œè¿˜ä¼šæ¶‰åŠåˆ°å¼‚æ­¥åŒé€šçŸ¥å¤„ç†çš„æ­¥éª¤ã€‚ ç½‘å…³å‰ç½®æ”¯ä»˜ç½‘å…³å‰ç½®æ˜¯å¯¹æ¥ä¸šåŠ¡ç³»ç»Ÿï¼Œä¸ºå…¶æä¾›æ”¯ä»˜æœåŠ¡çš„æ¨¡å—ã€‚å®ƒæ˜¯æ‰€æœ‰æ”¯ä»˜æœåŠ¡æ¥å£çš„é›†æˆå‰ç½®ï¼Œå°†ä¸åŒæ”¯ä»˜æ¸ é“æä¾›çš„æ¥å£é€šè¿‡ç»Ÿä¸€çš„æ–¹å¼å‘ˆç°ç»™ä¸šåŠ¡æ–¹ã€‚è¿™æ ·æ¥å…¥æ–¹å°±åªéœ€è¦å¯¹æ¥æ”¯ä»˜ç½‘å…³ï¼Œå¢åŠ å’Œè°ƒæ•´æ”¯ä»˜æ¸ é“å¯¹ä¸šåŠ¡æ–¹æ˜¯é€æ˜çš„ã€‚ æ”¯ä»˜ç½‘å…³å‰ç½®çš„è®¾è®¡å¯¹æ•´ä¸ªæ”¯ä»˜ç³»ç»Ÿçš„ç¨³å®šæ€§ã€åŠŸèƒ½ã€æ€§èƒ½ä»¥åŠå…¶ä»–éåŠŸèƒ½æ€§éœ€æ±‚æœ‰ç€ç›´æ¥çš„å½±å“ã€‚ åœ¨æ”¯ä»˜ç½‘å…³ä¸­éœ€è¦å®Œæˆå¤§é‡çš„æ“ä½œï¼Œä¸ºäº†ä¿è¯æ€§èƒ½ï¼Œè¿™äº›æ“ä½œéƒ½å°½é‡å¼‚æ­¥åŒ–æ¥å¤„ç†ã€‚æ”¯ä»˜ç½‘å…³å‰ç½®åº”ä¿æŒç¨³å®šï¼Œå°½é‡å‡å°‘ç³»ç»Ÿé‡å¯ç­‰æ“ä½œå¯¹ä¸šåŠ¡æ–¹çš„å½±å“ã€‚æ”¯ä»˜ç½‘å…³ä¹Ÿé¿å…ä¸äº†å‡çº§å’Œé‡å¯ã€‚è¿™å¯é€šè¿‡åŸºäºNginxçš„LBS(Load Balance System)ç½‘å…³æ¥è§£å†³ã€‚LBSåœ¨è¿™é‡Œæœ‰ä¸¤ä¸ªä½œç”¨ï¼š ä¸€ä¸ªæ˜¯å®ç°è´Ÿè½½å‡è¡¡ï¼Œä¸€ä¸ªæ˜¯éš”ç¦»æ”¯ä»˜ç½‘å…³é‡å¯å¯¹è°ƒç”¨çš„å½±å“ã€‚ æ”¯ä»˜ç½‘å…³ä¹Ÿé‡‡ç”¨å¤šå°æœºå™¨åˆ†å¸ƒå¼éƒ¨ç½²ï¼Œé‡å¯æ—¶ï¼Œæ¯ä¸ªæœåŠ¡å™¨é€ä¸ªå¯åŠ¨ã€‚æŸå°æœåŠ¡å™¨é‡å¯æ—¶ï¼Œé¦–å…ˆä»LBSç³»ç»Ÿä¸­å–æ¶ˆæ³¨å†Œï¼Œé‡å¯å®Œæˆåï¼Œå†é‡æ–°æ³¨å†Œåˆ°LBSä¸Šã€‚è¿™ä¸ªè¿‡ç¨‹å¯¹è°ƒç”¨æ–¹æ˜¯æ— æ„ŸçŸ¥çš„ã€‚ ä¸ºäº†é¿å…æ¥å£å—æ”»å‡»ï¼Œåœ¨å®‰å…¨ä¸Šï¼Œè¿˜å¾—è¦æ±‚ä¸šåŠ¡æ–¹é€šè¿‡HTTPSæ¥è®¿é—®æ¥å£ï¼Œå¹¶æä¾›é˜²ç¯¡æ”¹æœºåˆ¶ã€‚é˜²ç¯¡æ”¹åˆ™é€šè¿‡æ¥å£å‚æ•°ç­¾åæ¥å¤„ç†ã€‚ç°åœ¨ä¸»æµçš„ç­¾åæ˜¯å¯¹æ¥å£å‚æ•°æŒ‰ç…§å‚æ•°åç§°æ’åºåï¼ŒåšåŠ å¯†å’Œæ•£åˆ—ï¼Œå‚è€ƒå¾®ä¿¡çš„ç­¾åè§„èŒƒã€‚ å‚æ•°æ ¡éªŒ æ‰€æœ‰çš„æ”¯ä»˜æ“ä½œï¼Œéƒ½éœ€è¦å¯¹è¾“å…¥æ‰§è¡Œå‚æ•°æ ¡éªŒï¼Œé¿å…æ¥å£å—åˆ°æ”»å‡»ã€‚ éªŒè¯è¾“å…¥å‚æ•°ä¸­å„å­—æ®µçš„æœ‰æ•ˆæ€§éªŒè¯ï¼Œæ¯”å¦‚ç”¨æˆ·ID,å•†æˆ·ID,ä»·æ ¼ï¼Œè¿”å›åœ°å€ç­‰å‚æ•°ã€‚ éªŒè¯è´¦æˆ·çŠ¶æ€ã€‚äº¤æ˜“ä¸»ä½“ã€äº¤æ˜“å¯¹æ‰‹ç­‰è´¦æˆ·çš„çŠ¶æ€æ˜¯å¤„äºå¯äº¤æ˜“çš„çŠ¶æ€ã€‚ éªŒè¯è®¢å•ï¼šå¦‚æœæ¶‰åŠåˆ°é¢„å•ï¼Œè¿˜éœ€è¦éªŒè¯è®¢å•å·çš„æœ‰æ•ˆæ€§ï¼Œè®¢å•çŠ¶æ€æ˜¯æœªæ”¯ä»˜ã€‚ä¸ºäº†é¿å…ç”¨æˆ·ç¼“å­˜æŸä¸ªURLåœ°å€ï¼Œè¿˜éœ€è¦æ ¡éªŒä¸‹å•æ—¶é—´å’Œæ”¯ä»˜æ—¶é—´æ˜¯å¦è¶…è¿‡é¢„å®šçš„é—´éš”ã€‚ éªŒè¯ç­¾åã€‚ç­¾åä¹Ÿæ˜¯ä¸ºäº†é˜²æ­¢æ”¯ä»˜æ¥å£è¢«ä¼ªé€ ã€‚ ä¸€èˆ¬ç­¾åæ˜¯ä½¿ç”¨åˆ†å‘ç»™å•†æˆ·çš„keyæ¥å¯¹è¾“å…¥å‚æ•°æ‹¼æ¥æˆçš„å­—ç¬¦ä¸²åšMD5 Hashæˆ–è€…RSAåŠ å¯†ï¼Œç„¶åä½œä¸ºä¸€ä¸ªå‚æ•°éšå…¶ä»–å‚æ•°ä¸€èµ·æäº¤åˆ°æœåŠ¡å™¨ç«¯ã€‚ è·¯ç”±é€‰æ‹©æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„æ”¯ä»˜æ–¹å¼ç¡®å®šç”¨æ¥å®Œæˆè¯¥æ“ä½œçš„åˆé€‚çš„æ”¯ä»˜æ¸ é“ã€‚ç”¨æˆ·æŒ‡å®šçš„æ”¯ä»˜æ–¹å¼ä¸ä¸€å®šæ˜¯æœ€ç»ˆçš„æ‰§è¡Œæ”¯ä»˜çš„æ¸ é“ã€‚æ¯”å¦‚ç”¨æˆ·é€‰æ‹©é€šè¿‡å·¥è¡Œä¿¡ç”¨å¡æ¥æ‰§è¡Œæ”¯ä»˜ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰å®ç°å’Œå·¥è¡Œçš„å¯¹æ¥ï¼Œè€Œæ˜¯å¯ä»¥é€šè¿‡ç¬¬ä¸‰æ–¹æ”¯ä»˜ï¼Œæ¯”å¦‚æ”¯ä»˜å®ã€å¾®ä¿¡æ”¯ä»˜ã€æ˜“å®æ”¯ä»˜ï¼Œæˆ–è€…é“¶è”æ¥å®Œæˆã€‚é‚£å¦‚ä½•é€‰æ‹©åˆé€‚çš„æ”¯ä»˜æ¸ é“ï¼Œå°±é€šè¿‡æ”¯ä»˜è·¯ç”±æ¥å®ç°ã€‚æ”¯ä»˜è·¯ç”±ä¼šç»¼åˆè€ƒè™‘æ”¶è´¹ã€æ¸ é“çš„å¯ç”¨æ€§ç­‰å› ç´ æ¥é€‰æ‹©æœ€ä¼˜æ–¹æ¡ˆ é£é™©è¯„ä¼°æ£€æŸ¥æœ¬æ¬¡äº¤æ˜“æ˜¯å¦æœ‰é£é™©ã€‚é£æ§æ¥å£è¿”å›ä¸‰ç§ç»“æœï¼šé˜»æ–­äº¤æ˜“ã€å¢å¼ºéªŒè¯å’Œæ”¾è¡Œäº¤æ˜“ã€‚ é˜»æ–­äº¤æ˜“ï¼Œè¯´æ˜è¯¥äº¤æ˜“æ˜¯é«˜é£é™©çš„ï¼Œéœ€è¦ç»ˆæ­¢ï¼Œä¸æ‰§è¡Œç¬¬5ä¸ªæ­¥éª¤ï¼› å¢å¼ºéªŒè¯ï¼Œè¯´æ˜è¯¥äº¤æ˜“æœ‰ä¸€å®šçš„é£é™©ï¼Œéœ€è¦ç¡®è®¤ä¸‹æ˜¯ä¸æ˜¯ç”¨æˆ·æœ¬äººåœ¨æ“ä½œã€‚è¿™å¯ä»¥é€šè¿‡å‘é€çŸ­ä¿¡éªŒè¯ç æˆ–è€…å…¶ä»–å¯ä»¥éªŒè¯ç”¨æˆ·èº«ä»½çš„æ–¹å¼æ¥åšæ ¡éªŒï¼ŒéªŒè¯é€šè¿‡åï¼Œå¯ä»¥ç»§ç»­æ‰§è¡Œè¯¥äº¤æ˜“ã€‚ æ”¾è¡Œäº¤æ˜“ï¼Œå³æœ¬æ¬¡äº¤æ˜“æ˜¯å®‰å…¨çš„ï¼Œå¯ä»¥ç»§ç»­å¾€ä¸‹èµ°ã€‚ å‘é€æ¶ˆæ¯é€šè¿‡æ¶ˆæ¯æ¥é€šçŸ¥ç›¸å…³ç³»ç»Ÿå…³äºè®¢å•çš„å˜æ›´ã€‚é£æ§ï¼Œä¿¡ç”¨BIç­‰ï¼Œéƒ½éœ€è¦ä¾èµ–è¿™æ•°æ®åšå‡†å®æ—¶è®¡ç®—ã€‚ æ›´æ–°è®¢å•å¯¹äºåŒæ­¥è¿”å›çš„ç»“æœï¼Œéœ€è¦åœ¨ä¸»çº¿ç¨‹ä¸­æ›´æ–°è®¢å•çš„çŠ¶æ€ï¼Œæ ‡è®°æ˜¯æ”¯ä»˜æˆåŠŸè¿˜æ˜¯å¤±è´¥ã€‚å¯¹äºå¼‚æ­¥è¿”å›çš„æ¸ é“ï¼Œéœ€è¦åœ¨å¼‚æ­¥ç¨‹åºä¸­å¤„ç†ã€‚ å¼‚æ­¥é€šçŸ¥å…¶ä¸­æ¶‰åŠåˆ°è°ƒç”¨è¿œç¨‹æ¥å£ï¼Œå…¶å»¶è¿Ÿä¸å¯æ§ã€‚å¦‚æœè°ƒç”¨æ–¹ä¸€ç›´é˜»å¡ç­‰å¾…ï¼Œå¾ˆå®¹æ˜“è¶…æ—¶ã€‚å¼•å…¥å¼‚æ­¥é€šçŸ¥æœºåˆ¶ï¼Œå¯ä»¥è®©è°ƒç”¨æ–¹åœ¨ä¸»çº¿ç¨‹ä¸­å°½å¿«è¿”å›ï¼Œé€šè¿‡å¼‚æ­¥çº¿ç¨‹æ¥å¾—åˆ°æ”¯ä»˜ç»“æœã€‚å¯¹äºé€šè¿‡å¼‚æ­¥æ¥è·å–æ”¯ä»˜ç»“æœçš„æ¸ é“æ¥å£ï¼Œä¹Ÿéœ€è¦å¯¹åº”çš„åœ¨å¼‚æ­¥é€šçŸ¥ä¸­å°†ç»“æœè¿”å›ç»™è°ƒç”¨æ–¹ã€‚ å¼‚æ­¥é€šçŸ¥éœ€è¦è°ƒç”¨æ–¹æä¾›ä¸€ä¸ªå›è°ƒåœ°å€ï¼Œä¸€èˆ¬ä»¥httpæˆ–è€…httpsçš„æ–¹å¼ã€‚è¿™å°±æœ‰æŠ€æœ¯é£é™©ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œè¿˜éœ€è¦é‡è¯•ã€‚è€Œé‡è¯•ä¸èƒ½è¿‡äºé¢‘ç¹ï¼Œéœ€è¦é€æ­¥æ‹‰å¤§æ¯ä¸€æ¬¡é‡è¯•çš„æ—¶é—´é—´éš”ã€‚ åœ¨å¼‚æ­¥å¤„ç†ç¨‹åºä¸­ï¼Œè®¢å•æ ¹æ®å¤„ç†ç»“æœå˜æ›´çŠ¶æ€åï¼Œä¹Ÿè¦å‘æ¶ˆæ¯é€šçŸ¥ç›¸å…³ç³»ç»Ÿã€‚ ç”Ÿæˆäº¤æ˜“è®¢å•å°†è®¢å•ä¿¡æ¯æŒä¹…åŒ–åˆ°æ•°æ®åº“ä¸­ã€‚å½“è®¿é—®å‹åŠ›å¤§çš„æ—¶å€™ï¼Œæ•°æ®åº“å†™å…¥ä¼šæˆä¸ºä¸€ä¸ªç“¶é¢ˆã€‚ äº¤æ˜“æµæ°´å’Œè®°è´¦æ¯ä¸€ç¬”äº¤æ˜“éƒ½éœ€è¦è®°å½•æµæ°´ï¼Œå¹¶ç™»è®°åˆ°ä¸ªäººå’Œæœºæ„çš„åˆ†æˆ·è´¦æˆ·ä¸Šï¼Œç»Ÿè®¡å’Œåˆ†æä¹Ÿéœ€è¦æ ¹æ®äº¤æ˜“æµæ°´æ¥æ›´æ–°ç›¸å…³æ•°æ®ã€‚ è€Œä¸ªäººå’Œæœºæ„è´¦æˆ·æ€»é¢æ›´æ–°ã€äº¤æ˜“æµæ°´è®°å½•ä»¥åŠåº“å­˜çš„å¤„ç†ï¼Œæ›´æ˜¯éœ€è¦äº‹åŠ¡å¤„ç†æœºåˆ¶çš„æ”¯æŒã€‚ ä»æ€§èƒ½è§’åº¦ï¼Œ å¯ä»¥å¼±åŒ–äº†äº‹åŠ¡å¤„ç†çš„è¦æ±‚ï¼Œé‡‡ç”¨æ¶ˆæ¯æœºåˆ¶æ¥å¼‚æ­¥åŒ–å’Œäº¤æ˜“ç›¸å…³çš„æ•°æ®å¤„ç†ã€‚ åœ¨æ”¯ä»˜ç½‘å…³å‰ç½®çš„ä¸»æµç¨‹ä¸­ï¼Œä»…è®°å½•äº¤æ˜“æµæ°´ï¼Œå³å°†å½“å‰çš„è¯·æ±‚ä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚ å®Œæˆæ•°æ®è®°å½•åï¼Œå‘é€MQå‡ºæ¥ï¼Œè®°è´¦ã€ç»Ÿè®¡ã€åˆ†æï¼Œéƒ½æ˜¯æ¥æ”¶MQæ¥å®Œæˆæ•°æ®å¤„ç†ã€‚ æ¶‰åŠåˆ°æœ¬åœ°èµ„é‡‘æ”¯ä»˜ï¼Œæ¯”å¦‚é’±åŒ…æ”¯ä»˜ï¼Œä¼šéœ€è¦åˆ†å¸ƒå¼äº‹åŠ¡å¤„ç†ï¼Œæ‰£å‡è´¦å·ä½™é¢ï¼Œè®°è´¦ï¼Œæ‰£å‡åº“å­˜ç­‰ï¼Œæ¯ä¸ªæ“ä½œå¤±è´¥ï¼Œéƒ½è¦å›æ»šã€‚é˜¿é‡Œæœ‰å¾ˆä¸é”™çš„åˆ†äº«ï¼Œè¿™é‡Œä¸è¯¦ç»†æè¿°ã€‚ å½“äº¤æ˜“é‡ä¸Šæ¥åï¼Œéœ€è¦è€ƒè™‘äº¤æ˜“è¡¨çš„åˆ†è¡¨åˆ†åº“çš„äº‹æƒ…ã€‚åˆ†è¡¨åˆ†åº“æœ‰ä¸¤ä¸ªç­–ç•¥ï¼ŒæŒ‰ç…§æµæ°´å·æˆ–è€…äº¤æ˜“ä¸»ä½“idæ¥èµ°ã€‚åè€…å¯ä»¥æ”¯æŒæŒ‰ç”¨æˆ·æ¥è·å–äº¤æ˜“è®°å½•ã€‚æˆ‘ä»¬ç”¨çš„æ˜¯å‰è€…ã€‚åè€…å¯ä»¥èµ°elasticï¼Œç¡®ä¿æ•°æ®åº“ä¸“ç”¨ã€‚é£æ§ï¼Œä¿¡ç”¨å’Œç»Ÿè®¡æ‰€éœ€è¦çš„æ•°æ®ï¼Œé€šè¿‡MQåŒæ­¥åˆ°å†å²åº“é‡Œé¢ã€‚ä½œä¸ºæ”¯ä»˜ç³»ç»Ÿæœ€æœ‰ä»·å€¼çš„æ•°æ®ï¼Œåœ¨å­˜å‚¨ä¸Šåšåˆ°ä¸“åº“ä¸“ç”¨ï¼Œæ— å¯åšéï¼Œæ¯•ç«Ÿå­˜å‚¨æˆæœ¬è¿˜æ˜¯å»‰ä»·çš„ã€‚ æ”¯ä»˜è·¯ç”±æ”¯ä»˜è·¯ç”±æ˜¯ä¸€ä¸ªå¤æ‚çš„è¯é¢˜ã€‚å¯¹æ”¯ä»˜ç³»ç»Ÿæ¥è¯´ï¼Œèƒ½æ”¯æŒçš„æ”¯ä»˜æ–¹å¼è¶Šå¤šè¶Šå¥½ï¼Œä¸èƒ½ç”±äºæ”¯ä»˜æ–¹å¼çš„ä¸æ”¯æŒæ–­äº†è´¢è·¯ã€‚ç°å®ä¸­çš„æ”¯ä»˜æ–¹å¼å¤šå¾—éš¾ä»¥ç½®ä¿¡ã€‚ç”¨æˆ·éšæ—¶ç”©å‡ºä¸€å¼ ä½ å¬éƒ½æ²¡å¬è¯´è¿‡çš„å¡ã€‚å¦‚æœä¸€ä¸ªé“¶è¡Œå¡åªæœ‰å‡ ä¸ªç”¨æˆ·åœ¨ç”¨ï¼Œé‚£é’ˆå¯¹è¿™ä¸ªå¡å¼€å‘ä¸ªå¯¹æ¥æœ‰ç‚¹å¾—ä¸å°å¤±ã€‚ç°åœ¨ç¬¬ä¸‰æ–¹æ”¯ä»˜çš„çˆ†å‘ï¼Œç¡®å®ç»™å¼€å‘æ”¯ä»˜ç³»ç»Ÿçœäº†ä¸å°‘äº‹ã€‚ä½†æ˜¯å…¬å¸ä¸å¯èƒ½åªå¯¹æ¥ä¸€ä¸ªç¬¬ä¸‰æ–¹æ”¯ä»˜ï¼Œå¦‚æœè¿™ä¸ªæ¸ é“å‡ºé—®é¢˜äº†ï¼Œæˆ–è€…é—¹çŸ›ç›¾äº†ï¼ŒæŠŠé“¾æ¥ç»™æäº†ï¼Œè€æ¿è¿˜ä¸æ¬²å“­æ— æ³ªã€‚æ€»ä¹‹ï¼Œå¾—å¯¹æ¥å¤šä¸ªæ¸ é“ã€‚å¯¹äºäº¤æ˜“é‡å¤§çš„é“¶è¡Œï¼Œè¿˜å¾—è€ƒè™‘ç›´è”ã€‚ æ¸ é“æ¥å…¥å¯¹äºæ”¯ä»˜æ¸ é“ï¼Œé¦–å…ˆè€ƒè™‘çš„æ˜¯æ¥å…¥å“ªäº›æ¸ é“ã€‚è¦å¯¹æ¥çš„æ¸ é“æŒ‰ä¼˜å…ˆçº§æœ‰ï¼š ç¬¬ä¸‰æ–¹æ”¯ä»˜ï¼Œå¯¹å¤§éƒ¨åˆ†åº”ç”¨æ¥è¯´ï¼Œæ”¯ä»˜å®å’Œå¾®ä¿¡æ”¯ä»˜éƒ½æ˜¯å¿…é¡»çš„ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸¤è€…å¯ä»¥å åˆ°90%ä»¥ä¸Šçš„äº¤æ˜“é‡ã€‚ç”¨æˆ·ä¸éœ€è¦ç»‘å¡ï¼Œæˆæƒåç›´æ¥æ”¯ä»˜å°±è¡Œã€‚å„ç§å¹³å°éƒ½æ”¯æŒï¼Œæ€§èƒ½å’Œç¨³å®šæ€§éƒ½ä¸é”™ã€‚å¯¹äºä¸€äº›ç‰¹æ®Šä¸šåŠ¡ï¼Œæ¯”å¦‚æ¸¸æˆï¼Œä¼ä¸šæ”¯ä»˜ï¼Œå¯ä»¥æŸ¥çœ‹ä¸€äº›ä¸“ç”¨çš„ç¬¬ä¸‰æ–¹æ”¯ä»˜å¹³å°ã€‚ é“¶è”ï¼Œå®ƒçš„å­˜åœ¨ï¼Œæå¤§æ–¹ä¾¿äº†å’Œé“¶è¡Œçš„å¯¹æ¥ã€‚å’Œç¬¬ä¸‰æ–¹æ”¯ä»˜ä¸»è¦ä¸åŒåœ¨ä¸¤ä¸ªåœ°æ–¹ä¸€æ˜¯éœ€è¦ç»‘å¡ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·å…ˆæŠŠå¡å·ï¼Œæ‰‹æœºï¼Œèº«ä»½è¯å·æä¾›å‡ºæ¥ã€‚è¿™ä¸€æ­¥ä¼šæŠ˜æŸä¸å°‘ç”¨æˆ·ã€‚ç»‘å¡åï¼Œä»¥åçš„æ”¯ä»˜æ“ä½œå°±ç®€å•äº†ï¼Œç”¨æˆ·åªéœ€è¦è¾“å…¥å¯†ç å°±è¡Œã€‚æ‰‹æœºå®¢æˆ·ç«¯ä¸éœ€è¦åƒç¬¬ä¸‰æ–¹æ”¯ä»˜é‚£æ ·å®‰è£…SDKï¼Œéƒ½åœ¨æœåŠ¡å™¨ç«¯å®Œæˆã€‚å½“ç„¶ï¼Œè¿™æ˜¯é’ˆå¯¹å¿«æ·æ”¯ä»˜ã€‚ç½‘é“¶æ”¯ä»˜è¿˜æ˜¯æŒºéº»çƒ¦çš„ã€‚é“¶è”æ¥å…¥ä¹Ÿéœ€è¦ADSSè®¤è¯ã€‚ é“¶è¡Œï¼š2018å¹´2æœˆ9æ—¥é“¶ç›‘ä¼šå…¬å¸ƒäº†æœ€æ–°æƒå¨æ•°å­—ï¼šä¸€å…±ã€4549å®¶ã€‘å¼€å‘æ€§é‡‘èæœºæ„1å®¶ï¼šå›½å®¶å¼€å‘é“¶è¡Œï¼›æ”¿ç­–æ€§é“¶è¡Œ2å®¶ï¼šè¿›å‡ºå£é“¶è¡Œã€å†œä¸šå‘å±•é“¶è¡Œï¼›5å¤§å›½æœ‰é“¶è¡Œï¼šå·¥ã€å»ºã€å†œã€ä¸­ã€äº¤ï¼›é‚®å‚¨é“¶è¡Œ1å®¶ï¼›å…¨å›½æ€§è‚¡ä»½åˆ¶å•†ä¸šé“¶è¡Œ12å®¶ï¼šæ‹›è¡Œã€ä¸­ä¿¡ã€å…´ä¸šã€æ°‘ç”Ÿã€æµ¦å‘ã€å…‰å¤§ã€å¹¿å‘ã€åå¤ã€å¹³å®‰ã€æµ™å•†ã€æ¸¤æµ·ã€æ’ä¸°ï¼›é‡‘èèµ„äº§ç®¡ç†å…¬å¸4å®¶ï¼šä¿¡è¾¾ã€åèã€é•¿åŸã€ä¸œæ–¹å››å¤§AMCï¼›åŸå•†è¡Œ134å®¶ï¼›ä½æˆ¿å‚¨è“„é“¶è¡Œ1å®¶ï¼›æ°‘è¥é“¶è¡Œ17å®¶ï¼Œå¦‚ç½‘å•†é“¶è¡Œï¼›å†œå•†è¡Œ1262å®¶ï¼›å†œæ‘åˆä½œé“¶è¡Œ33å®¶ï¼›å†œæ‘ä¿¡ç”¨ç¤¾965å®¶ï¼›æ‘é•‡é“¶è¡Œ1562å®¶ï¼›è´·æ¬¾å…¬å¸13å®¶ï¼›å†œæ‘èµ„é‡‘äº’åŠ©ç¤¾48å®¶ï¼›å¤–èµ„æ³•äººé“¶è¡Œ39å®¶ï¼›ä¿¡æ‰˜å…¬å¸68å®¶ï¼›é‡‘èç§Ÿèµå…¬å¸69å®¶ï¼›ä¼ä¸šé›†å›¢è´¢åŠ¡å…¬å¸247å®¶ï¼›æ±½è½¦é‡‘èå…¬å¸25å®¶ï¼›æ¶ˆè´¹é‡‘èå…¬å¸22å®¶ï¼›è´§å¸ç»çºªå…¬å¸5å®¶ï¼›å…¶ä»–é‡‘èæœºæ„14å®¶ã€‚ä¸€èˆ¬å¯¹æ¥ä¸€ä¸ªé“¶è¡Œé¢„è®¡æœ‰3å‘¨å·¦å³çš„å·¥ä½œé‡ï¼Œå¤§éƒ¨åˆ†é“¶è¡Œéœ€è¦ä¸“çº¿æ¥å…¥ï¼Œè´¹ç”¨å’Œå¸¦å®½æœ‰å…³ï¼Œä¸€å¹´ä¹Ÿå¾—å‡ ä¸‡è´¹ç”¨ã€‚ä¸åŒé“¶è¡Œå¯¹æ¥å…¥ç¯å¢ƒæœ‰ä¸åŒè¦æ±‚ï¼Œè¿™ä¹Ÿæ˜¯æˆæœ¬ã€‚ æ‰‹æœºæ”¯ä»˜ï¼šæ¯”å¦‚è‹¹æœçš„In-Appæ”¯ä»˜ï¼Œ ä¸‰æ˜Ÿæ”¯ä»˜ã€åä¸ºæ”¯ä»˜ç­‰ï¼Œ è¿™äº›æ”¯ä»˜ä»…é’ˆå¯¹ç‰¹å®šçš„æ‰‹æœºå‹å·ï¼Œ æ”¯æŒNFCç­‰ï¼Œæ ¹æ®ä¸šåŠ¡éœ€è¦ä¹Ÿå¯ä»¥æ¥å…¥ã€‚ æ€»ç»“æ”¯ä»˜ç³»ç»Ÿæ˜¯ä¸€ä¸ªç¹æ‚çš„ç³»ç»Ÿï¼Œå…¶ä¸­æ¶‰åŠäº†å„ç§é”™ç»¼å¤æ‚çš„ä¸šåŠ¡æµç¨‹ï¼Œä»¥ä¸Šåªæ˜¯ç®€å•ä»‹ç»äº†æ”¯ä»˜ç³»ç»Ÿæˆ‘ä»¬èƒ½çœ‹è§çš„ä¸€äº›é—®é¢˜å’Œè®¾è®¡ï¼Œè¿˜æœ‰åç»­çš„ç³»ç»Ÿä¿éšœæ²¡æœ‰å†™å‡ºæ¥ï¼Œæ²¡å†™å‡ºæ¥çš„æ‰æ˜¯å…³é”®éƒ¨åˆ†ï¼Œæ¯”å¦‚ï¼šæ”¯ä»˜ç³»ç»Ÿç›‘æ§ï¼ˆä¸šåŠ¡ç›‘æ§åˆ†ç±»ã€æ¸ é“ç›‘æ§ã€å•†æˆ·ç›‘æ§ã€è´¦æˆ·ç›‘æ§ï¼‰æ–‡ç« åªæ˜¯å¼•å­ï¼Œ æ¶æ„ä¸æ˜¯é™æ€çš„ï¼Œè€Œæ˜¯åŠ¨æ€æ¼”åŒ–çš„ã€‚åªæœ‰èƒ½å¤Ÿä¸æ–­åº”å¯¹ç¯å¢ƒå˜åŒ–çš„ç³»ç»Ÿï¼Œæ‰æ˜¯æœ‰ç”Ÿå‘½åŠ›çš„ç³»ç»Ÿã€‚æ‰€ä»¥å³ä½¿ä½ æŒæ¡äº†ä»¥ä¸Šæ‰€æœ‰çš„ä¸šåŠ¡ç»†èŠ‚ï¼Œä»ç„¶éœ€è¦æ¼”åŒ–å¼æ€ç»´ï¼Œåœ¨è®¾è®¡çš„åŒæ—¶ï¼Œå€ŸåŠ©åé¦ˆå’Œè¿›åŒ–çš„åŠ›é‡æ¨åŠ¨æ¶æ„çš„æŒç»­æ¼”è¿›ã€‚ åŸæ–‡è½¬è½½è‡ª","link":"/2018/12/01/æ”¯ä»˜ç³»ç»Ÿè®¾è®¡-è½¬è½½.html"},{"title":"Javaè®¾è®¡æ¨¡å¼ä¹‹è£…é¥°è€…æ¨¡å¼","text":"é—®é¢˜å¼•å…¥å’–å•¡åº—çš„ç±»è®¾è®¡ï¼š ä¸€ä¸ªé¥®æ–™åŸºç±»ï¼Œå„ç§é¥®æ–™ç±»ç»§æ‰¿è¿™ä¸ªåŸºç±»ï¼Œå¹¶ä¸”è®¡ç®—å„è‡ªçš„ä»·é’±ã€‚ é¥®æ–™ä¸­éœ€è¦åŠ å…¥å„ç§è°ƒæ–™ï¼Œè€ƒè™‘åœ¨åŸºç±»ä¸­åŠ å…¥ä¸€äº›å¸ƒå°”å€¼å˜é‡ä»£è¡¨æ˜¯å¦åŠ å…¥å„ç§è°ƒæ–™ï¼ŒåŸºç±»çš„cost()ä¸­çš„è®¡ç®—å„ç§è°ƒæ–™çš„ä»·é’±ï¼Œå­ç±»è¦†ç›–cost()ï¼Œå¹¶ä¸”åœ¨å…¶ä¸­è°ƒç”¨è¶…ç±»çš„cost()ï¼ŒåŠ ä¸Šç‰¹å®šé¥®æ–™çš„ä»·é’±ï¼Œè®¡ç®—å‡ºå­ç±»ç‰¹å®šé¥®æ–™çš„ä»·é’±ã€‚ ç¼ºç‚¹ï¼šç±»æ•°é‡çˆ†ç‚¸ã€åŸºç±»åŠ å…¥çš„æ–°åŠŸèƒ½å¹¶ä¸é€‚ç”¨äºæ‰€æœ‰çš„å­ç±»ã€è°ƒæ–™ä»·é’±çš„æ”¹å˜ã€æ–°è°ƒæ–™çš„å‡ºç°éƒ½ä¼šè¦æ±‚æ”¹å˜ç°æœ‰ä»£ç ï¼›æœ‰çš„å­ç±»å¹¶ä¸é€‚åˆæŸäº›è°ƒæ–™ç­‰æƒ…å†µâ€¦â€¦ è®¾è®¡åŸåˆ™ ç±»åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚ æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å…è®¸ç±»å®¹æ˜“æ‰©å±•ï¼Œåœ¨ä¸ä¿®æ”¹ç°æœ‰ä»£ç çš„æƒ…å†µä¸‹ï¼Œå°±å¯æ­é…æ–°çš„è¡Œä¸ºã€‚ å¦‚èƒ½å®ç°è¿™æ ·çš„ç›®æ ‡ï¼Œæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿè¿™æ ·çš„è®¾è®¡å…·æœ‰å¼¹æ€§å¯ä»¥åº”å¯¹æ”¹å˜ï¼Œå¯ä»¥æ¥å—æ–°çš„åŠŸèƒ½æ¥åº”å¯¹æ”¹å˜çš„éœ€æ±‚ã€‚ è¦è®©OOè®¾è®¡åŒæ—¶å…·å¤‡å¼€æ”¾æ€§å’Œå…³é—­æ€§ï¼Œä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹ï¼Œé€šå¸¸æ¥è¯´ï¼Œæ²¡æœ‰å¿…è¦æŠŠè®¾è®¡çš„æ¯ä¸ªéƒ¨åˆ†éƒ½è¿™ä¹ˆè®¾è®¡ã€‚ éµå¾ªå¼€æ”¾-å…³é—­åŸåˆ™ï¼Œé€šå¸¸ä¼šå¼•å…¥æ–°çš„æŠ½è±¡å±‚æ¬¡ï¼Œå¢åŠ ä»£ç çš„å¤æ‚åº¦ã€‚ æˆ‘ä»¬éœ€è¦æŠŠæ³¨æ„åŠ›é›†ä¸­åœ¨è®¾è®¡ä¸­æœ€æœ‰å¯èƒ½æ”¹å˜çš„åœ°æ–¹ï¼Œç„¶ååº”ç”¨å¼€æ”¾-å…³é—­åŸåˆ™ã€‚ ç”¨è£…é¥°è€…æ¨¡å¼è§£å†³é—®é¢˜è§£å†³å’–å•¡åº—é¥®æ–™é—®é¢˜çš„æ–¹æ³•ï¼š ä»¥é¥®æ–™ä¸ºä¸»ä½“ï¼Œç„¶ååœ¨è¿è¡Œæ—¶ä»¥è°ƒæ–™æ¥â€œè£…é¥°â€é¥®æ–™ã€‚ æ¯”å¦‚ï¼Œé¡¾å®¢æƒ³è¦æ‘©å¡ï¼ˆMochaï¼‰å’Œå¥¶æ³¡ï¼ˆWhipï¼‰æ·±ç„™å’–å•¡ï¼ˆDarkRoastï¼‰ï¼š DarkRoastç»§æ‰¿è‡ªBeverageï¼Œæœ‰ä¸€ä¸ªcost()æ–¹æ³•ã€‚ ç¬¬ä¸€æ­¥ï¼Œä»¥DarkRoastå¯¹è±¡å¼€å§‹ï¼› ç¬¬äºŒæ­¥ï¼Œé¡¾å®¢æƒ³è¦æ‘©å¡ï¼Œæ‰€ä»¥å»ºç«‹ä¸€ä¸ªMochaè£…é¥°è€…å¯¹è±¡ï¼Œå¹¶ç”¨å®ƒå°†DarkRoastå¯¹è±¡åŒ…è£…ï¼ˆwrapï¼‰èµ·æ¥ï¼› ç¬¬ä¸‰æ­¥ï¼Œé¡¾å®¢æƒ³è¦å¥¶æ³¡ï¼Œæ‰€ä»¥å»ºç«‹ä¸€ä¸ªWhipè£…é¥°è€…å¯¹è±¡ï¼Œå¹¶ç”¨å®ƒå°†Mochaå¯¹è±¡åŒ…èµ·æ¥ï¼›ï¼ˆMochaå’ŒWhipä¹Ÿç»§æ‰¿è‡ªBeverageï¼Œæœ‰ä¸€ä¸ªcost()æ–¹æ³•ï¼‰ï¼› æœ€åï¼Œä¸ºé¡¾å®¢ç®—é’±ï¼Œé€šè¿‡è°ƒç”¨æœ€å¤–åœˆè£…é¥°è€…ï¼ˆWhipï¼‰çš„cost()å°±å¯ä»¥ã€‚Whip()çš„cost()ä¼šå…ˆå§”æ‰˜å®ƒè£…é¥°çš„å¯¹è±¡ï¼ˆMochaï¼‰è®¡ç®—å‡ºä»·é’±ï¼Œç„¶ååœ¨åŠ ä¸Šå¥¶æ³¡çš„ä»·é’±ã€‚Mochaçš„cost()ä¹Ÿæ˜¯ç±»ä¼¼ã€‚ è£…é¥°è€…æ¨¡å¼çš„ç‰¹ç‚¹ è£…é¥°è€…å’Œè¢«è£…é¥°å¯¹è±¡æœ‰ç›¸åŒçš„è¶…ç±»å‹ã€‚ å¯ä»¥ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªè£…é¥°è€…åŒ…è£…ä¸€ä¸ªå¯¹è±¡ã€‚ å› ä¸ºè£…é¥°è€…å’Œè¢«è£…é¥°è€…å…·æœ‰ç›¸åŒçš„ç±»å‹ï¼Œæ‰€ä»¥ä»»ä½•éœ€è¦åŸå§‹å¯¹è±¡çš„åœºåˆï¼Œå¯ä»¥ç”¨è£…é¥°è¿‡çš„å¯¹è±¡ä»£æ›¿ã€‚ è£…é¥°è€…å¯ä»¥åœ¨æ‰€å§”æ‰˜è¢«è£…é¥°è€…çš„è¡Œä¸ºä¹‹å‰ä¸/æˆ–ä¹‹åï¼ŒåŠ ä¸Šè‡ªå·±çš„è¡Œä¸ºï¼Œä»¥è¾¾åˆ°ç‰¹å®šçš„ç›®çš„ã€‚ å¯¹è±¡å¯ä»¥åœ¨ä»»ä½•æ—¶å€™è¢«è£…é¥°ï¼Œæ‰€ä»¥å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°ã€ä¸é™é‡åœ°ç”¨ä½ å–œæ¬¢çš„è£…é¥°è€…æ¥è£…é¥°å¯¹è±¡ã€‚ è£…é¥°è€…æ¨¡å¼çš„å®šä¹‰è£…é¥°è€…æ¨¡å¼åŠ¨æ€åœ°å°†è´£ä»»é™„åŠ åˆ°å¯¹è±¡ä¸Šã€‚è‹¥è¦æ‰©å±•åŠŸèƒ½ï¼Œè£…é¥°è€…æä¾›äº†æ¯”ç»§æ‰¿æ›´æœ‰å¼¹æ€§çš„æ›¿ä»£æ–¹æ¡ˆã€‚ è£…é¥°è€…æ¨¡å¼çš„å®ç°å®ç°ç±»å›¾ è£…é¥°è€…å’Œè¢«è£…é¥°è€…å…·æœ‰å…±åŒçš„è¶…ç±»ï¼Œåˆ©ç”¨ç»§æ‰¿è¾¾åˆ°â€œç±»å‹åŒ¹é…â€ï¼Œè€Œä¸æ˜¯åˆ©ç”¨ç»§æ‰¿è·å¾—â€œè¡Œä¸ºâ€ï¼›å°†è£…é¥°è€…å’Œè¢«è£…é¥°è€…ç»„åˆæ—¶ï¼ŒåŠ å…¥æ–°çš„è¡Œä¸ºã€‚ å®ç°Javaä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133// æŠ½è±¡é¥®æ–™ç±»(æŠ½è±¡ç»„ä»¶)public abstract class Beverage { String description = \"Unkown Beverage\"; public String getDescription() { return description; } /** * æŠ½è±¡ä»·æ ¼è®¡ç®—æ–¹æ³• * @return */ public abstract double cost();}// æµ“ç¼©é¥®æ–™public class Espresso extends Beverage { public Espresso() { description = \"Espresso\"; } @Override public double cost() { return 1.99; }}// åˆä¸€é¥®æ–™public class HouseBlend extends Beverage { public HouseBlend() { description = \"House Blend\"; } @Override public double cost() { return .20; }}// æŠ½è±¡è£…é¥°è€…ç±»public abstract class CondimentDecorator extends Beverage { /** * ä¸ºäº†åé¢çš„è°ƒæ–™éƒ½èƒ½å¤Ÿè·å–åˆ°è‡ªå·±è°ƒæ–™çš„æè¿° */ public abstract String getDescription();}/** * @desc Mochaè°ƒæ–™(å…·ä½“è£…é¥°è€…) */public class Mocha extends CondimentDecorator { Beverage beverage; public Mocha(Beverage beverage) { this.beverage = beverage; } @Override public String getDescription() { return beverage.getDescription() + \",Mocha\"; } @Override public double cost() { return .20 + beverage.cost(); }}/** * @desc Soyè°ƒæ–™(å…·ä½“è£…é¥°è€…) */public class Soy extends CondimentDecorator { Beverage beverage; public Soy(Beverage beverage) { this.beverage = beverage; } @Override public String getDescription() { return beverage.getDescription() + \",Soy\"; } @Override public double cost() { return .60 + beverage.cost(); }}/** * @desc Whipè°ƒæ–™(å…·ä½“è£…é¥°è€…) */public class Whip extends CondimentDecorator { Beverage beverage; public Whip(Beverage beverage) { this.beverage = beverage; } @Override public String getDescription() { return beverage.getDescription() + \",Whip\"; } @Override public double cost() { return .40 + beverage.cost(); }}/** * @desc æµ‹è¯•è£…é¥°è€…æ¨¡å¼ */public class MainTest { public static void main(String[] args) { // åˆ›å»ºä¸€ç§è°ƒæ–™ Beverage beverage = new Espresso(); // æè¿°å’Œä»·æ ¼ System.out.println(beverage.getDescription() + \" $\" + beverage.cost()); Beverage beverage1 = new HouseBlend(); beverage1 = new Mocha(beverage1); beverage1 = new Whip(beverage1); beverage1 = new Soy(beverage1); System.out.println(beverage1.getDescription() + \" $\" + beverage1.cost()); Beverage beverage2 = new Espresso(); beverage2 = new Mocha(beverage2); beverage2 = new Whip(beverage2); beverage2 = new Soy(beverage2); beverage2 = new Mocha(beverage2); System.out.println(beverage2.getDescription() + \" $\" + beverage2.cost()); }} æµ‹è¯•ç»“æœ è£…é¥°è€…å’Œè¢«è£…é¥°è€…å…·æœ‰å…±åŒçš„è¶…ç±»ï¼Œåˆ©ç”¨ç»§æ‰¿è¾¾åˆ°â€œç±»å‹åŒ¹é…â€ï¼Œè€Œä¸æ˜¯åˆ©ç”¨ç»§æ‰¿è·å¾—â€œè¡Œä¸ºâ€ï¼›å°†è£…é¥°è€…å’Œè¢«è£…é¥°è€…ç»„åˆæ—¶ï¼ŒåŠ å…¥æ–°çš„è¡Œä¸ºã€‚ è§£å†³æœ¬æ–‡ä¸­é¥®æ–™çš„å…·ä½“é—®é¢˜æ—¶ï¼Œå›¾ä¸­Componentå³ä¸ºBeverageï¼ˆå¯ä»¥æ˜¯æŠ½è±¡ç±»æˆ–è€…æ¥å£ï¼‰ï¼Œè€ŒConcreteComponentä¸ºå„ç§é¥®æ–™ï¼ŒDecoratorï¼ˆæŠ½è±¡è£…é¥°è€…ï¼‰ä¸ºè°ƒæ–™çš„æŠ½è±¡ç±»æˆ–æ¥å£ï¼ŒConcreteDecoratorXåˆ™ä¸ºå„ç§å…·ä½“çš„è°ƒæ–™ã€‚ å› ä¸ºä½¿ç”¨å¯¹è±¡ç»„åˆï¼Œå¯ä»¥æŠŠé¥®æ–™å’Œè°ƒæ–™æ›´æœ‰å¼¹æ€§åœ°åŠ ä»¥æ··åˆä¸åŒ¹é…ã€‚ ä»£ç å¤–éƒ¨ç»†èŠ‚ï¼š ä»£ç ä¸­å®ç°çš„æ—¶å€™ï¼Œé€šè¿‡æ„é€ å‡½æ•°å°†è¢«è£…é¥°è€…ä¼ å…¥è£…é¥°è€…ä¸­å³å¯ï¼Œå¦‚æœ€åçš„è°ƒç”¨å½¢å¼å¦‚ä¸‹ï¼š 123Beverage beverage = new DarkRoast();beverage = new Mocha(beverage);beverage = new Whip(beverage); å³å®Œæˆäº†ä¸¤å±‚åŒ…è£…ï¼Œæ­¤æ—¶å†è°ƒç”¨beverageçš„cost()å‡½æ•°å³å¯å¾—åˆ°æ€»ä»·ã€‚ java.ioåŒ…å†…çš„è£…é¥°è€…æ¨¡å¼ è£…é¥°è€…æ¨¡å¼çš„ç¼ºç‚¹ï¼šåœ¨è®¾è®¡ä¸­åŠ å…¥å¤§é‡çš„å°ç±»ï¼Œå¦‚æœè¿‡åº¦ä½¿ç”¨ï¼Œä¼šè®©ç¨‹åºå˜å¾—å¤æ‚ã€‚ å‚è€ƒï¼šhttp://www.cnblogs.com/mengdd/archive/2013/01/03/2843439.html","link":"/2018/11/29/Javaè®¾è®¡æ¨¡å¼ä¹‹è£…é¥°è€…æ¨¡å¼.html"},{"title":"Javaè®¾è®¡æ¨¡å¼ä¹‹å·¥å‚æ¨¡å¼","text":"å·¥å‚æ¨¡å¼åºè¨€å·¥å‚æ¨¡å¼åœ¨ã€ŠJavaä¸æ¨¡å¼ã€‹ä¸­åˆ†ä¸ºä¸‰ç±»ï¼š ç®€å•å·¥å‚æ¨¡å¼ï¼ˆSimple Factoryï¼‰ï¼šä¸åˆ©äºäº§ç”Ÿç³»åˆ—äº§å“ï¼› å·¥å‚æ–¹æ³•æ¨¡å¼ï¼ˆFactory Methodï¼‰ï¼šåˆç§°ä¸ºå¤šå½¢æ€§å·¥å‚ï¼› æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract Factoryï¼‰ï¼šåˆç§°ä¸ºå·¥å…·ç®±ï¼Œäº§ç”Ÿäº§å“æ—ï¼Œä½†ä¸åˆ©äºäº§ç”Ÿæ–°çš„äº§å“ï¼› è¿™ä¸‰ç§æ¨¡å¼ä»ä¸Šåˆ°ä¸‹é€æ­¥æŠ½è±¡ï¼Œå¹¶ä¸”æ›´å…·ä¸€èˆ¬æ€§ã€‚GOFåœ¨ã€Šè®¾è®¡æ¨¡å¼ã€‹ä¸€ä¹¦ä¸­å°†å·¥å‚æ¨¡å¼åˆ†ä¸ºä¸¤ç±»ï¼šå·¥å‚æ–¹æ³•æ¨¡å¼ï¼ˆFactory Methodï¼‰ä¸æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract Factoryï¼‰ã€‚å°†ç®€å•å·¥å‚æ¨¡å¼ï¼ˆSimple Factoryï¼‰çœ‹ä¸ºå·¥å‚æ–¹æ³•æ¨¡å¼çš„ä¸€ç§ç‰¹ä¾‹ï¼Œä¸¤è€…å½’ä¸ºä¸€ç±»ã€‚ ç®€å•å·¥å‚æ¨¡å¼ ç®€å•å·¥å‚æ¨¡å¼åˆç§°é™æ€å·¥å‚æ–¹æ³•æ¨¡å¼ã€‚ä»å‘½åä¸Šå°±å¯ä»¥çœ‹å‡ºè¿™ä¸ªæ¨¡å¼ä¸€å®šå¾ˆç®€å•ã€‚å®ƒå­˜åœ¨çš„ç›®çš„å¾ˆç®€å•ï¼šå®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ã€‚åœ¨ç®€å•å·¥å‚æ¨¡å¼ä¸­,ä¸€ä¸ªå·¥å‚ç±»å¤„äºå¯¹äº§å“ç±»å®ä¾‹åŒ–è°ƒç”¨çš„ä¸­å¿ƒä½ç½®ä¸Š,å®ƒå†³å®šé‚£ä¸€ä¸ªäº§å“ç±»åº”å½“è¢«å®ä¾‹åŒ–, å¦‚åŒä¸€ä¸ªäº¤é€šè­¦å¯Ÿç«™åœ¨æ¥å¾€çš„è½¦è¾†æµä¸­,å†³å®šæ”¾è¡Œé‚£ä¸€ä¸ªæ–¹å‘çš„è½¦è¾†å‘é‚£ä¸€ä¸ªæ–¹å‘æµåŠ¨ä¸€æ ·ã€‚ ç»„æˆè§’è‰²ï¼š å·¥å‚ç±»è§’è‰²ï¼šè¿™æ˜¯æœ¬æ¨¡å¼çš„æ ¸å¿ƒï¼Œå«æœ‰ä¸€å®šçš„å•†ä¸šé€»è¾‘å’Œåˆ¤æ–­é€»è¾‘ã€‚åœ¨javaä¸­å®ƒå¾€å¾€ç”±ä¸€ä¸ªå…·ä½“ç±»å®ç°ã€‚ æŠ½è±¡äº§å“è§’è‰²ï¼šå®ƒä¸€èˆ¬æ˜¯å…·ä½“äº§å“ç»§æ‰¿çš„çˆ¶ç±»æˆ–è€…å®ç°çš„æ¥å£ã€‚åœ¨javaä¸­ç”±æ¥å£æˆ–è€…æŠ½è±¡ç±»æ¥å®ç°ã€‚ å…·ä½“äº§å“è§’è‰²ï¼šå·¥å‚ç±»æ‰€åˆ›å»ºçš„å¯¹è±¡å°±æ˜¯æ­¤è§’è‰²çš„å®ä¾‹ã€‚åœ¨javaä¸­ç”±ä¸€ä¸ªå…·ä½“ç±»å®ç°ã€‚ ç®€å•å·¥å‚æ¨¡å¼çš„UMLå›¾ ç®€å•å·¥å‚æ¨¡å¼çš„Javaä»£ç 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374// æŠ½è±¡æ¥å£ äººç±»public interface Human { public void say();}// ç”·äººpublic class Man implements Human { @Override public void say() { System.out.println(\"ç”·äºº\"); }}// å¥³äººpublic class Woman implements Human { @Override public void say() { System.out.println(\"å¥³äºº\"); }}// ç®€å•å·¥å‚public class SampleFactory { public static Human makeHuman(String type){ if(type.equals(\"man\")){ Human man = new Man(); return man; }else if(type.equals(\"womman\")){ Human woman = new Woman(); return woman; }else{ System.out.println(\"ç”Ÿäº§ä¸å‡ºæ¥\"); return null; } }}// ç®€å•å·¥å‚æ¨¡å¼åå°„å®ç°public class SampleFactory1 { public static Human makeHuman(Class c){ Human human = null; try { human = (Human) Class.forName(c.getName()).newInstance(); } catch (InstantiationException e) { // TODO Auto-generated catch block System.out.println(\"ä¸æ”¯æŒæŠ½è±¡ç±»æˆ–æ¥å£\"); e.printStackTrace(); } catch (IllegalAccessException e) { // TODO Auto-generated catch block e.printStackTrace(); System.out.println(\"æ²¡æœ‰è¶³å¤Ÿæƒé™ï¼Œå³ä¸èƒ½è®¿é—®ç§æœ‰å¯¹è±¡\"); } catch (ClassNotFoundException e) { // TODO Auto-generated catch block System.out.println(\"ç±»ä¸å­˜åœ¨\"); e.printStackTrace(); } return human; }}// ç®€å•å·¥å‚æµ‹è¯•public class Client { public static void main(String[] args) { Human man = SampleFactory.makeHuman(\"man\"); man.say(); Human womman = SampleFactory.makeHuman(\"womman\"); womman.say(); Human test = SampleFactory.makeHuman(\"tttt\"); Human man = SampleFactory1.makeHuman(Man.class); man.say(); Human woman = SampleFactory1.makeHuman(Woman.class); woman.say(); }} ä¼˜ç¼ºç‚¹ï¼š ä¼˜ç‚¹ï¼šå·¥å‚ç±»æ˜¯æ•´ä¸ªæ¨¡å¼çš„å…³é”®.åŒ…å«äº†å¿…è¦çš„é€»è¾‘åˆ¤æ–­,æ ¹æ®å¤–ç•Œç»™å®šçš„ä¿¡æ¯,å†³å®šç©¶ç«Ÿåº”è¯¥åˆ›å»ºå“ªä¸ªå…·ä½“ç±»çš„å¯¹è±¡.é€šè¿‡ä½¿ç”¨å·¥å‚ç±»,å¤–ç•Œå¯ä»¥ä»ç›´æ¥åˆ›å»ºå…·ä½“äº§å“å¯¹è±¡çš„å°´å°¬å±€é¢æ‘†è„±å‡ºæ¥,ä»…ä»…éœ€è¦è´Ÿè´£â€œæ¶ˆè´¹â€å¯¹è±¡å°±å¯ä»¥äº†ã€‚è€Œä¸å¿…ç®¡è¿™äº›å¯¹è±¡ç©¶ç«Ÿå¦‚ä½•åˆ›å»ºåŠå¦‚ä½•ç»„ç»‡çš„ï¼æ˜ç¡®äº†å„è‡ªçš„èŒè´£å’Œæƒåˆ©ï¼Œæœ‰åˆ©äºæ•´ä¸ªè½¯ä»¶ä½“ç³»ç»“æ„çš„ä¼˜åŒ–ã€‚ ç¼ºç‚¹ï¼šç”±äºå·¥å‚ç±»é›†ä¸­äº†æ‰€æœ‰å®ä¾‹çš„åˆ›å»ºé€»è¾‘ï¼Œè¿åäº†é«˜å†…èšè´£ä»»åˆ†é…åŸåˆ™ï¼Œå°†å…¨éƒ¨åˆ›å»ºé€»è¾‘é›†ä¸­åˆ°äº†ä¸€ä¸ªå·¥å‚ç±»ä¸­ï¼›å®ƒæ‰€èƒ½åˆ›å»ºçš„ç±»åªèƒ½æ˜¯äº‹å…ˆè€ƒè™‘åˆ°çš„ï¼Œå¦‚æœéœ€è¦æ·»åŠ æ–°çš„ç±»ï¼Œåˆ™å°±éœ€è¦æ”¹å˜å·¥å‚ç±»äº†ã€‚å½“ç³»ç»Ÿä¸­çš„å…·ä½“äº§å“ç±»ä¸æ–­å¢å¤šæ—¶å€™ï¼Œå¯èƒ½ä¼šå‡ºç°è¦æ±‚å·¥å‚ç±»æ ¹æ®ä¸åŒæ¡ä»¶åˆ›å»ºä¸åŒå®ä¾‹çš„éœ€æ±‚ï¼è¿™ç§å¯¹æ¡ä»¶çš„åˆ¤æ–­å’Œå¯¹å…·ä½“äº§å“ç±»å‹çš„åˆ¤æ–­äº¤é”™åœ¨ä¸€èµ·ï¼Œå¾ˆéš¾é¿å…æ¨¡å—åŠŸèƒ½çš„è”“å»¶ï¼Œå¯¹ç³»ç»Ÿçš„ç»´æŠ¤å’Œæ‰©å±•éå¸¸ä¸åˆ©ï¼› å·¥å‚æ–¹æ³•æ¨¡å¼ å·¥å‚æ–¹æ³•æ¨¡å¼æ˜¯ç®€å•å·¥å‚æ¨¡å¼çš„è¿›ä¸€æ­¥æŠ½è±¡åŒ–å’Œæ¨å¹¿ï¼Œå·¥å‚æ–¹æ³•æ¨¡å¼é‡Œä¸å†åªç”±ä¸€ä¸ªå·¥å‚ç±»å†³å®šé‚£ä¸€ä¸ªäº§å“ç±»åº”å½“è¢«å®ä¾‹åŒ–,è¿™ä¸ªå†³å®šè¢«äº¤ç»™æŠ½è±¡å·¥å‚çš„å­ç±»å»åšã€‚ ç»„æˆè§’è‰²ï¼š æŠ½è±¡å·¥å‚è§’è‰²ï¼š è¿™æ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„æ ¸å¿ƒï¼Œå®ƒä¸åº”ç”¨ç¨‹åºæ— å…³ã€‚æ˜¯å…·ä½“å·¥å‚è§’è‰²å¿…é¡»å®ç°çš„æ¥å£æˆ–è€…å¿…é¡»ç»§æ‰¿çš„çˆ¶ç±»ã€‚åœ¨javaä¸­å®ƒç”±æŠ½è±¡ç±»æˆ–è€…æ¥å£æ¥å®ç°ã€‚ å…·ä½“å·¥å‚è§’è‰²ï¼šå®ƒå«æœ‰å’Œå…·ä½“ä¸šåŠ¡é€»è¾‘æœ‰å…³çš„ä»£ç ã€‚ç”±åº”ç”¨ç¨‹åºè°ƒç”¨ä»¥åˆ›å»ºå¯¹åº”çš„å…·ä½“äº§å“çš„å¯¹è±¡ã€‚ æŠ½è±¡äº§å“è§’è‰²ï¼šå®ƒæ˜¯å…·ä½“äº§å“ç»§æ‰¿çš„çˆ¶ç±»æˆ–è€…æ˜¯å®ç°çš„æ¥å£ã€‚åœ¨javaä¸­ä¸€èˆ¬æœ‰æŠ½è±¡ç±»æˆ–è€…æ¥å£æ¥å®ç°ã€‚ å…·ä½“äº§å“è§’è‰²ï¼šå…·ä½“å·¥å‚è§’è‰²æ‰€åˆ›å»ºçš„å¯¹è±¡å°±æ˜¯æ­¤è§’è‰²çš„å®ä¾‹ã€‚åœ¨javaä¸­ç”±å…·ä½“çš„ç±»æ¥å®ç°ã€‚ å·¥å‚æ–¹æ³•æ¨¡å¼ä½¿ç”¨ç»§æ‰¿è‡ªæŠ½è±¡å·¥å‚è§’è‰²çš„å¤šä¸ªå­ç±»æ¥ä»£æ›¿ç®€å•å·¥å‚æ¨¡å¼ä¸­çš„â€œä¸Šå¸ç±»â€ã€‚æ­£å¦‚ä¸Šé¢æ‰€è¯´ï¼Œè¿™æ ·ä¾¿åˆ†æ‹…äº†å¯¹è±¡æ‰¿å—çš„å‹åŠ›ï¼›è€Œä¸”è¿™æ ·ä½¿å¾—ç»“æ„å˜å¾—çµæ´» èµ·æ¥â€”â€”å½“æœ‰æ–°çš„äº§å“ï¼ˆå³æš´å‘æˆ·çš„æ±½è½¦ï¼‰äº§ç”Ÿæ—¶ï¼Œåªè¦æŒ‰ç…§æŠ½è±¡äº§å“è§’è‰²ã€æŠ½è±¡å·¥å‚è§’è‰²æä¾›çš„åˆåŒæ¥ç”Ÿæˆï¼Œé‚£ä¹ˆå°±å¯ä»¥è¢«å®¢æˆ·ä½¿ç”¨ï¼Œè€Œä¸å¿…å»ä¿®æ”¹ä»»ä½•å·²æœ‰çš„ä»£ ç ã€‚å¯ä»¥çœ‹å‡ºå·¥å‚è§’è‰²çš„ç»“æ„ä¹Ÿæ˜¯ç¬¦åˆå¼€é—­åŸåˆ™çš„ï¼ å·¥å‚æ–¹æ³•æ¨¡å¼Javaä»£ç 1234567891011121314151617181920212223242526272829303132333435363738394041424344//æŠ½è±¡äº§å“è§’è‰²public interface Moveable { void run();}//å…·ä½“äº§å“è§’è‰²public class Plane implements Moveable { @Override public void run() { System.out.println(\"plane....\"); }}public class Broom implements Moveable { @Override public void run() { System.out.println(\"broom.....\"); }}//æŠ½è±¡å·¥å‚public abstract class VehicleFactory { abstract Moveable create();}//å…·ä½“å·¥å‚public class PlaneFactory extends VehicleFactory{ public Moveable create() { return new Plane(); }}public class BroomFactory extends VehicleFactory{ public Moveable create() { return new Broom(); }}//æµ‹è¯•ç±»public class Test { public static void main(String[] args) { VehicleFactory factory = new BroomFactory(); Moveable m = factory.create(); m.run(); }} å¯ä»¥çœ‹å‡ºå·¥å‚æ–¹æ³•çš„åŠ å…¥ï¼Œä½¿å¾—å¯¹è±¡çš„æ•°é‡æˆå€å¢é•¿ã€‚å½“äº§å“ç§ç±»éå¸¸å¤šæ—¶ï¼Œä¼šå‡ºç°å¤§é‡çš„ä¸ä¹‹å¯¹åº”çš„å·¥å‚å¯¹è±¡ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æ‰€å¸Œæœ›çš„ã€‚å› ä¸ºå¦‚æœä¸èƒ½é¿å…è¿™ç§æƒ… å†µï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼ä¸å·¥å‚æ–¹æ³•æ¨¡å¼ç›¸ç»“åˆçš„æ–¹å¼æ¥å‡å°‘å·¥å‚ç±»ï¼šå³å¯¹äºäº§å“æ ‘ä¸Šç±»ä¼¼çš„ç§ç±»ï¼ˆä¸€èˆ¬æ˜¯æ ‘çš„å¶å­ä¸­äº’ä¸ºå…„å¼Ÿçš„ï¼‰ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼æ¥å® ç°ã€‚ ç®€å•å·¥å‚å’Œå·¥å‚æ–¹æ³•æ¨¡å¼çš„æ¯”è¾ƒ å·¥å‚æ–¹æ³•æ¨¡å¼å’Œç®€å•å·¥å‚æ¨¡å¼åœ¨å®šä¹‰ä¸Šçš„ä¸åŒæ˜¯å¾ˆæ˜æ˜¾çš„ã€‚å·¥å‚æ–¹æ³•æ¨¡å¼çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªæŠ½è±¡å·¥å‚ç±»,è€Œä¸åƒç®€å•å·¥å‚æ¨¡å¼, æŠŠæ ¸å¿ƒæ”¾åœ¨ä¸€ä¸ªå®ç±»ä¸Šã€‚å·¥å‚æ–¹æ³•æ¨¡å¼å¯ä»¥å…è®¸å¾ˆå¤šå®çš„å·¥å‚ç±»ä»æŠ½è±¡å·¥å‚ç±»ç»§æ‰¿ä¸‹æ¥, ä»è€Œå¯ä»¥åœ¨å®é™…ä¸Šæˆä¸ºå¤šä¸ªç®€å•å·¥å‚æ¨¡å¼çš„ç»¼åˆ,ä»è€Œæ¨å¹¿äº†ç®€å•å·¥å‚æ¨¡å¼ã€‚ åè¿‡æ¥è®²,ç®€å•å·¥å‚æ¨¡å¼æ˜¯ç”±å·¥å‚æ–¹æ³•æ¨¡å¼é€€åŒ–è€Œæ¥ã€‚è®¾æƒ³å¦‚æœæˆ‘ä»¬éå¸¸ç¡®å®šä¸€ä¸ªç³»ç»Ÿåªéœ€è¦ä¸€ä¸ªå®çš„å·¥å‚ç±», é‚£ä¹ˆå°±ä¸å¦¨æŠŠæŠ½è±¡å·¥å‚ç±»åˆå¹¶åˆ°å®çš„å·¥å‚ç±»ä¸­å»ã€‚è€Œè¿™æ ·ä¸€æ¥,æˆ‘ä»¬å°±é€€åŒ–åˆ°ç®€å•å·¥å‚æ¨¡å¼äº†ã€‚ æŠ½è±¡å·¥å‚æ¨¡å¼1234567891011121314151617181920212223242526272829303132333435//æŠ½è±¡å·¥å‚ç±»public abstract class AbstractFactory { public abstract Vehicle createVehicle(); public abstract Weapon createWeapon(); public abstract Food createFood();}//å…·ä½“å·¥å‚ç±»ï¼Œå…¶ä¸­Food,Vehicleï¼ŒWeaponæ˜¯æŠ½è±¡ç±»ï¼Œpublic class DefaultFactory extends AbstractFactory{ @Override public Food createFood() { return new Apple(); } @Override public Vehicle createVehicle() { return new Car(); } @Override public Weapon createWeapon() { return new AK47(); }}//æµ‹è¯•ç±»public class Test { public static void main(String[] args) { AbstractFactory f = new DefaultFactory(); Vehicle v = f.createVehicle(); v.run(); Weapon w = f.createWeapon(); w.shoot(); Food a = f.createFood(); a.printName(); }} åœ¨æŠ½è±¡å·¥å‚æ¨¡å¼ä¸­ï¼ŒæŠ½è±¡äº§å“ (AbstractProduct) å¯èƒ½æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªï¼Œä»è€Œæ„æˆä¸€ä¸ªæˆ–å¤šä¸ªäº§å“æ—(Product Family)ã€‚ åœ¨åªæœ‰ä¸€ä¸ªäº§å“æ—çš„æƒ…å†µä¸‹ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼å®é™…ä¸Šé€€åŒ–åˆ°å·¥å‚æ–¹æ³•æ¨¡å¼ã€‚ æ€»ç»“ ç®€å•å·¥å‚æ¨¡å¼æ˜¯ç”±ä¸€ä¸ªå…·ä½“çš„ç±»å»åˆ›å»ºå…¶ä»–ç±»çš„å®ä¾‹ï¼Œçˆ¶ç±»æ˜¯ç›¸åŒçš„ï¼Œçˆ¶ç±»æ˜¯å…·ä½“çš„ã€‚ å·¥å‚æ–¹æ³•æ¨¡å¼æ˜¯æœ‰ä¸€ä¸ªæŠ½è±¡çš„çˆ¶ç±»å®šä¹‰å…¬å…±æ¥å£ï¼Œå­ç±»è´Ÿè´£ç”Ÿæˆå…·ä½“çš„å¯¹è±¡ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯å°†ç±»çš„å®ä¾‹åŒ–æ“ä½œå»¶è¿Ÿåˆ°å­ç±»ä¸­å®Œæˆã€‚ æŠ½è±¡å·¥å‚æ¨¡å¼æä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ— é¡»æŒ‡å®šä»–ä»¬å…·ä½“çš„ç±»ã€‚å®ƒé’ˆå¯¹çš„æ˜¯æœ‰å¤šä¸ªäº§å“çš„ç­‰çº§ç»“æ„ã€‚è€Œå·¥å‚æ–¹æ³•æ¨¡å¼é’ˆå¯¹çš„æ˜¯ä¸€ä¸ªäº§å“çš„ç­‰çº§ç»“æ„ã€‚ å‚è€ƒï¼šhttp://www.cnblogs.com/liaoweipeng/p/5768197.html http://www.cnblogs.com/forlina/archive/2011/06/21/2086114.html","link":"/2018/11/24/Javaè®¾è®¡æ¨¡å¼ä¹‹å·¥å‚æ¨¡å¼.html"},{"title":"Effective-Java-2-é‡åˆ°å¤šä¸ªæ„é€ å™¨å‚æ•°æ—¶è€ƒè™‘ç”¨æ„å»ºå™¨","text":"é‡åˆ°å¤šä¸ªæ„é€ å™¨å‚æ•°æ—¶è€ƒè™‘ç”¨æ„å»ºå™¨é™æ€å·¥å‚å’Œæ„é€ å™¨æœ‰ä¸ªå…±åŒçš„å±€é™æ€§ï¼šå®ƒä»¬éƒ½ä¸èƒ½å¾ˆå¥½åœ°æ‰©å±•åˆ°å¤§é‡çš„å¯é€‰å‚æ•°ã€‚å½“æœ‰è¶…è¿‡20ä¸ªå¯é€‰åŸŸæ˜¯å¿…é¡»çš„æ—¶å€™ï¼Œå¯¹äºæ­¤ç§æƒ…å†µï¼Œç¨‹åºå‘˜ä¸€èˆ¬è€ƒè™‘é‡‡ç”¨é‡å æ„é€ å™¨æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼ä¸‹ï¼Œæä¾›ç¬¬ä¸€ä¸ªåªæœ‰å¿…è¦å‚æ•°çš„æ„é€ å™¨ï¼Œç¬¬äºŒä¸ªæ„é€ å™¨æœ‰ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œç¬¬ä¸‰ä¸ªæœ‰ä¸¤ä¸ªå¯é€‰å‚æ•°ï¼Œä»¥æ­¤ç±»æ¨ï¼Œæœ€åä¸€ä¸ªæ„é€ å™¨åŒ…å«æ‰€æœ‰çš„å‚æ•°ã€‚ é‡å æ„é€ å™¨æ¨¡å¼ å«æœ‰å››ä¸ªå¯é€‰åŸŸçš„æƒ…å†µ 1234567891011121314151617181920212223242526272829public class NutritionFacts{ private final int servingSize; // required private final int servings; // required private final int calories; // optional private final int fat; // optional private final int sodium; // optional private final int carbohydrate; // optional public NutritionFacts(int servingSize, int servings){ this(servingSize, servings, 0); } public NutritionFacts(int servingSize, int servings, int calories){ this(servingSize, servings, calories, 0); } public NutritionFacts(int servingSize, int servings, int calories, int fat){ this(servingSize, servings, calories, fat, 0); } public NutritionFacts(int servingSize, int servings, int calories, int fat, int sodium){ this(servingSize, servings, calories, fat, sodium, 0); } public NutritionFacts(int servingSize, int servings, int calories, int fat, int sodium, int carbohydrate){ this(servingSize, servings, calories, fat, sodium, carbohydrate); } } å½“ä½ æƒ³åˆ›å»ºå®ä¾‹çš„æ—¶å€™ï¼Œå°±åˆ©ç”¨å‚æ•°åˆ—è¡¨æœ€çŸ­çš„æ„é€ å™¨ã€‚ é‡å æ„é€ å™¨æ¨¡å¼å¯è¡Œï¼Œä½†æ˜¯å½“æœ‰è®¸å¤šå‚æ•°çš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯ä»£ç ä¼šå¾ˆéš¾ç¼–å†™ï¼Œå¹¶ä¸”è¾ƒéš¾é˜…è¯»ï¼Œä½¿ç”¨çš„æ—¶å€™å®¹æ˜“æ··æ·†éƒ¨åˆ†å‚æ•°å®¹æ˜“å‡ºé”™ JavaBeansæ¨¡å¼è¿™ç§æ¨¡å¼è°ƒç”¨ä¸€ä¸ªæ— å‚æ„é€ å™¨æ¥åˆ›å»ºå¯¹è±¡ï¼Œç„¶åç”¨setteræ–¹æ³•æ¥è®¾ç½®å¿…è¦çš„å‚æ•°ä»¥åŠç›¸å…³å‚æ•°çš„å€¼ã€‚ 12345678910111213141516171819public class NutritionFacts { private int servingSize = -1; // required private int servings = -1; // required private int calories = 0; // optional private int fat = 0; // optional private int sodium = 0; // optional private int carbohydrate = 0; // optional public NutritionFacts(){ } public void setServingSize(int val) { servingSize = val; } public void setServings(int val) { servings = val; } public void setCalories(int val) { calories = val; } public void setFat(int val) { fat = val; } public void setSodium(int val) { sodium = val; } public void setCarbohydrate(int val) { carbohydrate = val; }} è¿™ç§æ–¹å¼å¼¥è¡¥äº†é‡å æ„é€ å™¨æ¨¡å¼çš„ä¸è¶³ï¼Œåˆ›å»ºå®ä¾‹å®¹æ˜“ï¼Œé˜…è¯»ä»£ç ä¹Ÿå®¹æ˜“ã€‚ 12345NutritionFacts cocaCola = new NutritionFacts();cocaCola.setServingSize(10);cocaCola.setServings(10);cocaCola.setCalories(10);cocaCola.setFat(10); é—æ†¾çš„æ˜¯è‡ªèº«æœ‰ä¸¥é‡çš„ç¼ºé™·ã€‚æ„é€ è¿‡ç¨‹è¢«åˆ†åˆ°äº†å‡ ä¸ªè°ƒç”¨ä¸­ï¼Œæ„é€ è¿‡ç¨‹ä¸­JavaBeanå¯èƒ½å¤„äºä¸ä¸€è‡´çŠ¶æ€çš„å¯¹è±¡ï¼Œå°†ä¼šå¯¼è‡´å¤±è´¥ã€‚ç±»æ— æ³•ä»…ä»…é€šéš¾è¿‡æ ¡éªŒæ„é€ å™¨å‚æ•°çš„æœ‰æ•ˆæ€§æ¥ä¿è¯ä¸€è‡´æ€§ï¼ŒJavabeansæ¨¡å¼é˜»æ­¢äº†æŠŠç±»åšæˆä¸å¯å˜çš„å¯èƒ½ï¼Œéœ€è¦ä»˜å‡ºé¢å¤–çš„åŠªåŠ›æ¥ç¡®ä¿å®ƒçš„çº¿ç¨‹å®‰å…¨ã€‚ Builderæ¨¡å¼æ—¢èƒ½ä¿è¯åƒé‡å æ„é€ å™¨æ¨¡å¼é‚£æ ·çš„å®‰å…¨æ€§ï¼Œä¹Ÿèƒ½ä¿è¯åƒJavaBeansæ¨¡å¼é‚£æ ·çš„å¯è¯»æ€§ã€‚ ä¸ç›´æ¥ç”Ÿæˆæƒ³è¦çš„å¯¹è±¡ï¼Œè€Œæ˜¯è®©å®¢æˆ·ç«¯åˆ©ç”¨æ‰€æœ‰å¿…è¦çš„å‚æ•°è°ƒç”¨æ„é€ å™¨ï¼ˆæˆ–é™æ€å·¥å‚ï¼‰ï¼Œå¾—åˆ°ä¸€ä¸ªbuilderå¯¹è±¡ã€‚ç„¶åå®¢æˆ·ç«¯åœ¨builderå¯¹è±¡ä¸Šè°ƒç”¨ç±»ä¼¼äºsetterçš„æ–¹æ³•ï¼Œæ¥è®¾ç½®æ¯ä¸ªç›¸å…³çš„å¯é€‰å‚æ•°ã€‚æœ€åï¼Œå®¢æˆ·ç«¯è°ƒç”¨æ— å‚çš„buildæ–¹æ³•æ¥ç”Ÿæˆä¸å¯å˜çš„å¯¹è±¡ï¼Œè¿™ä¸ªbuilderæ˜¯å®ƒæ„å»ºçš„ç±»çš„é™æ€æˆå‘˜ç±»ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455public class NutritionFacts{ private final int servingSize; // required private final int servings; // required private final int calories; // optional private final int fat; // optional private final int sodium; // optional private final int carbohydrate; // optional public static class Builder{ private final int servingSize; // required private final int servings; // required private final int calories = 0; // optional private final int fat = 0; // optional private final int sodium = 0; // optional private final int carbohydrate = 0; // optional public Builder(int servingSize, int servings){ this.servingSize = servingSize; this.servings =servings; } public Builder calories(int val){ calories = val; return this; } public Builder fat(int val){ fat = val; return this; } public Builder sodium(int val){ sodium = val; return this; } public Builder carbohydrate(int val){ carbohydrate = val; return this; } public NutritionFacts build(){ return new NutritionFacts(this); } } private NutritionFacts(Builder builder){ servingSize = builder.servingSize; servings = builder.servingSize; calories = builder.servingSize; fat = builder.servingSize; sodium = builder.servingSize; carbohydrate = builder.servingSize; }} æ³¨æ„NutritionFactsæ˜¯ä¸å¯å˜çš„ï¼Œæ‰€æœ‰çš„é»˜è®¤å‚æ•°å€¼éƒ½å•ç‹¬æ”¾ä¸€ä¸ªåœ°æ–¹ã€‚builderçš„setteræ–¹æ³•è¿”å›builderæœ¬èº«ï¼Œä»¥ä¾¿å¯ä»¥æŠŠè°ƒç”¨ç”¨è°ƒç”¨é“¾è¿æ¥èµ·æ¥ã€‚ 1NutritionFacts cocaCola = new NutritionFacts.Builder(200,20).calories(10).fat(15).sodium(10).build(); builderåƒä¸ªæ„é€ å™¨ä¸€æ ·ï¼Œå¯ä»¥å¯¹å…¶å‚æ•°å¼ºåŠ çº¦æŸæ¡ä»¶ã€‚buildæ–¹æ³•å¯ä»¥æ£€éªŒè¿™äº›çº¦æŸæ¡ä»¶ï¼Œå°†å‚æ•°ä»builderæ‹·è´åˆ°å¯¹è±¡ä¸­ä¹‹åï¼Œå¹¶åœ¨å¯¹è±¡åŸŸè€Œä¸æ˜¯builderåŸŸä¸­å¯¹ä»–ä»¬è¿›è¡Œæ ¡éªŒï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚å¦‚æœè¿åäº†ä»»ä½•çº¦æŸæ¡ä»¶ï¼Œbuildæ–¹æ³•å°±åº”è¯¥æŠ›å‡ºIllegalStateException,æ˜¾ç¤ºè¿èƒŒäº†å“ªä¸ªçº¦æŸæ¡ä»¶ã€‚ å¯¹å¤šä¸ªå‚æ•°å¼ºåŠ çº¦æŸæ¡ä»¶çš„å¦ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨å¤šä¸ªsetteræ–¹æ³•å¯¹æŸä¸ªçº¦æŸæ¡ä»¶å¿…é¡»æŒæœ‰çš„æ‰€æœ‰å‚æ•°è¿›è¡Œæ£€æŸ¥ã€‚å¦‚æœè¯¥çº¦æŸæ¡ä»¶æ²¡æœ‰å¾—åˆ°æ»¡è¶³ï¼Œsetteræ–¹æ³•å°±æŠ›å‡ºIllegalStateExceptionï¼Œä¸ç”¨ç­‰åˆ°åœ¨buildçš„æ—¶å€™ã€‚ è®¾ç½®äº†å‚æ•°çš„builderç”Ÿæˆäº†ä¸€ä¸ªå¾ˆå¥½çš„æŠ½è±¡å·¥å‚ï¼Œå®¢æˆ·ç«¯å¯ä»¥å°†è¿™æ ·ä¸€ä¸ªbuilderä¼ ç»™æ–¹æ³•ï¼Œä½¿è¯¥æ–¹æ³•èƒ½å¤Ÿä¸ºå®¢æˆ·ç«¯åˆ›å»ºä¸€ä¸ªæˆ–è€…å¤šä¸ªå¯¹è±¡ã€‚è¦ä½¿ç”¨è¿™ç§ç”¨æ³•ï¼Œéœ€è¦æœ‰ä¸ªç±»å‹æ¥è¡¨ç¤ºbuilderï¼Œåªè¦ä¸€ä¸ªæ³›å‹å°±èƒ½æ»¡è¶³æ‰€æœ‰çš„builderï¼Œæ— è®ºä»–ä»¬åœ¨æ„å»ºå“ªç§ç±»å‹çš„å¯¹è±¡ï¼š 123public interface Builder&lt;T&gt;{ public T build();} å¯ä»¥å£°æ˜NutritionFacts.Builderç±»æ¥å®ç°Builder&lt;NutritionFacts&gt; ã€‚ å¸¦æœ‰Builderå®ä¾‹çš„æ–¹æ³•é€šå¸¸åˆ©ç”¨æœ‰é™åˆ¶çš„é€šé…ç¬¦ç±»å‹æ¥çº¦æŸæ„å»ºå™¨çš„ç±»å‹å‚æ•°ã€‚eg.ä¸‹é¢å°±æ˜¯æ„å»ºæ¯ä¸ªèŠ‚ç‚¹çš„æ–¹æ³•ï¼Œå®ƒåˆ©ç”¨ä¸€ä¸ªå®¢æˆ·ç«¯æä¾›çš„Builderå®ä¾‹æ¥æ„å»ºæ ‘ï¼š 1Tree buildTree(Builder&lt;? extends Node&gt; nodeBuilder){ ... } **Builderæ¨¡å¼è¿˜æ¯”é‡å æ„é€ å™¨æ¨¡å¼æ›´åŠ å†—é•¿ï¼Œå› æ­¤å®ƒåªæœ‰åœ¨å¾ˆéš¾å‚æ•°çš„æ—¶å€™æ‰ä½¿ç”¨ï¼Œæ¯”å¦‚4ä¸ªæˆ–è€…æ›´å¤šã€‚ä½†æ˜¯ä½ è¦è®°ä½ï¼Œå°†æ¥å¯èƒ½æ·»åŠ å‚æ•°ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå¦‚æœç±»çš„æ„é€ å™¨æˆ–è€…é™æ€å·¥å‚ä¸­å…·æœ‰å¤šä¸ªå‚æ•°ï¼Œè®¾è®¡è¿™ç§ç±»æ—¶ï¼ŒBuilderæ¨¡å¼å°±æ˜¯ç§ä¸é”™çš„é€‰æ‹©ï¼Œç‰¹åˆ«æ˜¯å¤§å¤šå‚æ•°éƒ½æ˜¯å¯é€‰çš„æ—¶å€™ã€‚ä»£ç æ˜“äºé˜…è¯»ç¼–å†™ï¼Œæ„å»ºå™¨ä¹Ÿæ¯”JavaBeansæ›´åŠ å®‰å…¨ã€‚","link":"/2018/11/17/Effective-Java-2-é‡åˆ°å¤šä¸ªæ„é€ å™¨å‚æ•°æ—¶è€ƒè™‘ç”¨æ„å»ºå™¨.html"},{"title":"Javaè®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼","text":"å•ä¾‹æ¨¡å¼ ç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ï¼ é¥¿æ±‰å¼ï¼šçº¿ç¨‹å®‰å…¨ï¼Œä½†æ•ˆç‡æ¯”è¾ƒä½ 123456789101112131415161718/** * å•ä¾‹æ¨¡å¼çš„å®ç°ï¼šé¥¿æ±‰å¼,çº¿ç¨‹å®‰å…¨ ä½†æ•ˆç‡æ¯”è¾ƒä½ */ public class SingletonTest { // å®šä¹‰ä¸€ä¸ªç§æœ‰çš„æ„é€ æ–¹æ³• private SingletonTest() { } // å°†è‡ªèº«çš„å®ä¾‹å¯¹è±¡è®¾ç½®ä¸ºä¸€ä¸ªå±æ€§,å¹¶åŠ ä¸ŠStaticå’Œfinalä¿®é¥°ç¬¦ private static final SingletonTest instance = new SingletonTest(); // é™æ€æ–¹æ³•è¿”å›è¯¥ç±»çš„å®ä¾‹ public static SingletonTest getInstancei() { return instance; } } å•ä¾‹æ¨¡å¼çš„å®ç°ï¼šé¥±æ±‰å¼ï¼Œéçº¿ç¨‹å®‰å…¨12345678910111213141516171819/** * å•ä¾‹æ¨¡å¼çš„å®ç°ï¼šé¥±æ±‰å¼,éçº¿ç¨‹å®‰å…¨ * */ public class SingletonTest { // å®šä¹‰ç§æœ‰æ„é€ æ–¹æ³•ï¼ˆé˜²æ­¢é€šè¿‡ new SingletonTest()å»å®ä¾‹åŒ–ï¼‰ private SingletonTest() { } // å®šä¹‰ä¸€ä¸ªSingletonTestç±»å‹çš„å˜é‡ï¼ˆä¸åˆå§‹åŒ–ï¼Œæ³¨æ„è¿™é‡Œæ²¡æœ‰ä½¿ç”¨finalå…³é”®å­—ï¼‰ private static SingletonTest instance; // å®šä¹‰ä¸€ä¸ªé™æ€çš„æ–¹æ³•ï¼ˆè°ƒç”¨æ—¶å†åˆå§‹åŒ–SingletonTestï¼Œä½†æ˜¯å¤šçº¿ç¨‹è®¿é—®æ—¶ï¼Œå¯èƒ½é€ æˆé‡å¤åˆå§‹åŒ–é—®é¢˜ï¼‰ public static SingletonTest getInstance() { if (instance == null) instance = new SingletonTest(); return instance; } } é¥±æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨ç®€å•å®ç°1234567891011121314151617181920/** * å•ä¾‹æ¨¡å¼çš„å®ç°ï¼šé¥±æ±‰å¼,çº¿ç¨‹å®‰å…¨ç®€å•å®ç° * */ public class SingletonTest { // å®šä¹‰ç§æœ‰æ„é€ æ–¹æ³•ï¼ˆé˜²æ­¢é€šè¿‡ new SingletonTest()å»å®ä¾‹åŒ–ï¼‰ private SingletonTest() { } // å®šä¹‰ä¸€ä¸ªSingletonTestç±»å‹çš„å˜é‡ï¼ˆä¸åˆå§‹åŒ–ï¼Œæ³¨æ„è¿™é‡Œæ²¡æœ‰ä½¿ç”¨finalå…³é”®å­—ï¼‰ private static SingletonTest instance; // å®šä¹‰ä¸€ä¸ªé™æ€çš„æ–¹æ³•ï¼ˆè°ƒç”¨æ—¶å†åˆå§‹åŒ–SingletonTestï¼Œä½¿ç”¨synchronized é¿å…å¤šçº¿ç¨‹è®¿é—®æ—¶ï¼Œå¯èƒ½é€ æˆé‡çš„å¤åˆå§‹åŒ–é—®é¢˜ï¼‰ public static synchronized SingletonTest getInstance() { if (instance == null) instance = new SingletonTest(); return instance; } } åŒé‡é”æœºåˆ¶ï¼šçº¿ç¨‹å®‰å…¨ï¼Œæ•ˆç‡é«˜ï¼Œå•ä¾‹æ¨¡å¼æœ€ä¼˜æ–¹æ¡ˆ12345678910111213141516171819202122232425262728/** * å•ä¾‹æ¨¡å¼æœ€ä¼˜æ–¹æ¡ˆ * çº¿ç¨‹å®‰å…¨ å¹¶ä¸”æ•ˆç‡é«˜ * */ public class SingletonTest { // å®šä¹‰ä¸€ä¸ªç§æœ‰æ„é€ æ–¹æ³• private SingletonTest() { } //å®šä¹‰ä¸€ä¸ªé™æ€ç§æœ‰å˜é‡(ä¸åˆå§‹åŒ–ï¼Œä¸ä½¿ç”¨finalå…³é”®å­—ï¼Œä½¿ç”¨volatileä¿è¯äº†å¤šçº¿ç¨‹è®¿é—®æ—¶instanceå˜é‡çš„å¯è§æ€§ï¼Œé¿å…äº†instanceåˆå§‹åŒ–æ—¶å…¶ä»–å˜é‡å±æ€§è¿˜æ²¡èµ‹å€¼å®Œæ—¶ï¼Œè¢«å¦å¤–çº¿ç¨‹è°ƒç”¨) private static volatile SingletonTest instance; //å®šä¹‰ä¸€ä¸ªå…±æœ‰çš„é™æ€æ–¹æ³•ï¼Œè¿”å›è¯¥ç±»å‹å®ä¾‹ public static SingletonTest getIstance() { // å¯¹è±¡å®ä¾‹åŒ–æ—¶ä¸å¦åˆ¤æ–­ï¼ˆä¸ä½¿ç”¨åŒæ­¥ä»£ç å—ï¼Œinstanceä¸ç­‰äºnullæ—¶ï¼Œç›´æ¥è¿”å›å¯¹è±¡ï¼Œæé«˜è¿è¡Œæ•ˆç‡ï¼‰ if (instance == null) { //åŒæ­¥ä»£ç å—ï¼ˆå¯¹è±¡æœªåˆå§‹åŒ–æ—¶ï¼Œä½¿ç”¨åŒæ­¥ä»£ç å—ï¼Œä¿è¯å¤šçº¿ç¨‹è®¿é—®æ—¶å¯¹è±¡åœ¨ç¬¬ä¸€æ¬¡åˆ›å»ºåï¼Œä¸å†é‡å¤è¢«åˆ›å»ºï¼‰ synchronized (SingletonTest.class) { //æœªåˆå§‹åŒ–ï¼Œåˆ™åˆå§‹instanceå˜é‡ if (instance == null) { instance = new SingletonTest(); } } } return instance; } } é™æ€å†…éƒ¨ç±»æ–¹å¼12345678910111213/** * é™æ€å†…éƒ¨ç±»æ–¹å¼ * */ public class Singleton { private static class SingletonHolder { private static final Singleton INSTANCE = new Singleton(); } private Singleton (){} public static final Singleton getInstance() { return SingletonHolder.INSTANCE; } } è¿™ç§æ–¹å¼åŒæ ·åˆ©ç”¨äº†classloderçš„æœºåˆ¶æ¥ä¿è¯åˆå§‹åŒ–instanceæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒè·Ÿç¬¬ä¸‰ç§å’Œç¬¬å››ç§æ–¹å¼ä¸åŒçš„æ˜¯ï¼ˆå¾ˆç»†å¾®çš„å·®åˆ«ï¼‰ï¼šç¬¬ä¸‰ç§å’Œç¬¬å››ç§æ–¹å¼æ˜¯åªè¦Singletonç±»è¢«è£…è½½äº†ï¼Œé‚£ä¹ˆinstanceå°±ä¼šè¢«å®ä¾‹åŒ–ï¼ˆæ²¡æœ‰è¾¾åˆ°lazy loadingæ•ˆæœï¼‰ï¼Œè€Œè¿™ç§æ–¹å¼æ˜¯Singletonç±»è¢«è£…è½½äº†ï¼Œinstanceä¸ä¸€å®šè¢«åˆå§‹åŒ–ã€‚å› ä¸ºSingletonHolderç±»æ²¡æœ‰è¢«ä¸»åŠ¨ä½¿ç”¨ï¼Œåªæœ‰æ˜¾ç¤ºé€šè¿‡è°ƒç”¨getInstanceæ–¹æ³•æ—¶ï¼Œæ‰ä¼šæ˜¾ç¤ºè£…è½½SingletonHolderç±»ï¼Œä»è€Œå®ä¾‹åŒ–instanceã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœå®ä¾‹åŒ–instanceå¾ˆæ¶ˆè€—èµ„æºï¼Œæˆ‘æƒ³è®©ä»–å»¶è¿ŸåŠ è½½ï¼Œå¦å¤–ä¸€æ–¹é¢ï¼Œæˆ‘ä¸å¸Œæœ›åœ¨Singletonç±»åŠ è½½æ—¶å°±å®ä¾‹åŒ–ï¼Œå› ä¸ºæˆ‘ä¸èƒ½ç¡®ä¿Singletonç±»è¿˜å¯èƒ½åœ¨å…¶ä»–çš„åœ°æ–¹è¢«ä¸»åŠ¨ä½¿ç”¨ä»è€Œè¢«åŠ è½½ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å®ä¾‹åŒ–instanceæ˜¾ç„¶æ˜¯ä¸åˆé€‚çš„ã€‚è¿™ä¸ªæ—¶å€™ï¼Œè¿™ç§æ–¹å¼ç›¸æ¯”ç¬¬ä¸‰å’Œç¬¬å››ç§æ–¹å¼å°±æ˜¾å¾—å¾ˆåˆç†ã€‚ æ€»ç»“ã€ä»¥ä¸Šå•ä¾‹æ¨¡å¼ã€‘ä¼ ç»Ÿçš„ä¸¤ç§æœ‰ä¸€å…¬å¼€ï¼ˆç§æœ‰æ„é€ æ–¹æ³•ã€ç§æœ‰é™æ€å®ä¾‹(æ‡’å®ä¾‹åŒ–/ç›´æ¥å®ä¾‹åŒ–)ã€å…¬å¼€çš„é™æ€è·å–æ–¹æ³•ï¼‰æ¶‰åŠçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼ˆå³ä½¿æœ‰å¤šé‡æ£€æŸ¥é”ä¹Ÿå¯ä»¥é€šè¿‡åå°„ç ´åå•ä¾‹ï¼‰ç›®å‰æœ€ä¸ºå®‰å…¨çš„å®ç°å•ä¾‹çš„æ–¹æ³•æ˜¯é€šè¿‡å†…éƒ¨é™æ€enumçš„æ–¹æ³•æ¥å®ç°ï¼Œå› ä¸ºJVMä¼šä¿è¯enumä¸èƒ½è¢«åå°„å¹¶ä¸”æ„é€ å™¨æ–¹æ³•åªæ‰§è¡Œä¸€æ¬¡ã€‚ åˆ©ç”¨åå°„æ¨¡å¼è·å–1234567891011121314151617181920212223242526272829303132333435363738// é¥¿æ±‰è¯•å•ä¾‹æ¨¡å¼public class HelloWorld { private HelloWorld(){}; private static HelloWorld hell = new HelloWorld(); public static HelloWorld getHello(){ return hell; } public void getWorld(){ System.out.println(\"hahahahah\"); }}// javaåå°„æœºåˆ¶ è°ƒç”¨getWorld()æ–¹æ³•public class HelloJava{ public static void main(String[] args){ /* HelloWorld hell = HelloWorld.getHello(); hell.getWorld(); */ try { Class class1 = Class.forName(\"cn.jr.text.HelloWorld\"); Constructor[] constructors = class1.getDeclaredConstructors(); AccessibleObject.setAccessible(constructors, true); for (Constructor con : constructors) { if (con.isAccessible()) { Object classObject = con.newInstance(); Method method = class1.getMethod(\"getWorld\"); method.invoke(classObject); } } } catch (Exception e) { e.printStackTrace(); } }} ä½¿ç”¨æšä¸¾çš„å•ä¾‹æ¨¡å¼123456789101112131415161718public class EnumSingleton{ private EnumSingleton(){} public static EnumSingleton getInstance(){ return Singleton.INSTANCE.getInstance(); } private static enum Singleton{ INSTANCE; private EnumSingleton singleton; //JVMä¼šä¿è¯æ­¤æ–¹æ³•ç»å¯¹åªè°ƒç”¨ä¸€æ¬¡ private Singleton(){ singleton = new EnumSingleton(); } public EnumSingleton getInstance(){ return singleton; } }} ä½¿ç”¨æšä¸¾ï¼Œstaticå¤„è°ƒç”¨ï¼Œåˆå§‹åŒ–ä¸€æ¬¡1234567891011121314151617181920212223public class StaticInitTest { private static List&lt;Integer&gt; dataList = null; static{ dataList = Singleton.INSTANCE.init(); } private static enum Singleton { INSTANCE; private List&lt;Integer&gt; list; private Singleton(){ fillData(); } private void fillData(){ list = new ArrayList&lt;Integer&gt;(5); for(int i =1; i&lt;6; i++){ list.add(i); } } public List&lt;Integer&gt; init(){ return list; } }} å€ŸåŠ©CASï¼ˆAtomicReferenceï¼‰å®ç°å•ä¾‹æ¨¡å¼ï¼š12345678910111213141516171819public class Singleton { private static final AtomicReference&lt;Singleton&gt; INSTANCE = new AtomicReference&lt;Singleton&gt;(); private Singleton() {} public static Singleton getInstance() { for (;;) { Singleton singleton = INSTANCE.get(); if (null != singleton) { return singleton; } singleton = new Singleton(); if (INSTANCE.compareAndSet(null, singleton)) { return singleton; } } }} ç”¨CASçš„å¥½å¤„åœ¨äºä¸éœ€è¦ä½¿ç”¨ä¼ ç»Ÿçš„é”æœºåˆ¶æ¥ä¿è¯çº¿ç¨‹å®‰å…¨,CASæ˜¯ä¸€ç§åŸºäºå¿™ç­‰å¾…çš„ç®—æ³•,ä¾èµ–åº•å±‚ç¡¬ä»¶çš„å®ç°,ç›¸å¯¹äºé”å®ƒæ²¡æœ‰çº¿ç¨‹åˆ‡æ¢å’Œé˜»å¡çš„é¢å¤–æ¶ˆè€—,å¯ä»¥æ”¯æŒè¾ƒå¤§çš„å¹¶è¡Œåº¦ã€‚ä½¿ç”¨CASå®ç°å•ä¾‹åªæ˜¯ä¸ªæ€è·¯è€Œå·²ï¼Œåªæ˜¯æ‹“å±•ä¸€ä¸‹å¸®åŠ©è¯»è€…ç†Ÿç»ƒæŒæ¡CASä»¥åŠå•ä¾‹ç­‰çŸ¥è¯†ã€åƒä¸‡ä¸è¦åœ¨ä»£ç ä¸­ä½¿ç”¨ï¼ï¼ï¼è¿™ä¸ªä»£ç å…¶å®æœ‰å¾ˆå¤§çš„ä¼˜åŒ–ç©ºé—´ã€‚èªæ˜çš„ä½ ï¼ŒçŸ¥é“ä»¥ä¸Šä»£ç å­˜åœ¨å“ªäº›éšæ‚£å—ï¼Ÿ æœ€ç»ˆæ€»ç»“æœ‰ä¸¤ä¸ªé—®é¢˜éœ€è¦æ³¨æ„ï¼š å¦‚æœå•ä¾‹ç”±ä¸åŒçš„ç±»è£…è½½å™¨è£…å…¥ï¼Œé‚£ä¾¿æœ‰å¯èƒ½å­˜åœ¨å¤šä¸ªå•ä¾‹ç±»çš„å®ä¾‹ã€‚å‡å®šä¸æ˜¯è¿œç«¯å­˜å–ï¼Œä¾‹å¦‚ä¸€äº›servletå®¹å™¨å¯¹æ¯ä¸ªservletä½¿ç”¨å®Œå…¨ä¸åŒçš„ç±» è£…è½½å™¨ï¼Œè¿™æ ·çš„è¯å¦‚æœæœ‰ä¸¤ä¸ªservletè®¿é—®ä¸€ä¸ªå•ä¾‹ç±»ï¼Œå®ƒä»¬å°±éƒ½ä¼šæœ‰å„è‡ªçš„å®ä¾‹ã€‚ å¦‚æœSingletonå®ç°äº†java.io.Serializableæ¥å£ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»çš„å®ä¾‹å°±å¯èƒ½è¢«åºåˆ—åŒ–å’Œå¤åŸã€‚ä¸ç®¡æ€æ ·ï¼Œå¦‚æœä½ åºåˆ—åŒ–ä¸€ä¸ªå•ä¾‹ç±»çš„å¯¹è±¡ï¼Œæ¥ä¸‹æ¥å¤åŸå¤šä¸ªé‚£ä¸ªå¯¹è±¡ï¼Œé‚£ä½ å°±ä¼šæœ‰å¤šä¸ªå•ä¾‹ç±»çš„å®ä¾‹ã€‚ å¯¹ç¬¬ä¸€ä¸ªé—®é¢˜ä¿®å¤çš„åŠæ³•æ˜¯ï¼š 123456789private static Class getClass(String classname) throws ClassNotFoundException { ClassLoader classLoader = Thread.currentThread().getContextClassLoader(); if(classLoader == null) classLoader = Singleton.class.getClassLoader(); return (classLoader.loadClass(classname)); } } å¯¹ç¬¬äºŒä¸ªé—®é¢˜ä¿®å¤çš„åŠæ³•æ˜¯ï¼š 12345678910public class Singleton implements java.io.Serializable { public static Singleton INSTANCE = new Singleton(); protected Singleton() { } private Object readResolve() { return INSTANCE; } } å¯¹æˆ‘æ¥è¯´ï¼Œæˆ‘æ¯”è¾ƒå–œæ¬¢ç¬¬aå’Œeç§æ–¹å¼ï¼Œç®€å•æ˜“æ‡‚ï¼Œè€Œä¸”åœ¨JVMå±‚å®ç°äº†çº¿ç¨‹å®‰å…¨ï¼ˆå¦‚æœä¸æ˜¯å¤šä¸ªç±»åŠ è½½å™¨ç¯å¢ƒï¼‰ï¼Œä¸€èˆ¬çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä¼šä½¿ç”¨ç¬¬aç§æ–¹å¼ï¼Œåªæœ‰åœ¨è¦æ˜ç¡®å®ç°lazy loadingæ•ˆæœæ—¶æ‰ä¼šä½¿ç”¨ç¬¬eç§æ–¹å¼ï¼Œå¦å¤–ï¼Œå¦‚æœæ¶‰åŠåˆ°ååºåˆ—åŒ–åˆ›å»ºå¯¹è±¡æ—¶æˆ‘ä¼šè¯•ç€ä½¿ç”¨æšä¸¾çš„æ–¹å¼æ¥å®ç°å•ä¾‹ï¼Œä¸è¿‡ï¼Œæˆ‘ä¸€ç›´ä¼šä¿è¯æˆ‘çš„ç¨‹åºæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¦‚æœæœ‰å…¶ä»–ç‰¹æ®Šçš„éœ€æ±‚ï¼Œæˆ‘å¯èƒ½ä¼šä½¿ç”¨ç¬¬ä¸ƒç§æ–¹å¼ï¼Œæ¯•ç«Ÿï¼ŒJDK1.5å·²ç»æ²¡æœ‰åŒé‡æ£€æŸ¥é”å®šçš„é—®é¢˜äº†ã€‚ å‚è€ƒèµ„æ–™ï¼šjavaå•ä¾‹ä¹‹enumå®ç°æ–¹å¼ è®¾è®¡æ¨¡å¼ javaè®¾è®¡æ¨¡å¼â€“å•ä¾‹æ¨¡å¼","link":"/2018/11/17/Javaè®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼.html"},{"title":"leetcode-2-Add Two Numbers","text":"Add Two Numbers You are given two non-empty linked lists representing two non-negative integers. The digits are stored in reverse order and each of their nodes contain a single digit. Add the two numbers and return it as a linked list. You may assume the two numbers do not contain any leading zero, except the number 0 itself. Example:Input: (2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4) Output: 7 -&gt; 0 -&gt; 8 Explanation: 342 + 465 = 807. common 1234567891011121314151617181920212223242526272829/** * Definition for singly-linked list. * public class ListNode { * int val; * ListNode next; * ListNode(int x) { val = x; } * } */class Solution { public ListNode addTwoNumbers(ListNode l1, ListNode l2) { ListNode dummyHead = new ListNode(0); // ä¸€ç‚¹è¦èµ‹å€¼ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿›è¡Œæ“ä½œ ListNode p = l1, q = l2, curr = dummyHead; int carry = 0; while (p != null || q != null) { int x = (p != null) ? p.val : 0; int y = (q != null) ? q.val : 0; int sum = carry + x + y; carry = sum / 10; curr.next = new ListNode(sum % 10); curr = curr.next; if (p != null) p = p.next; if (q != null) q = q.next; } if (carry &gt; 0) { curr.next = new ListNode(carry); } return dummyHead.next; }} best123456789101112131415161718192021222324252627282930/** * Definition for singly-linked list. * public class ListNode { * int val; * ListNode next; * ListNode(int x) { val = x; } * } */ class Solution { public ListNode addTwoNumbers(ListNode l1, ListNode l2) { ListNode head = new ListNode(0); int carry = 0; while(l1!=null||l2!=null||carry&gt;0) { ListNode itr = head; while(itr.next!=null) itr = itr.next; // å¯»æ‰¾æœ€åä¸€ä¸ªèŠ‚ç‚¹ int sum = ( (l1==null ? 0 : l1.val) + (l2==null ? 0 : l2.val) + carry); carry = sum/10; ListNode temp = new ListNode(sum%10); itr.next = temp; if(l1!=null) l1 = l1.next; if(l2!=null) l2 = l2.next; } return head.next; }}","link":"/2018/11/16/leetcode-2-Add-Two-Numbers.html"},{"title":"Javaè®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼","text":"å®šä¹‰ åœ¨é˜å®åšå£«çš„ã€ŠJAVAä¸æ¨¡å¼ã€‹ä¸€ä¹¦ä¸­å¼€å¤´æ˜¯è¿™æ ·æè¿°è§‚å¯Ÿè€…ï¼ˆObserverï¼‰æ¨¡å¼çš„ï¼šè§‚å¯Ÿè€…æ¨¡å¼æ˜¯å¯¹è±¡çš„è¡Œä¸ºæ¨¡å¼ï¼Œåˆå«å‘å¸ƒ-è®¢é˜…(Publish/Subscribe)æ¨¡å¼ã€æ¨¡å‹-è§†å›¾(Model/View)æ¨¡å¼ã€æº-ç›‘å¬å™¨(Source/Listener)æ¨¡å¼æˆ–ä»å±è€…(Dependents)æ¨¡å¼ã€‚è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œè®©å¤šä¸ªè§‚å¯Ÿè€…å¯¹è±¡åŒæ—¶ç›‘å¬æŸä¸€ä¸ªä¸»é¢˜å¯¹è±¡ã€‚è¿™ä¸ªä¸»é¢˜å¯¹è±¡åœ¨çŠ¶æ€ä¸Šå‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä½¿å®ƒä»¬èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°è‡ªå·±ã€‚ æ¨ç»“æ„æ¨¡å¼æ¨æ¨¡å¼ç›¸å…³ç»“æ„è¯´æ˜ä¸€ä¸ªè½¯ä»¶ç³»ç»Ÿé‡Œé¢åŒ…å«äº†å„ç§å¯¹è±¡ï¼Œå°±åƒä¸€ç‰‡æ¬£æ¬£å‘è£çš„æ£®æ—å……æ»¡äº†å„ç§ç”Ÿç‰©ä¸€æ ·ã€‚åœ¨ä¸€ç‰‡æ£®æ—ä¸­ï¼Œå„ç§ç”Ÿç‰©å½¼æ­¤ä¾èµ–å’Œçº¦æŸï¼Œå½¢æˆä¸€ä¸ªä¸ªç”Ÿç‰©é“¾ã€‚ä¸€ç§ç”Ÿç‰©çš„çŠ¶æ€å˜åŒ–ä¼šé€ æˆå…¶ä»–ä¸€äº›ç”Ÿç‰©çš„ç›¸åº”è¡ŒåŠ¨ï¼Œæ¯ä¸€ä¸ªç”Ÿç‰©éƒ½å¤„äºåˆ«çš„ç”Ÿç‰©çš„äº’åŠ¨ä¹‹ä¸­ã€‚ åŒæ ·ï¼Œä¸€ä¸ªè½¯ä»¶ç³»ç»Ÿå¸¸å¸¸è¦æ±‚åœ¨æŸä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼ŒæŸäº›å…¶ä»–çš„å¯¹è±¡åšå‡ºç›¸åº”çš„æ”¹å˜ã€‚åšåˆ°è¿™ä¸€ç‚¹çš„è®¾è®¡æ–¹æ¡ˆæœ‰å¾ˆå¤šï¼Œä½†æ˜¯ä¸ºäº†ä½¿ç³»ç»Ÿèƒ½å¤Ÿæ˜“äºå¤ç”¨ï¼Œåº”è¯¥é€‰æ‹©ä½è€¦åˆåº¦çš„è®¾è®¡æ–¹æ¡ˆã€‚å‡å°‘å¯¹è±¡ä¹‹é—´çš„è€¦åˆæœ‰åˆ©äºç³»ç»Ÿçš„å¤ç”¨ï¼Œä½†æ˜¯åŒæ—¶è®¾è®¡å¸ˆéœ€è¦ä½¿è¿™äº›ä½è€¦åˆåº¦çš„å¯¹è±¡ä¹‹é—´èƒ½å¤Ÿç»´æŒè¡ŒåŠ¨çš„åè°ƒä¸€è‡´ï¼Œä¿è¯é«˜åº¦çš„åä½œã€‚è§‚å¯Ÿè€…æ¨¡å¼æ˜¯æ»¡è¶³è¿™ä¸€è¦æ±‚çš„å„ç§è®¾è®¡æ–¹æ¡ˆä¸­æœ€é‡è¦çš„ä¸€ç§ã€‚ ä¸‹é¢ä»¥ä¸€ä¸ªç®€å•çš„ç¤ºæ„æ€§å®ç°ä¸ºä¾‹ï¼Œè®¨è®ºè§‚å¯Ÿè€…æ¨¡å¼çš„ç»“æ„ã€‚ è§‚å¯Ÿè€…æ¨¡å¼æ‰€æ¶‰åŠçš„è§’è‰²æœ‰ï¼š â— æŠ½è±¡ä¸»é¢˜(Subject)è§’è‰²ï¼šæŠ½è±¡ä¸»é¢˜è§’è‰²æŠŠæ‰€æœ‰å¯¹è§‚å¯Ÿè€…å¯¹è±¡çš„å¼•ç”¨ä¿å­˜åœ¨ä¸€ä¸ªèšé›†ï¼ˆæ¯”å¦‚ArrayListå¯¹è±¡ï¼‰é‡Œï¼Œæ¯ä¸ªä¸»é¢˜éƒ½å¯ä»¥æœ‰ä»»ä½•æ•°é‡çš„è§‚å¯Ÿè€…ã€‚æŠ½è±¡ä¸»é¢˜æä¾›ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥å¢åŠ å’Œåˆ é™¤è§‚å¯Ÿè€…å¯¹è±¡ï¼ŒæŠ½è±¡ä¸»é¢˜è§’è‰²åˆå«åšæŠ½è±¡è¢«è§‚å¯Ÿè€…(Observable)è§’è‰²ã€‚ â— å…·ä½“ä¸»é¢˜(ConcreteSubject)è§’è‰²ï¼šå°†æœ‰å…³çŠ¶æ€å­˜å…¥å…·ä½“è§‚å¯Ÿè€…å¯¹è±¡ï¼›åœ¨å…·ä½“ä¸»é¢˜çš„å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶ï¼Œç»™æ‰€æœ‰ç™»è®°è¿‡çš„è§‚å¯Ÿè€…å‘å‡ºé€šçŸ¥ã€‚å…·ä½“ä¸»é¢˜è§’è‰²åˆå«åšå…·ä½“è¢«è§‚å¯Ÿè€…(Concrete Observable)è§’è‰²ã€‚ â— æŠ½è±¡è§‚å¯Ÿè€…(Observer)è§’è‰²ï¼šä¸ºæ‰€æœ‰çš„å…·ä½“è§‚å¯Ÿè€…å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œåœ¨å¾—åˆ°ä¸»é¢˜çš„é€šçŸ¥æ—¶æ›´æ–°è‡ªå·±ï¼Œè¿™ä¸ªæ¥å£å«åšæ›´æ–°æ¥å£ã€‚ â— å…·ä½“è§‚å¯Ÿè€…(ConcreteObserver)è§’è‰²ï¼šå­˜å‚¨ä¸ä¸»é¢˜çš„çŠ¶æ€è‡ªæ°çš„çŠ¶æ€ã€‚å…·ä½“è§‚å¯Ÿè€…è§’è‰²å®ç°æŠ½è±¡è§‚å¯Ÿè€…è§’è‰²æ‰€è¦æ±‚çš„æ›´æ–°æ¥å£ï¼Œä»¥ä¾¿ä½¿æœ¬èº«çš„çŠ¶æ€ä¸ä¸»é¢˜çš„çŠ¶æ€ åƒåè°ƒã€‚å¦‚æœéœ€è¦ï¼Œå…·ä½“è§‚å¯Ÿè€…è§’è‰²å¯ä»¥ä¿æŒä¸€ä¸ªæŒ‡å‘å…·ä½“ä¸»é¢˜å¯¹è±¡çš„å¼•ç”¨ã€‚ ä¸»é¢˜å¯¹è±¡å‘è§‚å¯Ÿè€…æ¨é€ä¸»é¢˜çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¸ç®¡è§‚å¯Ÿè€…æ˜¯å¦éœ€è¦ï¼Œæ¨é€çš„ä¿¡æ¯é€šå¸¸æ˜¯ä¸»é¢˜å¯¹è±¡çš„å…¨éƒ¨æˆ–éƒ¨åˆ†æ•°æ®ã€‚ æŠ½è±¡è§‚å¯Ÿè€…è§’è‰²1234public interface Observer { void update(String state); String getName();} å…·ä½“è§‚å¯Ÿè€…1234567891011121314151617181920212223242526public class ConcreteObserver implements Observer { private String name; private String state; public ConcreteObserver(String name) { this.name = name; } public String getState() { return state; } public void setState(String state) { this.state = state; } @Override public void update(String state) { // æ›´æ–°è§‚å¯Ÿ ç€çŠ¶æ€ this.state = state; System.out.println(getName() + \"è§‚å¯Ÿè€…çŠ¶æ€æ›´æ–°ä¸ºï¼š\" + state); } @Override public String getName() { return name; }} æŠ½è±¡ä¸»é¢˜è§’è‰²1234567891011121314151617181920212223242526272829303132public abstract class Subject { /** * ä¿å­˜è§‚å¯Ÿè€…çš„å®¹å™¨ */ private List&lt;Observer&gt; list = new ArrayList&lt;Observer&gt;(); /** * æ³¨å†Œè§‚å¯Ÿè€… */ public void register(Observer o) { list.add(o); System.out.println(\"å¢åŠ äº†ä¸€ä¸ªè§‚å¯Ÿè€…:\" + o.getName()); } /** * ç§»é™¤è§‚å¯Ÿè€… * * @param o */ public void remove(Observer o) { System.out.println(\"ç§»é™¤äº†ä¸€ä¸ªè§‚å¯Ÿè€…:\" + o.getName()); list.remove(o); } /** * é€šçŸ¥è§‚å¯Ÿè€… * * @param newState */ public void nodifyObservers(String newState) { for (Observer observer : list) { observer.update(newState); } }} å…·ä½“ä¸»é¢˜è§’è‰²12345678910111213141516public class ConcreteSubject extends Subject { /** * çŠ¶æ€ */ private String state; public String getState() { return state; } public void change(String newState) { state = newState; System.out.println(\"çŠ¶æ€å˜ä¸ºï¼š\" + newState); System.out.println(\"å¼€å§‹é€šçŸ¥è§‚å¯Ÿè€…...\"); this.nodifyObservers(state); }} æµ‹è¯•ç±»12345678910111213public class MainTest { public static void main(String[] args) { Observer o1 = new ConcreteObserver(\"o1\"); Observer o2 = new ConcreteObserver(\"o2\"); Observer o3 = new ConcreteObserver(\"o3\"); ConcreteSubject csj = new ConcreteSubject(); csj.register(o1); csj.register(o2); csj.register(o3); csj.remove(o2); csj.change(\"new Stateï¼\"); }} è¾“å‡ºç»“æœ åœ¨è¿è¡Œæ—¶ï¼Œè¿™ä¸ªå®¢æˆ·ç«¯é¦–å…ˆåˆ›å»ºäº†å…·ä½“ä¸»é¢˜ç±»çš„å®ä¾‹ï¼Œä»¥åŠä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡ã€‚ç„¶åï¼Œå®ƒè°ƒç”¨ä¸»é¢˜å¯¹è±¡çš„register()æ–¹æ³•ï¼Œå°†è¿™ä¸ªè§‚å¯Ÿè€…å¯¹è±¡å‘ä¸»é¢˜å¯¹è±¡ç™»è®°ï¼Œä¹Ÿå°±æ˜¯å°†å®ƒåŠ å…¥åˆ°ä¸»é¢˜å¯¹è±¡çš„èšé›†ä¸­å»ã€‚ è¿™æ—¶ï¼Œå®¢æˆ·ç«¯è°ƒç”¨ä¸»é¢˜çš„change()æ–¹æ³•ï¼Œæ”¹å˜äº†ä¸»é¢˜å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ã€‚ä¸»é¢˜å¯¹è±¡åœ¨çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè°ƒç”¨è¶…ç±»çš„notifyObservers()æ–¹æ³•ï¼Œé€šçŸ¥æ‰€æœ‰ç™»è®°è¿‡çš„è§‚å¯Ÿè€…å¯¹è±¡ æ‹‰æ¨¡å¼ç»“æ„è¯´æ˜ ä¸»é¢˜å¯¹è±¡åœ¨é€šçŸ¥è§‚å¯Ÿè€…çš„æ—¶å€™ï¼Œåªä¼ é€’å°‘é‡ä¿¡æ¯ã€‚å¦‚æœè§‚å¯Ÿè€…éœ€è¦æ›´å…·ä½“çš„ä¿¡æ¯ï¼Œç”±è§‚å¯Ÿè€…ä¸»åŠ¨åˆ°ä¸»é¢˜å¯¹è±¡ä¸­è·å–ï¼Œç›¸å½“äºæ˜¯è§‚å¯Ÿè€…ä»ä¸»é¢˜å¯¹è±¡ä¸­æ‹‰æ•°æ®ã€‚ä¸€èˆ¬è¿™ç§æ¨¡å‹çš„å®ç°ä¸­ï¼Œä¼šæŠŠä¸»é¢˜å¯¹è±¡è‡ªèº«é€šè¿‡update()æ–¹æ³•ä¼ é€’ç»™è§‚å¯Ÿè€…ï¼Œè¿™æ ·åœ¨è§‚å¯Ÿè€…éœ€è¦è·å–æ•°æ®çš„æ—¶å€™ï¼Œå°±å¯ä»¥é€šè¿‡è¿™ä¸ªå¼•ç”¨æ¥è·å–äº†ã€‚ æŠ½è±¡è§‚å¯Ÿè€…è§’è‰²12345678public interface Observer { /** * ä¼ å…¥ä¸»é¢˜ï¼Œè·å–ä¸­çš„å¯¹è±¡ * @param subject */ void update(Subject subject); String getName();} å…·ä½“è§‚å¯Ÿè€…123456789101112131415161718192021222324252627public class ConcreteObserver implements Observer { private String name; private String state; public ConcreteObserver(String name) { this.name = name; } public String getState() { return state; } public void setState(String state) { this.state = state; } @Override public String getName() { return name; } @Override public void update(Subject subject) { // ä¸»åŠ¨å»ä¸»é¢˜é‡Œæ‹¿æ•°æ® state = ((ConcreteSubject) subject).getState(); System.out.println(getName() + \"è§‚å¯Ÿè€…çŠ¶æ€æ›´æ–°ä¸ºï¼š\" + state); }} æŠ½è±¡ä¸»é¢˜è§’è‰²1234567891011121314151617181920212223242526272829303132333435public abstract class Subject { /** * ä¿å­˜è§‚å¯Ÿè€…çš„å®¹å™¨ */ private List&lt;Observer&gt; list = new ArrayList&lt;Observer&gt;(); /** * æ³¨å†Œè§‚å¯Ÿè€… */ public void register(Observer o) { list.add(o); System.out.println(\"å¢åŠ äº†ä¸€ä¸ªè§‚å¯Ÿè€…:\" + o.getName()); } /** * ç§»é™¤è§‚å¯Ÿè€… * * @param o */ public void remove(Observer o) { System.out.println(\"ç§»é™¤äº†ä¸€ä¸ªè§‚å¯Ÿè€…:\" + o.getName()); list.remove(o); } /** * é€šçŸ¥è§‚å¯Ÿè€… * * @param newState */ public void nodifyObservers() { for (Observer observer : list) { observer.update(this); } }} å…·ä½“ä¸»é¢˜è§’è‰²123456789101112131415161718public class ConcreteSubject extends Subject { /** * çŠ¶æ€ */ private String state; public String getState() { return state; } public void change(String newState) { state = newState; System.out.println(\"çŠ¶æ€å˜ä¸ºï¼š\" + newState); System.out.println(\"å¼€å§‹é€šçŸ¥è§‚å¯Ÿè€…...\"); this.nodifyObservers(); }} æµ‹è¯•12345678910111213public class MainTest { public static void main(String[] args) { Observer o1 = new ConcreteObserver(\"o1\"); Observer o2 = new ConcreteObserver(\"o2\"); Observer o3 = new ConcreteObserver(\"o3\"); ConcreteSubject csj = new ConcreteSubject(); csj.register(o1); csj.register(o2); csj.register(o3); csj.remove(o2); csj.change(\"new Stateï¼\"); }} æµ‹è¯•ç»“æœ ä¸¤ç§æ¨¡å¼çš„æ¯”è¾ƒ æ¨æ¨¡å‹æ˜¯å‡å®šä¸»é¢˜å¯¹è±¡çŸ¥é“è§‚å¯Ÿè€…éœ€è¦çš„æ•°æ®ï¼›è€Œæ‹‰æ¨¡å‹æ˜¯ä¸»é¢˜å¯¹è±¡ä¸çŸ¥é“è§‚å¯Ÿè€…å…·ä½“éœ€è¦ä»€ä¹ˆæ•°æ®ï¼Œæ²¡æœ‰åŠæ³•çš„æƒ…å†µä¸‹ï¼Œå¹²è„†æŠŠè‡ªèº«ä¼ é€’ç»™è§‚å¯Ÿè€…ï¼Œè®©è§‚å¯Ÿè€…è‡ªå·±å»æŒ‰éœ€è¦å–å€¼ã€‚ æ¨æ¨¡å‹å¯èƒ½ä¼šä½¿å¾—è§‚å¯Ÿè€…å¯¹è±¡éš¾ä»¥å¤ç”¨ï¼Œå› ä¸ºè§‚å¯Ÿè€…çš„update()æ–¹æ³•æ˜¯æŒ‰éœ€è¦å®šä¹‰çš„å‚æ•°ï¼Œå¯èƒ½æ— æ³•å…¼é¡¾æ²¡æœ‰è€ƒè™‘åˆ°çš„ä½¿ç”¨æƒ…å†µã€‚è¿™å°±æ„å‘³ç€å‡ºç°æ–°æƒ…å†µçš„æ—¶å€™ï¼Œå°±å¯èƒ½æä¾›æ–°çš„update()æ–¹æ³•ï¼Œæˆ–è€…æ˜¯å¹²è„†é‡æ–°å®ç°è§‚å¯Ÿè€…ï¼›è€Œæ‹‰æ¨¡å‹å°±ä¸ä¼šé€ æˆè¿™æ ·çš„æƒ…å†µï¼Œå› ä¸ºæ‹‰æ¨¡å‹ä¸‹ï¼Œupdate()æ–¹æ³•çš„å‚æ•°æ˜¯ä¸»é¢˜å¯¹è±¡æœ¬èº«ï¼Œè¿™åŸºæœ¬ä¸Šæ˜¯ä¸»é¢˜å¯¹è±¡èƒ½ä¼ é€’çš„æœ€å¤§æ•°æ®é›†åˆäº†ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥é€‚åº”å„ç§æƒ…å†µçš„éœ€è¦ã€‚ å‚è€ƒé“¾æ¥","link":"/2018/11/15/Javaè®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼.html"},{"title":"Immutable Object(ä¸å¯å˜å¯¹è±¡)æ¨¡å¼","text":"å¤šçº¿ç¨‹ä¸‹ï¼Œä¸€ä¸ªå¯¹è±¡ä¼šè¢«å¤šä¸ªçº¿ç¨‹å…±äº«ï¼Œå­˜åœ¨å¤šçº¿ç¨‹å¹¶å‘åœ°ä¿®æ”¹å¯¹è±¡çš„å±æ€§ï¼Œéœ€è¦åšäº›åŒæ­¥è®¿é—®æ§åˆ¶ï¼Œå¦‚æ˜¾ç¤ºé”ï¼ŒCASæ“ä½œï¼Œä¼šå¸¦æ¥é¢å¤–çš„å¼€é”€å’Œé—®é¢˜ï¼Œå¦‚ä¸Šä¸‹æ–‡åˆ‡æ¢ã€ç­‰å¾…æ—¶é—´ã€ABAé—®é¢˜ã€‚Immutable Objectæ¨¡å¼æ„å›¾é€šè¿‡ä½¿ç”¨å¯¹å¤–å¯è§çš„çŠ¶æ€ä¸å¯å˜çš„å¯¹è±¡ï¼Œä½¿å¾—å¤©ç”Ÿå…·æœ‰çº¿ç¨‹å®‰å…¨æ€§ã€‚ è½¦è¾†ç®¡ç†ç³»ç»ŸçŠ¶æ€å¯å˜çš„ä½ç½®ä¿¡æ¯æ¨¡å‹123456789101112131415161718192021public class Location { private double x; private double y; public Location(double x, double y) { this.x = x; this.y = y; } public double getX() { return x; } public double getY() { return y; } public void setXY(double x, double y) { this.x = x; this.y = y; }} ç®¡ç†ç³»ç»Ÿä¸­ä¼šè°ƒç”¨Locationçš„setXYæ–¹æ³•æ¥æ›´æ–°ä½ç½®ï¼Œå› ä¸ºæ˜¯éçº¿ç¨‹å®‰å…¨ï¼Œå¹¶éåŸå­æ“ä½œï¼Œå¯¼è‡´è°ƒç”¨æ—¶ä¼šå‡ºç°æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µ æ”¹è¿›ï¼šçŠ¶æ€ä¸å¯å˜çš„ä½ç½®ä¿¡æ¯æ¨¡å‹123456789public final class Location{ public final double x; public final double y; public Location(double x,double y){ this.x = x; this.y = y; }} ä½¿ç”¨çŠ¶æ€ä¸å¯å˜çš„å¯¹è±¡æ—¶ï¼Œæ›´æ–°ä¿¡æ¯æ¨¡å‹æ—¶ï¼Œå¦‚æœè½¦è¾†çš„ä½ç½®å‘ç”Ÿå˜åŠ¨ï¼Œæ›´æ–°çš„æ˜¯æ•´ä¸ªä½ç½®ä¿¡æ¯çš„å¯¹è±¡ æ›´æ–°ä¸å¯å˜å¯¹è±¡çš„ä½ç½®ä¿¡æ¯123456public class VehicleTracker{ private Map&lt;String,Location&gt; locMap = new ConcurrentHashMap&lt;String, Location&gt;(); public void updateLocation(String vehicleId,Location newLocation){ locMap.put(vehicleId,newLocation); } } ä¸€ä¸ªä¸¥æ ¼æ„ä¹‰ä¸Šçš„ä¸å¯å˜å¯¹è±¡åº”è¯¥æ»¡è¶³ä»¥ä¸‹æ‰€æœ‰æ¡ä»¶ ç±»æœ¬èº«ç”¨finalä¿®é¥° æ‰€æœ‰å­—æ®µéƒ½æ˜¯ç”¨finalä¿®é¥°ï¼Œè¿™ä¸ªè¯­æ„åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ç”±JVMä¿è¯äº†è¢«ä¿®é¥°å­—æ®µæ‰€å¼•ç”¨å¯¹è±¡çš„åˆå§‹åŒ–å®‰å…¨ï¼Œå³finalä¿®é¥°çš„å­—æ®µåœ¨å…¶ä»–çº¿ç¨‹æ˜¯å¯è§çš„ï¼Œå¿…å®šæ˜¯åˆå§‹åŒ–å®Œæˆçš„ã€‚ åœ¨å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ä¸­ï¼Œthiså…³é”®å­—æ²¡æœ‰æ³„éœ²ç»™å…¶ä»–ç±»ï¼Œé˜²æ­¢å…¶ä»–ç±»åœ¨å¯¹è±¡åˆ›å»ºè¿‡ç¨‹ä¸­ä¿®æ”¹å…¶çŠ¶æ€ ä»»ä½•å­—æ®µå¦‚æœå¼•ç”¨å…¶ä»–çŠ¶æ€å¯å˜çš„å¯¹è±¡ï¼Œå¦‚é›†åˆæ•°ç»„ï¼Œè¿™äº›å­—æ®µå¿…é¡»æ˜¯privateä¿®é¥°çš„ï¼Œä¸èƒ½æš´éœ²ç»™å¤–éƒ¨ï¼Œæ‰€æœ‰ç›¸å…³æ–¹æ³•è¦è¿”å›è¿™äº›å­—æ®µå€¼ï¼Œåº”è¯¥é˜²æ­¢é˜²å¾¡æ€§å¤åˆ¶ å®ä¾‹ï¼š æŸå½©ä¿¡ç½‘å…³ç³»ç»Ÿ åœ¨å¤„ç†ç”±å¢å€¼ä¸šåŠ¡æä¾›å•†VASPä¸‹å‘ç»™æ‰‹æœºç»ˆç«¯ç”¨æˆ·çš„å½©ä¿¡ä¿¡æ¯æ—¶ï¼Œéœ€è¦æ ¹æ®å½©ä¿¡æ¥æ”¶æ–¹å·ç çš„å‰ç¼€é€‰æ‹©å¯¹åº”çš„å½©ä¿¡ä¸­å¿ƒMMSCï¼Œç„¶åè½¬å‘æ¶ˆæ¯ç»™é€‰ä¸­çš„å½©ä¿¡ä¸­å¿ƒã€‚ç”±å…¶ä»–ç³»ç»Ÿå°†å½©ä¿¡ä¿¡æ¯ä¸‹å‘ç»™æ‰‹æœºç»ˆç«¯ç”¨æˆ·ã€‚é€‰æ‹©å½©ä¿¡ä¸­å¿ƒçš„è¿‡ç¨‹ç§°ä¸º è·¯ç”± ï¼Œæ‰‹æœºå‰ç¼€å’Œå½©ä¿¡ä¸­å¿ƒå¯¹åº”çš„å…³ç³»å«è·¯ç”±è¡¨ï¼Œåœ¨ç³»ç»Ÿä¸­å¤šçº¿ç¨‹å…±äº«ï¼Œå¾ˆå°‘æ”¹å˜æ­¤æ•°æ®ï¼Œä¸å¸Œæœ›è®¿é—®è¿™äº›æ•°æ®æ—¶è¿›è¡ŒåŠ é”å¹¶å‘è®¿é—®æ§åˆ¶ï¼Œé¿å…äº§ç”Ÿä¸å¿…è¦çš„å¼€é”€ï¼Œæ‰€ä»¥é€‰æ‹©immutable objectæ¨¡å‹ã€‚ å½©ä¿¡ä¸­å¿ƒè·¯ç”±è§„åˆ™ç®¡ç†å™¨1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253/***å½©ä¿¡ä¸­å¿ƒè·¯ç”±è§„åˆ™ç®¡ç†å™¨**/public final class MMSCRouter{ // ä¿è¯å¤šçº¿ç¨‹ç¯å¢ƒä¸‹è¯¥å˜é‡çš„å¯è§æ€§ private static volatile MMSCRouter instance = new MMSCRouter(); // ç»´æŠ¤æ‰‹æœºå·ç å‰ç¼€åˆ°å½©ä¿¡ä¸­å¿ƒä¹‹é—´çš„æ˜ å°„å…³ç³» private final Map&lt;String,MMSCInfo&gt; routerMap; public MMSCRouter(){ // å°†æ•°æ®åº“è¡¨ä¸­çš„æ•°æ®åŠ è½½åˆ°å†…å­˜ï¼Œå­˜ä¸ºMap this.routerMap = MMSCRouter.retrieveRouterMapFromDB(); } private static Map&lt;String,MMSCInfo&gt; retrieveRouterMapFromDB(){ Map&lt;String,MMSCInfo&gt; map = new HashMap&lt;&gt;(); // çœç•¥å…¶ä½™ä»£ç  return map; } public static MMSCRouter getInstance(){ return instance; } /** *æ ¹æ®æ‰‹æœºå·å‰ç¼€è·å–å½©ä¿¡ä¸­å¿ƒä¿¡æ¯ **/ public MMSCInfo getMMSC(String msisdPrefix){ return routerMap.get(msisdPrefix); } /** *æ›´æ–°ä¸ºæŒ‡å®šçš„æ–°å®ä¾‹ **/ public static void setInstance(MMSCRouter newInstance){ instance = newInstance; } /** *é˜²å¾¡æ€§å¤åˆ¶ **/ private static Map&lt;String,MMSCInfo&gt; deepCopy(Map&lt;String,MMSCInfo&gt; m){ Map&lt;String,MMSCInfo&gt; result = new HashMap&lt;String,MMSCInfo&gt;(); for(String key : m.keySet()){ result.put(key, new MMSCInfo(m.get(key))); } return result; } // é˜²æ­¢å¤–éƒ¨ä»£ç ä¿®æ”¹å¯å˜æ•°æ®routerMapçš„å€¼ public Map&lt;String,MMSCInfo&gt; getRouterMap(){ return Collections.unmodifiableMap(deepCopy(routerMap)); }} å½©ä¿¡ä¸­å¿ƒä¿¡æ¯123456789101112131415161718192021222324252627282930public final class MMSCInfo{ private final String deviceId; private final String url; private final int maxAttachmentSizeInBytes; public MMSCInfo(String deviceId, String url, int maxAttachmentSizeInBytes){ this.deviceId = deviceId; this.url = url; this.maxAttachmentSizeInBytes = maxAttachmentSizeInBytes; } public MMSCInfo(MMSCInfo protoType){ this.deviceId = protoType.deviceId; this.url = protoType.url; this.maxAttachmentSizeInBytes = protoType.maxAttachmentSizeInBytes; } public String getDeviceId(){ return deviceId; } public String getUrl(){ return url; } public int getMaxAttachmentSizeInBytes(){ return maxAttachmentSizeInBytes; } } å½©ä¿¡ä¸­å¿ƒä¿¡æ¯å˜æ›´çš„é¢‘ç‡ä¹ŸåŒæ ·ä¸é«˜ã€‚å› æ­¤ï¼Œå½“å½©ä¿¡ç½‘å…³ç³»ç»Ÿé€šè¿‡ç½‘ç»œè¢«é€šçŸ¥åˆ°è¿™ç§å½©ä¿¡ä¸­å¿ƒä¿¡æ¯æœ¬èº«æˆ–è€…è·¯ç”±å˜æ›´æ—¶ï¼Œç½‘å…³ç³»ç»Ÿä¼šé‡æ–°ç”Ÿæˆæ–°çš„MMSInfoå’ŒMMSRouteræ¥ååº”å˜æ›´ã€‚ å½©ä¿¡ä¸­å¿ƒã€è·¯ç”±è¡¨çš„å˜æ›´123456789101112131415161718public class OMCAgent extends Thread{ @Override public void run(){ boolean isTableModificationMsg = false; String updatedTableName = null; while(true){ // çœç•¥ä»£ç  ä»ä¸OMC è¿æ¥ä¸­è¯»å–ä¿¡æ¯è¿›è¡Œè§£æ // è§£æåˆ°æ•°æ®è¡¨æ›´æ–°ä¿¡æ¯åï¼Œé‡ç½®MMSCRouterå®ä¾‹ if(isTableModificationMsg){ if(\"MMSCInfo\".equals(updatedTableName)){ // new MMSCRouter() ä»æ•°æ®åº“ä¸­åŠ è½½å˜æ›´çš„ä¿¡æ¯å­˜å…¥ MMSCRouter.setInstance(new MMSCRouter()); } } // çœç•¥å…¶ä»–ä»£ç  } }} æœ¬åˆ—ä¸­MMSCInfo æ˜¯ä¸€ä¸ªä¸¥æ ¼æ„ä¹‰ä¸Šçš„ä¸å¯å˜å¯¹è±¡ï¼Œè™½ç„¶MMSCRouterå¯¹è±¡å¯¹å¤–æä¾›äº†setInstanceæ–¹æ³•ç”¨äºæ”¹å˜é™æ€å­—æ®µinstanceçš„å€¼ï¼Œä½†å®ƒä»ç„¶å¯è¢«è§†ä½œä¸€ä¸ªç­‰æ•ˆçš„ä¸å¯å˜å¯¹è±¡ã€‚å› ä¸ºsetInstanceä»…ä»…æ”¹å˜instanceå˜é‡æŒ‡å‘çš„å¯¹è±¡ï¼Œè€Œinstanceå˜é‡é‡‡ç”¨volatileä¿®é¥°ä¿è¯äº†å…¶ä½™çº¿ç¨‹çš„å¯è§æ€§ï¼Œæ‰€ä»¥æ— éœ€åŠ é”å…¶ä»–çº¿ç¨‹ä¹Ÿèƒ½è·å–åˆ°æœ€æ–°çš„instance æ€»ç»“Immutable Object æ¨¡å‹ä½¿ç”¨åœºæ™¯ è¢«å»ºæ¨¡å¯¹è±¡çš„çŠ¶æ€å˜åŒ–ä¸é¢‘ç¹ åŒæ—¶å¯¹ä¸€ç»„ç›¸å…³çš„æ•°æ®è¿›è¡Œå†™æ“ä½œï¼Œå› æ­¤éœ€è¦ä¿è¯åŸå­æ€§ ä½¿ç”¨æŸä¸ªå¯¹è±¡ä½œä¸ºå®‰å…¨çš„HashMapçš„å¯ä»¥keyã€‚ç”±äºfinalä¸å¯å˜å¯¹è±¡ä¸å˜æ‰€æœ‰hashcodeä¸å˜ï¼Œæ‰€ä»¥é€‚åˆä½œä¸ºHashMap çš„keyã€‚ å‚è€ƒæ–‡çŒ®javaå¤šçº¿ç¨‹ç¼–ç¨‹å®æˆ˜æŒ‡å—ï¼ˆè®¾è®¡æ¨¡å¼ç¯‡ï¼‰é»„æ–‡æµ·/è‘—","link":"/2018/11/13/Immutable-Object-ä¸å¯å˜å¯¹è±¡-æ¨¡å¼.html"},{"title":"elasticsearch6 query å…¨æ–‡æŸ¥è¯¢ä¸è¯é¡¹æŸ¥è¯¢","text":"queryå…¨æ–‡æŸ¥è¯¢ QueryBuilders.matchQuery(â€œfiledâ€,â€valueâ€).operator(Operator.AND); // å¯¹æŸ¥è¯¢çš„è¯­å¥è¿›è¡Œåˆ†è¯ï¼Œåˆ†è¯åçš„è¯ä»»æ„ä¸€ä¸ªåŒ¹é…docéƒ½èƒ½æŸ¥å‡ºæ¥ term query æŸ¥è¯¢çš„æ˜¯è¯é¡¹&lt;åˆ†è¯åçš„&gt; ï¼ˆegï¼šJavaç¼–ç¨‹æ€æƒ³ï¼‰ Javaç¼–ç¨‹ term query ä¸èƒ½æŸ¥åˆ° åˆ†è¯åå˜æˆï¼ˆJava ç¼–ç¨‹ æ€æƒ³ï¼‰ matchQueryèƒ½æŸ¥åˆ° QueryBuilders.matchPhraseQuery(â€œfieldâ€,â€valueâ€);å¯¹valueè¿›è¡Œåˆ†è¯ï¼Œå¯ä»¥è‡ªå®šä¹‰åˆ†è¯å™¨,æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶æ‰èƒ½è¢«æœåˆ°ï¼š åˆ†è¯åçš„æ‰€æœ‰è¯é¡¹éƒ½è¦åŒ¹é…åŸå­—æ®µ é¡ºåºè¿˜éœ€è¦ä¸€è‡´ QueryBuilders.matchPhrasePrefixQuery(â€œfieldâ€,â€valueâ€);ä¸matchPhraseQueryç±»ä¼¼,æœ€åä¸€ä¸ªtermæ”¯æŒå‰ç¼€åŒ¹é…eg.matchPhraseQuery æŸ¥ â€œhello wordâ€ matchPhrasePrefixQueryåªéœ€è¦æŸ¥ â€œhello wâ€å³å¯ QueryBuilders.multiMatchQuery(â€œvalueâ€,â€field1â€,â€field2â€); å¤šå­—æ®µæ”¯æŒæŸ¥è¯¢ï¼Œå­—æ®µå¯ä»¥ä½¿ç”¨é€šé…ç¬¦eg,{&quot;ä¸­å›½&quot;,&quot;tit*&quot;,&quot;wor?&quot;} QueryBuilders.commonTermsQuery(â€œå“‡â€,â€heheâ€);é€šç”¨æŸ¥è¯¢ï¼Œä¼šè‡ªåŠ¨åˆ†è¯ä¸ºä½é¢‘å’Œé«˜é¢‘é¡¹ï¼Œå…ˆæŸ¥ä½é¢‘ï¼Œå¯ä»¥æ§åˆ¶ä½é¢‘ã€é«˜é¢‘å‡ºç°æ¦‚ç‡ eg.the word theå°±æ˜¯é«˜é¢‘ ï¼Œå¯ä»¥å…ˆæŸ¥ word QueryBuilders.queryStringQuery(â€œâ€);æ”¯æŒluceneæŸ¥è¯¢è¯­æ³• QueryBuilders.simpleQueryStringQuery(â€œâ€);æ”¯æŒluceneæŸ¥è¯¢è¯­æ³•ï¼Œå…·æœ‰éå¸¸å®Œå–„çš„è¯­æ³•æŸ¥è¯¢ï¼Œè§£æè¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸ä¸ä¼šæŠ›é”™ QueryBuilders.matchAllQuery();æŸ¥æ‰€æœ‰å’Œä¸å†™åŒæ ·æ•ˆæœ è¯é¡¹æŸ¥è¯¢ term query è¯é¡¹æ£€ç´¢ terms query è¯é¡¹æ£€ç´¢ï¼Œå¯ä»¥å¤šä¸ªè¯é¡¹ï¼ŒæŸ¥åˆ°ä¸€ä¸ªéƒ½èƒ½åŒ¹é…ç»“æœ range query æŸ¥è¯¢èŒƒå›´å†…çš„ gt å¤§äº gte å¤§äºç­‰äº lt å°äº lte å°äºç­‰äº exist query æŸ¥è¯¢ä¼šè¿”å›å­—æ®µä¸­è‡³å°‘æœ‰ä¸€ä¸ªéç©ºç©ºå­—ç¬¦ä¸²ä¹Ÿè¿”å›çš„doc prefix query æŸ¥è¯¢å­—æ®µä¸­ç»™å®šå‰ç¼€çš„æ–‡æ¡£ eg.{&quot;title&quot;:&quot;hel&quot;} wildcard query æŸ¥è¯¢å­—æ®µé€šé…ç¬¦eg.&quot;{&quot;title&quot;:&quot;hell?/ *ell*&quot;} regexp query æ­£åˆ™åŒ¹é…æŸ¥è¯¢eg.{&quot;title&quot;:&quot;W[0-9].+&quot;} fuzzy query æ¨¡ç³ŠæŸ¥è¯¢ï¼Œæœ€æ¥è¿‘çš„æŸ¥è¯¢ï¼Œå•è¯æ‹¼é”™ä¸€ä¸ªå­—æ¯çš„æ—¶å€™ï¼Œæ¶ˆè€—èµ„æºå¤š type query æŒ‡å®šç±»å‹çš„æ–‡æ¡£ ids query æŸ¥è¯¢å…·æœ‰æŒ‡å®šidçš„æ–‡æ¡£","link":"/2018/11/13/elasticsearch6-query-å…¨æ–‡æŸ¥è¯¢ä¸è¯é¡¹æŸ¥è¯¢.html"},{"title":"leetcode-1-Two Sum","text":"description Given an array of integers, return indices of the two numbers such that they add up to a specific target. You may assume that each input would have exactly one solution, and you may not use the same element twice. Example: Given nums = [2, 7, 11, 15], target = 9, Because nums[0] + nums[1] = 2 + 7 = 9, return [0, 1]. common method 1234567891011121314class Solution { public int[] twoSum(int[] nums, int target) { int[] ret = new int[2]; for(int i =0; i&lt;nums.length-1 ;i++){ for (int j = i+1 ;j &lt; nums.length ;j++ ){ if (nums[i] + nums[j] == target){ ret = new int[]{i, j}; return ret; } } } return ret ; }} best method1234567891011121314151617class Solution { public int[] twoSum(int[] nums, int target) { int len=nums.length; HashMap&lt;Integer, Integer&gt; map=new HashMap&lt;&gt;(); map.put(nums[0], 0); for(int i=1;i&lt;len;i++){ if(map.containsKey(target-nums[i])){ int[] returnArray={map.get(target-nums[i]),i}; return returnArray; } else{ map.put(nums[i], i); } } int[] returnArray={0,0}; return returnArray; }}","link":"/2018/11/11/leetcode-1-Two-Sum.html"},{"title":"Hello blog","text":"this is a first blog.It's a very exciting time make a plan execute have a harvest come on 12345public void start(){ while(true){ System.out.println(\"struggleï¼\"); }}","link":"/2018/11/11/Hello-blog.html"},{"title":"Hello World","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \" My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","link":"/2018/11/11/hello-world.html"}],"tags":[{"name":"Effective-Java","slug":"Effective-Java","link":"/tags/Effective-Java/"},{"name":"è¯»ä¹¦ç¬”è®°","slug":"è¯»ä¹¦ç¬”è®°","link":"/tags/è¯»ä¹¦ç¬”è®°/"},{"name":"java","slug":"java","link":"/tags/java/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","link":"/tags/è®¾è®¡æ¨¡å¼/"},{"name":"elasticsearch6","slug":"elasticsearch6","link":"/tags/elasticsearch6/"},{"name":"query","slug":"query","link":"/tags/query/"},{"name":"think","slug":"think","link":"/tags/think/"},{"name":"leetcode","slug":"leetcode","link":"/tags/leetcode/"},{"name":"arithmetic","slug":"arithmetic","link":"/tags/arithmetic/"},{"name":"å·¥å…·æ•™ç¨‹","slug":"å·¥å…·æ•™ç¨‹","link":"/tags/å·¥å…·æ•™ç¨‹/"},{"name":"icarusä¸»é¢˜é…ç½®","slug":"icarusä¸»é¢˜é…ç½®","link":"/tags/icarusä¸»é¢˜é…ç½®/"},{"name":"hexoä¸»é¢˜","slug":"hexoä¸»é¢˜","link":"/tags/hexoä¸»é¢˜/"},{"name":"æ­£åˆ™è¡¨è¾¾å¼","slug":"æ­£åˆ™è¡¨è¾¾å¼","link":"/tags/æ­£åˆ™è¡¨è¾¾å¼/"},{"name":"ç´¢å¼•åˆ†è¯","slug":"ç´¢å¼•åˆ†è¯","link":"/tags/ç´¢å¼•åˆ†è¯/"},{"name":"mysql","slug":"mysql","link":"/tags/mysql/"},{"name":"ç´¢å¼•","slug":"ç´¢å¼•","link":"/tags/ç´¢å¼•/"},{"name":"ç»éªŒæˆé•¿","slug":"ç»éªŒæˆé•¿","link":"/tags/ç»éªŒæˆé•¿/"},{"name":"å¹‚ç­‰æ€§,restful-api","slug":"å¹‚ç­‰æ€§-restful-api","link":"/tags/å¹‚ç­‰æ€§-restful-api/"},{"name":"æ”¯ä»˜ç³»ç»Ÿ","slug":"æ”¯ä»˜ç³»ç»Ÿ","link":"/tags/æ”¯ä»˜ç³»ç»Ÿ/"},{"name":"æ”¯ä»˜æ¶æ„","slug":"æ”¯ä»˜æ¶æ„","link":"/tags/æ”¯ä»˜æ¶æ„/"},{"name":"sql","slug":"sql","link":"/tags/sql/"},{"name":"æ³•å¾‹","slug":"æ³•å¾‹","link":"/tags/æ³•å¾‹/"},{"name":"é›†åˆ","slug":"é›†åˆ","link":"/tags/é›†åˆ/"},{"name":"java,å¹¶å‘,å¤šçº¿ç¨‹","slug":"java-å¹¶å‘-å¤šçº¿ç¨‹","link":"/tags/java-å¹¶å‘-å¤šçº¿ç¨‹/"}],"categories":[{"name":"java","slug":"java","link":"/categories/java/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"java/è®¾è®¡æ¨¡å¼","link":"/categories/java/è®¾è®¡æ¨¡å¼/"},{"name":"è¯»ä¹¦ç¬”è®°","slug":"java/è¯»ä¹¦ç¬”è®°","link":"/categories/java/è¯»ä¹¦ç¬”è®°/"},{"name":"elasticsearch6","slug":"java/elasticsearch6","link":"/categories/java/elasticsearch6/"},{"name":"javaåŸºç¡€","slug":"java/javaåŸºç¡€","link":"/categories/java/javaåŸºç¡€/"},{"name":"arithmetic","slug":"java/arithmetic","link":"/categories/java/arithmetic/"},{"name":"å·¥å…·æ•™ç¨‹","slug":"å·¥å…·æ•™ç¨‹","link":"/categories/å·¥å…·æ•™ç¨‹/"},{"name":"ä¸»é¢˜å·¥å…·","slug":"å·¥å…·æ•™ç¨‹/ä¸»é¢˜å·¥å…·","link":"/categories/å·¥å…·æ•™ç¨‹/ä¸»é¢˜å·¥å…·/"},{"name":"JVM","slug":"java/JVM","link":"/categories/java/JVM/"},{"name":"åŸºç¡€å·¥å…·ç±»","slug":"åŸºç¡€å·¥å…·ç±»","link":"/categories/åŸºç¡€å·¥å…·ç±»/"},{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","link":"/categories/æ•°æ®åº“/"},{"name":"ç»éªŒæˆé•¿","slug":"ç»éªŒæˆé•¿","link":"/categories/ç»éªŒæˆé•¿/"},{"name":"æ­£åˆ™","slug":"åŸºç¡€å·¥å…·ç±»/æ­£åˆ™","link":"/categories/åŸºç¡€å·¥å…·ç±»/æ­£åˆ™/"},{"name":"mysql","slug":"æ•°æ®åº“/mysql","link":"/categories/æ•°æ®åº“/mysql/"},{"name":"æ¶æ„","slug":"æ¶æ„","link":"/categories/æ¶æ„/"},{"name":"è®¾è®¡","slug":"æ¶æ„/è®¾è®¡","link":"/categories/æ¶æ„/è®¾è®¡/"},{"name":"æ³•å¾‹","slug":"æ³•å¾‹","link":"/categories/æ³•å¾‹/"},{"name":"å¹¶å‘","slug":"java/å¹¶å‘","link":"/categories/java/å¹¶å‘/"}]}